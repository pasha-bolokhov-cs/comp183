
window.JSON||(window.JSON={}),function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case "string":return quote(i);case "number":return isFinite(i)?
String(i):"null";case "boolean":case "null":return String(i);case "object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)d=rep[c],typeof d=="string"&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.hasOwnProperty.call(i,
d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=
function(a){return this.valueOf()});var JSON=window.JSON,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c==
"number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify");}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&
(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse");})}(),function(a,b){var c=a.History=a.History||{},d=a.jQuery;if(typeof c.Adapter!="undefined")throw new Error("History.js Adapter has already been loaded...");
c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){d(a)}},typeof c.init!="undefined"&&c.init()}(window),function(a,b){var c=a.document,d=a.setTimeout||d,e=a.clearTimeout||e,f=a.setInterval||f,g=a.History=a.History||{};if(typeof g.initHtml4!="undefined")throw new Error("History.js HTML4 Support has already been loaded...");g.initHtml4=function(){if(typeof g.initHtml4.initialized!=
"undefined")return!1;g.initHtml4.initialized=!0,g.enabled=!0,g.savedHashes=[],g.isLastHash=function(a){var b=g.getHashByIndex(),c;return c=a===b,c},g.saveHash=function(a){return g.isLastHash(a)?!1:(g.savedHashes.push(a),!0)},g.getHashByIndex=function(a){var b=null;return typeof a=="undefined"?b=g.savedHashes[g.savedHashes.length-1]:a<0?b=g.savedHashes[g.savedHashes.length+a]:b=g.savedHashes[a],b},g.discardedHashes={},g.discardedStates={},g.discardState=function(a,b,c){var d=g.getHashByState(a),e;
return e={discardedState:a,backState:c,forwardState:b},g.discardedStates[d]=e,!0},g.discardHash=function(a,b,c){var d={discardedHash:a,backState:c,forwardState:b};return g.discardedHashes[a]=d,!0},g.discardedState=function(a){var b=g.getHashByState(a),c;return c=g.discardedStates[b]||!1,c},g.discardedHash=function(a){var b=g.discardedHashes[a]||!1;return b},g.recycleState=function(a){var b=g.getHashByState(a);return g.discardedState(a)&&delete g.discardedStates[b],!0},g.emulated.hashChange&&(g.hashChangeInit=
function(){g.checkerFunction=null;var b="",d,e,h,i;return g.isInternetExplorer()?(d="historyjs-iframe",e=c.createElement("iframe"),e.setAttribute("id",d),e.style.display="none",c.body.appendChild(e),e.contentWindow.document.open(),e.contentWindow.document.close(),h="",i=!1,g.checkerFunction=function(){if(i)return!1;i=!0;var c=g.getHash()||"",d=g.unescapeHash(e.contentWindow.document.location.hash)||"";return c!==b?(b=c,d!==c&&(h=d=c,e.contentWindow.document.open(),e.contentWindow.document.close(),
e.contentWindow.document.location.hash=g.escapeHash(c)),g.Adapter.trigger(a,"hashchange")):d!==h&&(h=d,g.setHash(d,!1)),i=!1,!0}):g.checkerFunction=function(){var c=g.getHash();return c!==b&&(b=c,g.Adapter.trigger(a,"hashchange")),!0},g.intervalList.push(f(g.checkerFunction,g.options.hashChangeInterval)),!0},g.Adapter.onDomLoad(g.hashChangeInit)),g.emulated.pushState&&(g.onHashChange=function(b){var d=b&&b.newURL||c.location.href,e=g.getHashByUrl(d),f=null,h=null,i=null,j;return g.isLastHash(e)?(g.busy(!1),
!1):(g.doubleCheckComplete(),g.saveHash(e),e&&g.isTraditionalAnchor(e)?(g.Adapter.trigger(a,"anchorchange"),g.busy(!1),!1):(f=g.extractState(g.getFullUrl(e||c.location.href,!1),!0),g.isLastSavedState(f)?(g.busy(!1),!1):(h=g.getHashByState(f),j=g.discardedState(f),j?(g.getHashByIndex(-2)===g.getHashByState(j.forwardState)?g.back(!1):g.forward(!1),!1):(g.pushState(f.data,f.title,f.url,!1),!0))))},g.Adapter.bind(a,"hashchange",g.onHashChange),g.pushState=function(b,d,e,f){if(g.getHashByUrl(e))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(f!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:f}),!1;g.busy(!0);var h=g.createStateObject(b,d,e),i=g.getHashByState(h),j=g.getState(!1),k=g.getHashByState(j),l=g.getHash();return g.storeState(h),g.expectedStateId=h.id,g.recycleState(h),g.setTitle(h),i===k?(g.busy(!1),!1):i!==l&&i!==g.getShortUrl(c.location.href)?(g.setHash(i,!1),!1):(g.saveState(h),g.Adapter.trigger(a,"statechange"),g.busy(!1),!0)},g.replaceState=function(a,b,c,d){if(g.getHashByUrl(c))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");
if(d!==!1&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:d}),!1;g.busy(!0);var e=g.createStateObject(a,b,c),f=g.getState(!1),h=g.getStateByIndex(-2);return g.discardState(f,e,h),g.pushState(e.data,e.title,e.url,!1),!0}),g.emulated.pushState&&g.getHash()&&!g.emulated.hashChange&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(a,"hashchange")})},typeof g.init!="undefined"&&g.init()}(window),function(a,b){var c=a.console||b,d=a.document,e=a.navigator,f=a.sessionStorage||
!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode;if(typeof m.init!="undefined")throw new Error("History.js Core has already been loaded...");m.init=function(){return typeof m.Adapter=="undefined"?!1:(typeof m.initCore!="undefined"&&m.initCore(),typeof m.initHtml4!="undefined"&&m.initHtml4(),!0)},m.initCore=function(){if(typeof m.initCore.initialized!="undefined")return!1;
m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.storeInterval=m.options.storeInterval||1E3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;
if(typeof b!="undefined"&&b!==null){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){(m.options.debug||!1)&&m.log.apply(m,arguments)},m.log=function(){var a=typeof c!="undefined"&&typeof c.log!="undefined"&&typeof c.log.apply!="undefined",b=d.getElementById("log"),e,f,g,h,i;a?(h=Array.prototype.slice.call(arguments),e=h.shift(),typeof c.debug!="undefined"?c.debug.apply(c,[e,h]):c.log.apply(c,[e,h])):e="\n"+arguments[0]+"\n";for(f=1,g=arguments.length;f<g;++f){i=arguments[f];
if(typeof i=="object"&&typeof k!="undefined")try{i=k.stringify(i)}catch(j){}e+="\n"+i+"\n"}return b?(b.value+=e+"\n-----\n",b.scrollTop=b.scrollHeight-b.clientHeight):a||l(e),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached=typeof m.getInternetExplorerMajorVersion.cached!="undefined"?m.getInternetExplorerMajorVersion.cached:function(){var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");while((b.innerHTML="<\!--[if gt IE "+ ++a+"]><i></i><![endif]--\>")&&
c[0]);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached=typeof m.isInternetExplorer.cached!="undefined"?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated={pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)&&!/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent)),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||
m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&e.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<
7)},m.isEmptyObject=function(a){for(var b in a)return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);if(d.location.port||!1)a+=":"+d.location.port;return a+="/",a},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return a.length===1&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=
m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a=m.getState(!1,!1),b=(a||{}).url||d.location.href,c;return c=b.replace(/\/+$/,"").replace(/[^\/]+$/,function(a,b,c){return/\./.test(a)?a:a+"/"}),c},m.getBasePageUrl=function(){var a=d.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a,b,c){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b=typeof b=="undefined"?!0:b,/[a-z]+\:\/\//.test(a)||
(d==="/"?c=m.getRootUrl()+a.replace(/^\/+/,""):d==="#"?c=m.getPageUrl().replace(/#.*/,"")+a:d==="?"?c=m.getPageUrl().replace(/[\?#].*/,"")+a:b?c=m.getBaseUrl()+a.replace(/^(\.\/)+/,""):c=m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,""),b},m.store={},m.idToState=m.idToState||
{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){typeof a=="undefined"&&(a=!0),typeof b=="undefined"&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b=
m.extractId(a.url),c;if(!b){c=m.getStateString(a);if(typeof m.stateToId[c]!="undefined")b=m.stateToId[c];else if(typeof m.store.stateToId[c]!="undefined")b=m.store.stateToId[c];else{for(;;){b=(new Date).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof m.idToState[b]=="undefined"&&typeof m.store.idToState[b]=="undefined")break}m.stateToId[c]=b,m.idToState[b]=a}}return b},m.normalizeState=function(a){var b,c;if(!a||typeof a!="object")a={};if(typeof a.normalized!="undefined")return a;if(!a.data||
typeof a.data!="object")a.data={};b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(m.unescapeString(a.url||d.location.href)),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data);if(b.title||c)b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id;return b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&
m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d),d},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c),d},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id,c},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),
c=b.hash,c},m.extractId=function(a){var b,c,d;return c=/(.*)\&_suid=([0-9]+)$/.exec(a),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c=null,d,e;return b=b||!1,d=m.extractId(a),d&&(c=m.getStateById(d)),c||(e=m.getFullUrl(a),d=m.getIdByUrl(e)||!1,d&&(c=m.getStateById(d)),!c&&b&&!m.isTraditionalAnchor(a)&&(c=m.createStateObject(null,null,e))),c},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||
b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b=!1,c;return c=m.extractState(a.url),b=c&&c.id!==a.id,b},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b=!1,c,d,e;return m.savedStates.length&&(c=a.id,d=m.getLastSavedState(),e=d.id,b=c===e),b},m.saveState=function(a){return m.isLastSavedState(a)?
!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return typeof a=="undefined"?b=m.savedStates[m.savedStates.length-1]:a<0?b=m.savedStates[m.savedStates.length+a]:b=m.savedStates[a],b},m.getHash=function(){var a=m.unescapeHash(d.location.hash);return a},m.unescapeString=function(b){var c=b,d;for(;;){d=a.unescape(c);if(d===c)break;c=d}return c},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=m.unescapeString(b),b},m.normalizeHash=function(a){var b=
a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e,f;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(c=m.escapeHash(a),m.busy(!0),e=m.extractState(a,!0),e&&!m.emulated.pushState?m.pushState(e.data,e.title,e.url,!1):d.location.hash!==c&&(m.bugs.setHash?(f=m.getPageUrl(),m.pushState(null,null,f+"#"+c,!1)):d.location.hash=c),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.escape(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,
"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b),b},m.setTitle=function(a){var b=a.title,c;b||(c=m.getStateByIndex(0),c&&c.url===a.url&&(b=c.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=b.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=b,m},m.queues=[],m.busy=function(a){typeof a!="undefined"?
m.busy.flag=a:typeof m.busy.flag=="undefined"&&(m.busy.flag=!1);if(!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(m.busy.flag)return;for(a=m.queues.length-1;a>=0;--a){c=m.queues[a];if(c.length===0)continue;d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay)}};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||
0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return typeof a=="function"&&(a={callback:a}),typeof b!="undefined"&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=
!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b=m.extractState(d.location.href),c;if(!m.isLastSavedState(b))c=b;else return;return c||(c=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),
n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;c<=a;++c)m.forward(b);else{if(!(a<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m};if(m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||
o}else m.onPopState=function(b,c){var e=!1,f=!1,g,h;return m.doubleCheckComplete(),g=m.getHash(),g?(h=m.extractState(g||d.location.href,!0),h?m.replaceState(h.data,h.title,h.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(e=m.Adapter.extractEventData("state",b,c)||!1,e?f=m.getStateById(e):m.expectedStateId?f=m.getStateById(m.expectedStateId):f=m.extractState(d.location.href),f||(f=m.createStateObject(null,null,d.location.href)),m.expectedStateId=!1,m.isLastSavedState(f)?
(m.busy(!1),!1):(m.storeState(f),m.saveState(f),m.setTitle(f),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):
(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=
f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"beforeunload",m.clearAllIntervals),m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(d.location.href,!0))),f&&(m.onUnload=function(){var a,b;try{a=k.parse(f.getItem("History.store"))||{}}catch(c){a={}}a.idToState=a.idToState||{},a.urlToId=
a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState){if(!m.idToState.hasOwnProperty(b))continue;a.idToState[b]=m.idToState[b]}for(b in m.urlToId){if(!m.urlToId.hasOwnProperty(b))continue;a.urlToId[b]=m.urlToId[b]}for(b in m.stateToId){if(!m.stateToId.hasOwnProperty(b))continue;a.stateToId[b]=m.stateToId[b]}m.store=a,m.normalizeStore(),f.setItem("History.store",k.stringify(a))},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,
"unload",m.onUnload));if(!m.emulated.pushState){m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval));if(e.vendor==="Apple Computer, Inc."||(e.appCodeName||"")==="Mozilla")m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})}},m.init()}(window);var D2LMicrosoftAjax=D2LMicrosoftAjax||{};
D2LMicrosoftAjax.Hijri={ticks1970:621355968E5,monthDays:[0,30,59,89,118,148,177,207,236,266,295,325,355],minDate:-425216736E5,maxDate:253402300799999,adjustment:0,toGregorian:function(hyear,hmonth,hday){var daysSinceJan0101=this.daysToYear(hyear)+this.monthDays[hmonth]+hday-1-this.adjustment;var gdate=new Date(daysSinceJan0101*864E5-this.ticks1970);gdate.setMinutes(gdate.getMinutes()+gdate.getTimezoneOffset());return gdate},fromGregorian:function(gdate){if(gdate<this.minDate||gdate>this.maxDate)return null;
var ticks=this.ticks1970+(gdate-0)-gdate.getTimezoneOffset()*6E4,daysSinceJan0101=Math.floor(ticks/864E5)+1+this.adjustment;var hday,hmonth,hyear=Math.floor((daysSinceJan0101-227013)*30/10631)+1,absDays=this.daysToYear(hyear),daysInYear=this.isLeapYear(hyear)?355:354;if(daysSinceJan0101<absDays){hyear--;absDays-=daysInYear}else if(daysSinceJan0101===absDays){hyear--;absDays=this.daysToYear(hyear)}else if(daysSinceJan0101>absDays+daysInYear){absDays+=daysInYear;hyear++}hmonth=0;var daysIntoYear=daysSinceJan0101-
absDays;while(hmonth<=11&&daysIntoYear>this.monthDays[hmonth])hmonth++;hmonth--;hday=daysIntoYear-this.monthDays[hmonth];return[hyear,hmonth,hday]},daysToYear:function(year){var yearsToYear30=Math.floor((year-1)/30)*30,yearsInto30=year-yearsToYear30-1,days=Math.floor(yearsToYear30*10631/30)+227013;while(yearsInto30>0){days+=this.isLeapYear(yearsInto30)?355:354;yearsInto30--}return days},isLeapYear:function(year){return(year*11+14)%30<11}};var D2LMicrosoftAjax=D2LMicrosoftAjax||{};
D2LMicrosoftAjax.UmAlQura={_yearInfo:[[746,-21987072E5],[1769,-21681216E5],[3794,-21374496E5],[3748,-21067776E5],[3402,-2076192E6],[2710,-20456064E5],[1334,-20150208E5],[2741,-19844352E5],[3498,-19537632E5],[2980,-19230912E5],[2889,-18925056E5],[2707,-186192E7],[1323,-18313344E5],[2647,-18007488E5],[1206,-17700768E5],[2741,-17394912E5],[1450,-17088192E5],[3413,-16782336E5],[3370,-16475616E5],[2646,-1616976E6],[1198,-15863904E5],[2397,-15558048E5],[748,-15251328E5],[1749,-14945472E5],[1706,-14638752E5],
[1365,-14332896E5],[1195,-1402704E6],[2395,-13721184E5],[698,-13414464E5],[1397,-13108608E5],[2994,-12801888E5],[1892,-12495168E5],[1865,-12189312E5],[1621,-11883456E5],[683,-115776E7],[1371,-11271744E5],[2778,-10965024E5],[1748,-10658304E5],[3785,-10352448E5],[3474,-10045728E5],[3365,-9739872E5],[2637,-9434016E5],[685,-912816E6],[1389,-8822304E5],[2922,-8515584E5],[2898,-8208864E5],[2725,-7903008E5],[2635,-7597152E5],[1175,-7291296E5],[2359,-698544E6],[694,-667872E6],[1397,-6372864E5],[3434,-6066144E5],
[3410,-5759424E5],[2710,-5453568E5],[2349,-5147712E5],[605,-4841856E5],[1245,-4536E8],[2778,-422928E6],[1492,-392256E6],[3497,-3616704E5],[3410,-3309984E5],[2730,-3004128E5],[1238,-2698272E5],[2486,-2392416E5],[884,-2085696E5],[1897,-177984E6],[1874,-147312E6],[1701,-1167264E5],[1355,-861408E5],[2731,-555552E5],[1370,-248832E5],[2773,57024E5],[3538,363744E5],[3492,670464E5],[3401,97632E6],[2709,1282176E5],[1325,1588032E5],[2653,1893888E5],[1370,2200608E5],[2773,2506464E5],[1706,2813184E5],[1685,311904E6],
[1323,3424896E5],[2647,3730752E5],[1198,4037472E5],[2422,4343328E5],[1388,4650048E5],[2901,4955904E5],[2730,5262624E5],[2645,556848E6],[1197,5874336E5],[2397,6180192E5],[730,6486912E5],[1497,6792768E5],[3506,7099488E5],[2980,7406208E5],[2890,7712064E5],[2645,801792E6],[693,8323776E5],[1397,8629632E5],[2922,8936352E5],[3026,9243072E5],[3012,9549792E5],[2953,9855648E5],[2709,10161504E5],[1325,1046736E6],[1453,10773216E5],[2922,11079936E5],[1748,11386656E5],[3529,11692512E5],[3474,11999232E5],[2726,
12305088E5],[2390,12610944E5],[686,129168E7],[1389,13222656E5],[874,13529376E5],[2901,13835232E5],[2730,14141952E5],[2381,14447808E5],[1181,14753664E5],[2397,1505952E6],[698,1536624E6],[1461,15672096E5],[1450,15978816E5],[3413,16284672E5],[2714,16591392E5],[2350,16897248E5],[622,17203104E5],[1373,1750896E6],[2778,1781568E6],[1748,181224E7],[1701,18428256E5],[0,18734112E5]],minDate:-21987072E5,maxDate:1873411199999,toGregorian:function(hyear,hmonth,hday){var days=hday-1,gyear=hyear-1318;if(gyear<0||
gyear>=this._yearInfo.length)return null;var info=this._yearInfo[gyear],gdate=new Date(info[1]),monthLength=info[0];gdate.setMinutes(gdate.getMinutes()+gdate.getTimezoneOffset());for(var i=0;i<hmonth;i++){days+=29+(monthLength&1);monthLength=monthLength>>1}gdate.setDate(gdate.getDate()+days);return gdate},fromGregorian:function(gdate){var ticks=gdate-gdate.getTimezoneOffset()*6E4;if(ticks<this.minDate||ticks>this.maxDate)return null;var hyear=0,hmonth=1;while(ticks>this._yearInfo[++hyear][1]);if(ticks!==
this._yearInfo[hyear][1])hyear--;var info=this._yearInfo[hyear],days=Math.floor((ticks-info[1])/864E5),monthLength=info[0];hyear+=1318;var daysInMonth=29+(monthLength&1);while(days>=daysInMonth){days-=daysInMonth;monthLength=monthLength>>1;daysInMonth=29+(monthLength&1);hmonth++}return[hyear,hmonth-1,days+1]}};var D2L=D2L||{LP:{Web:{UI:{Html:{}}},Globalization:{Formatting:{Domain:{Default:{}}}},LayeredArch:{}},LE:{},PT:{},LOR:{},EP:{},IM:{},WCS:{}};
D2L.LP.Web.UI.ObjectRepository={Get:function(key,subKey){var obj=D2L.LP.Web.UI.ObjectRepository.TryGet(key,subKey);if(obj===null)throw"'"+key+"'["+subKey+"] not found in object repository.";return obj},GetDictionary:function(key){if(D2L.OR[key]===undefined)return null;var resultDic={};for(var subKey in D2L.OR[key])resultDic[subKey]=D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey]);return resultDic},HasKey:function(key){return D2L.OR[key]!==undefined},HasKeys:function(key,subKey){return D2L.OR[key]!==
undefined&&D2L.OR[key][subKey]!==undefined},Remove:function(key,subKey){if(D2L.OR[key]===undefined)return;if(subKey===undefined)delete D2L.OR[key];else if(D2L.OR[key][subKey]!==undefined)delete D2L.OR[key][subKey]},RpcReceivePayloadProvider:function(data){if(data===undefined||data===null)return;for(var key in data)D2L.OR[key]=data[key]},TryClone:function(key,subKey,newKey,newSubKey){if(key===undefined||subKey===undefined||newKey===undefined||newSubKey===undefined)return false;if(D2L.OR[key]===undefined)return false;
if(D2L.OR[newKey]===undefined)D2L.OR[newKey]={};D2L.OR[newKey][newSubKey]=D2L.OR[key][subKey];return true},TryGet:function(key,subKey){if(subKey===undefined)subKey="0";if(D2L.OR[key]===undefined||D2L.OR[key][subKey]===undefined)return null;return D2L.LP.Web.Serialization.Json.Deserialize(D2L.OR[key][subKey])}};D2L.O=function(key,subKey){return D2L.LP.Web.UI.ObjectRepository.Get(key,subKey)};D2L.OR={};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(element){if(this==null)throw new TypeError;var t=Object(this);var arrayLength=t.length>>>0;if(arrayLength===0)return-1;var fromIndex=0;if(arguments.length>0){fromIndex=Number(arguments[1]);if(fromIndex!=fromIndex)fromIndex=0;else if(fromIndex!=0&&fromIndex!=Infinity&&fromIndex!=-Infinity)fromIndex=(fromIndex>0||-1)*Math.floor(Math.abs(fromIndex))}if(fromIndex>=arrayLength)return-1;var elementIndex=fromIndex>=0?fromIndex:Math.max(arrayLength-
Math.abs(fromIndex),0);for(;elementIndex<arrayLength;elementIndex++)if(elementIndex in t&&t[elementIndex]===element)return elementIndex;return-1};D2L.Class=function(){};D2L.Class.prototype.Construct=function(){};D2L.Class.prototype.Dispose=function(){};D2L.Class.Create=function(def){var classDef=function(){if(arguments[0]!==D2L.Class)this.Construct.apply(this,arguments)};var proto=new this(D2L.Class);for(var n in def){var item=def[n];proto[n]=item}classDef.prototype=proto;return classDef};
D2L.Class.Extend=function(def){var classDef=function(){if(arguments[0]!==D2L.Class)this.Construct.apply(this,arguments)};var proto=new this(D2L.Class);var superClass=this.prototype;for(var n in def){var item=def[n];if(item instanceof Function)item.$=superClass;proto[n]=item}classDef.prototype=proto;classDef.extend=this.extend;classDef.Extend=this.extend;return classDef};D2L.Class.extend=D2L.Class.Extend;D2L.LP.Web.UI.Events=D2L.LP.Web.UI.Events||{};
D2L.LP.Web.UI.Events.AggregateEvents=function(events,callback){var evt=new D2L.LP.Web.UI.Events.Event;var numTriggered=0;var handleTrigger=function(){numTriggered++;if(numTriggered>=events.length){if(callback!==undefined)callback();evt.Trigger()}};for(var i=0;i<events.length;i++){var e=events[i];if(e===undefined||e===null||e.HasTriggered===undefined||e.HasTriggered())handleTrigger();else e.AddListener(handleTrigger)}if(events.length===0)setTimeout(handleTrigger,0);return evt};
D2L.LP.Web.UI.Events.Event=D2L.Class.Create({Construct:function(argumentDelegate){this.m_callbacks=[];this.m_argumentDelegate=argumentDelegate;this.m_hasTriggered=false;this.m_releaseCallbacks=[]},AddListener:function(callback){this.m_callbacks.push(callback)},AddReleaseListener:function(callback){this.m_releaseCallbacks.push(callback)},HasTriggered:function(){return this.m_hasTriggered},RemoveListener:function(callback){for(var i=0;i<this.m_callbacks.length;i++)if(this.m_callbacks[i]===callback)this.m_callbacks.splice(i,
1)},Release:function(){for(var i=0;i<this.m_releaseCallbacks.length;i++)this.m_releaseCallbacks[i].apply(this.m_releaseCallbacks[i])},Trigger:function(){this.m_hasTriggered=true;var args=arguments;if(typeof this.m_argumentDelegate!=="undefined")args=this.m_argumentDelegate();for(var i=0;i<this.m_callbacks.length;i++){var result=this.m_callbacks[i].apply(this.m_callbacks[i],args);if(typeof result!=="undefined"&&result===false)return}}});D2L.LP.Web.Http={};D2L.LP.Web.Http.ILocation=function(){};
D2L.LP.Web.Http.ILocation.prototype.GetUrl=function(){};
D2L.LP.Web.Http.UrlLocation=D2L.Class.Create({Construct:function(url){if(url===undefined||url===null)url="";this.m_url=url},_deserialize:function(deserializer){this.m_url=deserializer.GetMember("Url")},_serialize:function(serializer){serializer.AddMember("Url",this.m_url)},GetUrl:function(){return this.m_url},WithQueryString:function(param,value){var url=this.m_url;var delim=url.indexOf("?",0)==-1?"?":"&";var serializer=new D2L.LP.Web.Serialization.Url.Serializer;serializer.AddMember(param,value);
var serializedValue=serializer.Serialize();url+=delim+serializedValue;return new D2L.LP.Web.Http.UrlLocation(url)},HasQueryString:function(param){param=param.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+param+"=([^&#]*)");return regex.test(this.m_url)},RemoveQueryString:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("([\\?&])"+name+"=([^&#]*)");if(!regex.test(this.m_url))return;var pos=0;var url=this.m_url.replace(regex,function(match,
p1,p2,offset){pos=offset;return p1});if(url.length>pos&&url[pos+1]=="&")url=url.substr(0,pos+1)+url.substr(pos+2);else url=url.substr(0,url.length-1);this.m_url=url}});D2L.LP.Web.Http.UrlLocation.Create=function(url,query){var urlLocation=new D2L.LP.Web.Http.UrlLocation(url);for(var key in query)urlLocation=urlLocation.WithQueryString(key,query[key]);return urlLocation};
D2L.LP.Web.Mvc={RouteLocation:{Create:function(pattern,query,route){for(var key in route)pattern=pattern.replace(new RegExp("{"+key+"}","gi"),D2L.LP.Web.UI.Html.JavaScript.UrlEncode(route[key]));var url=new D2L.LP.Web.Http.UrlLocation(pattern);for(var key in query)url=url.WithQueryString(key,query[key]);return url}}};D2L.LP.Web.UI.Files={};
D2L.LP.Web.UI.Files.File=D2L.Class.Create({Construct:function(id,fileSystemType,name,size){this.m_id=id;this.m_fileSystemType=fileSystemType;this.m_name=name;this.m_size=size},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember("FileSystemType",this.m_fileSystemType);serializer.AddMember("Id",this.m_id)},GetFileSystemType:function(){return this.m_fileSystemType},GetId:function(){return this.m_id},GetName:function(){return this.m_name},GetSize:function(){return this.m_size}});
D2L.LP.Web.UI.FlashMessages={RpcReceivePayloadProvider:function(data){var win=window;while(win!=win.parent&&win.D2L!==undefined&&win.D2L.LP!==undefined&&win.D2L.LP.Web!==undefined&&win.D2L.LP.Web.UI!==undefined&&win.D2L.LP.Web.UI.FlashMessages!==undefined)win=win.parent;var $data=$(data);win.document.body.appendChild($data.get(0));win.D2L.LP.Web.UI.Events.OnViewRender.Trigger($data.get(0))}};D2L.LP.Web.UI.Rpc={ReceivePayloadProviders:{},SendPayloadProviders:{}};
D2L.LP.Web.UI.Rpc.Initialize=function(loginUrl,message,sendPayloadProviders,receivePayloadProviders){if(sendPayloadProviders!==undefined)D2L.LP.Web.UI.Rpc.SendPayloadProviders=sendPayloadProviders;if(receivePayloadProviders!==undefined)D2L.LP.Web.UI.Rpc.ReceivePayloadProviders=receivePayloadProviders;D2L.LP.Web.UI.Rpc.OnFailure.AddListener(function(args){var reason=args.reason;var keepAlive=args.keepAlive;if(reason===D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated){if(keepAlive!==undefined&&keepAlive)location.href=
loginUrl.GetUrl()}else alert(message)})};
D2L.LP.Web.UI.Rpc.Connect=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event;if(verb===undefined||verb===null||verb!="GET"&&verb!="POST")throw"Invalid RPC verb: '"+verb+"'.";if(loc===undefined||loc===null)throw"Invalid RPC location: '"+loc+"'.";if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};for(var key in params)if(params[key]===null)delete params[key];loc=loc.GetUrl();var complete=false;var timedOut=false;var isSynchronous=options.isSynchronous||
false;var fail=function(showErrorMsg){ret.Trigger(false);if(showErrorMsg===undefined)showErrorMsg=true;var errorMsg=function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.Unknown})};if(options.failure!==undefined){var result=options.failure.call(options.failure);var isDelayedReturn=typeof result!=="undefined"?result.Trigger!==undefined:false;var delayedReturnListener=function(returnVal){this.Trigger(returnVal);if(returnVal!==true)errorMsg()};if(result===true)showErrorMsg=
false;else if(isDelayedReturn){showErrorMsg=false;result.AddListener(delayedReturnListener)}}if(showErrorMsg)errorMsg()};var xhr=new XMLHttpRequest;var handleXhrResult=function(xhrResult){if(timedOut||xhrResult.readyState!=4)return;complete=true;if(xhrResult.status==200){var response=xhrResult.responseText.trim();var events=[];if(response.length>0){var payload;try{payload=D2L.LP.Web.Serialization.Json.Deserialize(response.substr(9))}catch(e){throw"Unable to parse JSON response: "+response;}if(payload.Redirect){D2L.LP.Web.UI.Html.Dom.Navigate(payload.Location);
return}var receivePayloadProviders=D2L.LP.Web.UI.Rpc.ReceivePayloadProviders;for(var key in receivePayloadProviders)if(payload.Data[key]!==undefined)events.push(receivePayloadProviders[key].call(receivePayloadProviders[key],payload.Data[key]));response=payload.Payload}D2L.LP.Web.UI.Events.AggregateEvents(events,function(){ret.Trigger(true);if(typeof options.success!=="undefined")options.success.call(options.success,response)})}else{if(xhrResult.status==403&&xhrResult.responseText=="Not authenticated."){ret.Release();
if(options.notAuthenticated!==undefined)options.notAuthenticated.call(options.notAuthenticated);else D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated,keepAlive:options.keepAlive});return}var showError=xhrResult.status!=0;fail(showError)}};if(!isSynchronous)xhr.onreadystatechange=function(){handleXhrResult(xhr)};var sendPayloadProviders=D2L.LP.Web.UI.Rpc.SendPayloadProviders;for(var key in sendPayloadProviders)sendPayloadProviders[key].call(sendPayloadProviders[key],
params);var serializeParametersAndSend=function(xsrfToken){params["isXhr"]="true";params["requestId"]=D2L.LP.Web.UI.Rpc.GetUniqueRequestId();if(xsrfToken)params[D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName()]=xsrfToken;if(options.keepAlive!==undefined&&!options.keepAlive)params["X-D2L-Session"]="no-keep-alive";var serializedParams=D2L.LP.Web.Serialization.Url.Serialize(params);if(verb==D2L.LP.Web.UI.Rpc.Verbs.GET){var sep=loc.indexOf("?")>-1?"&":"?";loc+=sep+serializedParams}xhr.open(verb,
loc,!isSynchronous);var data=undefined;if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");data=serializedParams}if(options.timeout!==undefined)setTimeout(function(){if(complete)return;timedOut=true;fail()},options.timeout);xhr.send(data)};if(verb==D2L.LP.Web.UI.Rpc.Verbs.POST){var xsrfToken=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();serializeParametersAndSend(xsrfToken)}else serializeParametersAndSend(null);if(isSynchronous)handleXhrResult(xhr);
return ret};
D2L.LP.Web.UI.Rpc.ConnectPartial=function(placeholderId,verb,loc,params,options){if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};var ret=new D2L.LP.Web.UI.Events.Event;params["_d2l_prc"]=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,{success:function(result){ret.Trigger(result);if(typeof options.success!=="undefined")options.success.call(options.success)},failure:function(){ret.Trigger(false);
if(options.failure!==undefined)options.failure.call(options.failure)},keepAlive:options.keepAlive,timeout:6E4,notAuthenticated:function(){D2L.LP.Web.UI.Rpc.OnFailure.Trigger({reason:D2L.LP.Web.UI.Rpc.FailureReasons.NotAuthenticated})}});return ret};D2L.LP.Web.UI.Rpc.GetUniqueRequestId=function(){var me=D2L.LP.Web.UI.Rpc;if(me.m_requestIdCounter===undefined)me.m_requestIdCounter=1;me.m_requestIdCounter++;return me.m_requestIdCounter};
D2L.LP.Web.UI.Rpc.ConnectObject=function(verb,loc,params,options){var ret=new D2L.LP.Web.UI.Events.Event;var callSuccess=function(result){if(options.isSynchronous)ret=result;else ret.Trigger(result)};if(options===undefined)options={};options.success=function(result){callSuccess(result)};var connectRet=D2L.LP.Web.UI.Rpc.Connect(verb,loc,params,options);connectRet.AddListener(function(result){if(result===false)ret.Trigger(false)});connectRet.AddReleaseListener(function(){ret.Release()});return ret};
D2L.LP.Web.UI.Rpc.ConnectObjectSynchronous=function(verb,loc,params,options){if(options===undefined)options={};options.isSynchronous=true;return D2L.LP.Web.UI.Rpc.ConnectObject(verb,loc,params,options)};D2L.LP.Web.UI.Rpc.Verbs={GET:"GET",POST:"POST"};D2L.LP.Web.UI.Selection={};
D2L.LP.Web.UI.Selection.SelectionInfo=D2L.Class.Create({Construct:function(type,keys){if(type===undefined)type=D2L.LP.LayeredArch.SelectionFilterType.None;if(keys===undefined)keys=[];this.m_type=type;this.m_keys=keys},_deserialize:function(deserializer){this.m_type=deserializer.GetMember("type");this.m_keys=D2L.LP.Web.UI.Selection.DecodeKeys(deserializer.GetMember("keys"))},_serialize:function(serializer){serializer.AddMember("type",this.m_type);serializer.AddMember("values",D2L.LP.Web.UI.Selection.EncodeKeys(this.m_keys))},
GetType:function(){return this.m_type},GetKeys:function(){return this.m_keys}});D2L.LP.Web.UI.Selection.EncodeKeys=function(keys){var ret="";if(keys.length>0){var delim="";for(var i=0;i<keys.length;i++){ret+=delim+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(keys[i]);delim="&"}}return ret};
D2L.LP.Web.UI.Selection.DecodeKeys=function(keysString){if(keysString==null||keysString.length==0)return[];var keys=[];var encodedKeys=keysString.split("&");for(var i=0;i<encodedKeys.length;i++)keys.push(D2L.Util.Url.Decode(encodedKeys[i]));return keys};D2L.LP.Web.Authentication=D2L.LP.Web.Authentication||{};
D2L.LP.Web.Authentication.Xsrf={m_xsrfTokenParameterName:"",Init:function(xsrfTokenParameterName,xsrfToken,hitCodeSeed){D2L.LP.Web.Authentication.Xsrf.m_xsrfTokenParameterName=xsrfTokenParameterName;D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("XSRF.HitCodeSeed",hitCodeSeed);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("XSRF.Token",xsrfToken)},GetHitCodeSeed:function(){var hitCodeSeed=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("XSRF.HitCodeSeed");return hitCodeSeed},GetXsrfTokenParameterName:function(){return D2L.LP.Web.Authentication.Xsrf.m_xsrfTokenParameterName},
GetXsrfToken:function(){var token=D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("XSRF.Token");return token},CreateXsrfHidden:function(){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();return hidden}};
D2L.LP.Web.UI.Html.Aria={LogMessage:function(message){var ariaLog=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-aria-log");if(ariaLog===null){ariaLog=document.createElement("div");ariaLog.className="d2l-aria-log d2l-offscreen";D2L.LP.Web.UI.Html.Aria.SetRole(ariaLog,"alert");D2L.LP.Web.UI.Html.Aria.SetAttribute(ariaLog,"live","assertive");document.body.appendChild(ariaLog)}ariaLog.innerHTML="";ariaLog.appendChild(document.createTextNode(message))},Politeness:{Off:"off",Polite:"polite",Assertive:"assertive",
Rude:"rude"},RemoveAttribute:function(element,attribute){if(element!==undefined&&element!==null)element.removeAttribute("aria-"+attribute)},SetAttribute:function(element,attribute,value){if(element!==undefined&&element!==null)D2L.LP.Web.UI.Html.Dom.SetAttribute(element,"aria-"+attribute,value)},SetRole:function(element,role){if(element!==undefined&&element!==null)D2L.LP.Web.UI.Html.Dom.SetAttribute(element,"role",role)},RpcReceivePayloadProvider:function(data){if(data.Items===undefined||data.Items===
null)return;var messages=data.Items;for(var i=0;i<messages.length;i++)D2L.LP.Web.UI.Html.Aria.LogMessage(messages[i].Message)}};D2L.LP.Web.UI.Html.DragDrop={};
D2L.LP.Web.UI.Html.DragDrop={Install:function(id,ddType,draggableSettings,droppableSettings){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,draggableSettings,droppableSettings)},InstallNode:function(node,ddType,draggableSettings,droppableSettings){if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Draggable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable)D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,draggableSettings);
if(ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.Droppable||ddType==D2L.LP.Web.UI.Html.DragDrop.DragDropType.DraggableDroppable)D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings)},CreateGhost:function(ghostType,node,initialPos,win){var ghost;if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow){ghost=win.document.createElement("div");ghost.className="d2l-dragdrop-shadow"}else if(ghostType==D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow){var clearFloat=win.document.createElement("div");
clearFloat.className="d2l-clear";var ghostWrapper=win.document.createElement("div");var clonedNode=node.cloneNode(true);clonedNode.style.margin=0;ghostWrapper.appendChild(clonedNode);ghostWrapper.appendChild(clearFloat);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-clone-shadow",ghostWrapper);ghost=ghostWrapper}ghost.style.left=initialPos.left+"px";ghost.style.top=initialPos.top+"px";ghost.style.width=initialPos.width+1+"px";ghost.style.height=initialPos.height+1+"px";ghost.style.zIndex=win.D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex();
win.document.body.appendChild(ghost);return ghost},RemoveDrag:function(dragObject){D2L.LP.Web.UI.Html.Dom.RemoveElement(dragObject.GetDragNode())}};D2L.LP.Web.UI.Html.DragDrop.DragDropEffect={None:0,Move:1};D2L.LP.Web.UI.Html.DragDrop.DragObject=D2L.Class.Create({Construct:function(dragNode,draggableSettings){this.m_dragNode=dragNode;this.m_draggableSettings=draggableSettings},GetDragNode:function(){return this.m_dragNode},GetDraggableSettings:function(){return this.m_draggableSettings}});
D2L.LP.Web.UI.Html.DragDrop.DragPosition={Invalid:0,Top:1,Middle:2,Bottom:3};D2L.LP.Web.UI.Html.DragDrop.DropEffect={None:0,Move:1,Swap:2};
D2L.LP.Web.UI.Html.DragDrop.DragDropManager={RefreshDroppables:function(){var nodes=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes;for(var i=0;i<nodes.length;i++)D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppable(nodes[i])},RefreshDroppable:function(node){node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node)},AddDroppable:function(node){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes.push(node)},SetDrag:function(dragObject){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(true);
D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=dragObject},GetDrag:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag},GetDragParam:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetParam()},GetDragKey:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag.GetDraggableSettings().GetKey()},IsDragging:function(){return D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging},SetIsDragging:function(isDragging){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=
isDragging}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_drag=null;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_isDragging=false;D2L.LP.Web.UI.Html.DragDrop.DragDropManager.m_droppableNodes=[];D2L.LP.Web.UI.Html.DragDrop.DragDropType={Draggable:0,Droppable:1,DraggableDroppable:2};
D2L.LP.Web.UI.Html.DragDrop.DraggableSettings=D2L.Class.Create({Construct:function(){this.m_key=null;this.m_handleNode=null;this.m_handleExceptions=[];this.m_ghostType=D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow;this.m_param=null;this.m_isDelayed=true;this.m_isAutoScroll=true;this.m_dragDropEffect=D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.None;this.m_dragStartEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragEndEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragGroup=null},_deserialize:function(deserializer){this.m_key=
deserializer.GetMember("Key");this.m_param=deserializer.GetMember("Param");this.m_dragGroup=deserializer.GetMember("DragGroup");var dragStartFunction=deserializer.GetMember("OnDragStartFunction");if(dragStartFunction!=null)this.GetDragStartEvent().AddListener(dragStartFunction)},AddHandleException:function(node){this.m_handleExceptions.push(node)},GetIsAutoScroll:function(){return this.m_isAutoScroll},GetDragDropEffect:function(){return this.m_dragDropEffect},GetDragGroup:function(){return this.m_dragGroup},
GetDragStartEvent:function(){return this.m_dragStartEvent},GetDragEndEvent:function(){return this.m_dragEndEvent},GetGhostType:function(){return this.m_ghostType},GetHandle:function(){return this.m_handleNode},GetHandleExceptions:function(){return this.m_handleExceptions},GetKey:function(){return this.m_key},GetParam:function(){return this.m_param},IsDelayed:function(){return this.m_isDelayed},SetIsDelayed:function(isDelayed){this.m_isDelayed=isDelayed},SetHandle:function(node){this.m_handleNode=
node},SetDragGroup:function(groupName){this.m_dragGroup=groupName},SetGhostType:function(ghostType){this.m_ghostType=ghostType},SetIsAutoScroll:function(autoScroll){this.m_isAutoScroll=autoScroll},SetDragDropEffect:function(dragDropEffect){this.m_dragDropEffect=dragDropEffect},SetKey:function(key){this.m_key=key},SetParam:function(param){this.m_param=param}});
D2L.LP.Web.UI.Html.DragDrop.DroppableSettings=D2L.Class.Create({Construct:function(){this.m_dropEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragInEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragOutEvent=new D2L.LP.Web.UI.Events.Event;this.m_dragOverEvent=new D2L.LP.Web.UI.Events.Event;this.m_dropEffect=D2L.LP.Web.UI.Html.DragDrop.DropEffect.None;this.m_eventPropagation=true;this.m_padding={top:0,left:0,right:0,bottom:0};this.m_acceptableDragGroups=[]},_deserialize:function(deserializer){var dropFunction=
deserializer.GetMember("OnDropFunction");if(dropFunction!=null)this.GetDropEvent().AddListener(dropFunction);var dragInFunction=deserializer.GetMember("OnDragInFunction");if(dragInFunction!=null)this.GetDragInEvent().AddListener(dragInFunction);var dragOutFunction=deserializer.GetMember("OnDragOutFunction");if(dragOutFunction!=null)this.GetDragOutEvent().AddListener(dragOutFunction);this.m_dropEffect=deserializer.GetMember("DropEffect");this.m_eventPropagation=deserializer.GetMember("EventPropagation")},
AddAcceptableDragGroup:function(groupName){this.m_acceptableDragGroups.push(groupName)},GetAcceptableDragGroups:function(){return this.m_acceptableDragGroups},GetDropEvent:function(){return this.m_dropEvent},GetDragInEvent:function(){return this.m_dragInEvent},GetDragOutEvent:function(){return this.m_dragOutEvent},GetDragOverEvent:function(){return this.m_dragOverEvent},GetPadding:function(){return this.m_padding},GetDropEffect:function(){return this.m_dropEffect},GetEventPropagation:function(){return this.m_eventPropagation},
SetAcceptableDragGroups:function(acceptableDragGroups){this.m_acceptableDragGroups=acceptableDragGroups},SetDropEffect:function(dropEffect){this.m_dropEffect=dropEffect},SetPadding:function(padding){this.m_padding=padding},SetEventPropagation:function(propagate){this.m_eventPropagation=propagate}});D2L.LP.Web.UI.Html.DragDrop.DropPosition={Before:0,After:1,On:2,Invalid:3};D2L.LP.Web.UI.Html.DragDrop.GhostType={OriginalShadow:1,CloneShadow:2};
D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode=function(node,draggableSettings,nodeWin,outerWin){if(draggableSettings===undefined)draggableSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;nodeWin=nodeWin||window;outerWin=outerWin||window;var handle=draggableSettings.GetHandle()||node;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-draggable",handle);var initialCursorPos=null;var initialPos=null;var newPos=null;var shadow=null;var scrollTopTimeout;var scrollTopInstalled;var scrollBottomTimeout;
var scrollBottomInstalled;var scrollLeftTimeout;var scrollLeftInstalled;var scrollRightTimeout;var scrollRightInstalled;var scrollSpeed=10;var scrollInterval=50;var scrollZone=40;var clearHorizontalAutoScroll=function(){scrollLeftInstalled=false;scrollRightInstalled=false;clearTimeout(scrollLeftTimeout);clearTimeout(scrollRightTimeout)};var clearVerticalAutoScroll=function(){scrollTopInstalled=false;scrollBottomInstalled=false;clearTimeout(scrollTopTimeout);clearTimeout(scrollBottomTimeout)};var clearAutoScroll=
function(){clearHorizontalAutoScroll();clearVerticalAutoScroll()};var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);if(initialCursorPos===null||initialPos===null||shadow===null)return;var newCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newPos={x:initialPos.left+newCursorPos.x-initialCursorPos.x,y:initialPos.top+newCursorPos.y-initialCursorPos.y};var pageSize=D2L.LP.Web.UI.Html.Dom.GetPageSize(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);
var dialogBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(shadow);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);if(newPos.x+dialogBox.width>pageSize.width)newPos.x=pageSize.width-dialogBox.width;if(newPos.y+dialogBox.height>viewport.height+scroll.top)newPos.y=viewport.height+scroll.top-dialogBox.height;if(newPos.x<0)newPos.x=0;if(newPos.y<scroll.top)newPos.y=scroll.top;shadow.style.left=newPos.x+"px";shadow.style.top=newPos.y+"px";if(draggableSettings.GetIsAutoScroll()){var viewPortSize=
D2L.LP.Web.UI.Html.Dom.GetViewportSize();var scrollPosition=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();var topDelta=newCursorPos.y-scrollPosition.top;var bottomDelta=scrollPosition.top+viewPortSize.height-newCursorPos.y;if(topDelta<scrollZone){var scrollTop=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().top>0){scrollTopInstalled=true;scrollTopTimeout=setTimeout(function(){scrollBy(0,-scrollSpeed);shadow.style.top=shadow.offsetTop-scrollSpeed+"px";scrollTop()},scrollInterval)}};if(!scrollTopInstalled)scrollTop()}else if(bottomDelta<
scrollZone){var scrollBottom=function(){scrollBottomInstalled=true;scrollBottomTimeout=setTimeout(function(){scrollBy(0,scrollSpeed);shadow.style.top=shadow.offsetTop+scrollSpeed+"px";scrollBottom()},scrollInterval)};if(!scrollBottomInstalled)scrollBottom()}else clearVerticalAutoScroll();var leftDelta=newCursorPos.x-scrollPosition.left;var rightDelta=scrollPosition.left+viewPortSize.width-newCursorPos.x;if(leftDelta<scrollZone){var scrollLeft=function(){if(D2L.LP.Web.UI.Html.Dom.GetScrollPosition().left>
0){scrollLeftInstalled=true;scrollLeftTimeout=setTimeout(function(){scrollBy(-scrollSpeed,0);shadow.style.left=shadow.offsetLeft-scrollSpeed+"px";scrollLeft()},scrollInterval)}};if(!scrollLeftInstalled)scrollLeft()}else if(rightDelta<scrollZone){var scrollRight=function(){scrollRightInstalled=true;scrollRightTimeout=setTimeout(function(){scrollBy(scrollSpeed,0);shadow.style.left=shadow.offsetLeft+scrollSpeed+"px";scrollRight()},scrollInterval)};if(!scrollRightInstalled)scrollRight()}else clearHorizontalAutoScroll()}};
var Finish=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);shadow.parentNode.removeChild(shadow);if(draggableSettings.GetDragDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move){node.style.left=newPos.x+"px";node.style.top=newPos.y+"px";node.style.display="block"}D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetIsDragging(false);clearAutoScroll();
draggableSettings.GetDragEndEvent().Trigger(e)};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);var handleExceptions=draggableSettings.GetHandleExceptions();for(var i=0;i<handleExceptions.length;i++)if(handleExceptions[i]==target||$.contains(handleExceptions[i],target))return;var dragObject=new D2L.LP.Web.UI.Html.DragDrop.DragObject(node,draggableSettings);D2L.LP.Web.UI.Html.DragDrop.DragDropManager.SetDrag(dragObject);
D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newPos={x:initialPos.left,y:initialPos.top};initialCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialCursorPos={x:initialCursorPos.x+(nodeWin!=outerWin?initialPos.left:0),y:initialCursorPos.y+(nodeWin!=outerWin?initialPos.top:0)};shadow=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(draggableSettings.GetGhostType(),node,initialPos,outerWin);if(draggableSettings.GetGhostType()==
D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow)node.style.display="none";setTimeout(function(){D2L.LP.Web.UI.Html.DragDrop.DragDropManager.RefreshDroppables()});outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish);draggableSettings.GetDragStartEvent().Trigger(evt)};var BeforeStart=function(clickEvt){var cancelDrag=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(clickEvt);var onDownCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,
clickEvt);if(draggableSettings.IsDelayed()){var moveThreshold=3;var moved=false;var MoveTimer=function(e){var onMoveCursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,e);if(Math.abs(onMoveCursorPos.y-onDownCursorPos.y)>moveThreshold||Math.abs(onMoveCursorPos.x-onDownCursorPos.x)>moveThreshold){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);if(!cancelDrag)Start(clickEvt);moved=true}};var UpTimer=function(e){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MoveTimer);
D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(UpTimer);cancelDrag=true;if(!moved)if(clickEvt.changedTouches!==undefined||clickEvt.targetTouches!==undefined)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(clickEvt));return false};outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(UpTimer)}else Start(clickEvt)};var BeforeStartTouch=function(touchEvt){var isDragEvent=true;var touchMoveTimer=function(){isDragEvent=
false};var touchUpTimer=function(){isDragEvent=false};setTimeout(function(){D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(touchMoveTimer);D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(touchUpTimer);if(isDragEvent)BeforeStart(touchEvt)},50);outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(touchMoveTimer);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(touchUpTimer)};if(handle.m_dragInstalled)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("touchstart",handle,BeforeStartTouch);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",
handle,BeforeStart);handle.m_dragInstalled=true};
D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode=function(node,droppableSettings){if(droppableSettings===undefined)droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings;var isDragIn=false;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-dragdrop-droppable",node);var IsOverNode=function(targetDroppableNode,targetEvent,forgivenessPadding){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,targetEvent);return cursorPos.x>=targetDroppableNode.m_rect.left-forgivenessPadding.left&&cursorPos.x<=
targetDroppableNode.m_rect.right+forgivenessPadding.right&&cursorPos.y>=targetDroppableNode.m_rect.top-forgivenessPadding.top&&cursorPos.y<=targetDroppableNode.m_rect.bottom+forgivenessPadding.bottom};var IsOver=function(evt){if(node.m_rect===undefined||!D2L.LP.Web.UI.Html.DragDrop.DragDropManager.IsDragging())return false;var forgivenessPadding=droppableSettings.GetPadding();var acceptableDragGroups=droppableSettings.GetAcceptableDragGroups();var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();
var dragGroup=dragObject.GetDraggableSettings().GetDragGroup();if(acceptableDragGroups.length>0){if(dragGroup==null)return false;var containsGroup=false;for(var i=0;i<acceptableDragGroups.length;i++)if(acceptableDragGroups[i]===dragGroup)containsGroup=true;if(!containsGroup)return false}var propagateEvent=droppableSettings.GetEventPropagation();if(!propagateEvent){var descendantDroppables=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dragdrop-droppable",node);for(var i=0;i<descendantDroppables.length;i++)if(IsOverNode(descendantDroppables[i],
evt,forgivenessPadding))return false}var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);var isOverResult=IsOverNode(node,evt,forgivenessPadding);if(isOverResult){var mouseDelta={topDelta:cursorPos.y-node.m_rect.top,rightDelta:node.m_rect.right-cursorPos.x,bottomDelta:node.m_rect.bottom-cursorPos.y,leftDelta:cursorPos.x-node.m_rect.left,nodeHeight:node.m_rect.height};droppableSettings.GetDragOverEvent().Trigger(dragObject,mouseDelta)}return isOverResult};var MouseUp=function(evt){if(isDragIn){var dragObject=
D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Move)node.appendChild(dragObject.GetDragNode());else if(droppableSettings.GetDropEffect()==D2L.LP.Web.UI.Html.DragDrop.DropEffect.Swap)D2L.LP.Web.UI.Html.Dom.SwapElements(node,dragObject.GetDragNode());droppableSettings.GetDropEvent().Trigger(dragObject)}};var MouseOut=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=false;droppableSettings.GetDragOutEvent().Trigger(dragObject)};
var MouseIn=function(evt){var dragObject=D2L.LP.Web.UI.Html.DragDrop.DragDropManager.GetDrag();isDragIn=true;droppableSettings.GetDragInEvent().Trigger(dragObject)};D2L.LP.Web.UI.Events.OnMouseUp.AddListener(MouseUp);if(node.m_dropInstalled)return;var mouseIn=false;var BeforeMouseMove=function(evt){if(IsOver(evt)){if(!mouseIn){mouseIn=true;MouseIn(evt)}}else if(mouseIn){mouseIn=false;MouseOut(evt)}};D2L.LP.Web.UI.Html.DragDrop.DragDropManager.AddDroppable(node);D2L.LP.Web.UI.Events.OnMouseMove.AddListener(BeforeMouseMove);
node.m_dropInstalled=true};
D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode=function(node,settings,nodeWin,outerWin){var ghost;var initialPos;var initialMousePos;var newWidth=200;var newHeight=200;var maxWidth=500;var maxHeight=500;var resizeEvent=new D2L.LP.Web.UI.Events.Event;var MouseMove=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);var newMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(outerWin,evt);newWidth=Math.min(Math.max(initialPos.width+newMousePos.x-initialMousePos.x,200),maxWidth);newHeight=
Math.min(Math.max(initialPos.height+newMousePos.y-initialMousePos.y,200),maxHeight);ghost.style.width=newWidth+"px";ghost.style.height=newHeight+"px"};var Finish=function(){outerWin.D2L.LP.Web.UI.Events.OnMouseMove.RemoveListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.RemoveListener(Finish);ghost.parentNode.removeChild(ghost);if(settings.DisplayType=="none")node.style.display="";else{node.style.visibility="";settings.Handle.style.visibility=""}resizeEvent.Trigger({width:newWidth,height:newHeight});
node.style.display="block"};var Start=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt);initialPos=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);newWidth=initialPos.width;newHeight=initialPos.height;initialMousePos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(nodeWin,evt);initialMousePos={x:initialMousePos.x+(outerWin!=nodeWin?initialPos.left:0),y:initialMousePos.y+(outerWin!=nodeWin?initialPos.top:0)};var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(outerWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(outerWin);
maxWidth=scroll.left+viewport.width-initialPos.left-20;maxHeight=scroll.top+viewport.height-initialPos.top-20;ghost=D2L.LP.Web.UI.Html.DragDrop.CreateGhost(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow,node,initialPos,outerWin);ghost.style.cursor="nw-resize";if(settings.DisplayType=="none")node.style.display="none";else{node.style.visibility="hidden";settings.Handle.style.visibility="hidden"}outerWin.D2L.LP.Web.UI.Events.OnMouseMove.AddListener(MouseMove);outerWin.D2L.LP.Web.UI.Events.OnMouseUp.AddListener(Finish)};
if(settings.Handle.m_resizeInstalled)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",settings.Handle,Start);D2L.LP.Web.UI.Html.Dom.AddEventListener("touchstart",settings.Handle,Start);settings.Handle.m_resizeInstalled=true;return resizeEvent};D2L.LP.Web.UI.Html.Files={};
D2L.LP.Web.UI.Html.Files.FileUpload={Upload:function(uploadLocation,files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode()}uploadStatus.RemoveErrorMessages(errorsNode)}var isUploading=
false;var uploadHandle=null;var fileNumber=0;var raiseError=function(errorNumber){if(params.IsStatusEnabled)uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);params.OnError.call(params.OnError,errorNumber)};var removeAllProgressFiles=function(){if(params.IsStatusEnabled){for(var k=0;k<progressFileNodes.length;k++)uploadStatus.RemoveFile(progressFileNodes[k]);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}};var resetUpload=function(){isUploading=false;uploadHandle=
null};if(!params.IsMultipleAllowed&&files.length>1){raiseError(1);return}for(var i=0;i<files.length;i++){if(!me.IsExtensionValid(files[i].name,params.Extensions,params.RestrictedExtensions)){raiseError(2);return}if(params.MaxFileSize>0&&files[i].size>params.MaxFileSize){raiseError(3);return}if(!me.IsFileNameValid(files[i].name)){raiseError(5);return}}var requestParams={BytesPerSlice:params.BytesPerSlice,OnFileStarted:function(fileName){if(params.IsStatusEnabled){progressFileNode=progressFileNodes[fileNumber];
fileNumber+=1}},OnProgress:function(progress){if(params.IsStatusEnabled)uploadStatus.UpdateFile(progressFileNode,progress.GetFileName(),progress.GetFilePercent());params.OnProgress.call(params.OnProgress,progress)},OnFileComplete:function(tempFile){if(params.IsStatusEnabled)uploadStatus.SetIsFileCompleted(progressFileNode,tempFile.FileName);var file=new D2L.LP.Web.UI.Files.File(tempFile.FileId,"Temp",tempFile.FileName,tempFile.Size);params.OnFileComplete.call(params.OnFileComplete,file)},OnFilesComplete:function(){if(params.IsStatusEnabled)uploadStatus.SetIsProgressContainerVisible(progressNode,
false);params.OnFilesComplete.call(params.OnFilesComplete);resetUpload()},OnAbort:function(){removeAllProgressFiles();params.OnAbort.call(params.OnAbort);resetUpload();params.OnProgress.call(params.OnProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,0,0,0))},OnError:function(){resetUpload();raiseError(4)},UploadLocation:uploadLocation};params.OnProgress.call(params.OnProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,0,0,0));isUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);
if(params.IsStatusEnabled){progressFileNodes=[];for(var j=0;j<files.length;j++)progressFileNodes.push(uploadStatus.AddFile(progressNode,files[j].name));setTimeout(function(){if(isUploading)uploadStatus.SetIsProgressContainerVisible(progressNode,true)},500)}uploadHandle=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest.UploadFiles(files,requestParams);return uploadHandle},GetFileExtension:function(fileName){var extStart=fileName.lastIndexOf(".");if(extStart<0)return null;return fileName.substr(extStart+
1).toLowerCase()},IsFileNameValid:function(fileName){var filenameRegex=/^([^\\\\/:\*\?\"<>\|]{0,127}[^\\\./:\*\?\"<>\|])\.*[^\\\./:\*\?\"<>\|]*$/;var match=filenameRegex.exec(fileName);return match!=null},IsExtensionValid:function(fileName,extensions,restrictedExtensions){var me=D2L.LP.Web.UI.Html.Files.FileUpload;var extension=me.GetFileExtension(fileName);if(extension!=null){if(D2L.LP.Web.UI.Html.Dom.IndexOf(restrictedExtensions,extension)!=-1)return false;if(D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,
"*.*")==-1&&D2L.LP.Web.UI.Html.Dom.IndexOf(extensions,extension)==-1)return false}else return false;return true}};
D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest={CallbackNumber:0,ERRCODE_MAXFILESIZE:"1000",ERRCODE_TOTALFILESIZE:"1001",ERRCODE_RESTRICTEDFILEEXT:"1002",Upload:function(openerId,uploadLocation,fileNode,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var fileUpload=D2L.LP.Web.UI.Html.Files.FileUpload;var uploadStatus=D2L.LP.Web.UI.Html.Files.FileUpload.Status;var errorsNode;var progressNode;var progressFileNode;if(params.IsStatusEnabled){if(progressNode===undefined||errorsNode===
undefined){errorsNode=uploadStatus.GetErrorsContainerNode();progressNode=uploadStatus.GetProgressContainerNode()}uploadStatus.RemoveErrorMessages(errorsNode)}var raiseError=function(errorNumber){if(params.IsStatusEnabled)uploadStatus.AddErrorMessage(errorsNode,params.ErrorMessages[errorNumber-1]);params.OnError.call(params.OnError,errorNumber)};if(!fileUpload.IsExtensionValid(fileNode.value,params.Extensions,params.RestrictedExtensions)){raiseError(2);return}var iFrameId=openerId.GetValue()+"_iframe_"+
me.CallbackNumber;var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetElementById(iFrameId);if(iFrameNode==null){iFrameNode=document.createElement("IFRAME");D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"id",iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"name",iFrameId);D2L.LP.Web.UI.Html.Dom.SetAttribute(iFrameNode,"src","/d2l/tools/blank.html");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",iFrameNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",iFrameNode);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(iFrameNode,
fileNode)}D2L.LP.Web.UI.Html.Dom.SetAttribute(fileNode,"name","uploadFile");var uploadHandle={Abort:function(){if(this.IsUploading){if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}if(params.OnAbort!=null)params.OnAbort.call(params.OnAbort)}},IsUploading:false};var uploadCallback=function(fileData){uploadHandle.IsUploading=false;var json=fileData;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);
var failCode=response.ResponseCode;var failReason=response.Message;if(failCode!="0"||response.File==null){if(failCode==me.ERRCODE_MAXFILESIZE||failCode==me.ERRCODE_TOTALFILESIZE)raiseError(3);else if(failCode==me.ERRCODE_RESTRICTEDFILEEXT)raiseError(2);if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}return}var file=new D2L.LP.Web.UI.Files.File(response.File.FileId,response.File.FileSystemType,response.File.FileName,
response.File.Size);if(params.IsStatusEnabled){uploadStatus.SetIsFileCompleted(progressFileNode,response.File.FileName);uploadStatus.SetIsProgressContainerVisible(progressNode,false)}params.OnFileComplete.call(params.OnFileComplete,file);params.OnFilesComplete.call(params.OnFilesComplete)};var callbackId=me.GetUniqueCallbackId(iFrameId);window[callbackId]=uploadCallback;var fileName=me.StripFilePath(fileNode.value);var location=uploadLocation.WithQueryString("cb",callbackId).WithQueryString("fileName",
fileName).WithQueryString("iframe",true).GetUrl();var formNode=document.createElement("FORM");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"action",location);D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"id",openerId.GetValue()+"_form");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"method","post");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"enctype","multipart/form-data");D2L.LP.Web.UI.Html.Dom.SetAttribute(formNode,"encoding","multipart/form-data");formNode.appendChild(D2L.LP.Web.Authentication.Xsrf.CreateXsrfHidden());
formNode.target=iFrameId;formNode.onsubmit="return false;";fileNode.parentNode.removeChild(fileNode);formNode.appendChild(fileNode);var doLoad=true;D2L.LP.Web.UI.Html.Dom.AddEventListener("load",iFrameNode,function(){if(doLoad){doLoad=false;uploadHandle.IsUploading=true;params.OnFilesStarted.call(params.OnFilesStarted);params.OnProgress.call(params.OnProgress.call,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(fileName));if(params.IsStatusEnabled){progressFileNode=uploadStatus.AddFile(progressNode,
fileName);uploadStatus.UpdateFile(progressFileNode,fileName);setTimeout(function(){if(uploadHandle.IsUploading)uploadStatus.SetIsProgressContainerVisible(progressNode,true)},500)}var iFrameBodyNode=iFrameNode.contentDocument.body;iFrameBodyNode.appendChild(formNode);formNode.submit()}else if(uploadHandle.IsUploading){uploadHandle.IsUploading=false;raiseError(3)}});return uploadHandle},GetUniqueCallbackId:function(iFrameId){var me=D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest;var date=new Date;
var time=date.getTime();me.CallbackNumber+=1;return iFrameId+"_cb_"+time+"_"+me.CallbackNumber},StripFilePath:function(fileName){var index=fileName.lastIndexOf("\\");return fileName.substring(index+1)}};
D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress=D2L.Class.Create({Construct:function(fileName,fileSentBytes,fileSizeBytes,totalSentBytes,totalSizeBytes){this.m_fileName=fileName;this.m_fileSentBytes=fileSentBytes;this.m_fileSizeBytes=fileSizeBytes;this.m_totalSentBytes=totalSentBytes;this.m_totalSizeBytes=totalSizeBytes},_deserialize:function(deserializer){},_serialize:function(serializer){serializer.AddMember("FileName",this.m_fileName);serializer.AddMember("FileSentBytes",this.m_fileSentBytes);
serializer.AddMember("FileSizeBytes",this.m_fileSizeBytes);serializer.AddMember("TotalSentBytes",this.m_totalSentBytes);serializer.AddMember("TotalSizeBytes",this.m_totalSizeBytes)},GetFileName:function(){return this.m_fileName},GetFileSentBytes:function(){return this.m_fileSentBytes},GetFileSizeBytes:function(){return this.m_fileSizeBytes},GetFilePercent:function(){if(this.m_fileSizeBytes===0)return 0;else{if(this.m_fileSentBytes>this.m_fileSizeBytes)this.m_fileSentBytes=this.m_fileSizeBytes;return Math.round(this.m_fileSentBytes*
100/this.m_fileSizeBytes)}},GetTotalSentBytes:function(){return this.m_totalSentBytes},GetTotalSizeBytes:function(){return this.m_totalSizeBytes},GetTotalPercent:function(){if(this.m_totalSizeBytes===0)return 0;else return Math.round(this.m_totalSentBytes*100/this.m_totalSizeBytes)}});
D2L.LP.Web.UI.Html.Files.FileUpload.Status={AddFile:function(node,fileName){var fileNode=document.createElement("li");fileNode.className="d2l-filedrop-status-file";fileNode.innerHTML=fileName;fileNode.d2l_isComplete=false;return node.childNodes[0].appendChild(fileNode)},AddErrorMessage:function(node,message){node.childNodes[1].innerHTML=message;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop-status-errors-hidden",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-errors-hidden",
node)},GetContainerNode:function(){var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filedrop-status-container");if(node!=null)return node;node=document.createElement("div");node.className="d2l-filedrop-status-container";var errorNode=document.createElement("div");errorNode.className="d2l-filedrop-status-errors d2l-filedrop-status-errors-hidden";node.appendChild(errorNode);var errorCloseNode=document.createElement("span");errorCloseNode.className="d2l-filedrop-status-errors-close";D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
errorCloseNode,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-errors-hidden",errorNode)});errorNode.appendChild(errorCloseNode);var errorTextNode=document.createElement("span");errorNode.appendChild(errorTextNode);var progressNode=document.createElement("div");progressNode.className="d2l-filedrop-status-progress d2l-filedrop-status-progress-hidden";node.appendChild(progressNode);var filesNode=document.createElement("ul");filesNode.className="d2l-filedrop-status-files";progressNode.appendChild(filesNode);
return document.body.appendChild(node)},GetErrorsContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[0]},GetProgressContainerNode:function(){var me=D2L.LP.Web.UI.Html.Files.FileUpload.Status;return me.GetContainerNode().childNodes[1]},SetIsProgressContainerVisible:function(node,isVisible){if(isVisible){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop-status-progress-hidden",node)){var fileCount=node.childNodes[0].childNodes.length;
for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(fileNode.d2l_isComplete)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fileNode)}D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-progress-hidden",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-status-container-hidden",node.parentNode)}}else{var fileCount=node.childNodes[0].childNodes.length;for(var i=0;i<fileCount;i++){var fileNode=node.childNodes[0].childNodes[i];if(!fileNode.d2l_isComplete)return}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-progress-hidden",
node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-container-hidden",node.parentNode)}},SetIsFileCompleted:function(node,fileName){node.d2l_isComplete=true;this.UpdateFile(node,fileName,100)},RemoveErrorMessages:function(node){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-errors-hidden",node);node.childNodes[1].innerHTML=""},RemoveFile:function(node){node.d2l_isComplete=true;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-status-file-hidden",node)},UpdateFile:function(node,
fileName,percent){if(node==null)return;if(percent!==undefined)node.innerHTML=fileName+" - "+percent+"%";else node.innerHTML=fileName+" - "+"Uploading"}};
D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest={UploadFiles:function(files,params){var me=D2L.LP.Web.UI.Html.Files.FileUpload.XmlHttpRequest;if(files===undefined||files.length==0)return;var fileNumber=0;var fileCount=files.length;var fileUploadHandle;var handle={Abort:function(){if(fileUploadHandle!=null)fileUploadHandle.Abort()}};var totalLoaded=0;var totalFileSize=0;for(var i=0;i<files.length;i++)totalFileSize+=files[i].size;var onProgress=params.OnProgress;params.OnProgress=function(progress){if(onProgress==
null)return;progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(progress.GetFileName(),progress.GetFileSentBytes(),progress.GetFileSizeBytes(),totalLoaded+progress.GetFileSentBytes(),totalFileSize);onProgress.call(onProgress,progress)};var onFileComplete=params.OnFileComplete;params.OnFileComplete=function(file){totalLoaded+=files[fileNumber].size;onFileComplete.call(onFileComplete,file);fileUploadHandle=null;fileNumber+=1;if(fileNumber<fileCount)fileUploadHandle=me.UploadFile(files[fileNumber],
params);else if(params.OnFilesComplete!=null)params.OnFilesComplete.call(params.OnFilesComplete)};onProgress.call(onProgress,new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress("",0,1,0,1));fileUploadHandle=me.UploadFile(files[fileNumber],params);return handle},UploadFile:function(file,params){if(file===undefined)return;var fileSize=file.size;var xhr;var handle={Abort:function(){if(this.IsUploading&&xhr!=null)xhr.abort()},IsUploading:false};var bytesLoaded=0;var onProgress=function(evt){if(params.OnProgress==
null)return;if(evt.lengthComputable){var progress=new D2L.LP.Web.UI.Html.Files.FileUpload.FileUploadProgress(file.name,bytesLoaded+evt.loaded,fileSize,bytesLoaded+evt.loaded,fileSize);params.OnProgress.call(params.OnProgress,progress)}};var sliceFunc;if(file.slice!==undefined)sliceFunc="slice";else if(file.mozSlice!==undefined)sliceFunc="mozSlice";else if(file.webkitSlice)sliceFunc="webkitSlice";var bytesPerSlice=params.BytesPerSlice;if(sliceFunc===undefined||bytesPerSlice===undefined)bytesPerSlice=
0;var getEndByte=function(startByte){var endByte=startByte+bytesPerSlice;if(endByte<fileSize)return endByte;else return fileSize};var isLastSlice=false;var uploadSlice=function(startByte,streamId){var endByte=getEndByte(startByte);var slice;if(bytesPerSlice>0){slice=file[sliceFunc](startByte,endByte);if(endByte>=fileSize)isLastSlice=true}else{slice=file;isLastSlice=true}var location=params.UploadLocation.WithQueryString("isLastSlice",isLastSlice);if(streamId!==undefined)location=location.WithQueryString("streamId",
streamId);location=location.GetUrl();var formData=new FormData;formData.append("fileName",file.name);formData.append("uploadFile",slice);formData.append(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());xhr=new XMLHttpRequest;D2L.LP.Web.UI.Html.Dom.AddEventListener("progress",xhr.upload,onProgress);D2L.LP.Web.UI.Html.Dom.AddEventListener("load",xhr.upload,onProgress);xhr.onload=function(evt){if(xhr.status==200){bytesLoaded+=slice.size;var json=
evt.target.responseText;var response=D2L.LP.Web.Serialization.Json.Deserialize(json);if(response.ResponseCode=="0")if(response.File!==undefined){handle.IsUploading=false;params.OnFileComplete.call(params.OnFileComplete,response.File)}else{startByte=endByte;if(!isLastSlice)uploadSlice(startByte,response.StreamId)}else{handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)}}else{handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)}slice=
null};xhr.onerror=function(){handle.IsUploading=false;if(params.OnError!=null)params.OnError.call(params.OnError)};xhr.onabort=function(){handle.IsUploading=false;if(params.OnAbort!=null)params.OnAbort.call(params.OnAbort)};xhr.open("POST",location);xhr.send(formData)};handle.IsUploading=true;if(params.OnFileStarted!=null)params.OnFileStarted.call(params.OnFileStarted,file.name);uploadSlice(0);return handle}};D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse={};
D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default={Abort:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(node.d2l_fu_handles===undefined)return;for(var i=0;i<node.d2l_fu_handles.length;i++){node.d2l_fu_handles[i].Abort();node.d2l_fu_handles.splice(0,1)}},Browse:function(openerId,settings){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var inputNode=document.createElement("input");
inputNode.className="d2l-fileinput-input d2l-font";inputNode.type="file";var isFileAPISupported=me.IsFileAPISupported();if(isFileAPISupported&&settings.IsMultipleAllowed)inputNode.setAttribute("multiple","multiple");var params={BytesPerSlice:settings.BytesPerSlice,ErrorMessages:settings.ErrorMessages,Extensions:settings.Extensions,RestrictedExtensions:settings.RestrictedExtensions,IsMultipleAllowed:settings.IsMultipleAllowed,IsStatusEnabled:settings.IsStatusEnabled,MaxFileSize:settings.MaxFileSize,
OnFilesStarted:function(){if(settings.OnFilesStarted!==null)settings.OnFilesStarted.call(settings.OnFilesStarted)},OnProgress:function(progress){node.d2l_fu_progress=progress;if(settings.OnProgress!=null)settings.OnProgress.call(settings.OnProgress)},OnFileComplete:function(file){node.d2l_fu_files.push(file);node.d2l_fu_files_queued+=1;if(settings.OnFileComplete!==null)settings.OnFileComplete.call(settings.OnFileComplete)},OnFilesComplete:function(){if(settings.OnFilesComplete!==null)settings.OnFilesComplete.call(settings.OnFilesComplete)},
OnAbort:function(){if(settings.OnAbort!==null)settings.OnAbort.call(settings.OnAbort)},OnError:function(errorNumber){node.d2l_fu_errorNumber=errorNumber;if(settings.OnError!==null)settings.OnError.call(settings.OnError)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",inputNode,function(){if(node.d2l_fu_files===undefined)node.d2l_fu_files=[];if(node.d2l_fu_files_queued===undefined)node.d2l_fu_files_queued=0;if(node.d2l_fu_handles===undefined)node.d2l_fu_handles=[];node.d2l_fu_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(settings.UploadLocation,
inputNode.files,params))});D2L.LP.Web.UI.Html.Dom.InsertElementAfter(inputNode,node);inputNode.click()},GetErrorNumber:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var errorNumber=node.d2l_fu_errorNumber;return errorNumber},GetFile:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var files=node.d2l_fu_files;if(files.length===0||files.length<node.d2l_fu_files_queued)return;var file=files[files.length-node.d2l_fu_files_queued];
node.d2l_fu_files_queued-=1;return file},GetFiles:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());var files=node.d2l_fu_files;if(files.length===0||files.length<node.d2l_fu_files_queued)return;var queuedFiles=[];var queuedIndex=files.length-node.d2l_fu_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fu_files_queued-=1}return queuedFiles},GetProgress:function(openerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());
var progress=node.d2l_fu_progress;return progress},InitializeLegacyBrowse:function(openerId,settings,buttonText){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);if(node.d2l_fu_files===undefined)node.d2l_fu_files=[];if(node.d2l_fu_files_queued===undefined)node.d2l_fu_files_queued=0;if(node.d2l_fu_handles===undefined)node.d2l_fu_handles=[];var inputNumber=0;var labelNode=document.createElement("label");labelNode.className="d2l-filebrowse-label d2l-filebrowse-label-hov";
labelNode.innerHTML=buttonText;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(labelNode,node);var params;var createInputNode=function(){var containerNode=document.createElement("div");containerNode.className="d2l-offscreen";D2L.LP.Web.UI.Html.Dom.InsertElementAfter(containerNode,node);inputNumber+=1;var inputId=openerId.GetValue()+"_input_"+inputNumber;labelNode.setAttribute("for",inputId);containerNode.innerHTML='<input id="'+inputId+'" type="file"/>';var inputNode=containerNode.firstChild;var cleanup=
function(){containerNode.parentNode.removeChild(containerNode)};params={ErrorMessages:settings.ErrorMessages,Extensions:settings.Extensions,RestrictedExtensions:settings.RestrictedExtensions,IsMultipleAllowed:settings.IsMultipleAllowed,IsStatusEnabled:settings.IsStatusEnabled,MaxFileSize:settings.MaxFileSize,OnFilesStarted:function(){if(settings.OnFilesStarted!==null)settings.OnFilesStarted.call(settings.OnFilesStarted)},OnProgress:function(progress){node.d2l_fu_progress=progress;if(settings.OnProgress!=
null)settings.OnProgress.call(settings.OnProgress)},OnFileComplete:function(file){node.d2l_fu_files.push(file);node.d2l_fu_files_queued+=1;cleanup();if(settings.OnFileComplete!==null)settings.OnFileComplete.call(settings.OnFileComplete)},OnFilesComplete:function(){if(settings.OnFilesComplete!==null)settings.OnFilesComplete.call(settings.OnFilesComplete)},OnAbort:function(){cleanup();if(settings.OnAbort!==null)settings.OnAbort.call(settings.OnAbort)},OnError:function(errorNumber){node.d2l_fu_errorNumber=
errorNumber;cleanup();if(settings.OnError!==null)settings.OnError.call(settings.OnError)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",inputNode,function(){node.d2l_fu_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.IFrameRequest.Upload(openerId,settings.UploadLocation,inputNode,params));createInputNode()})};createInputNode()},IsFileAPISupported:function(){return window.FileReader!==undefined},SetIsBrowseLabelEnabled:function(labelNode,isEnabled){if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filebrowse-label-disabled",
labelNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filebrowse-label-disabled",labelNode)}};D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop={};
D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default={Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_fd_handles===undefined)return;for(var i=0;i<node.d2l_fd_handles.length;i++)node.d2l_fd_handles[i].Abort()},GetVerticalDragPosition:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_verticalDragPosition)return node.m_verticalDragPosition;else return null},GetErrorNumber:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var errorNumber=node.d2l_fd_errorNumber;return errorNumber},GetFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued)return;var file=files[files.length-node.d2l_fd_files_queued];node.d2l_fd_files_queued-=1;return file},GetFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_fd_files;if(files.length===0||files.length<node.d2l_fd_files_queued)return;
var queuedFiles=[];var queuedIndex=files.length-node.d2l_fd_files_queued;for(var i=queuedIndex;i<files.length;i++){queuedFiles.push(files[i]);node.d2l_fd_files_queued-=1}return queuedFiles},GetProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progress=node.d2l_fd_progress;return progress},IsMultipleAllowedByNode:function(node){return node.d2l_fd_isMultipleAllowed},MakeFileDropNode:function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var dropStatus=
D2L.LP.Web.UI.Html.Files.FileUpload.Status;var bytesPerSlice=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"bytesPerSlice");var maxFileSize=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"maxFileSize");var extensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"extensions");var uploadLocation=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"uploadLocation");var restrictedExtensions=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"x-extensions");var statusIndicator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"statusIndicator");var isMultiple=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"isMultipleAllowed");var errorMessages=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"errorMessages");var onProgress=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onProgress");var onFileOver=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileOver");var onFileEnter=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileEnter");var onFileLeave=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileLeave");var fileOverCssClass=
D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"fileOverCssClass");var isStatusEnabled=statusIndicator==="auto";node.d2l_fd_isUploading=false;node.d2l_fd_files=[];node.d2l_fd_files_queued=0;node.d2l_fd_handles=[];me.SetIsEnabledByNode(node,true);me.SetIsMultipleAllowedByNode(node,isMultiple);var errorsNode;var progressNode;var progressFileNode;var progressFileNodes;var noopHandler=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(evt)};var isFileDropValid=
function(evt){if(node.d2l_fd_isAllowed&&!node.d2l_fd_isUploading&&evt.dataTransfer!=null&&evt.dataTransfer.types!=null){var dataTypes=evt.dataTransfer.types;for(var i=0;i<dataTypes.length;i++){if(dataTypes[i]=="application/x-moz-file-promise")return false;if(dataTypes[i]=="Files")return true}}return false};var dragEnterCount=0;var onDropFiles=function(evt){dragEnterCount=0;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,
node);if(onFileLeave)onFileLeave.call(onFileLeave);if(!isFileDropValid(evt))return;var files=evt.dataTransfer.files;if(files==null||files.length==0)return;var resetUpload=function(){node.d2l_fd_isUploading=false};var params={BytesPerSlice:bytesPerSlice,ErrorMessages:errorMessages,Extensions:extensions,RestrictedExtensions:restrictedExtensions,IsMultipleAllowed:isMultiple,IsStatusEnabled:isStatusEnabled,MaxFileSize:maxFileSize,OnFilesStarted:function(){var onFilesStarted=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"onFilesStarted");if(onFilesStarted!=null)onFilesStarted.call(onFilesStarted)},OnProgress:function(progress){node.d2l_fd_progress=progress;if(onProgress!=null)onProgress.call(onProgress)},OnFileComplete:function(file){node.d2l_fd_files.push(file);node.d2l_fd_files_queued+=1;var onFileComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onFileComplete");if(onFileComplete!=null)onFileComplete.call(onFileComplete)},OnFilesComplete:function(){var onFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"onFilesComplete");if(onFilesComplete!=null)onFilesComplete.call(onFilesComplete);resetUpload()},OnAbort:function(){var onAbort=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onAbort");if(onAbort!=null)onAbort.call(onAbort);resetUpload()},OnError:function(errorNumber){resetUpload();node.d2l_fd_errorNumber=errorNumber;var onError=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onError");if(onError!=null)onError.call(onError)}};node.d2l_fd_isUploading=true;node.d2l_fd_handles.push(D2L.LP.Web.UI.Html.Files.FileUpload.Upload(uploadLocation,
files,params))};D2L.LP.Web.UI.Html.Dom.AddEventListener("dragenter",node,function(evt){dragEnterCount++;if(isFileDropValid(evt)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.AddClassName(fileOverCssClass,node);if(onFileEnter)onFileEnter.call(onFileEnter)}noopHandler(evt)});D2L.LP.Web.UI.Html.Dom.AddEventListener("dragleave",node,function(evt){node.m_rect=null;dragEnterCount--;if(evt.relatedTarget!=null){var relatedTarget=evt.relatedTarget;
if(relatedTarget!=node){var tempNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-filedrop-drag",relatedTarget);if(tempNode==null||tempNode!=node){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,node);if(onFileLeave)onFileLeave.call(onFileLeave);noopHandler(evt)}}}else if(dragEnterCount==0){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-drag",node);if(fileOverCssClass)D2L.LP.Web.UI.Html.Dom.RemoveClassName(fileOverCssClass,
node);if(onFileLeave)onFileLeave.call(onFileLeave)}});var onDragOverHandler=function(evt){if(onFileOver)if(isFileDropValid(evt)){var cursorPos=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,evt);if(!node.m_rect)node.m_rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);var topDelta=cursorPos.y-node.m_rect.top;node.m_verticalDragPosition=topDelta/node.m_rect.height;onFileOver.call(onFileOver)}noopHandler(evt)};D2L.LP.Web.UI.Html.Dom.AddEventListener("dragover",node,onDragOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("drop",
node,function(evt){noopHandler(evt);onDropFiles(evt);node.m_rect=null})},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled)},SetIsEnabledByNode:function(node,isAllowed){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filedrop",node))return;node.d2l_fd_isAllowed=isAllowed;if(isAllowed)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedrop-add",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedrop-add",
node)},SetIsMultipleAllowedByNode:function(node,isAllowed){node.d2l_fd_isMultipleAllowed=isAllowed}};D2L.LP.Web.UI.Html.Ids={};
D2L.LP.Web.UI.Html.AbsoluteHtmlId=D2L.Class.Create({Construct:function(value){if(value===undefined||value===null)value="";this.m_value=value},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Value")},_serialize:function(serializer){serializer.AddMember("Value",this.m_value)},GetValue:function(){return this.m_value},$:function(){var node=document.getElementById(this.m_value);return $(node)}});D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create=function(id){return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id)};
D2L.LP.Web.UI.Html.Ids.Index=0;D2L.LP.Web.UI.Html.UniqueHtmlId=D2L.Class.Create({Construct:function(){D2L.LP.Web.UI.Html.Ids.Index++;this.m_value="d2l_c_"+D2L.LP.Web.UI.Html.Ids.Index+"_"+Math.floor(Math.random()*1E3)},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Value")},_serialize:function(serializer){serializer.AddMember("Value",this.m_value)},GetValue:function(){return this.m_value},$:function(){var node=document.getElementById(this.m_value);return $(node)}});
D2L.LP.Web.UI.Html.JavaScript=D2L.LP.Web.UI.Html.JavaScript||{};D2L.LP.Web.UI.Html.JavaScript.CompareBoolean=function(type,left,right){if(type===0)return left!=right;else return left==right};D2L.LP.Web.UI.Html.JavaScript.CompareDateTime=function(type,left,right){left=D2L.LocalDateTime.ToJavaScriptDate(left).getTime();right=D2L.LocalDateTime.ToJavaScriptDate(right).getTime();return D2L.LP.Web.UI.Html.JavaScript.CompareNumber(type,left,right)};
D2L.LP.Web.UI.Html.JavaScript.CompareNumber=function(type,left,right){if(type>0&&type<5){if(typeof left=="string")left=parseFloat(left);if(typeof right=="string")right=parseFloat(right)}if(type===0)return left==right;else if(type==1)return left<right;else if(type==2)return left>right;else if(type==3)return left<=right;else if(type==4)return left>=right;else return left!=right};
D2L.LP.Web.UI.Html.JavaScript.CompareObjects=function(type,left,right){if(type===0)return left!==right;else return left===right};
D2L.LP.Web.UI.Html.JavaScript.CompareString=function(type,haystack,needle){if(typeof haystack!="string")throw"CompareString Error: Haystack expression is not a string.";if(typeof needle!="string")throw"CompareString Error: Needle expression is not a string.";if(type===0)return haystack!=needle;else if(type===1)return haystack==needle;else if(type===2)return haystack.indexOf(needle)!==-1;else if(type===3)return haystack.slice(0,needle.length)==needle;else if(type===4)return haystack.slice(-needle.length)==
needle};D2L.LP.Web.UI.Html.JavaScript.IsNull=function(value){var isNull=value===undefined||value===null;return isNull};D2L.LP.Web.UI.Html.JavaScript.IsNotNull=function(value){var isNull=D2L.LP.Web.UI.Html.JavaScript.IsNull(value);return!isNull};D2L.LP.Web.UI.Html.JavaScript.Console={Error:function(){},Info:function(){},Warn:function(){},Log:function(){},Debug:function(){},IsEnabled:function(){return false}};D2L.LP.Web.UI.Html.Dom=D2L.LP.Web.UI.Html.Dom||{};
D2L.LP.Web.UI.Html.Dom.ClassDestructors={};D2L.LP.Web.UI.Html.Dom.AddClassDestructor=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]===undefined)D2L.LP.Web.UI.Html.Dom.ClassDestructors[className]=[];D2L.LP.Web.UI.Html.Dom.ClassDestructors[className].push(callback)};D2L.LP.Web.UI.Html.Dom.ClassInitializers={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer=function(className,callback){if(D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]===undefined)D2L.LP.Web.UI.Html.Dom.ClassInitializers[className]=[];D2L.LP.Web.UI.Html.Dom.ClassInitializers[className].push(callback)};D2L.LP.Web.UI.Html.Dom.AddClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return;$(domNode).addClass(className)};
D2L.LP.Web.UI.Html.Dom.AddClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null)D2L.LP.Web.UI.Html.Dom.AddClassName(className,node)};
D2L.LP.Web.UI.Html.Dom.AddEventListener=function(eventName,domNode,callback,useCapture){if(!domNode)return;if(domNode.addEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=="on")eventName=eventName.substr(2);domNode.addEventListener(eventName,callback,useCapture)}else if(domNode.attachEvent){if(eventName.substr(0,2)!="on")eventName="on"+eventName;domNode.attachEvent(eventName,callback)}};
D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener=function(domNode,callback){var handleKeyPress=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl())D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=true;var result=callback.call(callback,args);return result};var handleKeyUp=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs(e);if(args.IsCtrl())D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false};D2L.LP.Web.UI.Html.Dom.AddEventListener("keydown",
domNode,handleKeyPress);D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",domNode,handleKeyUp)};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e},GetKey:function(){return this.m_event.keyCode},GetEventObject:function(){return this.m_event},GetTarget:function(){return D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(this.m_event)},IsCtrl:function(){return this.m_event.keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Control}});
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,Space:32,PageUp:33,PageDown:34,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed=false;
D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener=function(domNode,callback){var handleKeyUp=function(e){var args=new D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs(e);return callback.call(callback,args)};D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",domNode,handleKeyUp)};D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs=D2L.Class.extend({Construct:function(e){this.m_event=e},GetKey:function(){return this.m_event.keyCode},GetEventObject:function(){return this.m_event}});
D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Escape:27,End:35,Home:36,ArrowLeft:37,ArrowUp:38,ArrowRight:39,ArrowDown:40,Delete:46};D2L.LP.Web.UI.Html.Dom.AddRemoveClassName=function(className,domNode,doAdd){if(doAdd)D2L.LP.Web.UI.Html.Dom.AddClassName(className,domNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,domNode)};
D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour=function(e){if(e.preventDefault!==undefined)e.preventDefault();else e.returnValue=false};D2L.LP.Web.UI.Html.Dom.CancelEventBubble=function(e){if(e.stopPropagation!==undefined)e.stopPropagation();else if(e.cancelBubble!==undefined)e.cancelBubble=true};
D2L.LP.Web.UI.Html.Dom.DispatchEvent=function(eventName,node){if(document.createEvent){var evt;if(eventName=="click"){evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null)}else{evt=document.createEvent("HTMLEvents");evt.initEvent(eventName,true,true)}return!node.dispatchEvent(evt)}else if(node.fireEvent)return node.fireEvent("on"+eventName);return false};
D2L.LP.Web.UI.Html.Dom.ElementExists=function(id){var elementId=id;if(elementId.GetValue)elementId=elementId.GetValue();return $("#"+elementId).length};D2L.LP.Web.UI.Html.Dom.Focus=function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.FocusNode(node)};D2L.LP.Web.UI.Html.Dom.FocusNode=function(node){if(!node||node.focus==undefined)return;try{node.focus()}catch(e){}};
D2L.LP.Web.UI.Html.Dom.FocusCycle={Init:function(firstElem,lastElem){if(!firstElem||!firstElem.parentNode||!lastElem||!lastElem.parentNode)return null;var doc=firstElem.ownerDocument;var startTrap=doc.createElement("span");startTrap.tabIndex=-1;startTrap.className="d2l-offscreen";D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",startTrap,function(){if(handle.endFocusElem!==null)handle.endFocusElem.focus()});firstElem.parentNode.insertBefore(startTrap,firstElem);var endTrap=doc.createElement("span");
endTrap.tabIndex=-1;endTrap.className="d2l-offscreen";D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",endTrap,function(){if(handle.startFocusElem!==null)handle.startFocusElem.focus()});if(lastElem.nextSibling)lastElem.parentNode.insertBefore(endTrap,lastElem.nextSibling);else lastElem.parentNode.appendChild(endTrap);var nextFocusableElem=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(firstElem,true);var prevFocusableElem=D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement(lastElem,true);var handle=
{startFocusElem:nextFocusableElem,startTrap:startTrap,endFocusElem:prevFocusableElem,endTrap:endTrap};return handle},SetIsEnabled:function(handle,isEnabled){handle.startTrap.tabIndex=isEnabled?0:-1;handle.endTrap.tabIndex=isEnabled?0:-1}};D2L.LP.Web.UI.Html.Dom.GetActiveElement=function(doc){if(doc===null||doc===undefined)return document.activeElement;else return doc.activeElement};
D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var result=[];var parentElem=elem.parentNode;className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))result.push(parentElem);parentElem=parentElem.parentNode}return result};D2L.LP.Web.UI.Html.Dom.GetAttribute=function(node,attrName){return node.getAttribute(attrName)};
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName=function(className,elem){var elems;if(elem===undefined||elem===null||elem===document)elems=$("."+className);else elems=$(elem).find("."+className);return $.makeArray(elems)};D2L.LP.Web.UI.Html.Dom.GetElementsByName=function(name,elem){if(elem===undefined)elem=document;var ret=[];var inputs=elem.getElementsByTagName("input");for(var i=0;i<inputs.length;i++)if(inputs[i].name!==undefined&&inputs[i].name==name)ret.push(inputs[i]);return ret};
D2L.LP.Web.UI.Html.Dom.GetElementById=function(id,doc){if(id===undefined||id===null)return null;if(id.GetValue!==undefined)id=id.GetValue();doc=doc||document;var elem=doc.getElementById(id);if(elem!==null&&elem.id!=id)if(doc.all){var possibleNodes=doc.all[id];for(var i=0;i<possibleNodes.length;i++)if(possibleNodes[i].id==id)return possibleNodes[i];return null}else return null;else return elem};D2L.LP.Web.UI.Html.Dom.GetEventTargetElement=function(e){return e.srcElement||e.target};
D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName=function(className,elem){for(var i=0;i<elem.childNodes.length;i++){var childNode=elem.childNodes[i];if(D2L.LP.Web.UI.Html.Dom.HasClassName(className,childNode))return childNode}return null};D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName=function(className,elem){var childNodes=new Array;for(var i=0;i<elem.childNodes.length;i++){var childNode=elem.childNodes[i];if(D2L.LP.Web.UI.Html.Dom.HasClassName(className,childNode))childNodes.push(childNode)}return childNodes};
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName=function(className,elem){if(elem===undefined||elem===null)elem=document;if(elem.getElementsByClassName!==undefined||elem.querySelectorAll!==undefined){var nodes;if(elem.getElementsByClassName!==undefined)nodes=elem.getElementsByClassName(className);else nodes=elem.querySelectorAll("."+className);if(nodes.length>0)return nodes[0];return null}var allElems=elem.all?elem.all:elem.getElementsByTagName("*");var elems=[];className=className.replace(/\-/g,
"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");for(var i=0;i<allElems.length;i++)if(oRegExp.test(allElems[i].className))return allElems[i];return null};D2L.LP.Web.UI.Html.Dom.GetFirstElementChild=function(elem){if(elem.firstElementChild!==undefined)return elem.firstElementChild;var childrenCount=elem.childNodes.length;for(var i=0;i<childrenCount;i++)if(elem.childNodes[i].nodeType==1)return elem.childNodes[i];return null};
D2L.LP.Web.UI.Html.Dom.GetBoundingRect=function(elem,baseOnDocumentCoordinates){if(baseOnDocumentCoordinates===undefined)baseOnDocumentCoordinates=true;var offsetParent=elem.offsetParent,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,top=elem.offsetTop,left=elem.offsetLeft;var width=elem.offsetWidth;var height=elem.offsetHeight;var positionedOffsetParent;if(!baseOnDocumentCoordinates)positionedOffsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);while((elem=elem.parentNode)&&
elem!==body&&elem!==docElem){if(!baseOnDocumentCoordinates&&elem===positionedOffsetParent)break;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;offsetParent=elem.offsetParent}}return{top:top,right:left+width,bottom:top+height,left:left,width:width,height:height}};
D2L.LP.Web.UI.Html.Dom.GetLastElementChild=function(elem){if(elem.lastElementChild!==undefined)return elem.lastElementChild;var childrenCount=elem.childNodes.length;for(var i=childrenCount-1;i>=0;i--)if(elem.childNodes[i].nodeType==1)return elem.childNodes[i];return null};
D2L.LP.Web.UI.Html.Dom.GetMousePosition=function(win,evt){var pos={x:0,y:0};if(evt.targetTouches&&evt.targetTouches[0]){pos.x=evt.targetTouches[0].pageX;pos.y=evt.targetTouches[0].pageY}else if(evt.changedTouches&&evt.changedTouches[0]){pos.x=evt.changedTouches[0].pageX;pos.y=evt.changedTouches[0].pageY}else if(win.event){pos.x=win.event.clientX+win.document.documentElement.scrollLeft+win.document.body.scrollLeft;pos.y=win.event.clientY+win.document.documentElement.scrollTop+win.document.body.scrollTop}else{pos.x=
evt.clientX+win.scrollX;pos.y=evt.clientY+win.scrollY}return pos};D2L.LP.Web.UI.Html.Dom.GetNextElementSibling=function(elem){if(elem.nextElementSibling!==undefined)return elem.nextElementSibling;var sibling=elem.nextSibling;while(sibling!==null){if(sibling.nodeType==1)return sibling;sibling=sibling.nextSibling}return null};
D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null)return null;if(includeHidden===undefined)includeHidden=false;var checkDecendents=function(node){var children=node.childNodes;for(var i=0;i<children.length;i++){var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable)return children[i];var childResult=checkDecendents(children[i]);if(childResult)return childResult}return null};var recursiveFunc=function(node,
skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden))return node;if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult)return childResult}var nextSibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(nextSibling){var siblingResult=recursiveFunc(nextSibling,false,false);if(siblingResult)return siblingResult;return null}var parent=null;if(node.parentNode)parent=node.parentNode;else{var win=null;if(node.defaultView)win=node.defaultView;
else if(node.parentWindow)win=node.parentWindow;if(win!=null&&win.D2L)if(win.frameElement)if(win.frameElement.parentNode)parent=win.frameElement.parentNode}if(!parent)return null;var nextSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(parent);if(nextSiblingOfParent){var r=recursiveFunc(nextSiblingOfParent,false,false);if(r)return r}return null};var result=recursiveFunc(domNode,true,false);return result};
D2L.LP.Web.UI.Html.Dom.GetPageSize=function(w){var ret={width:0,height:0};var doc=undefined;try{doc=w.document}catch(e){}if(doc===undefined)return ret;var dh=0;var dw=0;var sh=0;var sw=0;var oh=0;var ow=0;var dbH=0;var dbW=0;if(doc.height!==undefined){dh=doc.height;dw=doc.width}if(doc.body!==undefined&&doc.body!==null){if(doc.body.scrollHeight!==undefined)sh=doc.body.scrollHeight;if(doc.body.scrollWidth!==undefined)sw=doc.body.scrollWidth;if(doc.body.offsetHeight!==undefined)oh=doc.body.offsetHeight;
if(doc.body.offsetWidth!==undefined)ow=doc.body.offsetWidth;if(doc.documentElement.scrollHeight!==undefined)dbH=doc.documentElement.scrollHeight;if(doc.documentElement.scrollWidth!==undefined)dbW=doc.documentElement.scrollWidth}ret.height=Math.min(dbH,Math.max(Math.max(dh,sh),oh));ret.width=Math.min(dbW,Math.max(Math.max(dw,sw),ow));return ret};
D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var parentElem;try{parentElem=elem.parentNode}catch(e){return null}className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))return parentElem;parentElem=parentElem.parentNode}return null};
D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName=function(className,elem){if(elem===undefined||elem===null||className===undefined||className===null)return null;var parentElems=new Array;var parentElem;try{parentElem=elem.parentNode}catch(e){return null}className=className.replace(/\-/g,"\\-");var oRegExp=new RegExp("(^|\\s)"+className+"(\\s|$)");while(parentElem!==null){if(oRegExp.test(parentElem.className))parentElems.push(parentElem);parentElem=parentElem.parentNode}return parentElems};
D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent=function(elem){var offsetParent=elem.offsetParent||document.body;while(offsetParent&&D2L.LP.Web.UI.Html.Css.GetStyle(offsetParent,"position")==="static"&&offsetParent!==document.body&&offsetParent!==document.documentElement)offsetParent=offsetParent.offsetParent;return offsetParent};
D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling=function(elem){if(elem===undefined||elem===null)return null;if(elem.previousElementSibling!==undefined)return elem.previousElementSibling;var sibling=elem.previousSibling;while(sibling!==null){if(sibling.nodeType==1)return sibling;sibling=sibling.previousSibling}return null};
D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement=function(domNode,includeHidden){if(domNode===undefined||domNode===null)return null;if(includeHidden===undefined)includeHidden=false;var checkDecendents=function(node){var children=node.childNodes;for(var i=children.length-1;i>=0;i--){var childResult=checkDecendents(children[i]);if(childResult)return childResult;var isFocusable=D2L.LP.Web.UI.Html.Dom.IsFocusable(children[i],includeHidden);if(isFocusable)return children[i]}return null};var recursiveFunc=
function(node,skipFocusCheck,ignoreChildren){if(!skipFocusCheck&&D2L.LP.Web.UI.Html.Dom.IsFocusable(node,includeHidden))return node;if(!ignoreChildren){var childResult=checkDecendents(node);if(childResult)return childResult}var prevSibling=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(prevSibling){var siblingResult=recursiveFunc(prevSibling,false,false);if(siblingResult)return siblingResult;return null}var parent=null;if(node.parentNode)parent=node.parentNode;else{var win=null;if(node.defaultView)win=
node.defaultView;else if(node.parentWindow)win=node.parentWindow;if(win!=null&&win.D2L)if(win.frameElement)if(win.frameElement.parentNode)parent=win.frameElement.parentNode}if(!parent)return null;var prevSiblingOfParent=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(parent);if(prevSiblingOfParent){var r=recursiveFunc(prevSiblingOfParent,false,false);if(r)return r}return null};var result=recursiveFunc(domNode,true,true);return result};
D2L.LP.Web.UI.Html.Dom.GetScrollPosition=function(w){w=w||window;var ret={top:0,left:0};if(w.pageYOffset!==undefined){ret.top=w.pageYOffset;ret.left=w.pageXOffset}else if(w.document.documentElement!==undefined&&w.document.documentElement.scrollTop!==undefined){ret.top=w.document.documentElement.scrollTop;ret.left=w.document.documentElement.scrollLeft}else if(w.document.body!==undefined){ret.top=w.document.body.scrollTop;ret.left=w.document.body.scrollLeft}return ret};
D2L.LP.Web.UI.Html.Dom.GetTextContent=function(node){if(node==null)return null;if(node.textContent!==undefined)return node.textContent;else if(node.innerText!==undefined)return node.innerText;else return null};
D2L.LP.Web.UI.Html.Dom.GetViewportSize=function(w){w=w||window;var ret={width:0,height:0};if(w.innerWidth!==undefined){ret.width=w.innerWidth;ret.height=w.innerHeight}else if(w.document.documentElement&&w.document.documentElement.clientWidth){ret.width=w.document.documentElement.clientWidth;ret.height=w.document.documentElement.clientHeight}else if(w.document.body){ret.width=w.document.body.clientWidth;ret.height=w.document.body.clientHeight}return ret};
D2L.LP.Web.UI.Html.Dom.HasAnyClassName=function(classNames,domNode){if(!classNames||!domNode||domNode.className===undefined)return false;for(var i=0;i<classNames.length;i++){var hasClass=$(domNode).hasClass(classNames[i]);if(hasClass)return true}return false};D2L.LP.Web.UI.Html.Dom.HasAttribute=function(node,attrName){if(node.hasAttribute!==undefined)return node.hasAttribute(attrName);else{var val=node.getAttribute(attrName);return val!==null&&val.length>0}};
D2L.LP.Web.UI.Html.Dom.HasClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return false;var hasClass=$(domNode).hasClass(className);return hasClass};D2L.LP.Web.UI.Html.Dom.HasFocus=function(elem){if(!elem)return false;return D2L.LP.Web.UI.Html.Dom.GetActiveElement()===elem};
D2L.LP.Web.UI.Html.Dom.IndexOf=function(source,searchValue,from){from=from||0;if(source.indexOf!==undefined)return source.indexOf(searchValue,from);if(!D2L.LP.Web.UI.Html.JavaScript.IsArray(source))return;if(from>=source.length)return-1;for(;from<source.length;from++)if(source[from]===searchValue)return from;return-1};D2L.LP.Web.UI.Html.Dom.IndexOfElement=function(elem){var i=0;var e=elem;while(e=e.previousSibling)if(e.nodeType==1)i++;return i};
D2L.LP.Web.UI.Html.Dom.InsertElementAfter=function(elem,insertAfterElem){var nextElement=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(insertAfterElem);var parent=insertAfterElem.parentNode;if(nextElement!=null)parent.insertBefore(elem,nextElement);else parent.appendChild(elem)};D2L.LP.Web.UI.Html.Dom.IsAncestor=function(ancestorNode,node){var cur=node;while(cur){if(cur===ancestorNode)return true;cur=cur.parentNode}return false};
D2L.LP.Web.UI.Html.Dom.FocusableElements={a:true,body:true,button:true,frame:true,iframe:true,img:true,input:true,isindex:true,object:true,select:true,textarea:true};
D2L.LP.Web.UI.Html.Dom.IsFocusable=function(node,includeHidden){if(node===undefined||node===null||node.disabled)return false;if(!includeHidden){var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(node);if(!isVisible)return false}if(node.attachEvent){if(node.getAttributeNode){var tabIndexAttr=node.getAttributeNode("tabindex");if(tabIndexAttr!==null&&tabIndexAttr.specified)return tabIndexAttr.value>=0}var nodeName=node.nodeName.toLowerCase();if(D2L.LP.Web.UI.Html.Dom.FocusableElements[nodeName])return true;
return false}return node.tabIndex>=0};
D2L.LP.Web.UI.Html.Dom.IsVisible=function(domNode){if(domNode===undefined||domNode===null)return false;var isVisible=function(node){if(node.style===undefined)return true;if(node.style.visibility&&node.style.visibility!="visible"&&node.style.visibility!="inherit")return false;if(node.style.display&&node.style.display=="none")return false;if(D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!="visible"&&D2L.LP.Web.UI.Html.Css.GetStyle(node,"visibility")!="inherit")return false;if(D2L.LP.Web.UI.Html.Css.GetStyle(node,
"display")=="none")return false;return true};var visible=isVisible(domNode);if(visible){var _parentNode=domNode.parentNode;while(_parentNode!=null){var doc=null;var win=null;if(_parentNode.nodeName.toLowerCase()=="document")doc=_parentNode;else if(_parentNode.ownerDocument)doc=_parentNode.ownerDocument;if(doc!=null)win=doc.defaultView?doc.defaultView:doc.parentWindow;if(win!=null&&win.D2L){visible=isVisible(_parentNode);if(visible)_parentNode=_parentNode.parentNode;else break}else break}}return visible};
D2L.LP.Web.UI.Html.Dom.IsVisibleInContainer=function(elem,container){if(!container)container=window;var $container=$(container);var containerTop=$container.scrollTop();var containerBottom=containerTop+$container.height();var elemOffsetTop=$(elem).offset().top;return elemOffsetTop>=containerTop&&elemOffsetTop<=containerBottom};D2L.LP.Web.UI.Html.Dom.Navigate=function(location,formId){if(formId!==undefined&&formId!==null)D2L.LP.Web.UI.Common.Controls.Form.StopChangeTracking(formId);window.location.assign(location.GetUrl())};
D2L.LP.Web.UI.Html.Dom.OpenWindow=function(windowName,location,width,height,hasMenubar,hasToolbar){if(hasMenubar===undefined)hasMenubar=false;if(hasToolbar===undefined)hasToolbar=false;windowName=windowName.replace(/[^a-zA-Z0-9]+/g,"_");var features="";if(width>0)features+="width="+width+",";if(height>0)features+="height="+height+",";features+="location=1,"+"menubar="+(hasMenubar?"1":"0")+","+"resizable=1,"+"status=1,"+"scrollbars=1,"+"toolbar="+(hasToolbar?"1":"0");var w=window.open(location.GetUrl(),
windowName,features);w.focus()};
D2L.LP.Web.UI.Html.Dom.OverlayElement=function(elem,targetElem,insertAfterElem,position,verticalOffset,horizontalOffset,isAutoPosition,isAutoScroll,attachToBody){if(attachToBody===undefined)attachToBody=false;if(isAutoPosition===undefined)isAutoPosition=true;if(isAutoScroll===undefined)isAutoScroll=false;if(insertAfterElem===undefined)insertAfterElem=targetElem;if(position===undefined)position=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse;if(verticalOffset===undefined)verticalOffset=0;if(horizontalOffset===
undefined)horizontalOffset=0;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTL){var RTLposition=position;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left)RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right)RTLposition=D2L.LP.Web.UI.Html.Style.OverlayPosition.Left;position=RTLposition;horizontalOffset=-horizontalOffset}if(attachToBody)insertAfterElem=
document.body.lastChild;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(elem,insertAfterElem);elem.style.left="";elem.style.right="";elem.style.top="";elem.style.bottom="";var targetRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(targetElem,attachToBody);var elemRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem,attachToBody);var viewPortSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();var left;var top;if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){var clickPos=D2L.LP.Web.UI.Events.m_lastMouseDownPosition;
var scrollPos=D2L.LP.Web.UI.Html.Dom.GetScrollPosition();left=clickPos.x-scrollPos.left;top=clickPos.y-scrollPos.top;elem.style.position="fixed"}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Top){left=targetRect.left;top=targetRect.top-elemRect.height}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Right){left=targetRect.left+targetRect.width;top=targetRect.top}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom){left=targetRect.left+(isRTL?targetRect.width:0);
top=targetRect.top+targetRect.height}else if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Left){left=targetRect.left;top=targetRect.top}else throw"Invalid Overlay Position";left+=horizontalOffset;top+=verticalOffset;if(isRTL&&position!=D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse)left=left-elemRect.width;elem.style.left=left+"px";elem.style.top=top+"px";if(isAutoPosition||isAutoScroll){var offsetParent=D2L.LP.Web.UI.Html.Dom.GetPositionedOffsetParent(elem);var offsetParentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(offsetParent);
var elemNewRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem);var body=document.body;if(offsetParent==body){offsetParentRect.bottom=viewPortSize.height;elemNewRect.bottom-=document.documentElement.scrollTop;offsetParentRect.top=0;elemNewRect.top-=document.documentElement.scrollTop}var rightDelta=offsetParentRect.right-elemNewRect.right;var leftDelta=elemNewRect.left-offsetParentRect.left;var topDelta=elemNewRect.top-offsetParentRect.top;var bottomDelta=offsetParentRect.bottom-elemNewRect.bottom;if(isRTL){leftDelta=
elemNewRect.left;rightDelta=elemNewRect.right}if(isAutoPosition){if(position==D2L.LP.Web.UI.Html.Style.OverlayPosition.Mouse){if(left+elemRect.width>viewPortSize.width)left=left-elemRect.width;if(top+elemRect.height>viewPortSize.height)top=top-elemRect.height}else{if(!isRTL&&rightDelta<0&&leftDelta>=0)left=targetRect.left-(isRTL?0:elemRect.width);if(isRTL&&leftDelta<0&&rightDelta>=0)left=targetRect.left-(isRTL?0:elemRect.width);if(bottomDelta<0&&topDelta>=0)top=targetRect.top-elemRect.height}if(left>=
0)elem.style.left=left+"px";if(top>=0)elem.style.top=top+"px"}if(isAutoScroll){var scroll=false;var xScrollBy=0;var yScrollBy=0;if(rightDelta<0){xScrollBy=Math.abs(rightDelta)+10;scroll=true}if(leftDelta<0){xScrollBy=leftDelta-10;scroll=true}if(bottomDelta<0){yScrollBy=Math.abs(bottomDelta)+10;scroll=true}if(topDelta<0){yScrollBy=topDelta-10;scroll=true}if(scroll)scrollBy(xScrollBy,yScrollBy)}}};D2L.LP.Web.UI.Html.Dom.RemoveAttribute=function(node,attrName){node.removeAttribute(attrName)};
D2L.LP.Web.UI.Html.Dom.RemoveChildElements=function(domNode){if(domNode)domNode.innerHTML=""};D2L.LP.Web.UI.Html.Dom.RemoveClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return;$(domNode).removeClass(className)};D2L.LP.Web.UI.Html.Dom.RemoveClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null)D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node)};
D2L.LP.Web.UI.Html.Dom.RemoveElement=function(elem){if(elem&&elem.parentNode)elem.parentNode.removeChild(elem)};D2L.LP.Web.UI.Html.Dom.RemoveElementById=function(id){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.RemoveElement(elem)};
D2L.LP.Web.UI.Html.Dom.RemoveEventListener=function(eventName,domNode,callback,useCapture){if(domNode.removeEventListener){useCapture=useCapture||false;if(eventName.length>2&&eventName.substr(0,2)=="on")eventName=eventName.substr(2);domNode.removeEventListener(eventName,callback,useCapture)}else if(domNode.detachEvent){if(eventName.substr(0,2)!="on")eventName="on"+eventName;domNode.detachEvent(eventName,callback)}};
D2L.LP.Web.UI.Html.Dom.ScrollToElement=function(elem,delay,toMiddleOfView,animate){if(delay===undefined)delay=300;var animationSpeed=500;var animationEasing="easeOutCirc";var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(elem);var top=rect.top;if(toMiddleOfView){var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();top-=viewPort.height/2}var minibar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-minibar-placeholder-fixed");if(minibar){var minibarHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(minibar).height;
var minibarOffset=3;top-=minibarHeight+minibarOffset}if(top<0)top=0;var animate=function(jqNode){jqNode.animate({scrollTop:top},animationSpeed,animationEasing)};setTimeout(function(){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body");if(dialogBody)if(animate)animate($(dialogBody));else dialogBody.scrollTop=top;else if(animate)animate($("html, body"));else window.scrollTo(0,top)},delay)};
D2L.LP.Web.UI.Html.Dom.ScrollToElementById=function(id,delay,toMiddleOfView,animate){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!elem)return;return D2L.LP.Web.UI.Html.Dom.ScrollToElement(elem,delay,toMiddleOfView,animate)};D2L.LP.Web.UI.Html.Dom.SetAttribute=function(node,attrName,attrValue){node.setAttribute(attrName,attrValue)};
D2L.LP.Web.UI.Html.Dom.SetIsDisplayed=function(id,isDisplayed){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("SetIsDisplayed Error. Node does not exist: '"+id.GetValue()+"'.");return}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isDisplayed)};D2L.LP.Web.UI.Html.Dom.SetIsDisplayedMultiple=function(ids,isDisplayed){for(var i=0;i<ids.length;i++)D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(ids[i],isDisplayed)};
D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode=function(node,isDisplayed){if(isDisplayed)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);D2L.LP.Web.UI.Events.OnVisibilityChange.Trigger(node,isDisplayed)};D2L.LP.Web.UI.Html.Dom.SetIsEnabled=function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(node,isEnabled)};
D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode=function(node,isEnabled){if(node.disabled!==undefined)node.disabled=!isEnabled};
D2L.LP.Web.UI.Html.Dom.Storage={m_isSupported:undefined,IsSupported:function(){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(me.m_isSupported!==undefined)return me.m_isSupported;if(!window.localStorage){me.m_isSupported=false;return false}try{window.localStorage.setItem("test","");window.localStorage.removeItem("test")}catch(e){return false}return true},LocalIgnore:{},Repo:{},Common:{Get:function(storage,key){var me=D2L.LP.Web.UI.Html.Dom.Storage;var val;if(me.IsSupported())val=storage.getItem(key);else val=
D2L.LP.Web.UI.Html.Dom.Storage.Repo[key];if(val===undefined)val=null;return val},Remove:function(storage,key,triggerLocalEvent){if(triggerLocalEvent===undefined)triggerLocalEvent=true;var me=D2L.LP.Web.UI.Html.Dom.Storage;var oldValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);var isIE=window.navigator.userAgent.indexOf("MSIE")>-1;if(me.IsSupported()){if(isIE)me.LocalIgnore[key]=true;storage.removeItem(key);if(isIE)setTimeout(function(){me.LocalIgnore[key]=false},100)}else D2L.LP.Web.UI.Html.Dom.Storage.Repo[key]=
null;var newValue=D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(storage,key);if(oldValue==newValue)return;if(triggerLocalEvent)D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:null,OldValue:oldValue})},Set:function(storage,key,value,triggerLocalEvent){var me=D2L.LP.Web.UI.Html.Dom.Storage;if(triggerLocalEvent===undefined)triggerLocalEvent=true;value=value.toString();var oldValue=me.Common.Get(storage,key);if(oldValue==value)return;var isIE=window.navigator.userAgent.indexOf("MSIE")>-1;var success=
false;if(me.IsSupported())try{if(isIE)me.LocalIgnore[key]=true;storage.setItem(key,value);if(isIE)setTimeout(function(){me.LocalIgnore[key]=false},100);success=true}catch(e){D2L.LP.Web.UI.Html.JavaScript.Console.Error("Local storage: disabled or limit reached.",e)}if(!success)me.Repo[key]=value;if(triggerLocalEvent)D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:key,NewValue:value,OldValue:oldValue})}},Local:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.localStorage,key)},
Remove:function(key,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.localStorage,key,triggerLocalEvent)},Set:function(key,value,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.localStorage,key,value,triggerLocalEvent)}},OnStorage:function(e){if(e.oldValue===e.newValue)return;if(D2L.LP.Web.UI.Html.Dom.Storage.LocalIgnore[e.key])return;try{D2L.LP.Web.UI.Events.OnStorage.Trigger({Key:e.key,NewValue:e.newValue,OldValue:e.oldValue})}catch(e){}},Session:{Get:function(key){return D2L.LP.Web.UI.Html.Dom.Storage.Common.Get(window.sessionStorage,
key)},Remove:function(key,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Remove(window.sessionStorage,key,triggerLocalEvent)},Set:function(key,value,triggerLocalEvent){D2L.LP.Web.UI.Html.Dom.Storage.Common.Set(window.sessionStorage,key,value,triggerLocalEvent)}}};
D2L.LP.Web.UI.Html.Dom.SwapElements=function(elem1,elem2){var elem2NextSibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(elem2);var elem2Parent=elem2.parentNode;elem1.parentNode.replaceChild(elem2,elem1);if(elem2NextSibling!=null)elem2Parent.insertBefore(elem1,elem2NextSibling);else elem2Parent.appendChild(elem1)};
D2L.LP.Web.UI.Html.Dom.SwapControls=function(id1,id2){var node1=D2L.LP.Web.UI.Html.Dom.GetElementById(id1.GetValue());var node2=D2L.LP.Web.UI.Html.Dom.GetElementById(id2.GetValue());D2L.LP.Web.UI.Html.Dom.SwapElements(node1,node2)};D2L.LP.Web.UI.Html.Dom.ToggleClassName=function(className,domNode){if(!className||!domNode||domNode.className===undefined)return;$(domNode).toggleClass(className)};
D2L.LP.Web.UI.Html.Dom.ToggleClassNameById=function(className,id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null)D2L.LP.Web.UI.Html.Dom.ToggleClassName(className,node)};
D2L.LP.Web.UI.Html.Dom.ToggleVisibility=function(id,animate){var $node=id.$();if($node.length===0){D2L.LP.Web.UI.Html.JavaScript.Console.Warn("Toggle Visiblity Error. Node does not exist: '"+id.GetValue()+"'.");return}if(animate)if($node.hasClass("d2l-hidden"))$node.css("display","none").removeClass("d2l-hidden").slideToggle();else $node.slideToggle();else $node.toggleClass("d2l-hidden")};
D2L.LP.Web.UI.Html.JavaScript.If=function(){var args=arguments;var ret=new D2L.LP.Web.UI.Events.Event;var executeStatement=function(index){if(index==args.length){ret.Trigger();return}var condition=args[index];var func=args[index+1];if(!condition){index=index+2;executeStatement(index);return}var val=undefined;if(func!==undefined&&func!==null)val=func.call(func);if(val===undefined||val===null||val.AddListener===undefined){ret.Trigger();return}val.AddListener(function(){ret.Trigger()});val.AddReleaseListener(function(){ret.Release()})};
setTimeout(function(){executeStatement(0)});return ret};D2L.LP.Web.UI.Html.JavaScript.LogicalAnd=function(){var args=arguments;var result=args[0];for(var i=1;i<args.length;i++)result=result&&args[i];return result};D2L.LP.Web.UI.Html.JavaScript.LogicalNegate=function(booleanValue){return!booleanValue};D2L.LP.Web.UI.Html.JavaScript.LogicalOr=function(){var args=arguments;var result=args[0];for(var i=1;i<args.length;i++)result=result||args[i];return result};
D2L.LP.Web.UI.Html.JavaScript.Add=function(){var args=arguments;var result=0;for(var i=0;i<args.length;i++)result+=parseInt(args[i]);return result};D2L.LP.Web.UI.Html.JavaScript.Array=function(){var args=arguments;var values=[];for(var i=0;i<args.length;i++)values.push(args[i]);return values};D2L.LP.Web.UI.Html.JavaScript.ArrayLength=function(array){return array.length};
D2L.LP.Web.UI.Html.JavaScript.Bool={Parse:function(value){if(value===undefined||value===null)return false;value=$.trim(value.toString().toLowerCase());if(value==="0"||value==="false"||value==="")return false;return true},ToStringExpression:function(value){var strValue=value?"true":"false";return strValue}};D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline=function(){return D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline(arguments)};
D2L.LP.Web.UI.Html.JavaScript.CallFunctionArrayPipeline=function(funcs){var ret=new D2L.LP.Web.UI.Events.Event;var handleResult=function(result,index){if(typeof result!=="undefined"&&(result===null||result===false)){ret.Trigger(false);return}if(typeof result!=="undefined"&&result.AddListener!==undefined){result.AddListener(function(r){handleResult(r,index)});result.AddReleaseListener(function(){ret.Release()})}else callFunction(++index)};var callFunction=function(index){if(index==funcs.length){ret.Trigger(true);
return}if(funcs[index]===undefined||funcs[index]===null)callFunction(++index);else{var result=funcs[index].apply(funcs[index]);handleResult(result,index)}};setTimeout(function(){callFunction(0)},0);return ret};D2L.LP.Web.UI.Html.JavaScript.Concat=function(){var args=arguments;var result="";for(var i=0;i<args.length;i++)result+=args[i].toString();return result};
D2L.LP.Web.UI.Html.JavaScript.HtmlEncode=function(value){if(value==undefined||value==null)return value;if(value.indexOf("&")!=-1)value=value.replace(/&/g,"&amp;");if(value.indexOf("<")!=-1)value=value.replace(/</g,"&lt;");if(value.indexOf(">")!=-1)value=value.replace(/>/g,"&gt;");if(value.indexOf('"')!=-1)value=value.replace(/"/g,"&quot;");return value};
D2L.LP.Web.UI.Html.JavaScript.IncludeScript=function(src,params){var evt=new D2L.LP.Web.UI.Events.Event;var sep=src.indexOf("?")>-1?"&":"?";for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep="&"}var scripts=document.body.getElementsByTagName("script");for(var i=0;i<scripts.length;i++)if(scripts[i].src.length>=src.length&&scripts[i].src.substr(scripts[i].src.length-src.length)==src){setTimeout(function(){evt.Trigger()},
0);return evt}var script=document.createElement("script");script.type="text/javascript";if(script.readyState)script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;evt.Trigger()}};else script.onload=function(){evt.Trigger()};script.src=src;document.body.appendChild(script);return evt};
D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock=function(js){var script=document.createElement("script");script.type="text/javascript";script.appendChild(document.createTextNode(js));document.body.appendChild(script);return script};
D2L.LP.Web.UI.Html.JavaScript.Int={Parse:function(value){var val=D2L.LP.Web.UI.Html.JavaScript.Int.TryParse(value,null);return val},TryParse:function(value,defaultValue){if(value===undefined||value===null)return defaultValue;var val=parseInt(value);if(isNaN(val))return defaultValue;return val}};D2L.LP.Web.UI.Html.JavaScript.IsArray=function(obj){if(obj&&obj.pop&&obj.push)return true;return false};D2L.LP.Web.UI.Html.JavaScript.NameValuePair=function(pairName,pairValue){return{name:pairName,value:pairValue}};
D2L.LP.Web.UI.Html.JavaScript.ObjectAccessor=function(obj,property){if(obj[property]!==undefined)if(typeof obj[property]==="function")return obj[property]();else return obj[property];return null};
D2L.LP.Web.UI.Html.JavaScript.Poll=function(getMethod,frequency,condition){var handleConditionVal=function(val,evt){if(val===undefined||val===null){evt.Trigger(false);return}if(val===false||val===true){evt.Trigger(val);return}if(val.AddListener===undefined){evt.Trigger(true);return}val.AddListener(function(v){handleConditionVal(v,evt)});val.AddReleaseListener(function(){evt.Release()})};var getCondition=function(){var evt=new D2L.LP.Web.UI.Events.Event;if(condition===undefined||condition===null){setTimeout(function(){evt.Trigger(true)});
return evt}var val=condition();setTimeout(function(){handleConditionVal(val,evt)});return evt};var func=function(){var cond=getCondition();cond.AddListener(function(val){if(val){var method=getMethod();method()}setTimeout(func,frequency)})};setTimeout(func,frequency)};
D2L.LP.Web.UI.Html.JavaScript.Print=function(windowName){var win=window;if(windowName!==null&&windowName!==undefined&&window.name!==windowName){windowName=windowName.toLowerCase();var iframes=document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++)if(iframes[i].contentWindow.name.toLowerCase()===windowName){win=iframes[i].contentWindow;break}}win.focus();if(win.document.readyState=="complete")win.print();else $(win).load(function(){setTimeout(win.print,50)})};
D2L.LP.Web.UI.Html.JavaScript.RpcReceiveJsPayloadProvider=function(data){if(data===undefined||data===null)return true;var events=[];for(var i=0;i<data.length;i++){var item=data[i];if(item.Type=="File")events.push(D2L.LP.Web.UI.Html.JavaScript.IncludeScript(item.Content));else D2L.LP.Web.UI.Html.JavaScript.IncludeScriptBlock(item.Content)}var evt=D2L.LP.Web.UI.Events.AggregateEvents(events);return evt};
D2L.LP.Web.UI.Html.JavaScript.RpcReceiveCssPayloadProvider=function(data){if(data===undefined||data===null)return;var itemContent=null;var includeStyleBlock=function(){if(itemContent!==null){D2L.LP.Web.UI.Html.Style.IncludeStyleBlock(itemContent);itemContent=null}};for(var i=0;i<data.length;i++){var item=data[i];if(item.Type=="File"){includeStyleBlock();D2L.LP.Web.UI.Html.Style.IncludeStyleSheet(item.Content)}else if(itemContent===null)itemContent=item.Content;else itemContent+=item.Content}includeStyleBlock()};
window.oldSetTimeout=window.setTimeout;window.setTimeout=function(method,time){if(time===undefined||time===0)return D2L.LP.Web.UI.Html.JavaScript.SetImmediate(method);else return window.oldSetTimeout(method,time)};D2L.LP.Web.UI.Html.JavaScript.SetImmediate=function(handle){if(window.setImmediate!==undefined)return window.setImmediate(handle);else if(window.msSetImmediate!==undefined)return window.msSetImmediate(handle);else return window.oldSetTimeout(handle)};
D2L.LP.Web.UI.Html.JavaScript.SetTimeoutWithEvent=function(method,time){var evt=new D2L.LP.Web.UI.Events.Event;setTimeout(function(){var result=method.call(method);if(result===undefined||result===null||result.AddListener===undefined){evt.Trigger(result);return}result.AddListener(function(r){evt.Trigger(r)});result.AddReleaseListener(function(){evt.Release()})},time);return evt};
D2L.LP.Web.UI.Html.JavaScript.TrimString=function(type,str){if(typeof str!="string")throw"TrimString Error: given variable is not a string.";if(type===0)return str.replace(/^\s+|\s+$/g,"");else if(type===1)return str.replace(/^\s+/,"");else if(type===2)return str.replace(/\s+$/,"")};D2L.LP.Web.UI.Html.JavaScript.UrlEncode=function(value){if(value==undefined||value==null)return value;var encodedValue=encodeURIComponent(value);return encodedValue};
D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath=function(value){if(value==undefined||value==null)return value;var encodedValue="";var urlComponents=value.split("/");for(var i=0;i<urlComponents.length;i++)if(i==0)encodedValue+=encodeURIComponent(urlComponents[i]);else encodedValue+="/"+encodeURIComponent(urlComponents[i]);return encodedValue};
D2L.LP.Web.UI.Html.JavaScript.WidgetAccessor=function(id,widgetName,methodName){if(id===undefined||widgetName===undefined||methodName===undefined)return;var instance=id.$();if(instance[widgetName]===undefined)return;var args=Array.prototype.slice.call(arguments,2);instance[widgetName].apply(instance,args)};D2L.LP.Web.UI.Html.Css={};
D2L.LP.Web.UI.Html.Css.GetStyle=function(elem,styleAttribute){if(elem!=null&&elem!=undefined)if(window.getComputedStyle!==undefined)return window.getComputedStyle(elem,null).getPropertyValue(styleAttribute);else if(elem.currentStyle[styleAttribute])return elem.currentStyle[styleAttribute]};
D2L.LP.Web.UI.Html.Css.Capability={SupportsTransition:function(){return document.body.style.transition!==undefined||document.body.style.MozTransition!==undefined||document.body.style.webkitTransition!==undefined||document.body.style.msTransition!==undefined}};D2L.VS=function(varName,obj){D2L.V[varName]=obj};D2L.VG=function(varName){return D2L.V[varName]};D2L.VINS=function(varName){return D2L.V[varName]===undefined};D2L.V={};
D2L.VDS=function(dictName,varName,obj){if(!D2L.VD[dictName])D2L.VD[dictName]={};D2L.VD[dictName][varName]=obj};D2L.VDG=function(dictName,varName){if(D2L.VD[dictName])return D2L.VD[dictName][varName];return null};D2L.VD={};D2L.VAA=function(arrayName,obj){if(!D2L.VA[arrayName])D2L.VA[arrayName]=[];D2L.VA[arrayName].push(obj)};D2L.VAG=function(arrayName,index){if(D2L.VA[arrayName])return D2L.VA[arrayName][index];return null};
D2L.VAGA=function(arrayName){if(D2L.VA[arrayName])return D2L.VA[arrayName];return[]};D2L.VA={};
D2L.LP.Web.UI.Html.Math={AnnotateMathML:function(encoding,title,originalMath,mathML){if(title===undefined)title="";var mathStartRegEx=/<math[^>]*>/i;var mathEndRegEx=/<\/math>/i;var mathBlockRegEx=/(display="block"|display='block')/gi;var mathStyleRegEx=/(style="(.*?)")/i;var mathStart=mathStartRegEx.exec(mathML);var mathMLContent=mathML.replace(/<math[^>]*>/gi,"").replace(/<\/math>/gi,"");var mathDisplayStyle=mathBlockRegEx.test(mathStart)?' display="block"':"";var mathStyleMatch=mathStyleRegEx.exec(mathStart);
var style="";var encode;if(D2L.LP.Web.UI.Html.JavaScript.HtmlEncode!=undefined)encode=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode;else encode=D2L.Util.Html.Encode;if(mathStyleMatch!=null)style=mathStyleMatch[1];var encodedMath=encode(originalMath);var annotatedMathML='<math title="'+title+'" '+style+' xmlns="http://www.w3.org/1998/Math/MathML"'+mathDisplayStyle+"><semantics><mstyle>"+mathMLContent+'</mstyle><annotation encoding="'+encoding+'">'+'{"version":"1.1","math":"'+D2L.LP.Web.UI.Html.Math.EncodeMathML(encodedMath)+
'"}'+"</annotation></semantics></math>";return annotatedMathML},EncodeMathML:function(str){if(str.indexOf("&")!=-1||str.indexOf("<")!=-1||str.indexOf(">")!=-1||str.indexOf('"')!=-1){str=str.replace(/\&/g,"&amp;");str=str.replace(/\</g,"&lt;");str=str.replace(/\>/g,"&gt;");str=str.replace(/\"/g,"&quot;");var decodeCharRef=function(match){return match.replace("&amp;amp;","&")};str=str.replace(/&amp;amp;[\S]*?;/g,decodeCharRef)}return str},DecodeMathML:function(str){if(str.indexOf("&")!=-1){str=str.replace(/&amp;/g,
"&");str=str.replace(/&lt;/g,"<");str=str.replace(/&gt;/g,">");str=str.replace(/&quot;/g,'"')}return str},GetMath:function(node,callback){if(MathJax===undefined)return;MathJax.Hub.Queue(function(){var math=[];var allJax=MathJax.Hub.getAllJax(node);if(allJax!=null&&allJax.length>0)for(var i=0;i<allJax.length;i++){var jax=allJax[i];if(jax.root!==undefined&&jax.root.toMathML!==undefined)math.push({"originalMath":jax.originalText,"mathML":jax.root.toMathML()})}callback.call(callback,math)});return},Update:function(callback){D2L.LP.Web.UI.Html.Math.UpdateNode(null,
callback)},UpdateNode:function(node,callback){if(window.MathJax===undefined||window.MathJax===null){if(callback!==undefined&&callback!==null)callback.call(callback);return}if(node.nodeType!==9&&node.nodeType!==1)return;if(node!==null)MathJax.Hub.Queue(["Typeset",MathJax.Hub,node]);else MathJax.Hub.Queue(["Typeset",MathJax.Hub]);if(callback!==undefined&&callback!==null)MathJax.Hub.Queue(function(){callback.call(callback)})}};
D2LMathML={IsLatex:false,m_message:"",MobileInit:function(message){D2LMathML.m_message=message},DesktopInit:function(mathMLUrl,latexUrl){(function(){var head=document.getElementsByTagName("head")[0];var configScript='MathJax.Hub.Config({ delayStartupUntil: "onload",showProcessingMessages: false, messageStyle: "none", showMathMenu: true, showMathMenuMSIE: true, menuSettings: { context: "MathJax", zoom: "None" },NativeMML: { showMathMenuMSIE: false, scale: 140 }, "HTML-CSS": { linebreaks: { automatic: true, width: "container"}, imageFont: null, scale: 130 } });';
var script=document.createElement("script");script.type="text/x-mathjax-config";script.textContent=configScript;head.appendChild(script);var mathJaxScript=document.createElement("script");mathJaxScript.type="text/javascript";mathJaxScript.src=D2LMathML.IsLatex?latexUrl:mathMLUrl;head.appendChild(mathJaxScript)})()}};
D2L.LP.Web.UI.Html.JavaScript.History={States:{},HandleStateChange:function(state){if(state.data===null)return;var url=D2L.LP.Web.UI.Html.JavaScript.History.StripHost(state.url);var states=D2L.LP.Web.UI.Html.JavaScript.History.States;if(states[url]===undefined){window.location=state.url;return}document.title=states[url].Title;var reviver=states[url].Reviver;if(reviver===null)return;reviver()},Push:function(loc,title,reviver){if(!window.History.enabled)return;D2L.LP.Web.UI.Html.JavaScript.History.States[loc]=
{"Reviver":null,"Title":title};window.History.pushState(null,null,loc);setTimeout(function(){D2L.LP.Web.UI.Html.JavaScript.History.States[loc].Reviver=reviver},0)},StripHost:function(url){var index=url.indexOf("/d2l/");if(index<0)return url;return url.substr(index)}};D2L.LP.Web.UI.Html.PartialRendering={};
D2L.LP.Web.UI.Html.PartialRendering={_includeClasses:[],AddClassNameToFocusIncludeList:function(className){D2L.LP.Web.UI.Html.PartialRendering._includeClasses[className]=true},InjectResult:function(placeholder,result,animationType,reviver,isInnerReplacement,pathToActiveElement){animationType=animationType||D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var hasAnimation=animationType!=D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.None;var placeholderId=placeholder.getAttribute("id");
var prc=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId);var doInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-placeholder-inner",placeholder);var firstNewNode=null;var parentNode=placeholder.parentNode;if(parentNode!==null){var validClassNames=[];var validateClassNames=false;if(prc!==null){validClassNames=prc.GetValidClassNames();validateClassNames=validClassNames!==null&&validClassNames.length>0}var temp=document.createElement("div");temp.innerHTML=result.Html;
var nodes=[];var fragment=document.createDocumentFragment();while(temp.firstChild){var isClassNameValid=true;if(validateClassNames&&temp.firstChild.nodeType==1)isClassNameValid=D2L.LP.Web.UI.Html.Dom.HasAnyClassName(validClassNames,temp.firstChild);if(!isClassNameValid)throw" The partial view contains nodes that are not valid in "+"the current context.  The partial view node has class name: "+temp.firstChild.className+", but the valid class names "+"for this context are: "+prc.GetValidClassNames()+
".";var newChild=fragment.appendChild(temp.firstChild);if(firstNewNode===null&&newChild.nodeType==1)firstNewNode=newChild;nodes.push(newChild)}var placeholderClone=null;if(hasAnimation)placeholderClone=D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(placeholder);placeholder.innerHTML="";if(doInnerReplacement){placeholder.appendChild(fragment);D2L.LP.Web.UI.Events.OnViewRender.Trigger(placeholder)}else{parentNode.insertBefore(fragment,placeholder);parentNode.removeChild(placeholder);
for(var i=0;i<nodes.length;i++)D2L.LP.Web.UI.Events.OnViewRender.Trigger(nodes[i])}}for(var i=0;i<result.OnInit.length;i++)eval(result.OnInit[i]);for(var i=0;i<result.OnLoad.length;i++)eval(result.OnLoad[i]);var startAnimation=function(){var newNodesClone=[];for(var i=0;i<nodes.length;i++)newNodesClone.push(D2L.LP.Web.UI.Html.PartialRendering.Animation.CloneForAnimation(nodes[i]));D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateResult(animationType,firstNewNode,placeholderClone,newNodesClone)};
if(hasAnimation&&D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition())startAnimation();if(result.HistoryEntryLocation!==null&&result.HistoryEntryTitle!==null){D2L.LP.Web.UI.Html.JavaScript.History.Push(result.HistoryEntryLocation,result.HistoryEntryTitle,reviver);if(placeholder.parentNode!==null){var frag=D2L.LP.Web.UI.Desktop.Controls.Fragment.Build(placeholderId+"_focus");placeholder.parentNode.insertBefore(frag,placeholder);window.scrollTo(frag.offsetLeft,frag.offsetTop+frag.firstChild.offsetTop);
placeholder.parentNode.removeChild(frag)}if(firstNewNode!==null){var firstFocusable=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(firstNewNode);D2L.LP.Web.UI.Html.Dom.FocusNode(firstFocusable)}}else{var currNode=D2L.LP.Web.UI.Html.PartialRendering.FindElementByPath(pathToActiveElement,isInnerReplacement?placeholder:firstNewNode);if(currNode===null){var ph=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);currNode=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(ph)}D2L.LP.Web.UI.Html.Dom.FocusNode(currNode)}return firstNewNode},
PartialRender:function(id,provider,animationType){D2L.LP.Web.UI.Html.PartialRendering.OnBefore.Trigger(id);var ret=new D2L.LP.Web.UI.Events.Event;var placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){ret.Release();throw"Placeholder not found: '"+id.GetValue()+"'.";}var isInnerReplacement=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-placeholder-inner",placeholder);var hasLoading=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-loading",placeholder).length>0;var shim=
null,shim2=null;var done=false;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(placeholder);if(rect!==null){shim=document.createElement("div");shim.className="d2l-partial-render-shim1";shim2=document.createElement("div");shim2.className="d2l-partial-render-shimbg1";shim.style.top=shim2.style.top=rect.top+"px";shim.style.left=shim2.style.left=rect.left+"px";shim.style.width=shim2.style.width=rect.width+"px";shim.style.height=shim2.style.height=rect.height+"px";document.body.appendChild(shim);document.body.appendChild(shim2);
setTimeout(function(){if(!hasLoading&&!done){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-partial-render-shim2",shim);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-branding-bg",shim);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-partial-render-shimbg2",shim2)}},500)}var deleteShim=function(){if(shim!==null&&shim.parentNode!==null)shim.parentNode.removeChild(shim);if(shim2!==null&&shim2.parentNode!==null)shim2.parentNode.removeChild(shim2)};var finish=function(val){deleteShim();ret.Trigger(val);D2L.LP.Web.UI.Html.PartialRendering.OnAfter.Trigger(id)};
var activeElement=D2L.LP.Web.UI.Html.Dom.GetActiveElement(document);var pathToActiveElement=D2L.LP.Web.UI.Html.PartialRendering.GeneratePathToNode(activeElement,placeholder);var handleResult=function(result){done=true;if(!result){finish(false);return}placeholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(placeholder===null){finish(false);return}D2L.LP.Web.UI.Html.PartialRendering.InjectResult(placeholder,result,animationType,function(){D2L.LP.Web.UI.Html.PartialRendering.PartialRender(id,
provider,animationType)},isInnerReplacement,pathToActiveElement);finish(true)};var evt=provider.call(provider);evt.AddListener(handleResult);evt.AddReleaseListener(function(){ret.Release()});return ret},GetPartialRenderContext:function(placeholderId){var prc=null;if(placeholderId!==null)prc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,0);if(prc===null)prc=new D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext;var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId);
if(placeholderNode&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-primary",placeholderNode)!=null)prc.SetHasActiveForm(true);return prc},GeneratePathToNode:function(startNode,endNode){var path=[];var currElement=startNode;if(startNode==null||startNode==undefined||endNode==null||endNode==undefined)return[];while(true){var nodeIndex=D2L.LP.Web.UI.Html.Dom.IndexOfElement(currElement);path.push({tagName:currElement.tagName,className:currElement.className,childIndex:nodeIndex});if(currElement==
endNode)break;currElement=currElement.parentNode;if(currElement==null){path=[];break}}return path},FindElementByPath:function(path,rootNode){if(path===undefined||path===null||path.length===0)return false;if(!D2L.LP.Web.UI.Html.PartialRendering.CompareElements(path[path.length-1],rootNode))return false;var currNode=rootNode;for(var j=path.length-2;j>=0;j--){var pathElem=D2L.LP.Web.UI.Html.PartialRendering.FindMatchingElementInChildren(path[j],currNode);if(pathElem===null){currNode=null;break}currNode=
pathElem}return currNode},FindMatchingElementInChildren:function(refElem,parent){if(parent===undefined||parent===null)return null;var children=D2L.LP.Web.UI.Html.PartialRendering.GetChildNodes(parent);for(var i=0;i<children.length;i++)if(D2L.LP.Web.UI.Html.Dom.IndexOfElement(children[i])==refElem.childIndex&&D2L.LP.Web.UI.Html.PartialRendering.CompareElements(refElem,children[i]))return children[i];return null},GetChildNodes:function(parent){var children=[];var parentChildren=parent.childNodes;for(var i=
parentChildren.length;i>=0;i--)if(parentChildren[i]!==undefined&&parentChildren[i]!==null&&parentChildren[i].nodeType==1)children.push(parentChildren[i]);return children},RegexD2lClassName:/d2l_[0-9]*_[0-9]*_[0-9]*/,CompareElements:function(elem1,elem2){if(elem1==null||elem1==undefined||elem2==null||elem2==undefined)return false;if(elem1.tagName!=elem2.tagName)return false;var classes=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem1);var classes2=D2L.LP.Web.UI.Html.PartialRendering.GetClassNamesForMatching(elem2);
if(classes.length!=classes2.length)return false;var numClassNameMatches=0;for(var i=0;i<classes.length;i++){if(!D2L.LP.Web.UI.Html.PartialRendering.RegexD2lClassName.test(classes[i]))if(!D2L.LP.Web.UI.Html.Dom.HasClassName(classes[i],elem2))break;numClassNameMatches++}return numClassNameMatches==classes.length},GetClassNamesForMatching:function(elem){var classNames=elem.className.split(" ");var validClassNames=[];for(var i=classNames.length-1;i>=0;i--){var className=classNames[i];if(className in D2L.LP.Web.UI.Html.PartialRendering._includeClasses)validClassNames.push(className)}return validClassNames}};
D2L.LP.Web.UI.Html.PartialRendering.Animation={AnimateResult:function(animationType,firstNewNode,placeholderClone,newNodesClone){switch(animationType){case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRight:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade:var isSlideLeft=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||
animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeft;var hasHFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideLeftWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideRightWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateHorizontalSlide(isSlideLeft,hasHFade,firstNewNode,placeholderClone,newNodesClone);break;case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDown:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade:case D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade:var isSlideUp=
animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUp;var hasVFade=animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideUpWithFade||animationType==D2L.LP.Web.UI.Html.PartialRendering.Animation.Types.SlideDownWithFade;D2L.LP.Web.UI.Html.PartialRendering.Animation.AnimateVerticalSlide(isSlideUp,hasVFade,firstNewNode,placeholderClone,newNodesClone);break}},AnimateHorizontalSlide:function(isSlideLeft,
hasFade,firstNewNode,placeholderClone,newNodesClone){var isRTLCulture=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;if(isRTLCulture)isSlideLeft=!isSlideLeft;var animationDuration=400;var separatorWidth=10;var prevWidth=placeholderClone.d2l_boundingRect.width;var sliderOpener=document.createElement("div");sliderOpener.className="d2l-partial-render-animation-horizontal-slider-opener";D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,
"presentation");var sliderWindow=document.createElement("div");sliderWindow.className="d2l-partial-render-animation-horizontal-slider-window";sliderOpener.appendChild(sliderWindow);var slider=document.createElement("div");slider.className="d2l-partial-render-animation-horizontal-slider";sliderWindow.appendChild(slider);var sliderPrevPanel=document.createElement("div");sliderPrevPanel.className="d2l-partial-render-animation-horizontal-slider-prev";sliderPrevPanel.style.width=prevWidth+"px";D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,
"presentation");var separatorPanel=document.createElement("div");separatorPanel.className="d2l-partial-render-animation-horizontal-slider-separator";separatorPanel.style.width=separatorWidth+"px";separatorPanel.style.height="1px";var sliderNextPanel=document.createElement("div");sliderNextPanel.className="d2l-partial-render-animation-horizontal-slider-next";D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,"presentation");if(isSlideLeft){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);
slider.appendChild(sliderNextPanel);if(isRTLCulture)slider.style.left=prevWidth+"px";else slider.style.left="0px"}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);if(isRTLCulture)slider.style.left="0px";else slider.style.left=-(prevWidth+separatorWidth)+"px"}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1}var clearFloat=document.createElement("div");clearFloat.className="d2l-clear";slider.appendChild(clearFloat);
sliderPrevPanel.appendChild(placeholderClone);for(var i=0;i<newNodesClone.length;i++)sliderNextPanel.appendChild(newNodesClone[i]);firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.width=prevWidth+newContentBoundingRect.width+separatorWidth+"px";sliderWindow.style.width=newContentBoundingRect.width+"px";var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideLeft)if(isRTLCulture)slider.style.left=
"0px";else slider.style.left=-(prevWidth+separatorWidth)+"px";else if(isRTLCulture)slider.style.left=prevWidth+separatorWidth+"px";else slider.style.left="0px";if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener)};setTimeout(startAnimation,0)},AnimateVerticalSlide:function(isSlideUp,hasFade,firstNewNode,placeholderClone,newNodesClone){var animationDuration=400;var separatorHeight=10;var prevHeight=
placeholderClone.d2l_boundingRect.height;var sliderOpener=document.createElement("div");sliderOpener.className="d2l-partial-render-animation-vertical-slider-opener";D2L.LP.Web.UI.Html.Aria.SetRole(sliderOpener,"presentation");var sliderWindow=document.createElement("div");sliderWindow.className="d2l-partial-render-animation-vertical-slider-window";sliderOpener.appendChild(sliderWindow);var slider=document.createElement("div");slider.className="d2l-partial-render-animation-vertical-slider";sliderWindow.appendChild(slider);
var sliderPrevPanel=document.createElement("div");sliderPrevPanel.className="d2l-partial-render-animation-vertical-slider-prev";sliderPrevPanel.style.height=prevHeight+"px";D2L.LP.Web.UI.Html.Aria.SetRole(sliderPrevPanel,"presentation");var separatorPanel=document.createElement("div");separatorPanel.className="d2l-partial-render-animation-vertical-slider-separator";separatorPanel.style.height=separatorHeight+"px";separatorPanel.style.width="1px";var sliderNextPanel=document.createElement("div");sliderNextPanel.className=
"d2l-partial-render-animation-vertical-slider-next";D2L.LP.Web.UI.Html.Aria.SetRole(sliderNextPanel,"presentation");if(isSlideUp){slider.appendChild(sliderPrevPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderNextPanel);slider.style.top="0px"}else{slider.appendChild(sliderNextPanel);slider.appendChild(separatorPanel);slider.appendChild(sliderPrevPanel);slider.style.top=-(prevHeight+separatorHeight)+"px"}if(hasFade){sliderNextPanel.style.opacity=0;sliderPrevPanel.style.opacity=1}sliderPrevPanel.appendChild(placeholderClone);
for(var i=0;i<newNodesClone.length;i++)sliderNextPanel.appendChild(newNodesClone[i]);firstNewNode.parentNode.insertBefore(sliderOpener,firstNewNode);var newContentBoundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(sliderNextPanel);slider.style.height=prevHeight+newContentBoundingRect.height+separatorHeight+"px";sliderWindow.style.height=newContentBoundingRect.height+"px";var startAnimation=function(){setTimeout(finishAnimation,animationDuration);if(isSlideUp)slider.style.top=-(prevHeight+separatorHeight)+
"px";else slider.style.top="0px";if(hasFade){sliderNextPanel.style.opacity=1;sliderPrevPanel.style.opacity=0}};var finishAnimation=function(){sliderOpener.parentNode.removeChild(sliderOpener)};setTimeout(startAnimation,0)},CloneForAnimation:function(node){var cleanupAttributes=function(attrElement){D2L.LP.Web.UI.Html.Aria.RemoveAttribute(attrElement,"live");attrElement.removeAttribute("name");attrElement.removeAttribute("id")};var clone=node.cloneNode(true);if(clone.nodeType==1){var allElems=clone.all?
clone.all:clone.getElementsByTagName("*");for(var i=0;i<allElems.length;i++){var elem=allElems[i];cleanupAttributes(elem)}cleanupAttributes(clone);var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);clone.style.width=boundingRect.width+"px";clone.d2l_boundingRect=boundingRect}return clone}};D2L.LP.Web.UI.Html.PartialRendering.Animation.Types={None:0,SlideLeft:1,SlideRight:2,SlideLeftWithFade:3,SlideRightWithFade:4,SlideUp:5,SlideDown:6,SlideUpWithFade:7,SlideDownWithFade:8};
D2L.LP.Web.UI.Html.PartialRendering.PartialHtmlRenderContext=D2L.Class.Create({Construct:function(){this.m_headingLevel=1;this.m_scope="";this.m_childScopeCounters="";this.m_validClassNames=[];this.m_hasActiveForm=false;this.m_isPrintMode=false},_deserialize:function(deserializer){this.m_headingLevel=deserializer.GetMember("HeadingLevel");this.m_scope=deserializer.GetMember("Scope");if(deserializer.HasMember("ChildScopeCounters"))this.m_childScopeCounters=deserializer.GetMember("ChildScopeCounters");
this.m_validClassNames=deserializer.GetMember("ValidClassNames");if(deserializer.HasMember("IsPrintMode"))this.m_isPrintMode=deserializer.GetMember("IsPrintMode")},_serialize:function(serializer){serializer.AddMember("headingLevel",this.m_headingLevel);serializer.AddMember("scope",this.m_scope);if(this.m_childScopeCounters)serializer.AddMember("childScopeCounters",this.m_childScopeCounters);serializer.AddMember("validClassNames",this.m_validClassNames);serializer.AddMember("hasActiveForm",this.m_hasActiveForm);
if(this.m_isPrintMode)serializer.AddMember("isPrintMode",this.m_isPrintMode)},GetValidClassNames:function(){return this.m_validClassNames},SetHasActiveForm:function(hasActiveForm){this.m_hasActiveForm=hasActiveForm}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Html.PartialRendering.OnAfter=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Html.ReturnPoints={LocalStorageKey:"ReturnPoints",Get:function(key,defaultLocation){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);me.ValidateLocation(defaultLocation);var data=me.Read();for(var i=data.length-1;i>-1;i--)if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);data=data.slice(0,i);me.Write(data);return location}return defaultLocation},Set:function(key,location){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(location===undefined)location=
new D2L.LP.Web.Http.UrlLocation(document.location.href);location.RemoveQueryString("dst");me.ValidateKey(key);me.ValidateLocation(location);var data=me.Read();var entry={key:key,url:location.GetUrl()};data.push(entry);me.Write(data)},TryPeek:function(key){var me=D2L.LP.Web.UI.Html.ReturnPoints;me.ValidateKey(key);var data=me.Read();for(var i=data.length-1;i>-1;i--)if(data[i].key===key){var location=new D2L.LP.Web.Http.UrlLocation(data[i].url);return location}return null},Read:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;
var json=D2L.LP.Web.UI.Html.Dom.Storage.Session.Get(me.LocalStorageKey);if(json===null||json.length===0)return[];var data=D2L.LP.Web.Serialization.Json.Deserialize(json);return data},Reset:function(){var me=D2L.LP.Web.UI.Html.ReturnPoints;D2L.LP.Web.UI.Html.Dom.Storage.Session.Remove(me.LocalStorageKey)},ValidateKey:function(key){if(key===undefined||key===null||key.length===0)throw"Invalid key.";},ValidateLocation:function(location){if(location===undefined||location===null)throw"Invalid location.";
},Write:function(data){var me=D2L.LP.Web.UI.Html.ReturnPoints;if(data.length===0)me.Reset();var json=JSON.stringify(data);D2L.LP.Web.UI.Html.Dom.Storage.Session.Set(me.LocalStorageKey,json,false)}};D2L.LP.Web.UI.Html.Style={};
D2L.LP.Web.UI.Html.Style.IncludeStyleSheet=function(src,params){var head=document.getElementsByTagName("head");if(head.length!=1)return;var sep=src.indexOf("?")>-1?"&":"?";for(var key in params){src+=sep+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(key)+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(params[key]);sep="&"}var styles=document.getElementsByTagName("style");if(styles.length>0){var reSrc=src.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");if(styles[0].innerHTML.search(new RegExp("@import url\\('.*"+
reSrc+"'\\);","gm"))>-1)return}var links=document.getElementsByTagName("link");for(var i=0;i<links.length;i++){var href=links[i].href;if(href.length>=src.length){var end=href.substr(href.length-src.length);if(end==src)return}}var link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.href=src;head[0].appendChild(link)};
D2L.LP.Web.UI.Html.Style.IncludeStyleBlock=function(css){var head=document.getElementsByTagName("head");if(head.length!=1)return;var lastStyle=document.getElementById("d2l-style-block");if(lastStyle){css=lastStyle.innerHTML+css;lastStyle.parentNode.removeChild(lastStyle)}var style=document.createElement("style");style.id="d2l-style-block";style.type="text/css";try{style.appendChild(document.createTextNode(css))}catch(e){if(style.styleSheet)style.styleSheet.cssText=css}head[0].appendChild(style);return style};
D2L.LP.Web.UI.Html.Style.OverlayPosition={Top:1,Right:2,Bottom:3,Left:4,Mouse:5};
D2L.LocalDateTime=D2L.Class.Create({Construct:function(year,month,day,hour,minute,second){var now=new Date;this.m_year=year!==undefined?year:now.getFullYear();this.m_month=month!==undefined?month:now.getMonth+1;this.m_day=day!==undefined?day:now.getDate();this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds()},_deserialize:function(deserializer){this.m_year=deserializer.GetMember("Year");this.m_month=
deserializer.GetMember("Month");this.m_day=deserializer.GetMember("Day");this.m_hour=deserializer.GetMember("Hour");this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Year",this.m_year);serializer.AddMember("Month",this.m_month);serializer.AddMember("Day",this.m_day);serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",this.m_minute);serializer.AddMember("Second",this.m_second)},GetYear:function(){return this.m_year},
GetMonth:function(){return this.m_month},GetDay:function(){return this.m_day},GetHour:function(){return this.m_hour},GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second},GetDateString:function(){var ret;ret=this.GetYear();ret+=this.PadInt(this.GetMonth(),2);ret+=this.PadInt(this.GetDay(),2);ret+=this.PadInt(this.GetHour(),2);ret+=this.PadInt(this.GetMinute(),2);return ret},GetTimestamp:function(){var date=new Date(this.GetYear(),this.GetMonth()-1,this.GetDay(),this.GetHour(),
this.GetMinute(),this.GetSecond(),0);return date.getTime()},PadInt:function(val,digits){var ret=val.toString();while(ret.length<digits)ret="0"+ret;return ret}});D2L.LocalDateTime.ToJavaScriptDate=function(localDateTime){return new Date(localDateTime.GetYear(),localDateTime.GetMonth()-1,localDateTime.GetDay(),localDateTime.GetHour(),localDateTime.GetMinute(),localDateTime.GetSecond(),0)};
D2L.LocalDateTime.FromJavaScriptDate=function(jsDate){return new D2L.LocalDateTime(jsDate.getFullYear(),jsDate.getMonth()+1,jsDate.getDate(),jsDate.getHours(),jsDate.getMinutes(),jsDate.getSeconds())};
D2L.LocalDateTime.Compare=function(first,second,ignoreTime){if(ignoreTime){first=new D2L.LocalDateTime(first.GetYear(),first.GetMonth(),first.GetDay());second=new D2L.LocalDateTime(second.GetYear(),second.GetMonth(),second.GetDay())}var firstJsDate=D2L.LocalDateTime.ToJavaScriptDate(first);var secondJsDate=D2L.LocalDateTime.ToJavaScriptDate(second);if(firstJsDate<secondJsDate)return-1;else if(firstJsDate>secondJsDate)return 1;else return 0};
D2L.LocalTime=D2L.Class.Create({Construct:function(hour,minute,second){var now=new Date;this.m_hour=hour!==undefined?hour:now.getHours();this.m_minute=minute!==undefined?minute:now.getMinutes();this.m_second=second!==undefined?second:now.getSeconds()},_deserialize:function(deserializer){this.m_hour=deserializer.GetMember("Hour");this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",
this.m_minute);serializer.AddMember("Second",this.m_second)},GetHour:function(){return this.m_hour},GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second}});D2L.UtcDateTime=D2L.Class.Create({Construct:function(){this.m_ticks=null},_deserialize:function(deserializer){if(deserializer.HasMember("Ticks"))this.m_ticks=deserializer.GetMember("Ticks")},_serialize:function(serializer){if(this.m_ticks!=null)serializer.AddMember("Ticks",this.m_ticks)}});
D2L.LP.LayeredArch.SelectionFilterType={None:0,All:1,AllExcept:2,Some:3};D2L.LP.Web.Serialization={Json:{},Url:{}};
D2L.LP.Web.Serialization.Serializer=D2L.Class.Extend({Construct:function(){this.m_scopeString="";this.m_values=[]},AddMember:function(name,value){var type=typeof value;if(type==="undefined"||type==="function")return;if(type==="number"||type==="boolean"||type==="string"||value===null)this.m_values.push([this.m_scopeString+name,value]);else if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value)){var isObjArray=value.length>0&&typeof value[0]==="object";for(var i=0;i<value.length;i++)if(isObjArray&&i>0)this.AddMember(name+
"`"+i,value[i]);else this.AddMember(name,value[i])}else if(type==="object"){this.m_scopeString+=name+"$";if(value._serialize!==undefined)value._serialize(this);else for(var key in value)this.AddMember(key,value[key]);this.m_scopeString=this.m_scopeString.substr(0,this.m_scopeString.length-(name.length+1))}},GetMembers:function(){return this.m_values}});
D2L.LP.Web.Serialization.Json.Deserialize=function(jsonString){if(jsonString===undefined||jsonString===null||typeof jsonString!=="string")return undefined;var typeReviver=function(value){var type=D2L.LP.Web.Serialization.Json.GetType(this,value._type);if(type!==undefined&&type.func!==undefined){var obj=new type.func;if(obj._deserialize!==undefined){obj._deserialize(new D2L.LP.Web.Serialization.Json.Deserializer(value));value=obj}}return value};var functionReviver=function(value){return D2L.LP.Web.Serialization.Json.FunctionReviver(this,
value)};var dictionaryReviver=function(value){return D2L.LP.Web.Serialization.Json.DictionaryReviver(this,value)};var normalizeType=function(t){if(t=="url")return"D2L.LP.Web.Http.UrlLocation";else if(t=="id")return"D2L.LP.Web.UI.Html.AbsoluteHtmlId";return t};var json=JSON.parse(jsonString,function(key,value){if(value===undefined||value===null||value._type===undefined)return value;var ret;value._type=normalizeType(value._type);if(value._type=="D2L.LP.Util.Dictionary")ret=dictionaryReviver(value);
else if(value._type=="call"){ret=functionReviver(value);ret._isCall=true}else if(value._type=="func")ret=functionReviver(value);else if(value._type=="pipe"){value.N="D2L.LP.Web.UI.Html.JavaScript.CallFunctionPipeline";value.D=true;ret=functionReviver(value)}else ret=typeReviver(value);return ret});return json};
D2L.LP.Web.Serialization.Json.Deserializer=D2L.Class.Create({Construct:function(json){this.m_json=json},GetMember:function(name,defaultValue){return this.HasMember(name)?this.m_json[name]:defaultValue},HasMember:function(name){return this.m_json[name]!==undefined}});
D2L.LP.Web.Serialization.Json.DictionaryReviver=function(win,dict){delete dict["_type"];var isDelayed=false;var dictKeys=[];var newDict={};for(var key in dict){var val=dict[key];dictKeys.push(key);if(val!==undefined&&val!==null&&val._isDelayed===true)isDelayed=true}if(!isDelayed)return dict;var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var evt=new D2L.LP.Web.UI.Events.Event;evt._isDelayed=true;var buildParam=function(index){if(index==dictKeys.length){evt.Trigger(newDict);return}var p=
dict[dictKeys[index]];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){newDict[dictKeys[index]]=fixParam(p);buildParam(++index);return}if(p._isCall===true)p=p();p.AddListener(function(v){newDict[dictKeys[index]]=fixParam(v);buildParam(++index)});p.AddReleaseListener(function(){evt.Release()})};setTimeout(function(){buildParam(0)},0);return evt};
D2L.LP.Web.Serialization.Json.GetType=function(type,typeString){var typeSegments=typeString.replace(/\+/g,".").split(".");var prevType=type;for(var i=0;i<typeSegments.length;i++){if(type[typeSegments[i]]===undefined)return undefined;prevType=type;type=type[typeSegments[i]]}if(i!=typeSegments.length)return undefined;return{obj:prevType,func:type}};
D2L.LP.Web.Serialization.Json.FunctionReviver=function(win,value){var type=D2L.LP.Web.Serialization.Json.GetType(win,value.N);if(type===undefined)throw"Unrecognized function '"+value.N+"'.";if(value.P===undefined)value.P=[];var isParamDelayed=false;for(var i=0;i<value.P.length;i++){var p=value.P[i];if(p!==undefined&&p!==null&&p._isDelayed===true){isParamDelayed=true;break}}var fixParam=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam;var retFunc=function(){var evt=new D2L.LP.Web.UI.Events.Event;
evt._isDelayed=true;var isDelayed=value.D===true;var params=[];var args=arguments;var callFunction=function(){for(var i=0;i<args.length;i++)params.push(args[i]);if(type.func.apply===undefined){evt.Release();throw"'"+value.N+"' is not a function.";}return type.func.apply(type.obj,params)};if(!isDelayed&&!isParamDelayed){for(var i=0;i<value.P.length;i++)params.push(fixParam(value.P[i]));return callFunction()}var finish=function(){if(isDelayed){var result=callFunction();result.AddListener(function(val){evt.Trigger(val)});
result.AddReleaseListener(function(){evt.Release()})}else evt.Trigger(callFunction())};var buildParam=function(index){if(index==value.P.length){finish();return}var p=value.P[index];if(p===undefined||p===null||p._isDelayed===undefined||p._isDelayed===false){params.push(fixParam(p));buildParam(++index);return}if(p._isCall===true)p=p();p.AddListener(function(val){params.push(fixParam(val));buildParam(++index)});p.AddReleaseListener(function(){evt.Release()})};setTimeout(function(){buildParam(0)},0);
return evt};if(value._type=="call")retFunc._isDelayed=value.D===true||isParamDelayed;return retFunc};D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam=function(p){if(p===undefined||p===null)return p;if(typeof p=="object"){var origP=p;p=new p.constructor;for(var key in origP)p[key]=D2L.LP.Web.Serialization.Json.FunctionReviver.FixParam(origP[key])}if(p._isCall)p=p();return p};if(!this.JSON)this.JSON={};
(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,
k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function")value=value.toJSON(key);if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;
for(i=0;i<length;i+=1)partial[i]=str(i,value)||"null";v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}}}else for(k in value)if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}v=partial.length===0?"{}":gap?"{\n"+gap+
partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!=="function")JSON.parse=
function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object")for(k in value)if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();D2L.LP.Web.Serialization.Url.Serialize=function(value){if(value===undefined||value===null)return"";if(typeof value!=="object")return value.toString();var serializer=new D2L.LP.Web.Serialization.Url.Serializer;for(var key in value)serializer.AddMember(key,value[key]);return serializer.Serialize()};
D2L.LP.Web.Serialization.Url.Serializer=D2L.LP.Web.Serialization.Serializer.Extend({Construct:function(){arguments.callee.$.Construct.call(this)},Serialize:function(){var ret="";var delim="";var values=this.GetMembers();for(var i=0;i<values.length;i++){var kvp=values[i];ret+=delim+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[0])+"="+D2L.LP.Web.UI.Html.JavaScript.UrlEncode(kvp[1]);delim="&"}return ret}});D2L.LP.Globalization.Calendars={};
D2L.LP.Globalization.Calendars.Calendar=D2L.Class.extend({Construct:function(calendarType){this.m_calendarType=calendarType;this.m_calendar=this.GetSpecificCalendar()},GetSpecificCalendar:function(){switch(this.m_calendarType){case D2L.LP.Globalization.Calendars.Calendar.Type.Gregorian:return new D2L.LP.Globalization.Calendars.Gregorian;case D2L.LP.Globalization.Calendars.Calendar.Type.Hijri:return new D2L.LP.Globalization.Calendars.Hijri;default:throw"Not supported calendar: "+this.m_calendarType;
}},GetCalendarType:function(){return this.m_calendarType},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){return this.m_calendar.TryGetGregorianLocalDateTime(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay)},GetCalendarSpecificLocalDateTime:function(localDateTime){return this.m_calendar.GetCalendarSpecificLocalDateTime(localDateTime)},Validate:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){return this.m_calendar.Validate(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay)}});D2L.LP.Globalization.Calendars.Calendar.Type={Gregorian:0,Hijri:1};
D2L.LP.Globalization.Calendars.CalendarLocalDateTime=D2L.Class.extend({Construct:function(year,month,day,hour,minute,second){this.m_year=year;this.m_month=month;this.m_day=day;this.m_hour=hour!==undefined?hour:0;this.m_minute=minute!==undefined?minute:0;this.m_second=second!==undefined?second:0},_deserialize:function(deserializer){this.m_year=deserializer.GetMember("Year");this.m_month=deserializer.GetMember("Month");this.m_day=deserializer.GetMember("Day");this.m_hour=deserializer.GetMember("Hour");
this.m_minute=deserializer.GetMember("Minute");this.m_second=deserializer.GetMember("Second")},_serialize:function(serializer){serializer.AddMember("Year",this.m_year);serializer.AddMember("Month",this.m_month);serializer.AddMember("Day",this.m_day);serializer.AddMember("Hour",this.m_hour);serializer.AddMember("Minute",this.m_minute);serializer.AddMember("Second",this.m_second)},GetYear:function(){return this.m_year},GetMonth:function(){return this.m_month},GetDay:function(){return this.m_day},GetHour:function(){return this.m_hour},
GetMinute:function(){return this.m_minute},GetSecond:function(){return this.m_second}});
D2L.LP.Globalization.Calendars.Gregorian=D2L.Class.extend({Construct:function(){},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){if(!this.Validate(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay))return null;return new D2L.LocalDateTime(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay,0,0,0)},GetCalendarSpecificLocalDateTime:function(localDateTime){return localDateTime},Validate:function(calendarSpecificYear,calendarSpecificMonth,
calendarSpecificDay){var year=calendarSpecificYear;var month=calendarSpecificMonth;var day=calendarSpecificDay;if(isNaN(year)||year<1753||year>9999)return false;if(isNaN(month)||month<1||month>12)return false;if(isNaN(day)||day<1||day>31)return false;var allowedDays=31;if(month==2)if(year%4===0&&(!(year%100===0)||year%400===0))allowedDays=29;else allowedDays=28;else if(month==4||month==6||month==9||month==11)allowedDays=30;if(day>allowedDays)return false;return true}});
D2L.LP.Globalization.Calendars.Hijri=D2L.Class.extend({Construct:function(){},TryGetGregorianLocalDateTime:function(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay){if(!this.Validate(calendarSpecificYear,calendarSpecificMonth,calendarSpecificDay))return null;var gDate=D2LMicrosoftAjax.UmAlQura.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)gDate=D2LMicrosoftAjax.Hijri.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);
if(gDate)return new D2L.LocalDateTime(gDate.getFullYear(),gDate.getMonth()+1,gDate.getDate(),0,0,0);else return null},GetCalendarSpecificLocalDateTime:function(localDateTime){var gDate=D2L.LocalDateTime.ToJavaScriptDate(localDateTime);var calendarDate=D2LMicrosoftAjax.UmAlQura.fromGregorian(gDate);if(calendarDate==null)calendarDate=D2LMicrosoftAjax.Hijri.fromGregorian(gDate);return new D2L.LocalDateTime(calendarDate[0],calendarDate[1]+1,calendarDate[2],0,0,0)},Validate:function(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay){var gDate=D2LMicrosoftAjax.UmAlQura.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)gDate=D2LMicrosoftAjax.Hijri.toGregorian(calendarSpecificYear,calendarSpecificMonth-1,calendarSpecificDay);if(gDate==null)return false;var calendarDate=D2LMicrosoftAjax.UmAlQura.fromGregorian(gDate);if(calendarDate==null)calendarDate=D2LMicrosoftAjax.Hijri.fromGregorian(gDate);if(calendarDate==null)return false;return calendarSpecificYear==
calendarDate[0]&&calendarSpecificMonth==calendarDate[1]+1&&calendarSpecificDay==calendarDate[2]}});D2L.LP.Globalization.Formatting.DateTime={};D2L.LP.Globalization.Formatting.DateTime.Exceptions={InvalidDateFormat:0,UnsupportedInputDateFormat:1};D2L.LP.Globalization.Formatting.DateTime.FormatPart=D2L.Class.extend({Construct:function(partType,partFormat){this.Type=partType;this.Format=partFormat}});D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type={Day:0,Month:1,Year:2,Hour:3,Minute:4,Second:5};
D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer=D2L.Class.extend({Construct:function(dateFormat){this.m_dateFormatSeparator=null;this.m_dateFormatParts=null;this.m_dateFormat=dateFormat},GetSeparator:function(){if(this.m_dateFormatSeparator==null){var re=new RegExp("\\W");var match=re.exec(this.m_dateFormat);if(match!=null)this.m_dateFormatSeparator=match[0]}return this.m_dateFormatSeparator},GetParts:function(){var result=[];var separator=this.GetSeparator();if(separator==null)return null;
var parts=this.m_dateFormat.split(separator);if(parts.length!=3)return null;var isNotSupported=false;for(var i=0;i<parts.length;i++){part=parts[i].trim();if(part=="dd"||part=="d")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day,part));else if(part=="MM"||part=="M")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month,part));else if(part=="yyyy")result.push(new D2L.LP.Globalization.Formatting.DateTime.FormatPart(D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year,
part));else isNotSupported=true}if(isNotSupported)return null;else return result}});
D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,fuzzyDateTimeDescriptor){fuzzyDateTimeDescriptor.ClientNow=new Date;this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_dateTimeFormatDescriptor.NativeDigits,this.m_dateTimeFormatDescriptor.UseNativeDigits)},FormatInputDate:function(gregorianLocalDateTime){var calendar=
D2L.LP.Globalization.Locale.GetCalendar();var date=calendar.GetCalendarSpecificLocalDateTime(gregorianLocalDateTime);var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateParts!=null){var formattedDate="";for(var i=0;i<dateParts.length;i++){var datePart=dateParts[i];if(datePart.Type==
D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day)formattedDate+=this.PrePadByZero(date.GetDay(),datePart.Format.length);else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month)formattedDate+=this.PrePadByZero(date.GetMonth(),datePart.Format.length);else if(datePart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year)formattedDate+=date.GetYear().toString();if(i<dateParts.length-1)formattedDate+=separator}return this.m_nativeDigitConverter.Convert(formattedDate)}},
FormatDateTime:function(dateTime,format){var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;var calendarDateTime=D2L.LP.Globalization.Locale.GetCalendar().GetCalendarSpecificLocalDateTime(dateTime);if(format===undefined)format=formats.LongDateTime;var dateTimeJs=D2L.LocalDateTime.ToJavaScriptDate(dateTime);switch(format){case formats.Time:var time=new D2L.LocalTime(dateTime.GetHour(),dateTime.GetMinute(),dateTime.GetSecond());return this.FormatTime(time);case formats.MonthAndDay:return this.FormatDateTime(dateTime,
formats.ShortMonthName)+" "+calendarDateTime.GetDay();case formats.ShortMonthName:return this.m_dateTimeFormatDescriptor.ShortMonthNames[calendarDateTime.GetMonth()-1];case formats.ShortDayOfWeek:var dayOfWeekIndex=dateTimeJs.getDay();return this.m_dateTimeFormatDescriptor.ShortDayOfWeekNames[dayOfWeekIndex];default:throw"Unsupported DateTime format: '"+format+"'.";}},FormatTime:function(time){var timeFormat=this.m_dateTimeFormatDescriptor.TimeFormat;var am=this.m_dateTimeFormatDescriptor.AmDesignator;
var pm=this.m_dateTimeFormatDescriptor.PmDesignator;var hour=time.GetHour();var hour24=hour;var hour24Pad=this.PrePadByZero(hour,2);var hour12=hour%12;if(hour12===0)hour12=12;var hour12Pad=this.PrePadByZero(hour12,2);var minute=this.PrePadByZero(time.GetMinute(),2);var replacements=[{key:"HH",value:hour24Pad},{key:"H",value:hour24},{key:"hh",value:hour12Pad},{key:"h",value:hour12},{key:"mm",value:minute},{key:"tt",value:hour>11?pm:am}];var doReplacements=function(buf){for(var i=0;i<replacements.length;i++){var rep=
replacements[i];buf=buf.replace(rep.key,rep.value)}return buf};var escape=false;var buffer="";var value="";for(var i=0;i<timeFormat.length;i++){var c=timeFormat.charAt(i);if(c=="'"){if(!escape){value+=doReplacements(buffer);buffer=""}escape=!escape}else if(escape)value+=c;else{buffer+=c;if(i==timeFormat.length-1)value+=doReplacements(buffer)}}return value},FormatFuzzyDateTime:function(inputDate,nowDate){var fuzzy=this.m_fuzzyDateTimeDescriptor;var formats=D2L.LP.Globalization.Formatting.DateTime.Formats;
var calendar=D2L.LP.Globalization.Locale.GetCalendar();if(nowDate===undefined)nowDate=fuzzy.Now;var thirtySec=30*1E3;var oneMin=60*1E3;var thirtyMin=30*oneMin;var fortyFiveMin=45*oneMin;var oneHour=60*oneMin;var sixHour=6*oneHour;var inputDateJs=D2L.LocalDateTime.ToJavaScriptDate(inputDate);var nowDateJs=D2L.LocalDateTime.ToJavaScriptDate(nowDate);var sameYear=calendar.GetCalendarSpecificLocalDateTime(inputDate).GetYear()===calendar.GetCalendarSpecificLocalDateTime(nowDate).GetYear();var sameDay=
sameYear&&inputDate.GetMonth()===nowDate.GetMonth()&&inputDate.GetDay()===nowDate.GetDay();var midnight=new Date(nowDateJs.getFullYear(),nowDateJs.getMonth(),nowDateJs.getDate());var tomorrow=new Date(midnight.getTime()+24*oneHour);var yesterday=new Date(midnight.getTime()-24*oneHour);var threeDaysAgo=new Date(midnight.getTime()-3*24*oneHour);var timespan=nowDateJs.getTime()-inputDateJs.getTime();var text=this.FormatDateTime(inputDate,formats.MonthAndDay);if(!sameYear)text+=", "+inputDate.GetYear();
text+=" "+this.FormatDateTime(inputDate,formats.Time);var timeout=-1;if(timespan<0)timeout=timespan*-1;else if(timespan<thirtySec){text=fuzzy.JustNow;timeout=thirtySec-timespan}else if(timespan<oneMin+thirtySec){text=fuzzy.OneMinuteAgo;timeout=oneMin+thirtySec-timespan}else if(timespan<2*oneMin+thirtySec){text=fuzzy.TwoMinutesAgo;timeout=2*oneMin+thirtySec-timespan}else if(timespan<fortyFiveMin){var seconds=timespan%oneMin;var nextMin=seconds<thirtySec?thirtySec-seconds:oneMin-(seconds-thirtySec);
var timeUntilFortyFiveMin=fortyFiveMin-timespan;var minutesRounded=Math.round(timespan%oneHour/oneMin);text=fuzzy.MinutesAgoMany.replace("[0]",minutesRounded);timeout=Math.min(nextMin,timeUntilFortyFiveMin)}else if(timespan<sixHour||sameDay){var minutes=timespan%oneHour;var nextHour=minutes<thirtyMin?thirtyMin-minutes:oneHour-(minutes-thirtyMin);var timeUntilSixHour=sixHour-timespan;if(timespan<oneHour+thirtyMin)text=fuzzy.OneHourAgo;else if(timespan<oneHour*2+thirtyMin)text=fuzzy.TwoHoursAgo;else{var hoursRounded=
Math.round(timespan%(oneHour*24)/oneHour);text=fuzzy.ManyHoursAgo.replace("[0]",hoursRounded)}timeout=!sameDay&&timeUntilSixHour>0?timeUntilSixHour:nextHour}else if(inputDateJs>threeDaysAgo){if(inputDateJs>yesterday)text=fuzzy.YesterdayTime.replace("[0]",this.FormatDateTime(inputDate,formats.Time));else text=fuzzy.DayOfWeekTime.replace("[0]",this.FormatDateTime(inputDate,formats.ShortDayOfWeek)).replace("[1]",this.FormatDateTime(inputDate,formats.Time));timeout=tomorrow.getTime()-nowDateJs.getTime()}else if(sameYear){var endOfYear=
new Date(nowDateJs.getFullYear()+1,0,1);var timeUntilEndOfYear=endOfYear.getTime()-nowDateJs.getTime();timeout=timeUntilEndOfYear;text=fuzzy.MonthDayTime.replace("[0]",this.FormatDateTime(inputDate,formats.MonthAndDay)).replace("[1]",this.FormatDateTime(inputDate,formats.Time))}if(timeout>0)timeout=Math.max(timeout,1E3);return{timeout:timeout,text:text}},PrePadByZero:function(input,maxNum){input=input.toString();var zero="0";while(zero.length>0&&input.length<maxNum)input=zero+input;return input}});
D2L.LP.Globalization.Formatting.DateTime.DateTimeParser=D2L.Class.extend({Construct:function(dateTimeFormatDescriptor,numberParser){this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_numberParser=numberParser},TryParseInputDate:function(dateString){var inputDateTimeFormatTokenizer=new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatTokenizer(this.m_dateTimeFormatDescriptor.InputDateFormat);var calendarSpecificYear=null;var calendarSpecificMonth=null;var calendarSpecificDay=null;
dateString=dateString.toString().trim();var separator=inputDateTimeFormatTokenizer.GetSeparator();var dateFormatParts=inputDateTimeFormatTokenizer.GetParts();if(separator!=null&&dateFormatParts!=null){var dateParts=dateString.split(separator);if(dateParts.length!=dateFormatParts.length)throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;for(var i=0;i<dateFormatParts.length;i++){var dateFormatPart=dateFormatParts[i];try{var partValue=this.m_numberParser.ParseInteger(dateParts[i])}catch(e){throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.InvalidDateFormat;
}if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Year)calendarSpecificYear=partValue;else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Month)calendarSpecificMonth=partValue;else if(dateFormatPart.Type==D2L.LP.Globalization.Formatting.DateTime.FormatPart.Type.Day)calendarSpecificDay=partValue}var calendar=D2L.LP.Globalization.Locale.GetCalendar();var gregorianLocalDateTime=calendar.TryGetGregorianLocalDateTime(calendarSpecificYear,
calendarSpecificMonth,calendarSpecificDay);return gregorianLocalDateTime}else throw D2L.LP.Globalization.Formatting.DateTime.Exceptions.UnsupportedInputDateFormat;},TryParseTime:function(input){if(input===undefined||input===null||input=="")return null;var buildRe=function(part){var re="";var or="";for(var i=0;i<part.length;i++){re+=or+part.substr(0,i+1);or="|"}return new RegExp(re,"i")};var am=this.m_dateTimeFormatDescriptor.AmDesignator;var pm=this.m_dateTimeFormatDescriptor.PmDesignator;var is24HourClock=
this.m_dateTimeFormatDescriptor.Is24HourClock;var reAm=buildRe(am);var rePm=buildRe(pm);var isMorning=(new Date).getHours()<12;var reDigits=new RegExp("(\\d+)","g");var match=input.match(reDigits);if(match===null)return null;var digits=match.join("");var hour=0;var minute=0;if(digits.length===1)hour=digits.substr(0,1);else if(digits.length===2)hour=digits.substr(0,2);else if(digits.length===3){hour=digits.substr(0,1);minute=digits.substr(1,2)}else{hour=parseInt(digits.substr(0,2));minute=parseInt(digits.substr(2,
2))}hour=parseInt(hour,10);hour=Math.min(Math.max(hour,0),23);minute=parseInt(minute,10);minute=Math.min(Math.max(minute,0),59);if(!is24HourClock&&hour<13){var matchPm=input.match(rePm);var matchAm=input.match(reAm);var noAmPm=matchAm===null&&matchPm===null;if(matchPm!==null||noAmPm&&!isMorning){hour+=12;if(hour==24)hour=12}else if(hour==12)hour=0}var time=new D2L.LocalTime(hour,minute,0);return time}});
D2L.LP.Globalization.Formatting.DateTime.Formats={LongDate:"LongDate",StandardDate:"StandardDate",ShortDate:"ShortDate",LongDateTime:"LongDateTime",StandardDateTime:"StandardDateTime",ShortDateTime:"ShortDateTime",Time:"Time",MonthAndYear:"MonthAndYear",MonthAndDay:"MonthAndDay",LongMonthName:"LongMonthName",ShortMonthName:"ShortMonthName",LongDayOfWeek:"LongDayOfWeek",ShortDayOfWeek:"ShortDayOfWeek",InputDate:"InputDate"};D2L.LP.Globalization.Formatting.Number={};
D2L.LP.Globalization.Formatting.Number.DecimalFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits)},FormatSimple:function(value){value=value+"";var ret="";var negative=false;var processedDecimal=true;if(value.indexOf(".",0)>=0)processedDecimal=false;
var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c=="."){if(!processedDecimal)ret=this.m_numberFormatDescriptor.DecimalSeparator+ret;processedDecimal=true}else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(!processedDecimal)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==
digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+
ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret},Format:function(value,numOfDecimalPoints,trailingZeroes){if(isNaN(numOfDecimalPoints))return this.FormatSimple(value);else{value=Math.round(value*Math.pow(10,numOfDecimalPoints))/Math.pow(10,numOfDecimalPoints);value=value+"";var ret="";var negative=false;var hasDecimal=false;var currDecimalPoints=
0;var decimalRound=0;var processedDecimal=true;if(value.indexOf(".",0)>=0)processedDecimal=false;var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c=="."){if(!processedDecimal)ret=this.m_numberFormatDescriptor.DecimalSeparator+ret;processedDecimal=true}else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(!processedDecimal){ret=this.m_nativeDigitConverter.Convert(c)+
ret;currDecimalPoints++}else if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(trailingZeroes)for(var j=
currDecimalPoints;j<numOfDecimalPoints;j++){if(j==0)ret+=this.m_numberFormatDescriptor.DecimalSeparator;ret+=this.m_nativeDigitConverter.Convert(0)}if(currDecimalPoints>numOfDecimalPoints){var difference=numOfDecimalPoints-currDecimalPoints;ret=ret.substring(0,ret.length-difference)}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+
" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret}}});
D2L.LP.Globalization.Formatting.Number.DecimalParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor},Parse:function(value){var ret="";var negative=false;var hasDecimal=false;if(value===undefined||value===null)return 0;value=value.trim();if(value=="")return 0;if(this.m_numberFormatDescriptor.GroupSeparator!=" ")value=value.replace(" ","");else value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");var re=new RegExp(this.m_numberFormatDescriptor.DecimalRegex);
if(!re.test(value))throw"Invalid Decimal (re)";value=value.replace(new RegExp("["+this.m_numberFormatDescriptor.GroupSeparator+"]","g"),"");for(var i=0;i<value.length;i++){var c=value.charAt(i);if(c==this.m_numberFormatDescriptor.DecimalSeparator){if(!hasDecimal)ret+=".";hasDecimal=true}else if(c==this.m_numberFormatDescriptor.NegativeSign||c=="("||c==")")negative=true;else{for(var j=0;j<10;j++)if(c==this.m_numberFormatDescriptor.NativeDigits[j]){c=j;break}c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)ret+=
c;else throw"Invalid Decimal 2";}}ret=parseFloat(ret);if(negative)ret=ret*-1;return ret}});
D2L.LP.Globalization.Formatting.Number.IntegerFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits)},Format:function(value){value=value+"";var ret="";var negative=false;var groupSizes=this.m_numberFormatDescriptor.GroupSizes;var currentGroupSize=0;var digitsInCurrentGroup=
0;for(var i=value.length-1;i>=0;i--){var c=value.charAt(i);if(c==".")throw"Invalid Integer 2";else if(c=="-")negative=true;else{c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)if(groupSizes[currentGroupSize]==0)ret=this.m_nativeDigitConverter.Convert(c)+ret;else if(groupSizes[currentGroupSize]==digitsInCurrentGroup){ret=this.m_numberFormatDescriptor.GroupSeparator+ret;ret=this.m_nativeDigitConverter.Convert(c)+ret;currentGroupSize++;if(currentGroupSize>=groupSizes.length)currentGroupSize=groupSizes.length-
1;digitsInCurrentGroup=1}else{ret=this.m_nativeDigitConverter.Convert(c)+ret;digitsInCurrentGroup++}else throw"Invalid Integer 3";}}if(negative)switch(this.m_numberFormatDescriptor.NumberNegativePattern){case 0:ret="("+ret+")";break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+" "+ret;break;case 3:ret+=this.m_numberFormatDescriptor.NegativeSign;break;case 4:ret+=" "+this.m_numberFormatDescriptor.NegativeSign;break}return ret}});
D2L.LP.Globalization.Formatting.Number.IntegerParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor},Parse:function(value){var ret="";var negative=false;if(value===undefined||value===null)return 0;value=value.trim();if(value==""||value=="-")return 0;if(this.m_numberFormatDescriptor.GroupSeparator!=" ")value=value.replace(" ","");else value=value.replace(/^\s*|\s(?=\s)|\s*$/g,"");var re=new RegExp(this.m_numberFormatDescriptor.IntegerRegex);
if(!re.test(value))throw"Invalid Integer (re)";value=value.replace(new RegExp("["+this.m_numberFormatDescriptor.GroupSeparator+"]","g"),"");for(var i=0;i<value.length;i++){var c=value.charAt(i);if(c==this.m_numberFormatDescriptor.DecimalSeparator)throw"Invalid Integer 2";else if(c==this.m_numberFormatDescriptor.NegativeSign||c=="("||c==")")negative=true;else{for(var j=0;j<10;j++)if(c==this.m_numberFormatDescriptor.NativeDigits[j]){c=j;break}c=parseInt(c);if(!isNaN(c)&&c>=0&&c<=9)ret+=c;else throw"Invalid Integer 3";
}}ret=parseInt(ret,10);if(negative)ret=ret*-1;return ret}});
D2L.LP.Globalization.Formatting.Number.NativeDigitConverter=D2L.Class.extend({Construct:function(nativeDigits,useNativeDigits){this.m_nativeDigits=nativeDigits;this.m_useNativeDigits=useNativeDigits},Convert:function(value){if(this.m_useNativeDigits){value=value.toString();var toRet=new D2L.Util.StringBuilder;for(var i=0;i<value.length;i++){var x=parseInt(value.substr(i,1));if(!isNaN(x)&&x>=0&&x<=9)toRet.Append(this.m_nativeDigits[x]);else toRet.Append(value.substr(i,1))}return toRet.ToString()}else return value}});
D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor=D2L.Class.extend({Construct:function(decimalSeparator,groupSeparator,numberNegativePattern,percentPositivePattern,percentNegativePattern,percentSymbol,negativeSign,nativeDigits,useNativeDigits,groupSizes,integerRegex,decimalRegex){this.DecimalSeparator=decimalSeparator;this.GroupSeparator=groupSeparator;this.NumberNegativePattern=numberNegativePattern;this.PercentPositivePattern=percentPositivePattern;this.PercentNegativePattern=percentNegativePattern;
this.PercentSymbol=percentSymbol;this.NegativeSign=negativeSign;this.NativeDigits=nativeDigits;this.UseNativeDigits=useNativeDigits;this.GroupSizes=groupSizes;this.IntegerRegex=integerRegex;this.DecimalRegex=decimalRegex},_deserialize:function(deserializer){this.DecimalSeparator=deserializer.GetMember("DecimalSeparator");this.GroupSeparator=deserializer.GetMember("GroupSeparator");this.NumberNegativePattern=deserializer.GetMember("NumberNegativePattern");this.PercentPositivePattern=deserializer.GetMember("PercentPositivePattern");
this.PercentNegativePattern=deserializer.GetMember("PercentNegativePattern");this.PercentSymbol=deserializer.GetMember("PercentSymbol");this.NegativeSign=deserializer.GetMember("NegativeSign");this.NativeDigits=deserializer.GetMember("NativeDigits");this.UseNativeDigits=deserializer.GetMember("UseNativeDigits");this.GroupSizes=deserializer.GetMember("GroupSizes");this.IntegerRegex=deserializer.GetMember("IntegerRegex");this.DecimalRegex=deserializer.GetMember("DecimalRegex")}});
D2L.LP.Globalization.Formatting.Domain.Default.NumberFormatDescriptor=D2L.LP.Globalization.Formatting.Number.NumberFormatDescriptor;
D2L.LP.Globalization.Formatting.Number.NumberFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_nativeDigitConverter=new D2L.LP.Globalization.Formatting.Number.NativeDigitConverter(this.m_numberFormatDescriptor.NativeDigits,this.m_numberFormatDescriptor.UseNativeDigits);this.m_integerFormatter=null;this.m_decimalFormatter=null;this.m_percentageFormatter=null},FormatInteger:function(value){if(this.m_integerFormatter===
null)this.m_integerFormatter=new D2L.LP.Globalization.Formatting.Number.IntegerFormatter(this.m_numberFormatDescriptor);return this.m_integerFormatter.Format(value)},FormatDecimalSimple:function(value){if(this.m_decimalFormatter===null)this.m_decimalFormatter=new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor);return this.m_decimalFormatter.FormatSimple(value)},FormatDecimal:function(value,numOfDecimalPoints,trailingZeroes){if(this.m_decimalFormatter===null)this.m_decimalFormatter=
new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor);return this.m_decimalFormatter.Format(value,numOfDecimalPoints,trailingZeroes)},FormatPercentageSimple:function(value,outOf){if(this.m_percentageFormatter===null)this.m_percentageFormatter=new D2L.LP.Globalization.Formatting.Number.PercentageFormatter(this.m_numberFormatDescriptor);return this.m_percentageFormatter.FormatSimple(value,outOf)},FormatPercentage:function(value,outOf,numOfDecimalPoints,trailingZeroes){if(this.m_percentageFormatter===
null)this.m_percentageFormatter=new D2L.LP.Globalization.Formatting.Number.PercentageFormatter(this.m_numberFormatDescriptor);return this.m_percentageFormatter.FormatSimple(value,outOf,numOfDecimalPoints,trailingZeroes)}});
D2L.LP.Globalization.Formatting.Number.NumberParser=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_integerParser=null;this.m_decimalParser=null},ParseInteger:function(value){if(this.m_integerParser===null)this.m_integerParser=new D2L.LP.Globalization.Formatting.Number.IntegerParser(this.m_numberFormatDescriptor);return this.m_integerParser.Parse(value)},ParseDecimal:function(value){if(this.m_decimalParser===null)this.m_decimalParser=
new D2L.LP.Globalization.Formatting.Number.DecimalParser(this.m_numberFormatDescriptor);return this.m_decimalParser.Parse(value)}});
D2L.LP.Globalization.Formatting.Number.PercentageFormatter=D2L.Class.extend({Construct:function(numberFormatDescriptor){this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_decimalFormatter=new D2L.LP.Globalization.Formatting.Number.DecimalFormatter(this.m_numberFormatDescriptor)},FormatSimple:function(value,outOf){var negative=false;value=parseFloat(value)/parseFloat(outOf);value=value*100;if(value<0){negative=true;value=value*-1}var ret=this.m_decimalFormatter.Format(value);if(negative)switch(this.m_numberFormatDescriptor.PercentNegativePattern){case 0:ret=
this.m_numberFormatDescriptor.NegativeSign+ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 4:ret=this.m_numberFormatDescriptor.PercentSymbol+ret+this.m_numberFormatDescriptor.NegativeSign;
break;case 5:ret=ret+this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol;break;case 6:ret=ret+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 7:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break;case 8:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 9:ret=this.m_numberFormatDescriptor.PercentSymbol+
" "+ret+this.m_numberFormatDescriptor.NegativeSign;break;case 10:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 11:ret=ret+this.m_numberFormatDescriptor.NegativeSign+" "+this.m_numberFormatDescriptor.PercentSymbol;break}else switch(this.m_numberFormatDescriptor.PercentPositivePattern){case 0:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.PercentSymbol+
ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break}return ret},Format:function(value,outOf,numOfDecimalPoints,trailingZeroes){if(isNaN(numOfDecimalPoints))return this.FormatSimple(value,outOf);else{var negative=false;value=parseFloat(value)/parseFloat(outOf);value=value*100;if(value<0){negative=true;value=value*-1}var ret=this.m_decimalFormatter.Format(value,numOfDecimalPoints,trailingZeroes);if(negative)switch(this.m_numberFormatDescriptor.PercentNegativePattern){case 0:ret=
this.m_numberFormatDescriptor.NegativeSign+ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=this.m_numberFormatDescriptor.NegativeSign+ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 4:ret=this.m_numberFormatDescriptor.PercentSymbol+ret+this.m_numberFormatDescriptor.NegativeSign;
break;case 5:ret=ret+this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol;break;case 6:ret=ret+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 7:ret=this.m_numberFormatDescriptor.NegativeSign+this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break;case 8:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol+this.m_numberFormatDescriptor.NegativeSign;break;case 9:ret=this.m_numberFormatDescriptor.PercentSymbol+
" "+ret+this.m_numberFormatDescriptor.NegativeSign;break;case 10:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+this.m_numberFormatDescriptor.NegativeSign+ret;break;case 11:ret=ret+this.m_numberFormatDescriptor.NegativeSign+" "+this.m_numberFormatDescriptor.PercentSymbol;break}else switch(this.m_numberFormatDescriptor.PercentPositivePattern){case 0:ret=ret+" "+this.m_numberFormatDescriptor.PercentSymbol;break;case 1:ret=ret+this.m_numberFormatDescriptor.PercentSymbol;break;case 2:ret=this.m_numberFormatDescriptor.PercentSymbol+
ret;break;case 3:ret=this.m_numberFormatDescriptor.PercentSymbol+" "+ret;break}return ret}}});D2L.LP.Globalization.Formatting.Text={};D2L.LP.Globalization.Formatting.Text.TextDirection={LeftToRight:1,RightToLeft:2};D2L.LP.Globalization.Locale={};
D2L.LP.Globalization.Locale.Init=function(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){D2L.LP.Globalization.Locale=new D2L.LP.Globalization.LocaleObject(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor)};
D2L.LP.Globalization.LocaleObject=D2L.Class.extend({Construct:function(calendarType,numberFormatDescriptor,dateTimeFormatDescriptor,textFormatDescriptor,cultureCode,fuzzyDateTimeDescriptor){this.m_calendarType=calendarType;this.m_numberFormatDescriptor=numberFormatDescriptor;this.m_dateTimeFormatDescriptor=dateTimeFormatDescriptor;this.m_textFormatDescriptor=textFormatDescriptor;this.m_culture=cultureCode;this.m_fuzzyDateTimeDescriptor=fuzzyDateTimeDescriptor;this.m_numberParser=null;this.m_numberFormatter=
null;this.m_dateTimeParser=null;this.m_dateTimeFormatter=null;this.m_calendar=null},GetNumberFormatDescriptor:function(){return this.m_numberFormatDescriptor},GetNumberParser:function(){if(this.m_numberParser===null)this.m_numberParser=new D2L.LP.Globalization.Formatting.Number.NumberParser(this.GetNumberFormatDescriptor());return this.m_numberParser},GetNumberFormatter:function(){if(this.m_numberFormatter===null)this.m_numberFormatter=new D2L.LP.Globalization.Formatting.Number.NumberFormatter(this.GetNumberFormatDescriptor());
return this.m_numberFormatter},GetDateTimeFormatDescriptor:function(){return this.m_dateTimeFormatDescriptor},GetFuzzyDateTimeDescriptor:function(){return this.m_fuzzyDateTimeDescriptor},GetDateTimeParser:function(){if(this.m_dateTimeParser===null)this.m_dateTimeParser=new D2L.LP.Globalization.Formatting.DateTime.DateTimeParser(this.GetDateTimeFormatDescriptor(),this.GetNumberParser());return this.m_dateTimeParser},GetDateTimeFormatter:function(){if(this.m_dateTimeFormatter===null)this.m_dateTimeFormatter=
new D2L.LP.Globalization.Formatting.DateTime.DateTimeFormatter(this.GetDateTimeFormatDescriptor(),this.GetFuzzyDateTimeDescriptor());return this.m_dateTimeFormatter},GetTextFormatDescriptor:function(){return this.m_textFormatDescriptor},GetCultureCode:function(){return this.m_culture},GetCalendar:function(){if(this.m_calendar===null)this.m_calendar=new D2L.LP.Globalization.Calendars.Calendar(this.m_calendarType);return this.m_calendar}});D2L.Util={};
if(String.prototype.trim===undefined)String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")};D2L.Util.Url={};D2L.Util.Url.Encode=function(str){var ret=encodeURIComponent(str);ret=ret.replace("'","%27");ret=ret.replace("%2F","/");ret=ret.replace("%2C",",");return ret};D2L.Util.Url.Decode=function(str){return decodeURIComponent(str)};
D2L.Util.Dictionary=D2L.Class.extend({Construct:function(){this.m_keys=[];this.m_dict={};this.m_values=[];arguments.callee.$.Construct.call(this)},Add:function(key,value){var found=false;for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key){this.m_values[i]=value;found=true;break}if(!found){this.m_keys.push(key);this.m_values.push(value)}this.m_dict[key]=value},ContainsKey:function(key){for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key)return true;return false},GetCount:function(){return this.m_keys.length},
Get:function(key){if(this.m_dict[key]!==undefined)return this.m_dict[key];return undefined},Keys:function(){return this.m_keys},Remove:function(key){for(var i=0;i<this.m_keys.length;i++)if(this.m_keys[i]==key){this.m_keys.splice(i,1);this.m_values.splice(i,1);this.m_dict[key]=undefined;return true}return false},Values:function(){return this.m_values},Serialize:function(serializer){for(var i=0;i<this.m_keys.length;i++)serializer.AddMember(this.m_keys[i],this.Get(this.m_keys[i]))},Deserialize:function(deserializer){var keys=
deserializer.Keys();for(var i=0;i<keys.length;i++)this.Add(keys[i],deserializer.GetMember(keys[i]))}});D2L.Util.StringBuilder=D2L.Class.extend({Construct:function(initialValue){this.m_buffer=new Array("");if(initialValue!==undefined)this.Append(initialValue)},Append:function(value){this.m_buffer.push(value)},ToString:function(){return this.m_buffer.join("")}});D2L.LP.Web.UI.Common={CompositeViews:{},Controls:{},MasterPages:{}};
D2L.LP.Web.UI.Common.Controls.Button={Build:function(doc){doc=doc||document;var node=doc.createElement("a");D2L.LP.Web.UI.Html.Dom.AddClassName("vui-button",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button",node);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-onclick","var a=1;");return node},ClickNode:function(node){D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",node)},GetTextNode:function(node){var text=$(node).vui_button("getText");return text},GetTitleNode:function(node){var dom=D2L.LP.Web.UI.Html.Dom;
var hasTitle=dom.HasAttribute(node,"title");if(!hasTitle)return"";var title=dom.GetAttribute(node,"title");return title},Init:function(node){$(node).vui_button();var me=D2L.LP.Web.UI.Common.Controls.Button;var dom=D2L.LP.Web.UI.Html.Dom;var isDisabled=!me.IsEnabledNode(node);me.InitPageButtons(node);var hasOnClick=dom.HasAttribute(node,"data-onclick");if(!hasOnClick)return;var onClick=dom.GetAttribute(node,"data-onclick");dom.RemoveAttribute(node,"data-onclick");var processingText=dom.GetAttribute(node,
"data-processing-text");var clickTime=null;var isProcessing=false;var bypassDoubleClickPrevention=dom.HasClassName("d2l-button-bypass",node);var beginProcessing=function(){isProcessing=true;setTimeout(function(){if(isProcessing&&processingText!==null){$(node).vui_button("processingStart");D2L.LP.Web.UI.Events.OnProcessingBegin.Trigger()}},200)};var finishProcessing=function(){if(processingText!==null){$(node).vui_button("processingEnd");D2L.LP.Web.UI.Events.OnProcessingEnd.Trigger()}isProcessing=
false};var execOnClick=function(){if(node.d2l_onClick!==undefined)return node.d2l_onClick();return eval(onClick)};$(node).click(function(){var currentTime=(new Date).getTime();if(!bypassDoubleClickPrevention&&clickTime!==null&&currentTime-clickTime<=500){clickTime=currentTime;return}isDisabled=!me.IsEnabledNode(node);if(isDisabled||!bypassDoubleClickPrevention&&isProcessing)return;clickTime=currentTime;var ret=execOnClick();if(typeof ret==="undefined"||ret===null||ret.AddListener===undefined)return;
beginProcessing();ret.AddListener(finishProcessing);ret.AddReleaseListener(finishProcessing)})},InitPageButtons:function(node){var me=D2L.LP.Web.UI.Common.Controls.Button;var dom=D2L.LP.Web.UI.Html.Dom;var isPageButton=dom.GetParentElementByClassName("d2l-page-buttons",node)!==null;if(!isPageButton)isPageButton=dom.GetParentElementByClassName("d2l-dialog-buttons",node)!==null;if(!isPageButton)return;var enableOnEnd=true;D2L.LP.Web.UI.Events.OnProcessingBegin.AddListener(function(){enableOnEnd=me.IsEnabledNode(node);
if(enableOnEnd)me.SetIsEnabledNode(node,false)});D2L.LP.Web.UI.Events.OnProcessingEnd.AddListener(function(){if(enableOnEnd)me.SetIsEnabledNode(node,true);enableOnEnd=true})},IsEnabledNode:function(node){var isEnabled=$(node).vui_button("isEnabled");return isEnabled},IsPrimaryNode:function(node){var isPrimary=D2L.LP.Web.UI.Html.Dom.HasClassName("vui-button-primary",node);return isPrimary},IsVisibleNode:function(node){var isVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",node);return isVisible},
SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(node,isEnabled)},SetIsEnabledNode:function(node,isEnabled){var isEnabledCurrent=D2L.LP.Web.UI.Common.Controls.Button.IsEnabledNode(node);if(isEnabled==isEnabledCurrent)return;$(node).vui_button("setIsEnabled",isEnabled);var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?"data-href":"href");if(!hasHref)return;var href=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,
isEnabled?"data-href":"href");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?"href":"data-href",href);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?"data-href":"href")},SetIsPrimaryNode:function(node,isPrimary){if(!isPrimary)D2L.LP.Web.UI.Html.Dom.RemoveClassName("vui-button-primary",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("vui-button-primary",node)},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible)},SetOnClickNode:function(node,
onClick){node.d2l_onClick=onClick},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(node,text)},SetTextNode:function(node,text){$(node).vui_button("setText",text)},SetTitleNode:function(node,title){if(title===undefined||title===null||title.length===0)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"title");else D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"title",title)}};
D2L.LP.Web.UI.Common.Controls.Checkbox={SetIsChecked:function(id,checked){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null)return;var hidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(checkbox);if(hidden===null)return;hidden.value=checked?"1":"0";checkbox.checked=checked;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-checkbox-image-checkmark-no-css3-selector-support",checkbox))D2L.LP.Web.UI.Common.Controls.Checkbox.NoCss3SelectorSupportOnChange(checkbox,false)},
NoCss3SelectorSupportOnChange:function(node,hasFocus){var labelNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-checked-disabled",labelNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-checked-enabled",labelNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-checked-enabled-focus",labelNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-unchecked-disabled",
labelNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-unchecked-enabled",labelNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-checkbox-image-checkmark-unchecked-enabled-focus",labelNode);if(node.checked)if(node.disabled)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-checked-disabled",labelNode);else if(hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-checked-enabled-focus",labelNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-checked-enabled",
labelNode);else if(node.disabled)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-unchecked-disabled",labelNode);else if(hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-unchecked-enabled-focus",labelNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-checkbox-image-checkmark-unchecked-enabled",labelNode)},GetIsChecked:function(id){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null)throw"Checkbox not found '"+id.GetValue()+
"'.";return checkbox.checked},GetFirstChildCheckboxInputNode:function(parent){var checkboxes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-checkbox",parent);if(checkboxes!=null&&checkboxes.length>0)return checkboxes[0];else return null},TryGetIsChecked:function(id,defaultValue){var checkbox=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(checkbox===null)return defaultValue;return checkbox.checked}};
D2L.LP.Web.UI.Common.Controls.Edit={ClearValue:function(id){D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,"");var inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.Edit.SetClearLinkIsVisible(inputNode,false);inputNode.focus();var onClear=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),0);if(onClear==null)return;onClear.call(onClear)},ClearValueNode:function(node){D2L.LP.Web.UI.Common.Controls.Edit.SetValueNode(node,"")},SetClearLinkIsVisible:function(inputNode,
isVisible){var iconNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(inputNode);if(iconNode!==null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon",iconNode))return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon-visible",iconNode))return;if(!inputNode.value){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-edit-clearicon-hidden",iconNode);return}var isCurrentlyVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-edit-clearicon-hidden",iconNode);if(isVisible){if(!isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-edit-clearicon-hidden",
iconNode)}else if(isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-edit-clearicon-hidden",iconNode)},GetValue:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(input)},GetValueNode:function(node){if(node!==null)return node.value;return""},SetValue:function(id,value){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(input!==null)D2L.LP.Web.UI.Common.Controls.Edit.SetValueNode(input,value)},SetValueNode:function(node,
value){node.value=value},IsEnabledNode:function(node){if(node.disabled!==undefined)return!node.disabled;return true},IsVisibleNode:function(node){return D2L.LP.Web.UI.Html.Dom.IsVisible(node)},IsVisible:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.Edit.IsVisibleNode(input)},ValidateEnabledVisibleNode:function(node){if(!node)return true;var isEnabled=D2L.LP.Web.UI.Common.Controls.Edit.IsEnabledNode(node);var isVisible=D2L.LP.Web.UI.Common.Controls.Edit.IsVisibleNode(node);
if(!isEnabled||!isVisible)return false;return true},ValidateMinLength:function(id,minLength){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(input);if(!isEnabledVisible)return true;var length=input.value.trim().length;if(length===0||length>=minLength)return true;return false},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(input);
if(!isEnabledVisible)return true;var isEmpty=input.value.trim().length===0;return!isEmpty}};
D2L.LP.Web.UI.Common.Controls.EditEmail={ValidateEmail:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var emailPattern=/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/;var emailValue=D2L.LP.Web.UI.Common.Controls.Edit.GetValue(id).trim();
if(emailValue=="")return true;return emailPattern.test(emailValue)}};
D2L.LP.Web.UI.Common.Controls.EditInteger={TryGetInteger:function(id,isClientSideValidationEnabled){if(isClientSideValidationEnabled===undefined)isClientSideValidationEnabled=false;var editValue=D2L.LP.Web.UI.Common.Controls.Edit.GetValue(id).trim();if(editValue=="")return null;else try{return D2L.LP.Web.UI.Common.Controls.EditInteger.ParseNumber(editValue)}catch(e){var previousValue=D2L.LP.Web.UI.Common.Controls.EditInteger.GetHiddenValue(id);if(isClientSideValidationEnabled){var numberStr=D2L.LP.Web.UI.Common.Controls.EditInteger.FormatNumber(previousValue);
D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,numberStr)}return previousValue}},GetHiddenValue:function(id){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"HiddenId");var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());if(hiddenNode.value=="")return null;else return hiddenNode.value},ParseNumber:function(numberStr){var number=D2L.LP.Globalization.Locale.GetNumberParser().ParseInteger(numberStr);return number},FormatNumber:function(number){var numberStr=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(number);
return numberStr},SetInteger:function(id,number,triggerOnChange){var numberStr=D2L.LP.Web.UI.Common.Controls.EditInteger.FormatNumber(number);D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,numberStr);if(triggerOnChange===undefined||triggerOnChange){var editNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",editNode)}else D2L.LP.Web.UI.Common.Controls.EditInteger.UpdateHidden(id)},UpdateHidden:function(id,isClientSideValidationEnabled){var hiddenId=
D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"HiddenId");var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());var value=D2L.LP.Web.UI.Common.Controls.EditInteger.TryGetInteger(id,isClientSideValidationEnabled);if(value==null){D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,false);hiddenNode.value=""}else{D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,true);hiddenNode.value=value}},ValidateInteger:function(resolvedId){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var editValue=D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(node).trim();if(editValue=="")return true;try{D2L.LP.Web.UI.Common.Controls.EditInteger.ParseNumber(editValue);return true}catch(e){return false}},ValidateIntegerRange:function(resolvedId,min,max){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var value=D2L.LP.Web.UI.Common.Controls.EditInteger.TryGetInteger(id);if(value==null)return true;if(min!==null&&max!==null)return min<=value&&value<=max;else if(min!==null)return min<=value;else if(max!==null)return value<=max;else return true}};
D2L.LP.Web.UI.Common.Controls.EditDecimal={TryGetDecimal:function(id,isClientSideValidationEnabled){if(isClientSideValidationEnabled===undefined)isClientSideValidationEnabled=false;var editValue=D2L.LP.Web.UI.Common.Controls.Edit.GetValue(id).trim();if(editValue=="")return null;else try{return D2L.LP.Web.UI.Common.Controls.EditDecimal.ParseNumber(editValue)}catch(e){var previousValue=D2L.LP.Web.UI.Common.Controls.EditDecimal.GetHiddenValue(id);if(isClientSideValidationEnabled){var numberStr=D2L.LP.Web.UI.Common.Controls.EditDecimal.FormatNumber(previousValue);
D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,numberStr)}return previousValue}},GetHiddenValue:function(id){var hiddenId=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"HiddenId");var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());if(hiddenNode.value=="")return null;else return hiddenNode.value},ParseNumber:function(numberStr){var number=D2L.LP.Globalization.Locale.GetNumberParser().ParseDecimal(numberStr);return number},FormatNumber:function(number){var numberStr=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatDecimal(number);
return numberStr},SetDecimal:function(id,number,triggerOnChange){var numberStr=D2L.LP.Web.UI.Common.Controls.EditDecimal.FormatNumber(number);D2L.LP.Web.UI.Common.Controls.Edit.SetValue(id,numberStr);if(triggerOnChange===undefined||triggerOnChange){var editNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",editNode)}else D2L.LP.Web.UI.Common.Controls.EditDecimal.UpdateHidden(id)},UpdateHidden:function(id,isClientSideValidationEnabled){var hiddenId=
D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"HiddenId");var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenId.GetValue());var value=D2L.LP.Web.UI.Common.Controls.EditDecimal.TryGetDecimal(id,isClientSideValidationEnabled);if(value==null){D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,false);hiddenNode.value=""}else{D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(hiddenNode,true);hiddenNode.value=value}},ValidateDecimal:function(resolvedId){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var editValue=D2L.LP.Web.UI.Common.Controls.Edit.GetValue(id).trim();if(editValue=="")return true;try{D2L.LP.Web.UI.Common.Controls.EditDecimal.ParseNumber(editValue);return true}catch(e){return false}},ValidateDecimalRange:function(resolvedId,min,max){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(resolvedId);var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var value=D2L.LP.Web.UI.Common.Controls.EditDecimal.TryGetDecimal(id);if(value==null)return true;if(min!==null&&max!==null)return min<=value&&value<=max;else if(min!==null)return min<=value;else if(max!==null)return value<=max;else return true}};
D2L.LP.Web.UI.Common.Controls.EditUrl={Validate:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var value=D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(node);if(value===undefined||value===null||value.trim().length===0)return true;var regexpStr;if(allowInternal)regexpStr=D2L.LP.Web.UI.ObjectRepository.Get("UrlRegEx","AllowInternal");else regexpStr=
D2L.LP.Web.UI.ObjectRepository.Get("UrlRegEx","NoInternal");var regexp=new RegExp(regexpStr,"i");return regexp.test(value)},Required:function(id,allowInternal){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isEnabledVisible=D2L.LP.Web.UI.Common.Controls.Edit.ValidateEnabledVisibleNode(node);if(!isEnabledVisible)return true;var hasProtocol=D2L.LP.Web.UI.Common.Controls.EditUrl.Validate(id,allowInternal);if(!hasProtocol)return true;var value=D2L.LP.Web.UI.Common.Controls.Edit.GetValueNode(node);
if(value===undefined||value===null||value.trim().length===0)return true;var regexp=new RegExp("(:|/)[a-zA-Z0-9]","i");var hasContent=regexp.test(value);if(allowInternal&&hasContent)return true;return hasContent}};
D2L.LP.Web.UI.Common.Controls.ExpandCollapse={m_changedKey:null,m_changedState:null,GetChangedKey:function(){return D2L.LP.Web.UI.Common.Controls.ExpandCollapse.m_changedKey},GetChangedState:function(){return D2L.LP.Web.UI.Common.Controls.ExpandCollapse.m_changedState},SetChangedKey:function(key,state){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.m_changedKey=key;D2L.LP.Web.UI.Common.Controls.ExpandCollapse.m_changedState=state},SuppressFocusChange:false,SuppressStateChangeEvent:false,Toggle:function(id){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)throw"ExpandCollapse not found: '"+id.GetValue()+"'.";var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);if(links.length!==2)return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",links[0]))D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[1]);else D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[0])},CollapseAll:function(parentContainerId){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=
true;var node=document;if(parentContainerId!==undefined)node=D2L.LP.Web.UI.Html.Dom.GetElementById(parentContainerId.GetValue());$(node).find(".d2l-collapsepane").each(function(index,elem){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.CollapseNode(elem)});D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=false},ExpandAll:function(parentContainerId){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=true;var node=document;if(parentContainerId!==undefined)node=D2L.LP.Web.UI.Html.Dom.GetElementById(parentContainerId.GetValue());
$(node).find(".d2l-collapsepane").each(function(index,elem){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.ExpandNode(elem)});D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=false},CollapseNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);if(links.length!==2)return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",links[0]))D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[1])},ExpandNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",
node);if(links.length!==2)return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",links[1]))D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[0])}};
D2L.LP.Web.UI.Common.Controls.ExpandCollapseGroup={CollapseAll:function(groupName){D2L.LP.Web.UI.Common.Controls.ExpandCollapseGroup.ChangeAllState(groupName,false)},ExpandAll:function(groupName){D2L.LP.Web.UI.Common.Controls.ExpandCollapseGroup.ChangeAllState(groupName,true)},ChangeAllState:function(groupName,isExpanded){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=true;D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressStateChangeEvent=true;$(document).find(".d2l-expandcollapse").each(function(index,
elem){var elemGroupName=D2L.LP.Web.UI.Html.Dom.GetAttribute(elem,"data-group");if(elemGroupName==groupName)if(isExpanded)D2L.LP.Web.UI.Common.Controls.ExpandCollapseGroup.ExpandNode(elem);else D2L.LP.Web.UI.Common.Controls.ExpandCollapseGroup.CollapseNode(elem)});D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange=false;D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressStateChangeEvent=false},CollapseNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",
node);if(links.length!==2)return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",links[0]))D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[1])},ExpandNode:function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);if(links.length!==2)return;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",links[1]))D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",links[0])}};
D2L.LP.Web.UI.Common.Controls.Field={SetIsRequired:function(id,isRequired){id.$().toggleClass("d2l-field-required",isRequired)},SetLabel:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;var label=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);label.innerHTML=val},SetLabelEncoded:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;var label=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);label.innerHTML=val}};
D2L.LP.Web.UI.Common.Controls.Form={BuildParams:function(id,params){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.BuildParamsNode(form,params)},BuildParamsNode:function(form,params){var elements=D2L.LP.Web.UI.Common.Controls.Form.GetFormElements(form);var scopeToIgnore=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-scope");return D2L.LP.Web.UI.Common.Controls.Form.BuildParamsHelper(elements,params,scopeToIgnore)},GetFormElements:function(form){var elements;
var isNested=D2L.LP.Web.UI.Common.Controls.Form.IsNestedForm(form);if(isNested){var pageForm=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-primary",form);var pageFormElements=pageForm.elements;elements=[];for(var i=0;i<pageFormElements.length;i++){var pageFormElement=pageFormElements[i];if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,pageFormElement))elements.push(pageFormElement)}}else elements=form.elements;return elements},BuildParamsHelper:function(elements,params,scopeToIgnore){if(params===
undefined||params===null)params={};for(var key in params)if(params[key]===null)delete params[key];for(var i=0;i<elements.length;i++){var element=elements[i];if(element.name!==undefined&&element.name!=""&&element.disabled==false&&!(element.tagName.toLowerCase()=="input"&&(element.type=="radio"||element.type=="checkbox")&&element.checked==false)){var elemName=element.name;if(scopeToIgnore&&scopeToIgnore!="")elemName=elemName.replace(scopeToIgnore,"");if(params[elemName]!==undefined)if(D2L.LP.Web.UI.Html.JavaScript.IsArray(params[elemName]))params[elemName].push(element.value);
else params[elemName]=[params[elemName],element.value];else params[elemName]=element.value}}return params},ClearChange:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChange(node)},ClearChanges:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChanges(form)},FinishSubmit:function(form){var params=D2L.LP.Web.UI.Common.Controls.Form.BuildParamsNode(form,null);
var location=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-method");var target=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-target");var newForm=document.createElement("form");newForm.className="d2l-hidden";D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"action",location);D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"method",method);if(target)D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,"target",target);D2L.LP.Web.UI.Html.Dom.SetAttribute(newForm,
"enctype","application/x-www-form-urlencoded");newForm.onsubmit="return false;";var CreateAndAddHidden=function(name,val){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=name;hidden.value=val;newForm.appendChild(hidden)};CreateAndAddHidden(D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName(),D2L.LP.Web.Authentication.Xsrf.GetXsrfToken());for(var key in params){var value=params[key];if(D2L.LP.Web.UI.Html.JavaScript.IsArray(value))for(var i=0;i<value.length;i++)CreateAndAddHidden(key,
value[i]);else CreateAndAddHidden(key,value)}document.body.appendChild(newForm);newForm.submit();newForm.parentNode.removeChild(newForm)},ClearValidation:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(form)},DoSubmit:function(form,submitFunc){form.m_stopChangeTrackingPrompt=true;var parentForms=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName("d2l-form",form);for(var i=0;i<parentForms.length;i++)parentForms[i].m_stopChangeTrackingPrompt=
true;D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.Trigger(form);D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(form);var evt=new D2L.LP.Web.UI.Events.Event;evt.AddListener(function(){form.m_stopChangeTrackingPrompt=false;form.m_skipValidation=false;for(var i=0;i<parentForms.length;i++)parentForms[i].m_stopChangeTrackingPrompt=false});if(submitFunc===undefined)submitFunc=function(evt2){var hasAction=D2L.LP.Web.UI.Html.Dom.HasAttribute(form,"data-location");var submit=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,
"submit");var handleRet=function(retVal){if(retVal===true||retVal===false)evt2.Trigger(retVal);else if(retVal!==undefined&&retVal.AddListener!==undefined)retVal.AddListener(handleRet);else evt2.Trigger(true)};if(submit!==null){var ret=submit.call(submit);if(ret===undefined)ret=true;handleRet(ret)}else if(hasAction){form.m_skipValidation=false;D2L.LP.Web.UI.Common.Controls.Form.FinishSubmit(form);setTimeout(function(){evt2.Trigger(true)})}};var validators=D2L.LP.Web.UI.Common.Controls.Form.GetValidators(form);
if(validators.length>0&&!form.m_skipValidation)D2L.LP.Web.UI.Common.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed){form.m_skipValidation=true;submitFunc(evt)}else evt.Trigger(false)});else{form.m_skipValidation=false;submitFunc(evt)}return evt},GetForm:function(id){var form=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(form===null)throw"Form not found: '"+id.GetValue()+"'.";return form},GetLocation:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
var loc=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");if(loc)return new D2L.LP.Web.Http.UrlLocation(loc);else return null},GetRpcVerb:function(form){var verb=D2L.LP.Web.UI.Rpc.Verbs.POST;var method=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-method");if(method==="get")verb=D2L.LP.Web.UI.Rpc.Verbs.GET;return verb},GetValidators:function(form){var allForms=[];allForms.push(form);allForms=allForms.concat(D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form",form));var validators=[];
for(var i=0;i<allForms.length;i++){var formNode=allForms[i];if(formNode.d2l_validators!==undefined)for(var j=0;j<formNode.d2l_validators.length;j++)validators.push(formNode.d2l_validators[j]())}return validators},HasChanged:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.HasChangedNode(form)},HasValueChanged:function(id){var valueNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasValueChanged(valueNode)},
HasChangedNode:function(node){return D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasChanged(node)},IsNestedForm:function(formNode){return D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-nested",formNode)},RpcObjectSubmit:function(id,loc,skipValidation,params){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);var evt=new D2L.LP.Web.UI.Events.Event;var submitFunc=function(evt2){params=D2L.LP.Web.UI.Common.Controls.Form.BuildParams(id,params);var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Common.Controls.Form.GetRpcVerb(form),
loc,params);rpcEvt.AddListener(function(val){evt.Trigger(val);evt2.Trigger()})};var doSubmitEvt=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form,submitFunc);doSubmitEvt.AddListener(function(pass){if(!pass)setTimeout(function(){evt.Release()},50)});return evt},RpcSubmit:function(id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null)skipValidation=false;var submitFunc=function(evt){params=D2L.LP.Web.UI.Common.Controls.Form.BuildParams(id,params);var rpcEvt=
D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Common.Controls.Form.GetRpcVerb(form),location,params,options);rpcEvt.AddListener(function(pass){evt.Trigger(pass)})};var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);form.m_skipValidation=skipValidation;var submitRet=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form,submitFunc);return submitRet},RpcSubmitPartial:function(placeholderId,id,location,skipValidation,params,options){if(skipValidation===undefined||skipValidation===null)skipValidation=false;
if(options===undefined||options===null)options={};if(params===undefined||params===null)params={};var ret=new D2L.LP.Web.UI.Events.Event;params["_d2l_prc"]=D2L.LP.Web.UI.Html.PartialRendering.GetPartialRenderContext(placeholderId.GetValue());var functions={success:function(result){ret.Trigger(result);if(result&&options.success)options.success.call(options.success);if(!result&&options.failure!==undefined)options.failure.call(options.failure)},failure:function(){ret.Trigger(false);if(options.failure!==
undefined)options.failure.call(options.failure)}};var evt;evt=D2L.LP.Web.UI.Common.Controls.Form.RpcSubmit(id,location,skipValidation,params,functions);evt.AddListener(function(success){if(!success)ret.Trigger(false)});return ret},Reset:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);var elements=D2L.LP.Web.UI.Common.Controls.Form.GetFormElements(form);for(var i=0;i<elements.length;i++){var element=elements[i];if(element&&element.defaultValue!==undefined&&element.value!==undefined)element.value=
element.defaultValue;if(element&&element.defaultChecked!==undefined&&element.checked!==undefined)element.checked=element.defaultChecked}D2L.LP.Web.UI.Common.Controls.ChangeTracking.ClearChanges(form);D2L.LP.Web.UI.Events.OnFormReset.Trigger(form)},SetLocation:function(id,location){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl())},StopChangeTracking:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
form.m_stopChangeTrackingPrompt=true},Submit:function(id){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form)},SubmitByButton:function(buttonId){var submitButton=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId.GetValue());var form=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form",submitButton);if(form)return D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form)},SubmitToIFrame:function(id,iframeId,location){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);
var iframe=D2L.LP.Web.UI.Html.Dom.GetElementById(iframeId);return D2L.LP.Web.UI.Common.Controls.Form.SubmitToIFrameHelper(form,iframe,location)},SubmitToIFrameHelper:function(form,iframe,location){var oldAction=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-location");var oldTarget=D2L.LP.Web.UI.Html.Dom.GetAttribute(form,"data-target");D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",location.GetUrl());D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",iframe.name);var evt=D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(form);
evt.AddListener(function(){if(oldAction===null)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-location");else D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-location",oldAction);if(oldTarget===null)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(form,"data-target");else D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-target",oldTarget)});return evt},SubmitToDialog:function(id,dialogOpenerId,dialogLocation,dialogSettings){var form=D2L.LP.Web.UI.Common.Controls.Form.GetForm(id);return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,
dialogOpenerId,dialogLocation,dialogSettings)},ValidateById:function(formId){var evt=new D2L.LP.Web.UI.Events.Event;var form=D2L.LP.Web.UI.Html.Dom.GetElementById(formId.GetValue());var validators=D2L.LP.Web.UI.Common.Controls.Form.GetValidators(form);D2L.LP.Web.UI.Common.Controls.Form.Validate(form,validators).AddListener(function(passed){if(passed)evt.Trigger(true);else evt.Trigger(false)});return evt}};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Common.Controls.ChangeTracking={AddChangeTrackElement:function(elementNode,onChangeEvent,getValueDelegate){var visuallyChangeTrackers=false;var trackerNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-tracker",elementNode);var ancestorFormWithTrackChanges=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-track-changes",elementNode);visuallyChangeTrackers=ancestorFormWithTrackChanges!=null&&trackerNode!=null;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-form-tracked-element",
elementNode);var element={getValueDelegate:getValueDelegate,initialValue:getValueDelegate(),hasChanged:false};elementNode.d2l_tracking_element=element;var onChange=function(){D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange.Trigger(elementNode);var newValue=getValueDelegate();if(element.initialValue!==newValue){if(visuallyChangeTrackers)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-form-tracker-changed",trackerNode);element.hasChanged=true}else{element.hasChanged=false;if(visuallyChangeTrackers){var noMoreChangedElements=
!D2L.LP.Web.UI.Common.Controls.ChangeTracking.HasChanged(trackerNode);if(noMoreChangedElements)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",trackerNode)}}};onChangeEvent.AddListener(onChange)},ClearChanges:function(ancestorNode){var elements=D2L.LP.Web.UI.Common.Controls.ChangeTracking.GetElements(ancestorNode);for(var i=0;i<elements.length;i++){elements[i].initialValue=elements[i].getValueDelegate();elements[i].hasChanged=false}var trackerNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-tracker",
ancestorNode);for(var i=0;i<trackerNodes.length;i++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",trackerNodes[i])},ClearChange:function(elementNode){if(elementNode===undefined||elementNode===null)return;var element=elementNode.d2l_tracking_element;if(element===undefined)return;element.initialValue=element.getValueDelegate();element.hasChanged=false;var trackerNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-tracker",elementNode);if(trackerNode===null)return;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-form-tracker-changed",
trackerNode)},GetElements:function(ancestorNode){var elements=[];var elementNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-tracked-element",ancestorNode);for(var i=0;i<elementNodes.length;i++)if(elementNodes[i].d2l_tracking_element)elements.push(elementNodes[i].d2l_tracking_element);return elements},HasChanged:function(ancestorNode){var elements=D2L.LP.Web.UI.Common.Controls.ChangeTracking.GetElements(ancestorNode);for(var i=0;i<elements.length;i++)if(elements[i].hasChanged)return true;
return false},HasValueChanged:function(elementNode){if(elementNode===undefined||elementNode===null)return false;var element=elementNode.d2l_tracking_element;if(element===undefined)return false;return element.hasChanged}};D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Common.Controls.Hidden={GetValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var node=D2L.LP.Web.UI.Common.Controls.Hidden.Get(id,noThrow);if(node===null)return defaultValue;var value=node.value;return value},Get:function(id,noThrow){var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(hidden===null){if(noThrow)return null;throw"Hidden not found: '"+id.GetValue()+"'.";}return hidden},SetValue:function(id,value){var hidden=D2L.LP.Web.UI.Common.Controls.Hidden.Get(id);
hidden.value=value;if(hidden.d2l_changeEvent)hidden.d2l_changeEvent.Trigger()}};D2L.LP.Web.UI.Common.Controls.HtmlBlock={SetHtml:function(id,val){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"HtmlBlock not found '"+idVal+"'.";node.innerHTML=val}};
D2L.LP.Web.UI.Common.Controls.IFrame={AddOnLoadHandler:function(iframe,handler){if(iframe.m_loaded)handler();else D2L.LP.Web.UI.Html.Dom.AddEventListener("load",iframe,handler)},SetLocation:function(id,location){var $frame=id.$();var loadingIcon=$frame.prev(".d2l-iframe-loading-container");loadingIcon.show();$frame.hide().load(function(){loadingIcon.hide();$frame.show()}).attr("src",location.GetUrl())}};
D2L.LP.Web.UI.Common.Controls.Image={SetAlt:function(id,alt){var img=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(img!==null){img.alt=alt;img.title=alt}},SetImage:function(id,src,width,height){var img=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(img===null)return;img.style.backgroundImage="url("+src+")";if(width!==0)img.style.width=width+"px";if(height!==0)img.style.height=height+"px"},SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible)}};
D2L.LP.Web.UI.Common.Controls.ImageLink={SetTitle:function(id,title){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){node.title=title;var titleNode=node.firstChild;while(titleNode.childNodes.length>0)titleNode.removeChild(titleNode.childNodes[0]);titleNode.appendChild(document.createTextNode(title))}},SetImage:function(id,src,width,height){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node!==null){node.style.backgroundImage="url("+src+")";if(width!==
0)node.style.width=width+"px";if(height!==0)node.style.height=height+"px"}},AddOnClick:function(id,onclick){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node))onclick()})},AddOnFocus:function(id,onFocus){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,onFocus)},AddOnBlur:function(id,onBlur){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,onBlur)},IsEnabledNode:function(node){return!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-imagelink-disabled",node)},IsEnabled:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node)},
SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabledNode(node,isEnabled)},SetIsEnabledNode:function(node,isEnabled){var isDisabled=!D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node);if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled",!isEnabled);var hoverClassName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-hoverClassName");if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-imagelink-disabled",
node);if(hoverClassName)D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","false")}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-imagelink-disabled",node);if(hoverClassName)D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true")}var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?"data-href":"href");if(!hasHref)return;var href=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,
isEnabled?"data-href":"href");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?"href":"data-href",href);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?"data-href":"href")}};
D2L.LP.Web.UI.Common.Controls.Link={InstallClickable:function(node){node.tabIndex=0;var handleEnter=function(){D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",node)};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(key){if(key.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)handleEnter()})},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;while(node.firstChild)node.removeChild(node.firstChild);node.appendChild(document.createTextNode(text))}};
D2L.LP.Web.UI.Common.Controls.LinkHeading={SetText:function(id,text){var headingNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(headingNode);if(!node)return;while(node.firstChild)node.removeChild(node.firstChild);node.appendChild(document.createTextNode(text))}};
D2L.LP.Web.UI.Common.Controls.LongEdit={ClearValue:function(id){D2L.LP.Web.UI.Common.Controls.LongEdit.SetValue(id,"")},ClearValueNode:function(node){D2L.LP.Web.UI.Common.Controls.LongEdit.SetValueNode(node,"")},IsEmpty:function(id){var input=D2L.LP.Web.UI.Common.Controls.LongEdit.GetInput(id);var value=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,input.value);var isEmpty=value.length===0;return isEmpty},GetInput:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(input===
null)throw"LongEdit not found '"+id.GetValue()+"'.";return input},SetHeight:function(id,height){var input=D2L.LP.Web.UI.Common.Controls.LongEdit.GetInput(id);D2L.LP.Web.UI.Common.Controls.LongEdit.SetHeightNode(input,height)},SetHeightNode:function(node,height){if(height===undefined||height===null)height=50;D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-height",height);var isResized=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-longedit-resized",node);if(isResized)return;node.style.height=height+"px"},
SetValue:function(id,value){var input=D2L.LP.Web.UI.Common.Controls.LongEdit.GetInput(id);D2L.LP.Web.UI.Common.Controls.LongEdit.SetValueNode(input,value)},SetValueNode:function(node,value){node.value=value;if(node.d2l_onChange!==undefined)node.d2l_onChange()},AddOffScreenClass:function(node){var wasHidden=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",node.parentNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",node.parentNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-longedit-offscreen",
node.parentNode);return wasHidden},RemoveOffScreenClass:function(node,wasHidden){if(wasHidden)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node.parentNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-longedit-offscreen",node.parentNode)}};D2L.LP.Web.UI.Common.Controls.Placeholder={Clear:function(id){var ph=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(ph===null)return;vui.applyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassDestructors,ph);D2L.LP.Web.UI.Html.Dom.RemoveChildElements(ph)}};
D2L.LP.Web.UI.Common.Controls.RadioButton={GetChecked:function(id){return D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()).checked},GetSelectedValue:function(groupName){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++)if(radios[i].checked==true)return radios[i].value;return null},SetIsEnabled:function(groupName,isEnabled){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++)radios[i].disabled=!isEnabled},SetSelected:function(groupName,
value){var radios=document.getElementsByName(groupName.GetValue());for(var i=0;i<radios.length;i++)if(radios[i].value==value){radios[i].checked=true;return}}};
D2L.LP.Web.UI.Common.Controls.SelectList={GetInput:function(id,noThrow){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!noThrow&&input===null)throw"SelectList not found: '"+id.GetValue()+"'.";return input},GetSelectedValue:function(id,defaultValue){var noThrow=defaultValue!==undefined;var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id,noThrow);if(input===null)return defaultValue;var option=input.options[input.selectedIndex];return option.value},GetValues:function(id){var input=
D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);var values=[];for(var i=0;i<input.options.length;i++)values.push(input.options[i].value);return values},SetIsVisibleFunction:function(id,isVisible){var node=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-select-container",node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,isVisible)},SetSelectedValue:function(id,value){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);
for(var i=0;i<input.options.length;i++)if(input.options[i].value===value){input.selectedIndex=i;break}},Focus:function(id){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);input.focus()},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);if(input.options.length===0)return false;var option=input.options[input.selectedIndex];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-selectlist-nonselectable",option))return false;return true}};
D2L.LP.Web.UI.Common.Controls.TextBlock={Focus:function(id){id.$().attr("tabindex","-1").focus()},SetText:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;node.innerHTML=val},SetTextEncoded:function(id,val){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node)return;if(node.textContent!==undefined)node.textContent=val;else if(node.innerText!==undefined)node.innerText=val}};
D2L.LP.Web.UI.Common.Controls.ValidatorCustom={Init:function(form,node){if(form===null||node===null)return;if(form.d2l_validators===undefined)form.d2l_validators=[];var validator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id);if(validator===null)throw"Validator not found: '"+node.id+"'.";var initFunc=validator[3];if(initFunc!=null)initFunc();form.d2l_validators.push(function(){var newNode=D2L.LP.Web.UI.Html.Dom.GetElementById(node.id);var sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(validator[0]);
var isVisible=true;if(sourceNode!==null)isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(sourceNode);validator=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id);if(validator===null)throw"Validator not found: '"+node.id+"'.";if(newNode===null||!isVisible)validator[1]=function(){return true};var validateNode=D2L.LP.Web.UI.Html.Dom.GetElementById(validator[0]);var focusId=null;var inputId=null;if(validateNode!==null){focusId=D2L.LP.Web.UI.Html.Dom.GetAttribute(validateNode,"data-d2l-validatefocus");if(focusId==
null)focusId=validator[0];inputId=D2L.LP.Web.UI.Html.Dom.GetAttribute(validateNode,"data-d2l-validateinput");if(inputId==null)inputId=validator[0]}return D2L.LP.Web.UI.Common.Controls.ValidatorCustom.GenerateValidatorObject(inputId,validator[1],validator[2],focusId)})},GenerateValidatorObject:function(inputId,validationFunc,errMessage,focusId){return{inputId:inputId,validation:validationFunc,message:errMessage,focusId:focusId}}};D2L.LP.Web.UI.Desktop={CompositeViews:{},Controls:{},MasterPages:{}};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog={NumOfDialogs:0,Offset:20,AdaptPageToDialog:function(handle){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var doc=handle.frame.contentWindow.document;var pageHeader=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-header",handle.container);if(pageHeader===null)return;var close=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-close",handle.container);if(close!==null)return;close=doc.createElement("a");close.className="d2l-dialog-close vui-outline";
me.InitClose(close,handle.frame.contentWindow);pageHeader.insertBefore(close,pageHeader.childNodes[1])},InitClose:function(node,nodeWin){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);");if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"onclick")){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Abort(nodeWin)})}},
InitResize:function(node,nodeWin){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle(nodeWin);var settings={Handle:node,DisplayType:"none",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var evt=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(handle.dialog,settings,nodeWin,handle.rootWin);evt.AddListener(function(size){handle.isResized=true;me.SetSize(handle,size.width-8,size.height-8)});D2L.LP.Web.UI.Events.OnSizingFinished.AddListener(function(){if(!handle||!handle.container||
!handle.body)return;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);handle.height=rect.height+handle.nodes.footer.offsetHeight;var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height)});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(partialNode){if(!handle||!handle.nodes.footer||!handle.container||!handle.body)return;if(partialNode.nodeType!==1)return;if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(handle.nodes.footer,
partialNode))return;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);var height=rect.height;if(handle.height===height)return;var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.nodes.footer);height+=footerRect.height;if(handle.height===height)return;handle.height=height;var rectBody=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=handle.height-rectBody.height;me.SetSize(handle,handle.width,handle.height)})},InitTitle:function(node,nodeWin){var closeNode=
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-close",node)[0];var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(nodeWin);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper(handle,handle.dialog,node,closeNode,nodeWin,handle.rootWin)},InitTitleHelper:function(handle,dialogNode,titleNode,closeNode,nodeWin,win){var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;dragSettings.SetHandle(titleNode);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);
if(closeNode)dragSettings.AddHandleException(closeNode);dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.GetDragStartEvent().AddListener(function(){handle.isDragged=true});dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(dialogNode,dragSettings,nodeWin,win)},SetWidth:function(width){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var handle=me.GetHandle();width=Math.max(width,400);handle.width=width;handle.dialog.style.width=
width+"px";handle.setWidthCalled=true;if(handle.container!==null)handle.container.style.width=width-2+"px";if(handle.frame!==null)handle.frame.style.width=width-2+"px";handle.onresize();handle.dialog.OnResize.Trigger()},SetSize:function(handle,width,height){width=Math.max(width,400);handle.width=width;handle.height=height;handle.dialog.style.width=width+"px";handle.dialog.style.height=height+"px";if(handle.container!==null)handle.container.style.width=width-2+"px";if(handle.inner!==null)handle.inner.style.height=
height-2+"px";if(handle.frame!==null){handle.frame.style.width=width-2+"px";handle.frame.style.height=height-2+"px"}if(handle.body!==null&&handle.nodes.footer!==null){var footerSize=handle.nodes.footer.offsetHeight;handle.body.style.height=height-3-handle.bodyDiff-footerSize+"px";handle.dialog.OnResize.Trigger()}if(handle.setWidthCalled)return;clearTimeout(handle.heightTimeout);handle.heightTimeout=setTimeout(function(){if(handle.body===null||handle.nodes.title===null||handle.nodes.footer===null)return;
var headerPlusFooterHeight=handle.nodes.title.offsetHeight+handle.nodes.footer.offsetHeight;var newBodyHeight=parseInt(height-headerPlusFooterHeight);handle.body.style.height=newBodyHeight+"px";handle.dialog.OnResize.Trigger()},0)},Build:function(handle,form,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;handle.width=settings.Width?settings.Width:400;handle.height=settings.Height?settings.Height:300;var dialogHeight=handle.height;var loadedOnce=false;var adjustSize=function(){var scroll=
D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);handle.dialog.style.top=scroll.top+50+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Common.MasterPages.Dialog.Offset+"px";me.SetSize(handle,handle.width,handle.height)};handle.dialog=handle.rootWin.document.createElement("div");handle.dialog.OnResize=new D2L.LP.Web.UI.Events.Event;handle.dialog.className="d2l-dialog d2l-dialog-loading";handle.dialog.d2l_handle=handle;handle.firstLoadEvent=
new D2L.LP.Web.UI.Events.Event;handle.inner=handle.rootWin.document.createElement("div");handle.inner.className="d2l-dialog-inner";handle.dialog.appendChild(handle.inner);var frameId=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();handle.inner.innerHTML="<iframe src='/d2l/tools/blank.html' name='"+frameId+"'></iframe>";handle.frame=handle.inner.firstChild;handle.frame.frameBorder="0";handle.frame.scrolling="no";handle.frame.className="d2l-dialog-frame d2l-dialog-frame-loading";handle.onresize=function(){if(handle.isDragged)return;
var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var left=Math.max(viewport.width/2-handle.width/2,0);handle.dialog.style.left=left+handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs*handle.rootWin.D2L.LP.Web.UI.Common.MasterPages.Dialog.Offset+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(handle.onresize);D2L.LP.Web.UI.Html.Dom.AddEventListener("load",handle.frame,function(){if(!loadedOnce){loadedOnce=true;handle.firstLoadEvent.Trigger();return}handle.container=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-width",handle.frame.contentWindow.document);if(handle.container!==null)handle.frame.style.overflow="hidden";else{handle.frame.style.overflow="scroll";handle.container=handle.frame.contentWindow.document.body;me.AdaptPageToDialog(handle)}handle.body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",handle.container);if(handle.body===null)handle.body=handle.container;handle.nodes.title=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-title",
handle.container);handle.nodes.footer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-footer-container",handle.container);if(settings.Onload!==undefined)settings.Onload.call(settings.Onload,handle);var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.container);dialogHeight=rect.height;if(!handle.setWidthCalled)handle.width=rect.width;if(handle.frame.contentWindow.D2L!==undefined){handle.frame.contentWindow.D2L.LP.Web.UI.Events.OnContentHeightChange.AddListener(function(newHeight){var desiredGrowth=
newHeight+handle.bodyDiff-handle.height;if(handle.isResized||desiredGrowth<0)return;rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.dialog);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(handle.rootWin);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);var top=Math.max(rect.top-scroll.top,0);var roomToGrow=viewport.height-top-rect.height;newHeight=handle.height+Math.min(desiredGrowth,roomToGrow);me.SetSize(handle,handle.width,newHeight)});if(settings.Height===undefined){var h=
D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.container,"data-height");if(h!==null)handle.height=parseInt(h);else{var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);handle.height=Math.max(Math.min(dialogHeight+handle.nodes.footer.offsetHeight+10,viewport.height-100),200)}}if(handle.settings.AutoClose){handle.ondocumentclick=function(){handle.frame.contentWindow.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Close()};D2L.LP.Web.UI.Events.OnClick.AddListener(handle.ondocumentclick)}}setTimeout(function(){var rectBody=
D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.body);handle.bodyDiff=dialogHeight-rectBody.height;adjustSize();handle.onresize()},0);handle.frame.contentWindow.document.body.style.overflow="hidden";me.Focus(handle.container,handle.frame.contentWindow);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-dialog-loading",handle.dialog);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-dialog-frame-loading",handle.frame)});adjustSize();handle.onresize();if(form===null)handle.firstLoadEvent.AddListener(function(){handle.frame.src=
location.GetUrl()});handle.inner.appendChild(handle.frame)},Abort:function(win){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(false,undefined,win)},Close:function(result){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result)},CloseExternal:function(result){parent.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelper(true,result)},CloseHelper:function(doTrigger,result,win){var handle=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.GetHandle(win);if(handle===null)return result;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(doTrigger,
true,result,handle)},CloseHelperWithHandle:function(doTrigger,doFocus,result,handle){if(handle.m_isClosed)return;if(handle.onresize!==null)handle.win.D2L.LP.Web.UI.Events.OnResize.RemoveListener(handle.onresize);if(handle.ondocumentclick!==null)handle.win.D2L.LP.Web.UI.Events.OnClick.RemoveListener(handle.ondocumentclick);if(handle.shim!==null&&handle.settings.ShimType>0)D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);if(doTrigger)handle.evt.Trigger(result);else handle.evt.Release();setTimeout(function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperForFocusSwitch(handle,
doFocus)},0);handle.m_isClosed=true},CloseHelperForFocusSwitch:function(handle,doFocus){var removeDialog=function(){handle.dialog.d2l_handle=null;handle.dialog.parentNode.removeChild(handle.dialog);handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs--};var assignFocusToOpener=function(){try{if(doFocus)handle.opener.focus()}catch(e){}};if(navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1){var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");
if(body!==null){var rootDocument=handle.rootWin.document;var ieInput=rootDocument.createElement("input");ieInput.style.position="absolute";ieInput.style.height="0px";ieInput.style.width="0px";ieInput.style.top=rootDocument.documentElement.scrollTop+"px";ieInput.style.left=rootDocument.documentElement.scrollLeft+"px";body.appendChild(ieInput);var focusAndRemove=function(){ieInput.focus();body.removeChild(ieInput)};setTimeout(function(){focusAndRemove()},0);ieInput.focus()}removeDialog();assignFocusToOpener()}else{assignFocusToOpener();
removeDialog()}handle=null},Focus:function(dialog,win){var focusId=D2L.LP.Web.UI.Html.Dom.GetAttribute(dialog,"data-focusid");if(focusId!==null){var focusElem=win.D2L.LP.Web.UI.Html.Dom.GetElementById(focusId);if(D2L.LP.Web.UI.Html.Dom.IsFocusable(focusElem)){D2L.LP.Web.UI.Html.Dom.FocusNode(focusElem);return}}var doc=win.document;var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;var closeElem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-close",dialog);var elems=me.GetFocusableElements(dialog);
if(elems.length===0)return;try{elems[0].focus()}catch(e){}if(closeElem===null)return;var first=doc.createElement("span");first.tabIndex=0;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",first,function(){elems[elems.length-1].focus()});closeElem.parentNode.insertBefore(first,closeElem);var last=doc.createElement("span");last.tabIndex=0;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",last,function(){closeElem.focus()});var lastElem=elems[elems.length-1];if(lastElem.nextSibling)lastElem.parentNode.insertBefore(last,
lastElem.nextSibling);else lastElem.parentNode.appendChild(last)},GetFocusableElements:function(dialog){var focusableElems={"a":true,"input":true,"select":true,"textarea":true,"button":true};var elems=[];var closeElem=null;var findElems=function(node){if(node.nodeType!==1)return;var tagName=node.tagName.toLowerCase();if(focusableElems[tagName]===true){var focusable=true;if(tagName=="input"&&(node.type=="hidden"||node.disabled===true))focusable=false;else if(D2L.LP.Web.UI.Html.Css.GetStyle(node,"display")===
"none")focusable=false;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-dialog-close",node)){closeElem=node;focusable=false}if(focusable)elems.push(node)}for(var i=0;i<node.childNodes.length;i++)findElems(node.childNodes[i])};findElems(dialog);if(elems.length===0&&closeElem!==null)elems.push(closeElem);return elems},GetHandle:function(win){win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-frame",win.parent.document);for(var i=0;i<dialogs.length;i++)if(dialogs[i].contentWindow==
win)return dialogs[i].parentNode.parentNode.d2l_handle;return null},FixSettings:function(settings){if(settings===undefined||settings===null)settings={};if(settings.AutoClose===undefined)settings.AutoClose=false;if(settings.ShimType===undefined)settings.ShimType=1;if(settings.Window===undefined)if(window.parent&&window.parent.frames&&window.parent.frames.length===3)settings.Window=window;return settings},Open:function(openerId,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(null,
openerId,location,settings)},OpenHelper:function(opener,location,settings){return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(null,opener,location,settings)},OpenWithParam:function(openerId,location,params,settings){var evt=new D2L.LP.Web.UI.Events.Event;var serializer=new D2L.LP.Web.Serialization.Serializer;var createHidden=function(name,value){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=name;hidden.value=value;return hidden};var form=document.createElement("form");
D2L.LP.Web.UI.Html.Dom.SetAttribute(form,"data-method","POST");for(var key in params)serializer.AddMember(key,params[key]);var members=serializer.GetMembers();for(var i=0;i<members.length;i++)form.appendChild(createHidden(members[i][0],members[i][1]));document.body.appendChild(form);var openSubmitEvent=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmit(form,openerId,location,settings);openSubmitEvent.AddListener(function(result){evt.Trigger(result)});openSubmitEvent.AddReleaseListener(function(){evt.Release()});
return evt},OpenSubmit:function(form,openerId,location,settings){var opener=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(opener===null)throw"Dialog opener not found: "+openerId.GetValue();else if(opener.focus===undefined)throw"Invalid dialog opener: "+openerId.GetValue();return D2L.LP.Web.UI.Desktop.MasterPages.Dialog.OpenSubmitHelper(form,opener,location,settings)},OpenSubmitHelper:function(form,opener,location,settings){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;settings=me.FixSettings(settings);
var evt=new D2L.LP.Web.UI.Events.Event;var rootWin=window;while(true){if(rootWin.parent===rootWin||rootWin.D2L===undefined)break;rootWin=rootWin.parent}if(settings.Window)rootWin=settings.Window;var handle={dialog:null,frame:null,body:null,bodyDiff:50,height:200,heightTimeout:null,inner:null,isResized:false,container:null,onresize:null,ondocumentclick:null,shim:null,win:window,rootWin:rootWin,opener:opener,evt:evt,isDragged:false,settings:settings,nodes:{title:null,heading:null,close:null,footer:null},
width:300};handle.rootWin.D2L.LP.Web.UI.Desktop.MasterPages.Dialog.NumOfDialogs++;me.Build(handle,form,location,settings,rootWin);var appendToDom=function(){rootWin.document.body.appendChild(handle.dialog)};var shim=function(){if(settings.ShimType>0)handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(handle.dialog,settings.ShimType==2)};if(form!==null){handle.dialog.style.visibility="hidden";appendToDom();handle.firstLoadEvent.AddListener(function(){D2L.LP.Web.UI.Common.Controls.Form.SubmitToIFrameHelper(form,
handle.frame,location).AddListener(function(result){if(result){shim();handle.dialog.style.visibility="visible"}else me.CloseHelperWithHandle(false,false,undefined,handle)})})}else{shim();appendToDom()}return evt}};D2L.LP.Web.UI.Common.MasterPages.Dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog={FileStore:{},GetFiles:function(id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog;var f=me.FileStore[id.GetValue()];if(f===undefined)return;return f},OpenDialog:function(openFunction,dialogId,callback){openFunction.call(openFunction).AddListener(function(files){if(files==null||files.length==0)return;var fileParams=[];for(var i=0;i<files.length;i++){var file=files[i];var fileParam=new D2L.LP.Web.UI.Files.File(file.FileId,
file.FileSystemType,file.FileName,file.Size);fileParams.push(fileParam)}var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.FileSelectorDialog;me.FileStore[dialogId.GetValue()]=fileParams;callback.call(callback)})}};
D2L.LP.Web.UI.Html.JavaScript.Alert=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,"d2l-dialog-inline-body-alert",function(){evt.Trigger(true)},null,function(){evt.Trigger(true)},openerId);return evt};
D2L.LP.Web.UI.Html.JavaScript.Info=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,"d2l-dialog-inline-body-info",function(){evt.Trigger(true)},null,function(){evt.Trigger(true)},openerId);return evt};
D2L.LP.Web.UI.Html.JavaScript.Confirm=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,openerId,testFunc){var evt=new D2L.LP.Web.UI.Events.Event;testFunc();D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,"d2l-dialog-inline-body-confirm",function(){evt.Trigger(true)},function(){evt.Trigger(false)},null,openerId);return evt};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.EquationEditor={CloseAndReturn:function(){var ret=new D2L.LP.Web.UI.Events.Event;var node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexeditor");if(node!=null)D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.GetAnnotatedMathML(node,function(mathml){window.setTimeout(function(){ret.Trigger(mathml)},500)});else{node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-equationeditor");D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetAnnotatedMathML(node,
function(mathml){window.setTimeout(function(){ret.Trigger(mathml)},500)})}return ret}};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline={Open:function(titleText,primaryMessage,secondaryMessage,primaryButtonText,secondaryButtonText,closeButtonText,iconClass,primaryButtonCallback,secondaryButtonCallback,abortCallback,openerId,id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var rootWin=window;while(true){if(rootWin.parent===rootWin||rootWin.D2L===undefined)break;rootWin=rootWin.parent}var handle={activeElement:document.activeElement,cont:null,shim:null,openerId:openerId,abortCallback:abortCallback,
rootWin:rootWin};var nodes=me.Build(handle,titleText,closeButtonText,iconClass,primaryMessage,secondaryMessage,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id);handle.cont=nodes.container;handle.shim=D2L.LP.Web.UI.Desktop.Controls.Shim.Create(nodes.container,false);nodes.container.d2l_handle=handle;rootWin.document.body.appendChild(nodes.container);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(rootWin);var scroll=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(rootWin);
var width=Math.min(nodes.bodyCont.offsetWidth,viewport.width*0.6);nodes.container.style.width=width+"px";nodes.container.style.left=(viewport.width-width)/2+"px";nodes.container.style.top=scroll.top+50+"px";nodes.anchorStart.focus()},Build:function(handle,titleText,closeButtonText,iconClass,primaryMessage,secondaryMessage,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback,id){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var titleNodes=me.BuildTitle(handle,
titleText,closeButtonText);var footerNodes=me.BuildFooter(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback);var anchorStart=handle.rootWin.document.createElement("a");anchorStart.onclick="return false;";D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorStart,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchorStart,function(){if(footerNodes.secondaryButton!==null)footerNodes.secondaryButton.focus();else if(footerNodes.primaryButton!==
null)footerNodes.primaryButton.focus();else{var result=D2L.LP.Web.UI.Html.Dom.GetPreviousFocusableElement(anchorStart);if(result)result.focus();else titleNodes.close.focus()}});var html="";if(primaryMessage!==null&&primaryMessage!==undefined&&primaryMessage.length>0)html="<p><b>"+primaryMessage+"</b></p>";if(secondaryMessage!==null&&secondaryMessage!==undefined&&secondaryMessage.length>0)html+="<p>"+secondaryMessage+"</p>";var bodyCont=handle.rootWin.document.createElement("div");if(iconClass!==null&&
iconClass!==undefined&&iconClass.length>0)iconClass=" d2l-dialog-inline-body-icon "+iconClass;else iconClass=" d2l-dialog-inline-body-noicon";bodyCont.className="d2l-dialog-inline-body"+iconClass;bodyCont.id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();bodyCont.innerHTML=html;var anchorEnd=handle.rootWin.document.createElement("a");anchorEnd.onclick="return false";D2L.LP.Web.UI.Html.Dom.SetAttribute(anchorEnd,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchorEnd,
function(){titleNodes.close.focus()});var inner=handle.rootWin.document.createElement("div");inner.className="d2l-dialog-inner d2l-font";inner.appendChild(anchorStart);inner.appendChild(titleNodes.cont);inner.appendChild(bodyCont);if(footerNodes.cont!==null)inner.appendChild(footerNodes.cont);inner.appendChild(anchorEnd);var cont=handle.rootWin.document.createElement("div");if(id)cont.id=id.GetValue();cont.className="d2l-dialog d2l-dialog-inline";D2L.LP.Web.UI.Html.Aria.SetRole(cont,"alertdialog");
D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,"describedby",bodyCont.id);D2L.LP.Web.UI.Html.Aria.SetAttribute(cont,"labelledby",titleNodes.title.id);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cont,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)me.AbortWithHandle(handle)});cont.appendChild(inner);D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitleHelper({isDragged:false},cont,titleNodes.cont,titleNodes.close,handle.rootWin,handle.rootWin);return{container:cont,
title:titleNodes.title,bodyCont:bodyCont,close:titleNodes.close,anchorStart:anchorStart}},BuildTitle:function(handle,titleText,closeButtonText){var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var title=handle.rootWin.document.createElement("h2");title.className="d2l-heading";title.innerHTML=titleText;title.id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();var closeButtonSpan=handle.rootWin.document.createElement("span");closeButtonSpan.className="d2l-offscreen";closeButtonSpan.innerHTML=
closeButtonText;var closeButton=handle.rootWin.document.createElement("a");closeButton.className="d2l-dialog-close";D2L.LP.Web.UI.Html.Aria.SetRole(closeButton,"button");D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.SetAttribute(closeButton,"onclick","return false;");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",closeButton,function(){me.AbortWithHandle(handle)});var innerSpan=handle.rootWin.document.createElement("span");innerSpan.appendChild(closeButtonSpan);
closeButton.appendChild(innerSpan);var cont=handle.rootWin.document.createElement("div");cont.className="d2l-dialog-title";cont.appendChild(title);cont.appendChild(closeButton);return{cont:cont,title:title,close:closeButton}},BuildFooter:function(handle,primaryButtonText,primaryButtonCallback,secondaryButtonText,secondaryButtonCallback){if((primaryButtonText===undefined||primaryButtonText===null||primaryButtonText.length===0)&&(secondaryButtonText===undefined||secondaryButtonText===null||secondaryButtonText.length===
0))return{cont:null,primaryButton:null,secondaryButton:null};var me=D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline;var buttonCont=handle.rootWin.document.createElement("div");buttonCont.className="d2l-dialog-buttons";var primaryButton=null;if(primaryButtonText!==undefined&&primaryButtonText!==null&&primaryButtonText.length>0){primaryButton=D2L.LP.Web.UI.Common.Controls.Button.Build(handle.rootWin.document);buttonCont.appendChild(primaryButton);D2L.LP.Web.UI.Common.Controls.Button.Init(primaryButton);
D2L.LP.Web.UI.Common.Controls.Button.SetIsPrimaryNode(primaryButton,true);D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(primaryButton,primaryButtonText);D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(primaryButton,function(){me.Close(handle);if(primaryButtonCallback!==null)primaryButtonCallback()})}var secondaryButton=null;if(secondaryButtonText!==undefined&&secondaryButtonText!==null&&secondaryButtonText.length>0){secondaryButton=D2L.LP.Web.UI.Common.Controls.Button.Build(handle.rootWin.document);
buttonCont.appendChild(secondaryButton);D2L.LP.Web.UI.Common.Controls.Button.Init(secondaryButton);D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(secondaryButton,secondaryButtonText);D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(secondaryButton,function(){me.Close(handle);if(secondaryButtonCallback!==null)secondaryButtonCallback()})}var clear=handle.rootWin.document.createElement("div");clear.className="d2l-clear";var footerCont=handle.rootWin.document.createElement("div");footerCont.className=
"d2l-dialog-footer";footerCont.appendChild(buttonCont);footerCont.appendChild(clear);return{cont:footerCont,primaryButton:primaryButton,secondaryButton:secondaryButton}},Close:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveElement(handle.cont);D2L.LP.Web.UI.Desktop.Controls.Shim.Delete(handle.shim);var opener=handle.activeElement;if(handle.openerId!==null)opener=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.openerId);D2L.LP.Web.UI.Html.Dom.FocusNode(opener)},Abort:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);
if(node===null||node.d2l_handle===undefined)return;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.AbortWithHandle(node.d2l_handle)},AbortWithHandle:function(handle){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Close(handle);if(handle.abortCallback!==null)handle.abortCallback()}};
D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InlineDialog=function(openerId,id,titleText,primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,positiveCallback,negativeCallback,abortCallback,positiveResult,negativeResult,abortResult){var evt=new D2L.LP.Web.UI.Events.Event;positiveResult=positiveResult==null?undefined:positiveResult;negativeResult=negativeResult==null?undefined:negativeResult;abortResult=abortResult==null?undefined:abortResult;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,
primaryMessage,secondaryMessage,positiveButtonText,negativeButtonText,abortButtonText,iconImageClassName,function(){if(positiveCallback)positiveCallback();evt.Trigger(positiveResult)},function(){if(negativeCallback)negativeCallback();evt.Trigger(negativeResult)},function(){if(abortCallback)abortCallback();evt.Trigger(abortResult)},openerId,id);return evt};
D2L.LP.Web.UI.Html.JavaScript.Warning=function(titleText,primaryMessage,secondaryMessage,primaryButtonText,closeButtonText,openerId){var evt=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Desktop.MasterPages.Dialog.Inline.Open(titleText,primaryMessage,secondaryMessage,primaryButtonText,null,closeButtonText,"d2l-dialog-inline-body-warning",function(){evt.Trigger(true)},null,function(){evt.Trigger(true)},openerId);return evt};
D2L.LP.Web.UI.Desktop.Controls.PageButtons={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var $node=$(node);var nodeHeight=$node.outerHeight();var $spacer=$('<div class="d2l-page-buttons-spacer"></div>').height(nodeHeight+"px").insertAfter(node);var handle={buttonHeight:$node.height(),extraWidth:$node.outerWidth(true)-$node.width(),$node:$node,$spacer:$spacer,$win:$(window),isFloating:false};var reposition=function(){me.Reposition(handle)};handle.$win.scroll(reposition).resize(reposition);
$(document).ready(reposition);var prevDocumentHeight=document.body.offsetHeight;setInterval(function(){var documentHeight=document.body.offsetHeight;if(prevDocumentHeight!==documentHeight)reposition();prevDocumentHeight=documentHeight},100)},SetIsFloating:function(handle,isFloating){if(handle.isFloating!==isFloating){handle.$spacer.toggleClass("d2l-page-buttons-float",isFloating);handle.$node.toggleClass("d2l-page-buttons-float",isFloating)}if(isFloating){var floatParent=handle.$node.parent();if(handle.$node.offset().top-
50<floatParent.offset().top){handle.$spacer.removeClass("d2l-page-buttons-float");handle.$node.removeClass("d2l-page-buttons-float");handle.isFloating=false;return}var extras=handle.$node.outerWidth(true)-handle.$node.width();var width=floatParent.width()-extras;handle.$node.width(width)}else handle.$node.width("auto");handle.isFloating=isFloating},Reposition:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.PageButtons;var docViewTop=handle.$win.scrollTop();var docViewBottom=docViewTop+handle.$win.height();
var documentHeight=$(document).height();var buttonPosition=handle.isFloating?handle.$spacer.position().top:handle.$node.position().top;if(buttonPosition+handle.buttonHeight+10<=docViewBottom||docViewBottom==documentHeight)me.SetIsFloating(handle,false);else me.SetIsFloating(handle,true)}};
D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane={Blur:function(context){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-hover",context.sidebar);if(!context.isOpen)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-shadow-hover",context.shadow);context.isOver=false},Close:function(context,evt){if(!context.isOpen)return;context.isOpen=false;context.ignoreClicks=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-shadow-open",context.shadow);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-open",
context.sidebar);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-opening",context.sidebar);context.shadow.title=context.expandText;context.handleLink.title=context.expandText;if(evt!==undefined&&evt.type==="click")context.handleLink.blur();if(!context.isOver)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-shadow-hover",context.shadow);D2L.LP.Web.UI.Html.Dom.FocusCycle.SetIsEnabled(context.focusCycleHandle,false);var timeoutTime=D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()?
400:0;clearTimeout(context.timeout);context.timeout=setTimeout(function(){if(!context.isOpen){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-collapsepane-visible",context.sidebar);var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(window);var minibarHeight=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetMinibarHeight(context);var scrollPos=D2L.LP.Web.UI.Html.Dom.GetScrollPosition(window);var pageRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-page-main",
context.container));var navAdjustment=Math.max(minibarHeight,pageRect.top-scrollPos.top);context.container.style.width="20px";context.container.style.minHeight=viewport.height-navAdjustment+"px"}},timeoutTime)},Hover:function(context){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-page-collapsepane-hover",context.sidebar);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-page-collapsepane-shadow-hover",context.shadow);context.isOver=true},Init:function(container){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;
var dom=D2L.LP.Web.UI.Html.Dom;var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var sidebar=dom.GetFirstElementByClassName("d2l-page-collapsepane",container);var handleLink=dom.GetFirstElementByClassName("d2l-page-collapsepane-handle-link",sidebar);var handleExpand=dom.GetFirstElementByClassName("d2l-page-collapsepane-handle-expand",handleLink);var handleCollapse=dom.GetFirstElementByClassName("d2l-page-collapsepane-handle-collapse",
handleLink);var end=dom.GetFirstElementByClassName("d2l-page-collapsepane-end",container);var context={collapseText:dom.GetTextContent(handleCollapse),container:container,expandText:dom.GetTextContent(handleExpand),focusCycleHandle:null,handle:dom.GetFirstElementByClassName("d2l-page-collapsepane-handle",sidebar),handleLink:handleLink,firstOpen:true,ignoreClicks:false,ignoreToggle:false,isOpen:false,isOver:false,isRtl:isRtl,minibar:dom.GetFirstElementByClassName("d2l-minibar-placeholder",document),
openFirstFunction:$(sidebar).attr("data-openfirst"),shadow:dom.GetFirstElementByClassName("d2l-page-collapsepane-shadow",container),shadowEdge:0,sidebar:sidebar,sidebarContentInner:dom.GetFirstElementByClassName("d2l-page-collapsepane-content-inner",sidebar),timeout:null};var blur=function(){me.Blur(context)};var hover=function(){me.Hover(context)};var onClick=function(evt){me.OnClick(context,evt)};var onFocus=function(){me.OnFocus(context)};var onKeyPress=function(arg){me.OnKeyPress(context,arg)};
var onScroll=function(){me.OnScroll(context)};var toggle=function(evt){me.Toggle(context,evt)};var swipe=function(evt){me.Swipe(context,evt)};context.handleLink.tabIndex=0;context.handleLink.title=context.expandText;D2L.LP.Web.UI.Html.Aria.SetRole(context.handleLink,"button");context.shadow.title=context.expandText;D2L.LP.Web.UI.Events.OnResize.AddListener(onScroll);D2L.LP.Web.UI.Events.OnScroll.AddListener(onScroll);D2L.LP.Web.UI.Events.OnClick.AddListener(onClick);D2L.LP.Web.UI.Events.OnKeyPress.AddListener(onKeyPress);
dom.AddEventListener("click",context.shadow,toggle);dom.AddEventListener("click",context.handle,toggle);dom.AddEventListener("mouseover",context.shadow,hover);dom.AddEventListener("mouseout",context.shadow,blur);dom.AddEventListener("focus",context.handleLink,hover);dom.AddEventListener("blur",context.handleLink,blur);dom.AddEventListener("focus",document.body,onFocus,true);me.AddSwipeListener(document.body,swipe);context.focusCycleHandle=D2L.LP.Web.UI.Html.Dom.FocusCycle.Init(context.handle,end);
onScroll();container.d2l_context=context},GetContext:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-page-collapsepane-container",node)){node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-page-collapsepane-container",node);if(node==null)return null}return node.d2l_context},GetMinibarHeight:function(context){var minibarHeight=0;if(context.minibar!==null){var minibarRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(context.minibar);minibarHeight=minibarRect.height}return minibarHeight},
AddSwipeListener:function(el,listener){var dom=D2L.LP.Web.UI.Html.Dom;var startX;var startY;var dx;var direction;var verticalThreshold=70;var horizontalThreshold=100;var cancelTouch=function(){dom.RemoveEventListener("touchmove",el,onTouchMove);dom.RemoveEventListener("touchend",el,onTouchEnd);startX=null;startY=null;direction=null;dx=null};var onTouchMove=function(e){if(e.touches.length!==1){cancelTouch();return}dx=e.touches[0].pageX-startX;var dy=e.touches[0].pageY-startY;if(direction==null)direction=
dx;else if(direction<0&&dx>0||direction>0&&dx<0||Math.abs(dy)>verticalThreshold)cancelTouch()};var onTouchEnd=function(){var sX=startX;var distanceX=dx;cancelTouch();if(Math.abs(distanceX)>horizontalThreshold)listener({target:el,direction:distanceX>0?"right":"left",startX:sX})};var onTouchStart=function(e){if(e.touches.length!==1)return;dx=null;startX=e.touches[0].pageX;startY=e.touches[0].pageY;dom.AddEventListener("touchmove",el,onTouchMove,false);dom.AddEventListener("touchend",el,onTouchEnd,false)};
dom.AddEventListener("touchstart",el,onTouchStart,false)},OnClick:function(context,evt){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;if(!context.isOpen||context.ignoreClicks)return;var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(context.sidebar,eventTarget))me.Close(context,evt)},OnFocus:function(context){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(context.sidebar,
activeNode))me.Close(context)},OnKeyPress:function(context,arg){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;var target=arg.GetTarget();if(target===undefined||target===null)return;var evt=arg.GetEventObject();var key=arg.GetKey();if(target===context.handleLink&&key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){me.Toggle(context,evt);return}if(context.isOpen&&arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){me.Close(context,evt);return}},OnScroll:function(context){var dom=
D2L.LP.Web.UI.Html.Dom;var scrollPos=dom.GetScrollPosition();var parentRect=dom.GetBoundingRect(context.container);var pageRect=dom.GetBoundingRect(dom.GetParentElementByClassName("d2l-page-main",context.container));var visibleWindowHeight=window.innerHeight||document.body.clientHeight;var minibarHeight=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetMinibarHeight(context);var containerTop=Math.max(pageRect.top,scrollPos.top+minibarHeight);var shadowTop=Math.max(pageRect.top,parentRect.top-scrollPos.top);
var maxHeight=Math.max(237,visibleWindowHeight-shadowTop-24);var navAdjustment=Math.max(minibarHeight,pageRect.top-scrollPos.top);context.sidebarContentInner.style.maxHeight=maxHeight+"px";context.container.style.minHeight=visibleWindowHeight-navAdjustment+"px";context.container.style.top=containerTop+"px";if(context.isRtl)context.shadowEdge=parentRect.right;else context.shadowEdge=parentRect.left},Open:function(context){if(context.isOpen)return;var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;
var dom=D2L.LP.Web.UI.Html.Dom;if(context.firstOpen){context.firstOpen=false;if(context.openFirstFunction!==undefined)eval(context.openFirstFunction)}context.isOpen=true;context.ignoreClicks=true;dom.AddClassName("d2l-page-collapsepane-opening",context.sidebar);dom.AddClassName("d2l-page-collapsepane-visible",context.sidebar);var container=dom.GetBoundingRect(context.sidebar);context.container.style.width=container.width+20+"px";context.container.style.minHeight=container.height+"px";D2L.LP.Web.UI.Html.Dom.FocusCycle.SetIsEnabled(context.focusCycleHandle,
true);me.OnScroll(context);context.shadow.title=context.collapseText;context.handleLink.title=context.collapseText;var timeoutTime=D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition()?400:0;clearTimeout(context.timeout);context.timeout=setTimeout(function(){if(!context.isOpen)return;context.ignoreClicks=false;dom.AddClassName("d2l-page-collapsepane-open",context.sidebar);dom.AddClassName("d2l-page-collapsepane-shadow-open",context.shadow)},timeoutTime)},Swipe:function(context,e){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;
var isRtl=context.isRtl;var edge=context.shadowEdge;if(e.direction=="left"&&!isRtl||e.direction=="right"&&isRtl){me.Close(context);return}if(e.direction=="right"&&!isRtl&&e.startX<edge+40||e.direction=="left"&&isRtl&&e.startX>edge-40){context.ignoreToggle=true;me.Open(context);setTimeout(function(){context.ignoreToggle=false},100)}},Toggle:function(context,evt){var me=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane;if(context.ignoreToggle)return;if(context.isOpen)me.Close(context,evt);else me.Open(context)}};
D2L.LP.Web.UI.Desktop.MasterPages.PageMessage={Close:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;node.style.opacity=0;setTimeout(function(){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);node.style.opacity=0;node.style.bottom="40px"},1500)},Open:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;node.style.zIndex=D2L.LP.Web.UI.Desktop.Controls.Shim.GetZIndex()+1E3;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,
true);setTimeout(function(){node.style.opacity=1;node.style.bottom="50px"},100)},Shake:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)return;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-page-message-shake",node);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-page-message-shake",node)},1E3)}};
D2L.LP.Web.UI.Common.MasterPages.Title={SetTitle:function(title,orgName){if(document.title)document.title=title+" - "+orgName;var titleBreadcrumbs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-page-breadcrumb-title");for(var i=0;i<titleBreadcrumbs.length;i++)D2L.LP.Web.UI.Desktop.Controls.Breadcrumbs.SetTextNode(titleBreadcrumbs[i],title);var heading=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-title");if(heading===null)return;if(heading.firstChild.nodeValue!==null)heading.firstChild.nodeValue=
title;else heading.firstChild.innerHTML=title}};D2L.LP.Web.UI.Common.MasterPages.Popup={Close:function(){window.close()}};
D2L.LP.Web.UI.Desktop.Controls.ActionContainer={GetSelectionInfo:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_selectionInfo},TryGetSelectionUpdatedEventByNode:function(node){var dataControlId=node.getAttribute("data-d2l-dataControlId");if(dataControlId==null)return;var dataControlNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataControlId);if(dataControlNode==null)return;var dataControlNS=eval(dataControlNode.getAttribute("data-d2l-actionable-ns"));if(dataControlNS==
null)return;var dataControlUpdatedEvent=dataControlNS.TryGetSelectionUpdatedEvent(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataControlId));return dataControlUpdatedEvent}};
D2L.LP.Web.UI.Desktop.Controls.AutoComplete={CloseContainer:function(handle){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",handle.containerNode))return;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",handle.containerNode);var selectedNode=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-autocomplete-item-hover",selectedNode);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",handle.sourceNode,handle.onSourceFocus);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,
"aria-expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.containerNode,"aria-hidden","true")},DisplayAndSetText:function(handle,itemNode){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(itemNode==null)itemNode=me.FindMatch(handle);if(itemNode==null&&!handle.forceSelection){handle.sourceNode.value=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,handle.sourceNode.value);handle.text=handle.sourceNode.value;handle.key=""}else{var item=me.GetSearchTextElement(itemNode);var text=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,
"data-d2l-displaytext");var key=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-key");handle.sourceNode.value=text;handle.text=text;handle.key=key}handle.valueHidden.value=handle.text;handle.valueKey.value=handle.key;handle.lastSearch=null;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,"aria-activedescendant");me.FireChangeEvent(handle)},DisplayMessage:function(handle,isContainerVisible){var messageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-message",handle.containerNode)[0];
var message;var node;if(isContainerVisible){node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-autocomplete-invisible",node);if(handle.displayResultsMessage){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",messageNode);message=D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,"data-d2l-resultsmessage");message=message.split("{0}").join(handle.numberMatches);messageNode.innerHTML=message.split("{1}").join(handle.totalResults)}else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",
messageNode)}else if(handle.displayNoResultsMessage){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",messageNode);message=D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,"data-d2l-noresultsmessage");messageNode.innerHTML=message.split("{0}").join(handle.text);node=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-autocomplete-invisible",node)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",messageNode);D2L.LP.Web.UI.Desktop.Controls.AutoComplete.CloseContainer(handle)}},
DisplayText:function(handle,itemNode){var item=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(itemNode);var text=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-displaytext");handle.sourceNode.value=text;D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"aria-activedescendant",itemNode.id)},Encode:function(text){text=text.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;");text=text.replace(/\[/g,"<").replace(/]/g,">");
return text},FindMatch:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);var text=handle.sourceNode.value.toLowerCase();for(var i=0;i<items.length;i++){var item=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(items[i]);var searchText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-searchtext").toLowerCase();var displayText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-displaytext").toLowerCase();if(text==searchText||text==displayText)return items[i]}return null},
FireChangeEvent:function(handle){if("fireEvent"in handle.sourceNode)handle.sourceNode.fireEvent("onchange");else{var evt=document.createEvent("HTMLEvents");evt.initEvent("change",false,true);handle.sourceNode.dispatchEvent(evt)}},GetDataAttribute:function(node,attribute){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,attribute))return null;var value=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,attribute);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,attribute);if(value.toLowerCase()==="true")value=true;else if(value.toLowerCase()===
"false")value=false;return value},GetForceSelection:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetHandle(id);return handle.forceSelection},GetHandle:function(nodeId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId.GetValue());return node.handle},GetItems:function(handle){var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-item",handle.containerNode);return items},GetSearchTextElement:function(itemNode){var item=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-searchtext",
itemNode)[0];return item},GetSelectedItem:function(containerId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(containerId.GetValue());var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-hidden",node)[0];var valueNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddenNode);var keyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(valueNode);var param=new D2L.LP.Web.UI.Desktop.Controls.AutoComplete.SelectionInfo(valueNode.value,keyNode.value);return param},GetSelectedItemNode:function(handle){var selectedNode=
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-item-hover",handle.containerNode)[0];if(selectedNode)return selectedNode;var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);for(var i=0;i<items.length;i++){var searchTextNode=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetSearchTextElement(items[i]);var searchText=D2L.LP.Web.UI.Html.Dom.GetAttribute(searchTextNode,"data-d2l-searchtext");if(searchText==handle.text)return items[i]}},HandleKeyNavigation:function(handle,
goUp){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var items=me.GetItems(handle);var GetSelectedIndex=function(){var selected=me.GetSelectedItemNode(handle);var index=-1;for(var i=0;i<items.length;i++)if(items[i]===selected)index=i;return index};var selectedIndex=GetSelectedIndex(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-autocomplete-item-hover",items[selectedIndex]);var nextItem=null;if(goUp){if(selectedIndex===-1)selectedIndex=items.length;for(var i=--selectedIndex;i>=0;i--)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
items[i])&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-item",items[i])){nextItem=items[i];break}}else for(var i=++selectedIndex;i<items.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",items[i])&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-item",items[i])){nextItem=items[i];break}var div=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);if(nextItem!==null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-autocomplete-item-hover",nextItem);me.DisplayText(handle,
nextItem);var divBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(div);var itemBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(nextItem);if(itemBox.bottom>divBox.bottom)div.scrollTop+=itemBox.bottom-divBox.bottom;if(itemBox.top<divBox.top)div.scrollTop-=divBox.top-itemBox.top}else{me.ResetText(handle);div.scrollTop=0}},Highlight:function(text,start,length){if(length==0||length+start>text.length)return"";var a=text.split("");var result="";var countdown=false;for(var i=0;i<a.length;i++){if(i==start){result+="[b]";
countdown=true}result+=a[i];if(countdown)length--;if(length==0)result+="[/b]"}return result},InitHandle:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle={containerNode:node,sourceNode:null,placeholderNode:null,valueHidden:null,keyHidden:null,text:"",key:"",activeDescendant:null,threshold:1,hasHeaders:false,displayResultsMessage:false,displayNoResultsMessage:false,forceSelection:false,onSourceFocus:null,queryDelay:150,keyPressTimeout:null,onItemSelected:null,matchWidthId:null,
totalResults:0,numberMatches:0,removeMode:false};var sourceId=me.GetDataAttribute(handle.containerNode,"data-d2l-source");handle.sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sourceId);handle.text=handle.sourceNode.value;handle.placeholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-hidden",handle.containerNode)[0];handle.valueHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddenNode);handle.valueKey=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(handle.valueHidden);if(handle.text!=null){handle.valueHidden.value=handle.text;handle.valueKey.value=-1}handle.displayResultsMessage=me.GetDataAttribute(handle.containerNode,"data-d2l-displayresultsmessage");handle.displayNoResultsMessage=me.GetDataAttribute(handle.containerNode,"data-d2l-displaynoresultsmessage");handle.forceSelection=me.GetDataAttribute(handle.containerNode,"data-d2l-forceselection");handle.hasHeaders=me.GetDataAttribute(node,"data-d2l-hasheaders");
handle.threshold=me.GetDataAttribute(handle.containerNode,"data-d2l-threshold");handle.matchWidthId=me.GetDataAttribute(node,"data-d2l-width");handle.onItemSelected=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.containerNode.id,"itemSelected");handle.removeMode=me.GetDataAttribute(node,"data-d2l-removemode");var items=me.GetItems(handle);if(items.length!=0){handle.totalResults=items.length;handle.numberMatches=items.length}node.handle=handle;return handle},Initialize:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;
me.InstallMouseSupport(handle);me.InstallItemMouseSupport(handle);me.InstallKeyboardSupport(handle);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",handle.sourceNode,function(e){var target=e.explicitOriginalTarget||document.activeElement;if(target==handle.placeholderNode){handle.sourceNode.focus();return}me.CloseContainer(handle);if(me.FindMatch(handle)||!handle.forceSelection){me.DisplayAndSetText(handle);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){var itemNode=
me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,"data-d2l-added","");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",itemNode)}handle.onItemSelected()}}else me.ResetText(handle,true)});D2L.LP.Web.UI.Html.Dom.AddEventListener("paste",handle.sourceNode,function(){setTimeout(function(){me.SetText(handle);handle.processFunction(handle)},0)});handle.onSourceFocus=function(){me.SetText(handle);handle.processFunction(handle);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",
handle.sourceNode,handle.onSourceFocus)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",handle.sourceNode,handle.onSourceFocus);var items=me.GetItems(handle);for(var i=0;i<items.length;i++){var headers=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-headertextitem",items[i]);if(headers!=null&&headers[0]!=null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-autocomplete-headeritem",items[i]);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-autocomplete-item",items[i]);D2L.LP.Web.UI.Html.Dom.SetAttribute(headers[0],
"role","heading");handle.hasHeaders=true}}if(handle.hasHeaders){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-autocomplete-headers",handle.containerNode);handle.totalResults=me.GetItems(handle).length}D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"autocomplete","off");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"role","combobox");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"aria-autocomplete","list");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"aria-expanded","false");
D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"aria-owns",handle.containerNode.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"tabindex",0)},InstallItemMouseSupport:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var items=me.GetItems(handle);var MouseOverItem=function(e){var item;if(e.currentTarget)item=e.currentTarget;else{item=e.srcElement;if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-item",item))item=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-autocomplete-item",
item)}if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-item",item))return;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-autocomplete-item-hover",item)};for(var i=0;i<items.length;i++){D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",items[i],MouseOverItem);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",items[i],function(){var item=me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-autocomplete-item-hover",item)})}},ClearEntry:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetHandle(id);
handle.text="";handle.key=""},InstallKeyboardSupport:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var commitChoice=function(){if(me.FindMatch(handle)||!handle.forceSelection){me.DisplayAndSetText(handle);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){var itemNode=me.GetSelectedItemNode(handle);D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,"data-d2l-added","");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",itemNode)}handle.onItemSelected()}}else me.ResetText(handle,
true)};var onSourceKeyUp=function(kpArgs){var keys=D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key;var key=kpArgs.GetKey();if(key===keys.ArrowDown){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",handle.containerNode))handle.processFunction(handle);else me.HandleKeyNavigation(handle,false);me.SetText(handle)}else if(key===keys.ArrowUp){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",handle.containerNode))me.HandleKeyNavigation(handle,true)}else if(key===keys.Enter){commitChoice();me.CloseContainer(handle)}else if(key===
keys.Escape){me.CloseContainer(handle);me.ResetText(handle)}else if(key!=keys.Tab&&key!=keys.Shift&&key!=keys.Control&&key!=keys.ArrowLeft&&key!=keys.ArrowRight&&key!=keys.Home&&key!=keys.End){me.SetText(handle);if(handle.keyPressTimeout)clearTimeout(handle.keyPressTimeout);handle.keyPressTimeout=setTimeout(function(){handle.processFunction(handle,true)},handle.queryDelay)}};D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener(handle.sourceNode,function(kpArgs){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(kpArgs.m_event);
D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.m_event);onSourceKeyUp(kpArgs)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(handle.sourceNode,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){me.CloseContainer(handle);handle.sourceNode.focus()}});D2L.LP.Web.UI.Html.Dom.AddEventListener("keydown",handle.sourceNode,function(e){if(e.keyCode===38||e.keyCode===40)D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e)})},InstallMouseSupport:function(handle){var me=
D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var MouseDownItem=function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);if(target!=handle.placeholderNode){var itemNode=me.GetSelectedItemNode(handle);if(itemNode==null)return;me.DisplayAndSetText(handle,itemNode);if(handle.onItemSelected&&handle.text.length>0){if(handle.removeMode&&handle.forceSelection){D2L.LP.Web.UI.Html.Dom.SetAttribute(itemNode,
"data-d2l-added","");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",itemNode)}handle.onItemSelected()}me.CloseContainer(handle)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",handle.containerNode,MouseDownItem)},OpenContainer:function(handle){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",handle.containerNode))return;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",handle.containerNode);D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ResizeContainer(handle);handle.sourceNode.focus();
D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.sourceNode,"aria-expanded","true");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.containerNode,"aria-hidden","false")},ResizeContainer:function(handle){var listContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listContainerNode);if(!listContainerNode.style.minWidth){var maxItemWidth=Math.max(listContainerNode.offsetWidth,listContainerNode.scrollWidth)+20;var sourceControlWidth=
handle.sourceNode.offsetWidth-12;if(handle.matchWidthId){var matchWidthNode=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.matchWidthId);sourceControlWidth=matchWidthNode.clientWidth-12}var listWidth=sourceControlWidth>=maxItemWidth?sourceControlWidth:maxItemWidth+24;listContainerNode.style.minWidth=listWidth+"px";listNode.style.minWidth=listWidth-(listContainerNode.offsetWidth-listContainerNode.clientWidth+1)+"px"}},ResetText:function(handle,clear){if(clear){handle.text="";handle.key=""}handle.sourceNode.value=
handle.text;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,"aria-activedescendant");D2L.LP.Web.UI.Desktop.Controls.AutoComplete.FireChangeEvent(handle)},SetText:function(handle){var changed=handle.text!==handle.sourceNode.value;handle.text=handle.sourceNode.value;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(handle.sourceNode,"aria-activedescendant");if(changed)D2L.LP.Web.UI.Desktop.Controls.AutoComplete.FireChangeEvent(handle)},ShowItemByKey:function(id,key){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-item",node);for(var i=0;i<items.length;i++)if(D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],"data-d2l-added")){var textNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-searchtext",items[i])[0];var itemKey=D2L.LP.Web.UI.Html.Dom.GetAttribute(textNode,"data-d2l-key");if(key==itemKey){D2L.LP.Web.UI.Html.Dom.RemoveAttribute(items[i],"data-d2l-added");break}}},HideItemByKey:function(id,key){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-item",node);for(var i=0;i<items.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],"data-d2l-added")){var textNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-searchtext",items[i])[0];var itemKey=D2L.LP.Web.UI.Html.Dom.GetAttribute(textNode,"data-d2l-key");if(key==itemKey){D2L.LP.Web.UI.Html.Dom.SetAttribute(items[i],"data-d2l-added");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",items[i]);break}}}};
D2L.LP.Web.UI.Desktop.Controls.AutoComplete.SelectionInfo=D2L.Class.Create({Construct:function(value,key){this.m_value=value;this.m_key=key},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("value");this.m_key=deserializer.GetMember("key")},_serialize:function(serializer){serializer.AddMember("value",this.m_value);serializer.AddMember("key",this.m_key)},GetValue:function(){return this.m_value},GetKey:function(){return this.m_key}});
D2L.LP.Web.UI.Desktop.Controls.AutoComplete.Static={Filter:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.sourceNode.value.length<handle.threshold){me.CloseContainer(handle);return}me.OpenContainer(handle);var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-item",handle.containerNode);for(var i=0;i<items.length;i++){var item=me.GetSearchTextElement(items[i]);var displayText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-searchtext");if(displayText.toLowerCase().indexOf(handle.text.toLowerCase())==
-1)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",items[i]);else{if(D2L.LP.Web.UI.Html.Dom.HasAttribute(items[i],"data-d2l-added"))continue;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",items[i]);if(handle.text.length>0){var start=displayText.toLowerCase().indexOf(handle.text.toLowerCase());displayText=me.Highlight(displayText,start,handle.text.length)}displayText=me.Encode(displayText);item.innerHTML=displayText}}me.Static.RemoveHeaders(handle);var showContainer=me.Static.HasMatches(handle);
if(handle.displayNoResultsMessage||handle.displayResultsMessage)me.DisplayMessage(handle,showContainer);else if(!showContainer)me.CloseContainer(handle)},HasMatches:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetItems(handle);handle.numberMatches=0;for(var i=0;i<items.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",items[i]))handle.numberMatches++;if(handle.numberMatches==0)return false;return true},RemoveHeaders:function(handle){if(handle.hasHeaders){var headers=
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-headeritem",handle.containerNode);for(var i=0;i<headers.length;i++){var currentNode=headers[i];while(true){var sibling=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(currentNode);if(sibling==null||D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-headeritem",sibling)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",headers[i]);break}else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-autocomplete-item",sibling)&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
sibling)){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",headers[i]);break}currentNode=sibling}}}}};
D2L.LP.Web.UI.Desktop.Controls.AutoComplete.Dynamic={GetValue:function(sourceId){var sourceNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sourceId.GetValue());var text=sourceNode.value;return text},PartialFunction:function(handle,keyPressed){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.lastSearch==handle.text&&!keyPressed){me.OpenContainer(handle);return}if(handle.sourceNode.value.length>=handle.threshold){var reloadFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.containerNode.id,
"reload");var result=reloadFunction();result.AddListener(function(){me.InstallItemMouseSupport(handle);var items=me.GetItems(handle);handle.lastSearch=handle.text;var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.placeholderNode);handle.totalResults=me.GetDataAttribute(listNode,"data-d2l-totalresults");me.Dynamic.GetMessages(handle);if(items.length!=0)handle.numberMatches=items.length;if(items.length==0){me.DisplayMessage(handle,false);if(handle.displayNoResultsMessage)me.OpenContainer(handle)}else{me.DisplayMessage(handle,
true);me.Dynamic.IsResizeNeeded(handle);me.Dynamic.HighlightResults(handle,items);me.OpenContainer(handle)}})}else me.CloseContainer(handle)},HighlightResults:function(handle,items){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;if(handle.highlight&&handle.sourceNode.value.length>0)for(var i=0;i<items.length;i++){var item=me.GetSearchTextElement(items[i]);var displayText=D2L.LP.Web.UI.Html.Dom.GetAttribute(item,"data-d2l-searchtext");var start=displayText.toLowerCase().indexOf(handle.text.toLowerCase());
displayText=me.Highlight(displayText,start,handle.text.length);displayText=me.Encode(displayText);item.innerHTML=displayText}},IsResizeNeeded:function(handle){var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var width=Math.max(listNode.offsetWidth,listNode.scrollWidth);if(width>parseInt(listNode.style.minWidth,10)+2){listNode.style.minWidth="";D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ResizeContainer(handle)}},GetMessages:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;
var placeholder=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(handle.containerNode);var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(placeholder);var messageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-autocomplete-message",handle.containerNode)[0];var noResultsMessage=me.GetDataAttribute(listNode,"data-d2l-noresultsMessage");var resultsMessage=me.GetDataAttribute(listNode,"data-d2l-resultsMessage");if(noResultsMessage!=null)D2L.LP.Web.UI.Html.Dom.SetAttribute(messageNode,"data-d2l-noresultsmessage",
noResultsMessage);if(resultsMessage!=null)D2L.LP.Web.UI.Html.Dom.SetAttribute(messageNode,"data-d2l-resultsmessage",resultsMessage)}};D2L.LP.Web.UI.Desktop.Controls.Breadcrumbs={SetTextNode:function(node,text){var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-breadcrumb-text",node);if(!textNode)return;while(textNode.firstChild)textNode.removeChild(textNode.firstChild);textNode.appendChild(document.createTextNode(text))}};
D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox={AdjustAria:function(nodes){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var isSelected=me.GetIsSelectedNode(nodes.hidden);D2L.LP.Web.UI.Html.Aria.SetAttribute(nodes.node,"checked",isSelected);var textNode=nodes.text;if(isSelected&&nodes.textSelected!==undefined)textNode=nodes.textSelected;D2L.LP.Web.UI.Html.Aria.SetAttribute(nodes.node,"labelledby",textNode.id)},GetNodes:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
if(node===null)throw"ButtonCheckbox not found: '"+id.GetValue()+"'.";return D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox.GetNodesNode(node)},GetNodesNode:function(node){var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var textNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-button-checkbox-text",node);var ret={node:node,hidden:hidden,text:textNodes[0],textSelected:undefined};if(textNodes.length===2)ret.textSelected=textNodes[1];return ret},GetIsSelected:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;
var nodes=me.GetNodes(id);var isSelected=me.GetIsSelectedNode(nodes.hidden);return isSelected},GetIsSelectedNode:function(hiddenNode){var isSelected=hiddenNode.value==="1";return isSelected},SetIsSelected:function(id,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var nodes=me.GetNodes(id);if(isSelected==me.GetIsSelectedNode(nodes.hidden))return;nodes.hidden.value=isSelected?"1":"0";me.AdjustAria(nodes);if(isSelected){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-checkbox-selected",
nodes.node);if(nodes.textSelected!==undefined){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",nodes.textSelected);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",nodes.text)}}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-checkbox-selected",nodes.node);if(nodes.textSelected!==undefined){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",nodes.text);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",nodes.textSelected)}}var buttonId=id.GetValue();if(D2L.LP.Web.UI.ObjectRepository.HasKey(buttonId)){var onClick=
D2L.LP.Web.UI.ObjectRepository.Get(buttonId,0);if(onClick!==null)onClick.call(onClick)}},GetSelectedValues:function(groupName){var values=[];var groupNameId=groupName.GetValue();var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByName(groupName.GetValue());for(var i=0;i<inputs.length;i++){var valueNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(inputs[i]);var isSelectedNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(valueNode);if(isSelectedNode.value=="1")values.push(valueNode.value)}return values}};
D2L.LP.Web.UI.Desktop.Controls.ButtonFilterGroup={SetSelectedItem:function(itemId,triggerOnClick){var anchorNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(anchorNode===null)throw"ButtonFilterGroup.SetSelectedItem error: item not found '"+itemId.GetValue()+"'.";var anchorNodes=anchorNode.parentNode.parentNode.getElementsByTagName("a");for(var i=0;i<anchorNodes.length;i++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-filter-selected",anchorNodes[i]);if(triggerOnClick)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",
anchorNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-filter-selected",anchorNode)},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var anchorNodes=node.getElementsByTagName("a");for(var i=0;i<anchorNodes.length;i++){var idValue=anchorNodes[i].getAttribute("id");var anchorId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(idValue);D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(anchorId,isEnabled)}}};
D2L.LP.Web.UI.Desktop.Controls.ButtonMenu={Init:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonMenu;var dom=D2L.LP.Web.UI.Html.Dom;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"haspopup","true");D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var contextMenuId=dom.GetAttribute(node,
"data-contextMenuId");D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InitPlaceholder(node,contextMenuId,"d2l-button-menu-hover");var onClick=dom.GetAttribute(node,"data-onclick");dom.RemoveAttribute(node,"data-onclick");dom.AddEventListener("click",node,function(){isDisabled=!me.IsEnabledNode(node);if(isDisabled)return;eval(onClick)})},IsEnabledNode:function(node){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);return!isDisabled},SetItemIsEnabled:function(id,key,isEnabled){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var contextMenuId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-contextMenuId");D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetItemIsEnabled(D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(contextMenuId),key,isEnabled)},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",node);if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,
"disabled",!isEnabled);if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-disabled",node);D2L.LP.Web.UI.Desktop.Controls.ContextMenu.SetIsEnabled(id,isEnabled)}};
D2L.LP.Web.UI.Desktop.Controls.ButtonSplit={GetButtonNode:function(id){var button=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(button===null)throw"ButtonSplit not found: '"+id+"'.";return button},SetSelectedItem:function(buttonSplitId,itemKey){var id=buttonSplitId.GetValue();var buttonId=id+"_"+itemKey;var me=D2L.LP.Web.UI.Desktop.Controls.ButtonSplit;var button=me.GetButtonNode(id);var buttons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("vui-button",button);for(var i=0;i<buttons.length;i++){var isSelected=
buttons[i].id==buttonId;D2L.LP.Web.UI.Common.Controls.Button.SetIsVisibleNode(buttons[i],isSelected);if(isSelected)D2L.LP.Web.UI.Common.Controls.Button.ClickNode(buttons[i])}},SetIsEnabled:function(buttonSplitId,isEnabled){var id=buttonSplitId.GetValue();var me=D2L.LP.Web.UI.Desktop.Controls.ButtonSplit;var button=me.GetButtonNode(id);if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-disabled",button);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-disabled",button);var buttons=
D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("vui-button",button);for(var i=0;i<buttons.length;i++)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(buttons[i],isEnabled);var buttonMenuId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(id+"_menu");D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.SetIsEnabled(buttonMenuId,isEnabled)}};
D2L.LP.Web.UI.Desktop.Controls.CalendarMini={SetFocus:function(id,ariaMessage){var miniCalPlaceholder=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!miniCalPlaceholder)return;var miniCal=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",miniCalPlaceholder);if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-restoreColumn")){var startFromBottom=true;if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-startFromBottom")){startFromBottom=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,
"data-startFromBottom");startFromBottom=startFromBottom=="true";D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-startFromBottom")}var restoreColumn=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,"data-restoreColumn")-0;D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-restoreColumn");miniCal.navRestoreColumnFocus(restoreColumn,startFromBottom)}else if(D2L.LP.Web.UI.Html.Dom.HasAttribute(miniCalPlaceholder,"data-restoreDate")){var restoreDay=D2L.LP.Web.UI.Html.Dom.GetAttribute(miniCalPlaceholder,
"data-restoreDate");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(miniCalPlaceholder,"data-restoreDate");miniCal.navFocusDay(restoreDay)}else miniCal.navFocusDay(1);if(ariaMessage!==undefined&&ariaMessage!==null)D2L.LP.Web.UI.Html.Aria.LogMessage(ariaMessage)}};
D2L.LP.Web.UI.Desktop.Controls.CheckboxList={CascadeOptions:{None:0,CheckOnly:1,UncheckOnly:2,Both:3},CascadeSelection:function(node,cascadeOption){if(cascadeOption===undefined||cascadeOption===null||cascadeOption==this.CascadeOptions.None)return;var checkBox=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetCheckboxNode(node);var childList=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-checkboxlist",node);if(childList===undefined||childList===null)return;if(cascadeOption==this.CascadeOptions.EnableOnly&&
checkBox.checked||cascadeOption==this.CascadeOptions.DisableOnly&&!checkBox.checked||cascadeOption==this.CascadeOptions.Both)this.SetIsAllSelectedByNode(childList,checkBox.checked)},GetCheckboxNode:function(itemNode){var checkbox=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-checkbox",itemNode);if(checkbox===undefined||checkbox===null)return null;return checkbox},GetSelectedValues:function(id,includeNestedLists){var itemNodes=this.GetItemsNodes(id,includeNestedLists);var values=[];for(var i=
0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.checked)values.push(checkboxNode.value)}return values},GetItemsNodes:function(id,includeNestedLists){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return this.GetItemsNodesByNode(node,includeNestedLists)},GetItemsNodesByNode:function(node,includeNestedLists){var checkBoxes;if(includeNestedLists===undefined||includeNestedLists===null)includeNestedLists=false;if(!includeNestedLists)checkBoxes=
D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName("d2l-checkboxlist-item",node);else checkBoxes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-checkboxlist-item",node);return checkBoxes},SetIsAllSelected:function(id,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return this.SetIsAllSelectedByNode(node,isSelected)},SetIsAllSelectedByNode:function(node,isSelected){var itemNodes=this.GetItemsNodesByNode(node,false);var excludeDisabled=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,
"data-excludeDisabled");excludeDisabled=excludeDisabled=="true";for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!(checkboxNode.disabled&&excludeDisabled)){D2L.LP.Web.UI.Common.Controls.Checkbox.SetIsChecked(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(checkboxNode.id),isSelected);D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",checkboxNode)}}},SetIsSelected:function(id,value,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var excludeDisabled=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-excludeDisabled");if(excludeDisabled===undefined||excludeDisabled===null)excludeDisabled=false;var cascadeSelection=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-cascadeSelection");if(cascadeSelection===undefined||cascadeSelection===null)cascadeSelection=false;var itemNodes=this.GetItemsNodes(id,false);for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.value==
value&&!(node.disabled&&excludeDisabled)){D2L.LP.Web.UI.Common.Controls.Checkbox.SetIsChecked(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(checkboxNode.id),isSelected);if(cascadeSelection)this.CascadeSelection(node);return}}},SetIsAllEnabled:function(id,isEnabled){var itemNodes=this.GetItemsNodes(id,false);for(var i=0;i<itemNodes.length;i++){var checkboxNode=this.GetCheckboxNode(itemNodes[i]);D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(checkboxNode,isEnabled)}},GetIsAnySelectedFunction:function(id){return D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetSelectedValues(id).length>
0}};
D2L.LP.Web.UI.Desktop.Controls.ColourSelector={RegexpNumbersAndComma:/[^0-9\-,]/g,RegexpHexCode:/#([0-9a-fA-F]){6}/,RegexpRgb:/rgb\(([0-9]{1,3}\u002c?\s?){3}\)/,RecentColours:"",ColourLookupTable:[],DefaultBgColour:"#ffffff",DefaultFgColour:"#000000",SaveRcListSubkey:"saveRcListFunc",Init:function(node){var cp_hidden_defaultValue=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var cp_hidden_value=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_hidden_defaultValue);var cp_hidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",node);
var cp_hidden_otherColour=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-othercolour",node);var cp_dialog_form=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-form",node);var cp_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-button",node);var cp_button_colourBox;var cp_floating_container;if(cp_button!=null){cp_button_colourBox=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-colourbox",cp_button);cp_floating_container=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_button)}var cp_nav_matrix=new Array;var cp_recentColourNodes;var cp_titlebar_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-titlebar-cont",node);var cp_colourpalette=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette",node);var cp_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-cont",node);var cp_basic_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-basic-cont",
node);var cp_linebreak=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-linebreak",cp_basic_cont);var cp_adv_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-adv-cont",node);var cp_okcancel_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-okcancel",node);var cp_more_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-more",node);var cp_noColourOption=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-nocolour",
node);var cp_more_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-moreoptions",node);var cp_ok_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-ok",node);var cp_cancel_button=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-nav-cancel",node);var cp_slider_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-cont",node);var cp_slider_gradient=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-gradient",
node);var cp_slider_arrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-arrow",node);var cp_slider_label=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-label",node);var cp_slider_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-slider-input",node);var cp_hex_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-hex-input",node);var cp_adv_preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-previewbox",
node);var cp_adv_preview_smalltext=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-previewbox-smalltext",cp_adv_preview);var cp_adv_preview_largetext=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-previewbox-largetext",cp_adv_preview);var cp_wcag_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-cont",node);var cp_wcag_status_image=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-status-image",node);var cp_wcag_status_error;
var cp_wcag_status_warning;var cp_wcag_status_pass;if(cp_wcag_status_image!=null){cp_wcag_status_error=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_wcag_status_image);cp_wcag_status_warning=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_wcag_status_error);cp_wcag_status_pass=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_wcag_status_warning)}var cp_wcag_contrast_label=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-label",node);var cp_wcag_contrast_ratio=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-ratio",
node);var cp_wcag_accessible_ratio=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-accessible-ratio",node);var cp_getLcpValueSubkey="getLcpIdFunc";var getLinkedColourSelectorValueFunc=D2L.LP.Web.UI.ObjectRepository.Get(node.id,cp_getLcpValueSubkey);var linkedColourSelectorId=getLinkedColourSelectorValueFunc();var cp_lcpNode=D2L.LP.Web.UI.Html.Dom.GetElementById(linkedColourSelectorId);var cp_lcpButton;var cp_lcpHidden_defaultValue;var cp_lcpHidden_value;var cp_lcpHidden_type;
if(cp_lcpNode!=null){cp_lcpButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-button",cp_lcpNode);cp_lcpHidden_defaultValue=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_lcpNode);cp_lcpHidden_value=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(cp_lcpHidden_defaultValue);cp_lcpHidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",cp_lcpNode)}if(cp_lcpNode==null&&cp_hidden_otherColour==null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",
cp_wcag_cont);var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var cp_shiftDown=false;var cp_isPaletteOpen=false;var cp_numElementsPerRow=9;var cp_nav_currRow=0;var cp_nav_currCol=0;var cp_isAdvancedMode=cp_button==null;var cp_isForegroundMode=false;var cp_contrast_ratio_addspace=true;var cp_hexInput_label_addspace=true;var cp_basicModeWidth="21em";var cp_advModeWidth="42em";var cp_colourboxClassName="d2l-colourpalette-colourbox-a";
var cp_recentColourClassName="d2l-colourselector-nav-recentcolours";var cp_default_color=cp_hidden_type.value=="Background"?"#ffffff":"#000000";var cp_slider_rgb={r:255,g:255,b:255};var cp_slider_rgb_other={r:0,g:0,b:0};var cp_slider_hsl={h:0,s:0,l:0};var cp_slider_position={x:25,y:96};var cp_slider_posyclamp={min:-4,max:196};var cp_slider_posyrate=2;var cp_slider_max=100;var cp_nav_moreButtonRow=0;var cp_slider_mouseDown=false;var cp_slider_offsetY=0;var cp_regexp_numbers=/[^0-9\-]/g;var cp_wcag_failMarker=
3;var cp_wcag_warningMarker=4.5;var cp_wcag_correctMarker=4.5;var cp_initializeColourSelectorDialog;var cp_setBasicMode;var cp_setAdvancedMode;var cp_openContainer;var cp_closeContainer;var cp_button_clickHandler;var cp_nav_matrixBoundaryCheck;var cp_nav_focusNode;var cp_nav_resetRowColumn;var cp_nav_checkButtonSkip;var cp_setPreviewBoxColour;var cp_setColourSelectorColour;var cp_getEventTarget;var cp_getElementClassName;var cp_hasClassName;var cp_setLcpRgb;var cp_trim;var cp_setHexInput;var cp_setLightnessValue;
var cp_setContrastRatio;var cp_slider_getLValue;var cp_slider_updateHex;var cp_slider_updateRgb;var cp_slider_updateHsl;var cp_nav_arrowUpHandler;var cp_nav_arrowDownHandler;var cp_nav_arrowLeftHandler;var cp_nav_arrowRightHandler;var cp_nav_escapeHandler;var cp_nav_onKeyPress;var cp_nav_onKeyUp;var cp_onKeyPress;var cp_colourPaletteClick;var cp_cancelButtonHandler;var cp_moreButtonHandler;var cp_nav_onShiftPress;var cp_okButtonHandler;var cp_slider_updateWcagImage;var cp_handleHexChange;var cp_handleHslChange;
var cp_handleHslSliderChange;var cp_slider_arrowUpHandler;var cp_slider_arrowDownHandler;var cp_slider_handleMouse;var cp_slider_onKeyPress;var cp_set_nohover;var cp_set_hover;var cp_reset_hover;var cp_addHover;var cp_removeHover;var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return cp_hidden_value.value});var index;cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",
node);cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_currRow=0;cp_nav_currCol=0;for(index=0;index<cp_recentColourNodes.length;index++){if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currRow++;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_currCol=0}cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_recentColourNodes[index];cp_nav_currCol++}if(cp_noColourOption!==null){cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);
for(cp_nav_currCol=0;cp_nav_currCol<cp_numElementsPerRow;cp_nav_currCol++)cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_noColourOption}var cp_colourOptionNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-colouroptions",node);cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);for(index=0;index<cp_colourOptionNodes.length;index++){if(cp_nav_currCol>=cp_numElementsPerRow){cp_nav_currRow++;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);
cp_nav_currCol=0}cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_colourOptionNodes[index];cp_nav_currCol++}if(cp_more_button!=null){cp_nav_currRow++;cp_nav_currCol=0;cp_nav_matrix[cp_nav_currRow]=new Array(cp_numElementsPerRow);cp_nav_moreButtonRow=cp_nav_currRow;for(cp_nav_currCol=0;cp_nav_currCol<cp_numElementsPerRow;cp_nav_currCol++)cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]=cp_more_button}var cp_buildColourLangTermLookupTable=function(){for(var i=0;i<cp_colourOptionNodes.length;i++){var _hex=
D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_colourOptionNodes[i]);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);var _title=cp_colourOptionNodes[i].title;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.AddColourToLookupTable(_hex,_title)}};var cp_initRecentColoursTitles=function(){for(var i=0;i<cp_recentColourNodes.length;i++){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_recentColourNodes[i]);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);
var _title=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[_hex];if(_title==undefined||_title==null)cp_recentColourNodes[i].title=_hex;else cp_recentColourNodes[i].title=_title}};cp_buildColourLangTermLookupTable();cp_initRecentColoursTitles();var cp_initAriaRoles=function(){var _relatedElement;if(cp_button!=null){D2L.LP.Web.UI.Html.Aria.SetRole(cp_button,"button");D2L.LP.Web.UI.Html.Aria.SetRole(cp_floating_container,"application")}else D2L.LP.Web.UI.Html.Aria.SetRole(node,"application");
var colourLists=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourpalette-colourboxes-list",node);for(var i=0;i<colourLists.length;i++){var _heading=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(colourLists[i]);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-title",_heading);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-rclabel",_heading);D2L.LP.Web.UI.Html.Aria.SetAttribute(colourLists[i],"labelledby",_heading.id)}if(cp_slider_arrow!=null){D2L.LP.Web.UI.Html.Aria.SetRole(cp_slider_arrow,
"slider");_relatedElement=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(cp_slider_arrow);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"label",_relatedElement.firstChild.nodeValue);_relatedElement=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(cp_slider_input);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_input,"label",_relatedElement.innerHTML);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuemin","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuemax","100");D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,
"valuenow","50")}};cp_initAriaRoles();cp_initializeColourSelectorDialog=function(){cp_setLcpRgb();cp_moreButtonHandler()};cp_setBasicMode=function(){cp_isAdvancedMode=false;cp_floating_container.style.width=cp_basicModeWidth;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_more_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_titlebar_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_okcancel_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_cont);if(cp_noColourOption!==
null){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_noColourOption);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_linebreak)}};cp_setAdvancedMode=function(){cp_isAdvancedMode=true;if(cp_floating_container!=null)cp_floating_container.style.width=cp_advModeWidth;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_more_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_titlebar_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_okcancel_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
cp_adv_cont);if(cp_noColourOption!==null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_noColourOption);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_linebreak)}};cp_openContainer=function(){cp_reset_hover();cp_isPaletteOpen=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(cp_floating_container)||D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening;if(cp_isPaletteOpen){cp_nav_resetRowColumn();cp_shiftDown=false;cp_setBasicMode();cp_setLcpRgb()}else cp_closeContainer()};
cp_closeContainer=function(){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(cp_floating_container,false);cp_setBasicMode()};cp_nav_matrixBoundaryCheck=function(){return cp_nav_currRow>=0&&cp_nav_currRow<cp_nav_matrix.length&&cp_nav_currCol>=0&&cp_nav_currCol<cp_numElementsPerRow};cp_nav_resetRowColumn=function(ignoreFocus){cp_nav_currRow=0;cp_nav_currCol=0;if(!ignoreFocus)cp_nav_focusNode()};cp_nav_focusNode=function(){if(cp_nav_matrixBoundaryCheck())if(cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]!==
null)cp_nav_matrix[cp_nav_currRow][cp_nav_currCol].focus()};cp_nav_checkButtonSkip=function(skippedButtonNode){if(cp_nav_matrixBoundaryCheck())if(cp_nav_matrix[cp_nav_currRow][cp_nav_currCol]===skippedButtonNode)return true;return false};cp_setPreviewBoxColour=function(hex){if(cp_isForegroundMode===true){if(cp_adv_preview_smalltext!=null){cp_adv_preview_smalltext.style.color=hex;cp_adv_preview_largetext.style.color=hex}}else if(cp_adv_preview!=null)cp_adv_preview.style.backgroundColor=hex};cp_setColourSelectorColour=
function(isNone,updateRecentColours,selColour){if(isNone&&cp_isForegroundMode===false){cp_hidden_value.value="";if(cp_button_colourBox!=null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourselector-noneselected",cp_button_colourBox)}else{var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(selColour);if(_hex===false)_hex=cp_default_color;cp_hidden_value.value=_hex;if(cp_button_colourBox!=null){cp_button_colourBox.style.backgroundColor=_hex;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourselector-noneselected",
cp_button_colourBox)}D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourListFromNodes(_hex,cp_recentColourNodes,node.id);var saveRecentColourListFunc=D2L.LP.Web.UI.ObjectRepository.Get(node.id,D2L.LP.Web.UI.Desktop.Controls.ColourSelector.SaveRcListSubkey);saveRecentColourListFunc()}var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onchange");if(onChange!==null)onChange.call(onChange);changeEvent.Trigger();cp_closeContainer();return true};cp_getEventTarget=function(event){return D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(event)};
cp_getElementClassName=function(node){var _className=node.className;if(_className==null){_className=node.getAttribute("class");if(_className==null)return false}return _className};cp_hasClassName=function(className,node){var _className=cp_getElementClassName(node);if(_className===false)return _className;var _classes=_className.split(" ");for(var i=0;i<_classes.length;i++)if(_classes[i]==className)return true;return false};cp_setLcpRgb=function(){var _rgb;if(cp_hidden_type!=null){if(cp_lcpHidden_value!=
null&&cp_lcpHidden_type!=null){_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(cp_lcpHidden_value.value);if(_rgb!=null){cp_slider_rgb_other.r=_rgb.r;cp_slider_rgb_other.g=_rgb.g;cp_slider_rgb_other.b=_rgb.b;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_largetext)}}else if(cp_hidden_otherColour!=null){_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(cp_hidden_otherColour.value);
if(_rgb!=null){cp_slider_rgb_other.r=_rgb.r;cp_slider_rgb_other.g=_rgb.g;cp_slider_rgb_other.b=_rgb.b;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_adv_preview_largetext)}}if(cp_hidden_type.value=="Foreground"){cp_isForegroundMode=true;if(_rgb==null||cp_lcpHidden_type!=null&&cp_lcpHidden_type.value==cp_hidden_type.value&&cp_hidden_otherColour==null){cp_slider_rgb_other.r=255;cp_slider_rgb_other.g=255;cp_slider_rgb_other.b=
255}}else{cp_isForegroundMode=false;if(_rgb==null||cp_lcpHidden_type!=null&&cp_lcpHidden_type.value==cp_hidden_type.value&&cp_hidden_otherColour==null){cp_slider_rgb_other.r=0;cp_slider_rgb_other.g=0;cp_slider_rgb_other.b=0;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_preview_smalltext);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_adv_preview_largetext)}}var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(cp_slider_rgb_other);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);
if(cp_isForegroundMode!==true){if(cp_adv_preview_smalltext!=null){cp_adv_preview_smalltext.style.color=_hex;cp_adv_preview_largetext.style.color=_hex}}else if(cp_adv_preview!=null)cp_adv_preview.style.backgroundColor=_hex}};cp_trim=function(str){return str.replace(/^\s+|\s+$/g,"")};cp_setHexInput=function(newHexValue){if(newHexValue.charAt(0)=="#")newHexValue.substring(1);cp_hex_input.value=newHexValue;if(cp_hexInput_label_addspace===true)cp_hexInput_label_addspace=false;else cp_hexInput_label_addspace=
true};cp_setLightnessValue=function(newLightnessValue){cp_slider_input.value=newLightnessValue;D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_arrow,"valuenow",newLightnessValue);D2L.LP.Web.UI.Html.Aria.SetAttribute(cp_slider_input,"valuetext",cp_slider_label.innerHTML+" "+newLightnessValue+"%")};cp_setContrastRatio=function(newContrastRatio){if(cp_contrast_ratio_addspace===true){cp_wcag_contrast_ratio.innerHTML=newContrastRatio+":1"+" ";cp_wcag_contrast_label.innerHTML=cp_wcag_contrast_label.innerHTML+
" ";cp_contrast_ratio_addspace=false}else{cp_wcag_contrast_ratio.innerHTML=newContrastRatio+":1";cp_wcag_contrast_label.innerHTML=cp_trim(cp_wcag_contrast_label.innerHTML);cp_contrast_ratio_addspace=true}cp_slider_updateWcagImage(newContrastRatio)};cp_slider_getLValue=function(){var _lvalue=parseInt((cp_slider_position.y-cp_slider_posyclamp.min)/cp_slider_posyrate);_lvalue=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHslPercentage(_lvalue);return cp_slider_max-_lvalue};cp_slider_updateWcagImage=
function(contrastRatio){if(contrastRatio<cp_wcag_failMarker){cp_wcag_status_image.style.backgroundImage="url(/d2l/img/lp/colourSelector/error.gif)";cp_wcag_status_image.title=cp_wcag_status_error.innerHTML;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_pass)}else if(contrastRatio<cp_wcag_warningMarker){cp_wcag_status_image.style.backgroundImage=
"url(/d2l/img/lp/colourSelector/warning.gif)";cp_wcag_status_image.title=cp_wcag_status_warning.innerHTML;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_pass)}else if(contrastRatio>=cp_wcag_correctMarker){cp_wcag_status_image.style.backgroundImage="url(/d2l/img/lp/colourSelector/correct.gif)";cp_wcag_status_image.title=cp_wcag_status_pass.innerHTML;
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_error);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cp_wcag_status_warning);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",cp_wcag_status_pass)}};cp_slider_updateHex=function(updateGradient){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(cp_slider_rgb);cp_setHexInput(_hex);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);cp_setPreviewBoxColour(_hex);if(updateGradient===true){var _rgb=
D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HslToRgb(cp_slider_hsl.h,cp_slider_hsl.s,cp_slider_max*0.5);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(_rgb);_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_hex);cp_slider_gradient.style.backgroundColor=_hex}var _contrastRatio=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetContrastRatio(cp_slider_rgb_other,cp_slider_rgb);_contrastRatio=Math.round(_contrastRatio*10)/10;cp_setContrastRatio(_contrastRatio)};cp_slider_updateRgb=
function(updateGradient){cp_slider_hsl.l=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHslPercentage(cp_slider_input.value);cp_setLightnessValue(cp_slider_hsl.l);cp_slider_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HslToRgb(cp_slider_hsl.h,cp_slider_hsl.s,cp_slider_hsl.l);cp_slider_updateHex(updateGradient)};cp_slider_updateHsl=function(updateGradient){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hex_input.value);if(_hex==="false"||_hex.length==0)_hex=
cp_default_color;cp_setHexInput(_hex);cp_slider_rgb=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToRgb(_hex);cp_slider_hsl=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHsl(cp_slider_rgb.r,cp_slider_rgb.g,cp_slider_rgb.b);cp_setLightnessValue(cp_slider_hsl.l);cp_slider_updateHex(updateGradient)};cp_handleHexChange=function(){cp_slider_updateHsl(true);cp_slider_position.y=(cp_slider_max-cp_slider_input.value)*cp_slider_posyrate+cp_slider_posyclamp.min;cp_slider_arrow.style.top=cp_slider_position.y+
"px"};cp_handleHslChange=function(){cp_slider_updateRgb(true);cp_slider_position.y=(cp_slider_max-cp_slider_input.value)*cp_slider_posyrate+cp_slider_posyclamp.min;cp_slider_arrow.style.top=cp_slider_position.y+"px"};cp_handleHslSliderChange=function(){cp_slider_updateRgb(false)};cp_nav_arrowUpHandler=function(){cp_nav_currRow--;if(cp_nav_currRow<0)cp_nav_currRow=cp_nav_matrix.length-1;if(cp_isAdvancedMode===true&&(cp_nav_checkButtonSkip(cp_more_button)||cp_nav_checkButtonSkip(cp_noColourOption)))cp_nav_arrowUpHandler();
else cp_nav_focusNode()};cp_nav_arrowDownHandler=function(){cp_nav_currRow++;if(cp_nav_currRow>=cp_nav_matrix.length)cp_nav_currRow=0;if(cp_isAdvancedMode===true&&(cp_nav_checkButtonSkip(cp_more_button)||cp_nav_checkButtonSkip(cp_noColourOption)))cp_nav_arrowDownHandler();else cp_nav_focusNode()};cp_nav_arrowLeftHandler=function(){cp_nav_currCol-=isRTL?-1:1;if(cp_nav_currCol<0)cp_nav_currCol=cp_numElementsPerRow-1;else if(cp_nav_currCol>=cp_numElementsPerRow)cp_nav_currCol=0;cp_nav_focusNode()};cp_nav_arrowRightHandler=
function(){cp_nav_currCol+=isRTL?-1:1;if(cp_nav_currCol>=cp_numElementsPerRow)cp_nav_currCol=0;else if(cp_nav_currCol<0)cp_nav_currCol=cp_numElementsPerRow-1;cp_nav_focusNode()};cp_nav_escapeHandler=function(){cp_closeContainer();cp_button.focus()};cp_nav_onKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){cp_nav_arrowUpHandler();result=true}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){cp_nav_arrowDownHandler();
result=true}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){cp_nav_arrowLeftHandler();result=true}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){cp_nav_arrowRightHandler();result=true}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)result=cp_colourPaletteClick(kpArgs.GetEventObject());return result};cp_nav_onShiftPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){var _lastCol=
cp_nav_currCol;cp_nav_resetRowColumn();if(cp_isAdvancedMode===false){var _event=kpArgs.GetEventObject();if(!_event.shiftKey){cp_nav_currRow=cp_nav_moreButtonRow;cp_nav_currCol=_lastCol}}}};cp_onKeyPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)cp_nav_escapeHandler();if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){var _event=kpArgs.GetEventObject();var _target=cp_getEventTarget(_event);if(_event.shiftKey)if(cp_noColourOption!=null&&
_target==cp_noColourOption||cp_hasClassName(cp_colourboxClassName,_target))cp_closeContainer();else{if(_target==cp_more_button)cp_nav_resetRowColumn(true)}else if(cp_isAdvancedMode===true){if(_target==cp_cancel_button)cp_closeContainer()}else if(cp_more_button!=null){if(_target==cp_more_button)cp_closeContainer()}else cp_closeContainer()}};cp_button_clickHandler=function(){cp_openContainer()};cp_colourPaletteClick=function(event){var _target=null;var _isColourBoxSelected=false;_target=cp_getEventTarget(event);
if(_target==cp_noColourOption){cp_setColourSelectorColour(true,false,"");return true}else if(cp_hasClassName(cp_colourboxClassName,_target)){for(var r=0;r<cp_nav_matrix.length&&_isColourBoxSelected===false;r++)for(var c=0;c<cp_numElementsPerRow&&_isColourBoxSelected===false;c++)if(_target==cp_nav_matrix[r][c]){cp_nav_currCol=c;cp_nav_currRow=r;cp_nav_focusNode();_isColourBoxSelected=true}if(_isColourBoxSelected===true){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(_target);
if(cp_isAdvancedMode===true){if(_hex!==null){cp_setHexInput(_hex);cp_handleHexChange()}}else{if(_hex!==null)cp_setHexInput(_hex);var isRecentColourBox=D2L.LP.Web.UI.Html.Dom.HasClassName(cp_recentColourClassName,_target);cp_setColourSelectorColour(false,!isRecentColourBox,_hex);return true}}}return false};cp_moreButtonHandler=function(){var _hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hidden_value.value);cp_nav_resetRowColumn();cp_shiftDown=false;if(_hex===false)cp_setHexInput(cp_default_color);
else if(_hex.length==0)cp_setHexInput(cp_default_color);else cp_setHexInput(_hex);cp_handleHexChange();cp_setAdvancedMode()};cp_cancelButtonHandler=function(){cp_closeContainer()};cp_okButtonHandler=function(){cp_setColourSelectorColour(false,true,cp_hex_input.value)};cp_slider_arrowUpHandler=function(){cp_slider_position.y-=cp_slider_posyrate;cp_setLightnessValue(cp_slider_getLValue());if(cp_slider_position.y<cp_slider_posyclamp.min)cp_slider_position.y=cp_slider_posyclamp.min;cp_slider_arrow.style.top=
cp_slider_position.y+"px";cp_handleHslSliderChange()};cp_slider_arrowDownHandler=function(){cp_slider_position.y+=cp_slider_posyrate;cp_setLightnessValue(cp_slider_getLValue());if(cp_slider_position.y>cp_slider_posyclamp.max)cp_slider_position.y=cp_slider_posyclamp.max;cp_slider_arrow.style.top=cp_slider_position.y+"px";cp_handleHslSliderChange()};cp_slider_handleMouse=function(event){cp_regexp_numbers.lastIndex=0;var _posx=0;var _posy=0;var e=event;if(!e)e=window.event;if(e.pageX||e.pageY){_posx=
e.pageX;_posy=e.pageY}else if(e.clientX||e.clientY){_posx=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;_posy=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}if(e.type=="mousedown"){var _top=cp_slider_arrow.style.top;_top=_top.replace(cp_regexp_numbers,"");cp_slider_offsetY=_posy-parseInt(_top);cp_slider_mouseDown=true}else if(e.type=="mouseup")cp_slider_mouseDown=false;else if(e.type=="mouseout")cp_slider_mouseDown=false;if(cp_slider_mouseDown===true){cp_slider_position.y=
_posy-cp_slider_offsetY;if(cp_slider_position.y<cp_slider_posyclamp.min)cp_slider_position.y=cp_slider_posyclamp.min;else if(cp_slider_position.y>cp_slider_posyclamp.max)cp_slider_position.y=cp_slider_posyclamp.max;cp_setLightnessValue(cp_slider_getLValue());cp_slider_arrow.style.top=cp_slider_position.y+"px";cp_handleHslSliderChange()}};cp_slider_onKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){cp_slider_arrowUpHandler();result=
true}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){cp_slider_arrowDownHandler();result=true}return result};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_cont,function(kpArgs){cp_nav_onShiftPress(kpArgs)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_basic_cont,function(kpArgs){var result=cp_nav_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_floating_container,
function(kpArgs){var result=cp_onKeyPress(kpArgs)});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_basic_cont,cp_colourPaletteClick);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_more_button,cp_moreButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_cancel_button,cp_cancelButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_ok_button,cp_okButtonHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_button,cp_button_clickHandler);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_slider_arrow,
function(kpArgs){var result=cp_slider_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(cp_slider_input,function(kpArgs){var result=cp_slider_onKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",cp_hex_input,cp_handleHexChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("change",
cp_slider_input,cp_handleHslChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousemove",cp_slider_cont,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("mousedown",cp_slider_arrow,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cp_slider_gradient,cp_slider_handleMouse);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseup",cp_slider_cont,cp_slider_handleMouse);cp_set_hover=function(event){var target;if(event.target)target=event.target;if(event.srcElement)target=event.srcElement;
cp_addHover(target)};cp_set_nohover=function(event){var target;if(event.target)target=event.target;if(event.srcElement)target=event.srcElement;cp_removeHover(target)};cp_reset_hover=function(){for(var r=0;r<cp_nav_matrix.length;r++)for(var c=0;c<cp_numElementsPerRow;c++)cp_removeHover(cp_nav_matrix[r][c])};cp_addHover=function(target){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-colourbox-a",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-colourbox-hover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-colourbox-nohover",
target)}else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-nocolouropt",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-nocolouropt-hover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-nocolouropt-nohover",target)}};cp_removeHover=function(target){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-colourbox-a",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-colourbox-nohover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-colourbox-hover",
target)}else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourpalette-nocolouropt",target)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourpalette-nocolouropt-nohover",target);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourpalette-nocolouropt-hover",target)}};for(var r=0;r<cp_nav_matrix.length;r++)for(var c=0;c<cp_numElementsPerRow;c++){var target=cp_nav_matrix[r][c];cp_removeHover(target);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",target,cp_set_hover);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",
target,cp_set_nohover)}if(cp_button==null&&cp_colourpalette!=null)cp_initializeColourSelectorDialog()},AddColourToLookupTable:function(colour,title){if(colour!=undefined&&colour!=null&&title!=undefined&&title!=null)if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[colour]!=title)D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[colour]=title},OpenColourPalette:function(floatingContainerId,colourSelectorId,openerId,focus){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColoursList(floatingContainerId);
if(!D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)){var opener=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourselector-disabled",opener)){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=true;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,{Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,
TargetId:colourSelectorId,FocusOnOpen:focus})})}}else D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(floatingContainerId)},GetLinkedColourSelectorId:function(linkedColourSelectorId){if(linkedColourSelectorId!=null)return linkedColourSelectorId.GetValue();else return false},SetRecentColours:function(csvColourList){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours=csvColourList},UpdateRecentColoursList:function(floatingContainerId){if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours.length==
0)return false;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(floatingContainerId.GetValue());if(node!=null){var colourList=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours.split(",");var cp_recentColourNodes;var recentColourHexCode;cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);for(var index=0;index<cp_recentColourNodes.length;index++){recentColourHexCode=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(colourList[index]);
if(recentColourHexCode===false)recentColourHexCode="#ffffff";cp_recentColourNodes[index].style.backgroundColor=recentColourHexCode;var colourTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[recentColourHexCode];if(colourTitle===undefined||colourTitle===null)colourTitle=recentColourHexCode;cp_recentColourNodes[index].title=colourTitle}}},UpdateRecentColourListFromDialog:function(colourSelectorId){var newRecentColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetValue(colourSelectorId);
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());if(node===null)return;var recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node);D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourList(newRecentColour,recentColourNodes)},UpdateRecentColourListFromNodes:function(newRecentColour,cp_recentColourNodes,colourSelectorId){var node=colourSelectorId.GetValue?D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue()):
D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId);if(cp_recentColourNodes==null||cp_recentColourNodes==undefined){if(node===null)return;cp_recentColourNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-nav-recentcolours",node)}newRecentColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(newRecentColour);if(newRecentColour!==false)D2L.LP.Web.UI.Desktop.Controls.ColourSelector.UpdateRecentColourList(newRecentColour,cp_recentColourNodes)},UpdateRecentColourList:function(newRecentColour,
cp_recentColourNodes){var _prevColour;var _tempColour;var _prevTitle;var _tempTitle;var _newRecentColourList="";var _newColourExists=false;for(var i=0;i<cp_recentColourNodes.length;i++){_tempColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.GetBackgroundHexColour(cp_recentColourNodes[i]);_tempColour=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(_tempColour);_tempTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[_tempColour];if(_tempTitle==undefined||_tempTitle==
null)_tempTitle=_tempColour;if(!_newColourExists){_newColourExists=_tempColour==newRecentColour;if(i==0){var _newRecentColourTitle=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.ColourLookupTable[newRecentColour];if(_newRecentColourTitle==undefined||_newRecentColourTitle==null)_newRecentColourTitle=newRecentColour;cp_recentColourNodes[i].style.backgroundColor=newRecentColour;cp_recentColourNodes[i].title=_newRecentColourTitle;_newRecentColourList+=newRecentColour.substr(1,6)+","}else{cp_recentColourNodes[i].style.backgroundColor=
_prevColour;cp_recentColourNodes[i].title=_prevTitle;_newRecentColourList+=_prevColour.substr(1,6)+","}_prevColour=_tempColour;_prevTitle=_tempTitle}else _newRecentColourList+=_tempColour.substr(1,6)+","}if(_newRecentColourList.charAt(_newRecentColourList.length-1)==",")_newRecentColourList=_newRecentColourList.substr(0,_newRecentColourList.length-1);D2L.LP.Web.UI.Desktop.Controls.ColourSelector.SetRecentColours(_newRecentColourList)},SetIsEnabled:function(colourSelectorId,isEnabled){var colourSelector=
D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());var opener=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-colourselector-button",colourSelector)[0];if(opener!=null&&isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-colourselector-disabled",opener);D2L.LP.Web.UI.Html.Dom.SetAttribute(opener,"href","javascript:void(0);")}else if(opener!=null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-colourselector-disabled",opener);opener.removeAttribute("href")}},GetValue:function(colourSelectorId){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(colourSelectorId.GetValue());var cp_hex_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-hex-input",node);var cp_hidden_type=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourselector-type",node);var _hex=false;if(cp_hex_input!=null)_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(cp_hex_input.value);if(_hex===false)_hex=cp_hidden_type!=null&&cp_hidden_type.value=="Foreground"?D2L.LP.Web.UI.Desktop.Controls.ColourSelector.DefaultFgColour:
D2L.LP.Web.UI.Desktop.Controls.ColourSelector.DefaultBgColour;return _hex},GetRecentColoursList:function(colourSelectorId){return D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RecentColours},GetBackgroundHexColour:function(node){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpNumbersAndComma.lastIndex=0;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.lastIndex=0;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpRgb.lastIndex=0;var _rgb={r:0,g:0,b:0};var _str=node.style.backgroundColor;
var _hex;if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.test(_str))_hex=_str.substr(1,6);else if(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpRgb.test(_str)){var _arr=_str.replace(D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpNumbersAndComma,"").split(",");_rgb.r=_arr[0];_rgb.g=_arr[1];_rgb.b=_arr[2];_hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RgbToHex(_rgb)}else;return _hex},NormalizeHexCode:function(inputHexCode){var outputHexCode=inputHexCode;D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.lastIndex=
0;if(outputHexCode==null)return false;if(outputHexCode.length!==0){if(outputHexCode.charAt(0)!=="#")outputHexCode="#"+outputHexCode;if(outputHexCode.length!=7){var outputHexCodeLength=outputHexCode.length;if(outputHexCodeLength>7)outputHexCode=outputHexCode.substr(0,7);else if(outputHexCodeLength>=0&&outputHexCodeLength<7)for(var i=outputHexCodeLength;i<7&&outputHexCode.length<7;i++)outputHexCode=outputHexCode+"0";else outputHexCode="#000000"}if(!D2L.LP.Web.UI.Desktop.Controls.ColourSelector.RegexpHexCode.test(outputHexCode))return"false"}return outputHexCode},
NormalizeRgbValue:function(value){var normalizedVal=parseInt(value);if(isNaN(normalizedVal))normalizedVal=0;if(normalizedVal>255)normalizedVal=255;else if(normalizedVal<0)normalizedVal=0;return normalizedVal},NormalizeHslPercentage:function(value){var normalizedVal=parseInt(value);if(isNaN(normalizedVal))normalizedVal=50;if(normalizedVal>100)normalizedVal=100;else if(normalizedVal<0)normalizedVal=0;return normalizedVal},CalculateContrastRatio:function(rgb){var r_s=rgb.r/255;var g_s=rgb.g/255;var b_s=
rgb.b/255;var r=r_s<=0.03928?r_s/12.92:Math.pow((r_s+0.055)/1.055,2.4);var g=g_s<=0.03928?g_s/12.92:Math.pow((g_s+0.055)/1.055,2.4);var b=b_s<=0.03928?b_s/12.92:Math.pow((b_s+0.055)/1.055,2.4);var L=0.2126*r+0.7152*g+0.0722*b;return L},GetContrastRatio:function(rgb1,rgb2){var L1=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.CalculateContrastRatio(rgb1);var L2=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.CalculateContrastRatio(rgb2);var result=L1>=L2?(L1+0.05)/(L2+0.05):(L2+0.05)/(L1+0.05);return result},
RgbToHex:function(rgb){var hexCode=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.r)+D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.g)+D2L.LP.Web.UI.Desktop.Controls.ColourSelector.IntToHex(rgb.b);return hexCode},IntToHex:function(intVal){var hexVal=parseInt(intVal).toString(16);if(hexVal.length==1)hexVal="0"+hexVal;return hexVal},HexToInt:function(hexVal){return parseInt(hexVal,16)},HexToRgb:function(hex){hex=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.NormalizeHexCode(hex);
if(hex==false)return null;hex=hex.substr(1,6);var r="00",g="00",b="00";if(hex.length==6){r=hex.substring(0,2);g=hex.substring(2,4);b=hex.substring(4,6)}else{if(hex.length>4){r=hex.substring(4,hex.length);hex=hex.substring(0,4)}if(hex.length>2){g=hex.substring(2,hex.length);hex=hex.substring(0,2)}if(hex.length>0)b=hex.substring(0,hex.length)}var rgb={r:0,g:0,b:0};rgb.r=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(r);rgb.g=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(g);rgb.b=D2L.LP.Web.UI.Desktop.Controls.ColourSelector.HexToInt(b);
return rgb},RgbToHsl:function(r,g,b){r/=255,g/=255,b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b);var h,s,l=(max+min)/2;if(max==min)h=s=0;else{var d=max-min;s=l>0.5?d/(2-max-min):d/(max+min);switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}var hsl={h:0,s:0,l:0};hsl.h=h;hsl.s=s;hsl.l=l;hsl.h=parseInt(hsl.h*60);if(hsl.h<0)hsl.h+=360;hsl.s=parseInt(hsl.s*100);hsl.l=parseInt(hsl.l*100);return hsl},HslToRgb:function(h,s,l){var r,g,b;if(h==360)h=0;
h/=60;s=s/100;l=l/100;if(s==0)r=g=b=l;else{function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p}var q=l<0.5?l*(1+s):l+s-l*s;var p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3)}var rgb={r:0,g:0,b:0};rgb.r=r*255;rgb.g=g*255;rgb.b=b*255;rgb.r=Math.round(rgb.r);rgb.g=Math.round(rgb.g);rgb.b=Math.round(rgb.b);return rgb},ValidateContrastRatio:function(resolvedId,requiredValue){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(resolvedId);
var cp_wcag_contrast_ratio=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-colourpalette-wcag-contrast-ratio",node);if(cp_wcag_contrast_ratio==null)return true;var contrastRatio=cp_wcag_contrast_ratio.innerHTML;var arr=contrastRatio.split(":");if(arr.length>0){var contrast=parseFloat(arr[0]);if(contrast==undefined||contrast==null||isNaN(contrast))return true;if(contrast>=requiredValue)return true}return false},OnChangeEvents:{}};D2L.LP.Web.UI.Desktop.Controls.ColourSelector.m_isOpening=false;
D2L.LP.Web.UI.Desktop.Controls.ContainerIcon={SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible)}};D2L.LP.Web.UI.Desktop.Controls.ContainerLink={SetIsVisible:function(id,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(id,isVisible)}};
D2L.LP.Web.UI.Desktop.Controls.ContextMenu={Close:function(id){var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(floatingContainerId,true)},CloseAll:function(){for(var i=0;i<D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened.length;i++){var contextMenuId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened[i];D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(contextMenuId)}},OnCloseHandler:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.m_openerId!=null){var openerNode=D2L.LP.Web.UI.Html.Dom.GetElementById(node.m_openerId.GetValue());openerNode.m_isClicked=false;D2L.LP.Web.UI.Html.Dom.DispatchEvent("blur",openerNode)}D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetOnCloseEvent(id).Trigger()},GetFloatingContainerHtmlId:function(id){var contextMenuContext=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"Context");return contextMenuContext["floatingContainerId"]},
GetOpener:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!node.m_openerId)return null;return D2L.LP.Web.UI.Html.Dom.GetElementById(node.m_openerId.GetValue())},GetOpenerKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.m_openerKey},GetOnCloseEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;if(me.OnCloseEvents[id.GetValue()]===undefined)me.OnCloseEvents[id.GetValue()]=new D2L.LP.Web.UI.Events.Event;return me.OnCloseEvents[id.GetValue()]},
GetSelectedItemNode:function(contextMenuNode){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item-hover",contextMenuNode)[0]||D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item-disabled-hover",contextMenuNode)[0]||null},InstallKeyboardSupport:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;var floatingContainerNode=node.parentNode;var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",node);var GetSelectedIndex=
function(){var selected=me.GetSelectedItemNode(node);var selectedIndex=contextMenuItems.length;for(var i=0;i<contextMenuItems.length;i++)if(contextMenuItems[i]===selected)selectedIndex=i;return selectedIndex};var Up=function(){var selectedIndex=GetSelectedIndex();var toSelectNode=null;for(var i=selectedIndex-1;i>=0;i--)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode===null)for(var i=contextMenuItems.length-1;i>selectedIndex;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode!==null)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(toSelectNode).focus()};var Down=function(){var selectedIndex=GetSelectedIndex();var toSelectNode=null;for(var i=selectedIndex+1;i<contextMenuItems.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode===null)for(var i=0;i<selectedIndex;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
contextMenuItems[i])){toSelectNode=contextMenuItems[i];break}if(toSelectNode!==null)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(toSelectNode).focus()};var handleKeyPress=function(arg){if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp)Up();else if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown)Down();else if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){me.Close(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id));if(node.m_openerId!=null)D2L.LP.Web.UI.Html.Dom.Focus(node.m_openerId)}else if(arg.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){var selectedGetSelectedItem=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetSelectedItemNode(node);if(selectedGetSelectedItem){var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(selectedGetSelectedItem);D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",anchor)}}else return true;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(arg.GetEventObject());return false};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(floatingContainerNode,handleKeyPress)},
IsOpen:function(id){var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)},Open:function(id,openerId,openerKey,targetId){var isOnDemand=D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),"LoadHandler");if(isOnDemand&&!D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.IsLoaded(id)){var loadRet=D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.Load(id,openerKey);loadRet.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Open(id,
openerId,openerKey,targetId)});return}var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());node.m_openerKey=openerKey;node.m_openerId=openerId;var floatingContainerId=D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetFloatingContainerHtmlId(id);var openSettings={Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom};if(targetId!==undefined&&targetId!==null)openSettings.TargetId=targetId;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,openSettings);var floatingContainerNode=
node.parentNode;D2L.LP.Web.UI.Html.Aria.SetAttribute(floatingContainerNode,"labelledby",openerId.GetValue());var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",floatingContainerNode);if(contextMenuItems.length>0)D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(contextMenuItems[0]).focus();D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened.push(id)},Toggle:function(id,openerId,openerKey){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenu;if(me.IsOpen(id))me.Close(id);
else me.Open(id,openerId,openerKey)},InitPlaceholder:function(node,contextMenuId,hoverClassName){var contextMenu=D2L.LP.Web.UI.Html.Dom.GetElementById(contextMenuId);var mouseIn=false;var OnOverHandler=function(){if(!mouseIn){D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node);mouseIn=true}};var OnOutHandler=function(){if(!node.m_isClicked)D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node);mouseIn=false};var OnClickHandler=function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||
window.event);var parentFloatingContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-floating-container",node);if(parentFloatingContainer)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",parentFloatingContainer);else D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",document);node.m_isClicked=true;D2L.LP.Web.UI.Html.Dom.AddClassName(hoverClassName,node)};node.d2l_onOverHandler=OnOverHandler;node.d2l_onOutHandler=OnOutHandler;node.d2l_onClickHandler=OnClickHandler;var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-disabled",
node);if(!isDisabled){D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,OnClickHandler)}D2L.LP.Web.UI.Events.OnClick.AddListener(function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(node,
eventTarget)&&!D2L.LP.Web.UI.Html.Dom.IsAncestor(contextMenu,eventTarget)){node.m_isClicked=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName(hoverClassName,node)}})},SetIsEnabled:function(id,isEnabled){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isEnabled){D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,node.d2l_onOverHandler);
D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,node.d2l_onClickHandler)}else{D2L.LP.Web.UI.Html.Dom.RemoveEventListener("mouseover",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("mouseout",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",node,node.d2l_onOverHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("blur",node,node.d2l_onOutHandler);D2L.LP.Web.UI.Html.Dom.RemoveEventListener("click",
node,node.d2l_onClickHandler)}},SetItemIsEnabled:function(id,key,isEnabled){var itemId=id.GetValue()+"_"+key;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId);var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var contextMenuItemContext=D2L.LP.Web.UI.ObjectRepository.Get(itemId);var enabledCssIconClassName=contextMenuItemContext["enabledIconCss"];var disabledCssIconClassName=contextMenuItemContext["disabledIconCss"];if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled",
node);D2L.LP.Web.UI.Html.Dom.AddClassName(enabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Dom.RemoveClassName(disabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Aria.RemoveAttribute(anchor,"disabled")}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-disabled",node);D2L.LP.Web.UI.Html.Dom.AddClassName(disabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Dom.RemoveClassName(enabledCssIconClassName,anchor);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,"disabled","true")}},SetItemIsVisible:function(id,
key,isVisible){var itemId=id.GetValue()+"_"+key;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,isVisible)}};D2L.LP.Web.UI.Desktop.Controls.ContextMenu.m_opened=[];D2L.LP.Web.UI.Desktop.Controls.ContextMenu.OnCloseEvents={};
D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem={ClickItemNode:function(node){var onClickFunc=null;var ret=true;var contextMenuItemContext=D2L.LP.Web.UI.ObjectRepository.Get(node.id);if(contextMenuItemContext["onClick"]!==undefined)onClickFunc=contextMenuItemContext["onClick"];var isEnabled=D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.IsEnabledNode(node);if(onClickFunc!==null&&isEnabled){onClickFunc.call(this);ret=false}if(isEnabled){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-hover",
node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled-hover",node);D2L.LP.Web.UI.Desktop.Controls.ContextMenu.Close(node.m_contextMenuId);D2L.LP.Web.UI.Html.Dom.FocusNode(D2L.LP.Web.UI.Desktop.Controls.ContextMenu.GetOpener(node.m_contextMenuId))}return ret},Initialize:function(node,contextMenuId){var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem;var anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);anchor.tabIndex=-1;node.m_contextMenuId=contextMenuId;D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
anchor,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);return D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.ClickItemNode(node)});var OnOverHandler=function(e){if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-disabled-hover",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-contextmenu-item-hover",node)};var OnOutHandler=function(e){if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-disabled-hover",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-contextmenu-item-hover",
node)};D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,OnOutHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchor,OnOverHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",anchor,OnOutHandler);D2L.LP.Web.UI.Html.Aria.SetRole(node,"presentation");D2L.LP.Web.UI.Html.Aria.SetRole(anchor,"menuitem");if(!me.IsEnabledNode(node))D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,"disabled","true")},IsEnabledNode:function(node){return!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-contextmenu-item-disabled",
node)}};
D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand={m_currentPlaceholderKey:null,m_currentId:null,m_loadedList:[],Load:function(id,placeholderKey){var ret=new D2L.LP.Web.UI.Events.Event;var me=D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand;me.m_currentId=id;me.m_currentPlaceholderKey=placeholderKey;var loadHandler=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"LoadHandler");var loadRet=eval(loadHandler);loadRet.AddListener(function(){ret.Trigger()});loadRet.AddReleaseListener(function(){ret.Release()});me.m_loadedList[id.GetValue()]=
true;return ret},IsLoaded:function(id){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_loadedList[id.GetValue()]||false},GetCurrentPlaceholderKey:function(){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentPlaceholderKey},GetCurrentPlaceholderId:function(){return D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentId.GetValue()+"_cmodph")},GetCurrentId:function(){return D2L.LP.Web.UI.Desktop.Controls.ContextMenuOnDemand.m_currentId}};
D2L.LP.Web.UI.Desktop.Controls.DataListItem={};
D2L.LP.Web.UI.Desktop.Controls.DataList={AdjustLastVisibleChild:function(node){var lastVisibleChild=null;var child=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);while(child!==null){var isHidden=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",child);if(!isHidden)lastVisibleChild=child;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-lastchild",child);child=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(child)}if(lastVisibleChild!==null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-lastchild",lastVisibleChild)},
AddItems:function(dataListId,itemId,placeholderId,provider,createPlaceholder){var evt=new D2L.LP.Web.UI.Events.Event;if(dataListId===null||placeholderId===null||provider===null){evt.Release();return evt}if(D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue())===null)createPlaceholder.call(createPlaceholder);var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0")){evt.Release();
return evt}var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var providerRet=provider.call(provider);providerRet.AddReleaseListener(function(){evt.Release()});providerRet.AddListener(function(){var listNode=me.GetListNode(dataListId);me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);var newItemNodes=me.GetNewItemNodesByNode(listNode);me.SetIsNewItems(newItemNodes,false);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId),newItemNodes);D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),
"0");evt.Trigger()});return evt},AddItemsAfter:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null)dataListId=me.GetDataListIdByItemId(itemId);var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null)itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());else itemNode=me.GetLastItemNode(dataListId);var placeholderNode=document.createElement("li");
placeholderNode.setAttribute("id",placeholderId.GetValue());placeholderNode.className="d2l-datalist-item-placeholder";if(itemNode!==null)D2L.LP.Web.UI.Html.Dom.InsertElementAfter(placeholderNode,itemNode);else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode)}else listNode.appendChild(placeholderNode)}});
return evt},AddItemsBefore:function(dataListId,itemId,placeholderId,provider){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;if(dataListId===null)dataListId=me.GetDataListIdByItemId(itemId);var listNode=me.GetListNode(dataListId);var evt=me.AddItems(dataListId,itemId,placeholderId,provider,function(){var itemNode;if(itemId!==null)itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());else itemNode=me.GetFirstItemNode(dataListId,true);var placeholderNode=document.createElement("li");placeholderNode.setAttribute("id",
placeholderId.GetValue());placeholderNode.className="d2l-datalist-item-placeholder";if(itemNode!==null)itemNode.parentNode.insertBefore(placeholderNode,itemNode);else{var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(placeholderNode,loadMorePlaceholderNode)}else listNode.appendChild(placeholderNode)}});return evt},AddItemByNode:function(listNode,
itemNode){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var loadMorePlaceholderNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-placeholder-bottom",listNode);var sourceList=itemNode.parentNode;if(loadMorePlaceholderNode!==null){var parent=loadMorePlaceholderNode.parentNode;parent.insertBefore(itemNode,loadMorePlaceholderNode)}else listNode.appendChild(itemNode);me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);if(sourceList!==listNode){var sourceListId=
new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute("id"));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId))me.SetIsEmptyTextVisible(sourceList,true)}},AddItemClassNames:function(node,className){if(node!==undefined&&className.length>0&&node.className.indexOf(className,0)==-1)node.className+=" "+className},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList},GetDataListIdByItemId:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());
return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute("id"))},GetDataListPlaceholder:function(dataListRootNode){var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(dataListRootNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item-placeholder",itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return null},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event;
events[id]=evt}return evt},GetFirstItemNode:function(id,includeHidden){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item",listNode);if(itemNode===null)return null;if(includeHidden)return itemNode;else if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode))return itemNode;return me.GetNextItemNode(itemNode,includeHidden)},GetHasMoreItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;
var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null)return false;if(D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderNode.getAttribute("id"),2))return true;return false},GetHasVisibleItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(id,false);return itemNode!==null},GetItemCount:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var count=0;var itemNode=me.GetFirstItemNode(id,false);
while(itemNode!==null){count+=1;itemNode=me.GetNextItemNode(itemNode,false)}return count},GetItemsNodes:function(id,className){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName(className,listNode)},GetLastItemNode:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var itemNode=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(listNode);while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item",
itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(itemNode)}return null},GetListNode:function(id){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},GetNewItemNodesByNode:function(listNode){var itemNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName("d2l-datalist-newitem",listNode);return itemNodes},GetNextItemNode:function(itemNode,includeHidden){itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode);
while(itemNode!==null){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item",itemNode))if(includeHidden)return itemNode;else if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode))return itemNode;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return null},GetPage:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKey(dataListId))return;var onGetPage=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,
1);if(onGetPage===null)return;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);var isReadOnly=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node);me.GetOnPageEvent(id).Trigger();me.GetOnLoadEvent(id).Trigger();onGetPage.call(onGetPage).AddListener(function(){if(isReadOnly){var dlNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-readonly",dlNode)}me.TryFocusFirstItem(id);me.GetOnPageCompletedEvent(id).Trigger(me.GetItemsNodes(id,"d2l-datalist-item"))})},
GetOnLoadEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadEvents)},GetOnLoadCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadCompletedEvents)},GetOnLoadMoreCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnLoadMoreCompletedEvents)},GetOnPageEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),
me.OnPageEvents)},GetOnPageCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnPageCompletedEvents)},GetOnRemoveItemEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;return me.GetEvent(id.GetValue(),me.OnRemoveItemEvents)},HighlightItem:function(itemId){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataList.HighlightItemByNode(itemNode)},HighlightItemByNode:function(itemNode){if(!itemNode)return;
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-highlight-transition-color",itemNode);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-highlight-transition",itemNode);if(D2L.LP.Web.UI.Html.Css.Capability.SupportsTransition())D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition-color",itemNode);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition",itemNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-highlight-transition-color",
itemNode)},1500)},0)},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=me.GetListNode(id);var placeholderNode=me.GetDataListPlaceholder(listNode);if(placeholderNode===null)return;var placeholderId=placeholderNode.getAttribute("id");var onLoadMore;if(D2L.LP.Web.UI.ObjectRepository.HasKey(placeholderId)){onLoadMore=D2L.LP.Web.UI.ObjectRepository.Get(placeholderId,1);if(onLoadMore!==null){var nextItemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(placeholderNode);
var previousItemNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(placeholderNode);me.GetOnLoadEvent(id).Trigger();onLoadMore.call(onLoadMore).AddListener(function(){var itemNode;var itemNodes=[];if(previousItemNode===null)itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);else itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(previousItemNode);while(itemNode!==null&&itemNode!=nextItemNode){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item-placeholder",itemNode))itemNodes.push(itemNode);
itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}me.SetIsNewItems(itemNodes,false);if(itemNodes.length>0){var focusableElement=D2L.LP.Web.UI.Html.Dom.GetNextFocusableElement(itemNodes[0]);if(focusableElement&&focusableElement.focus)focusableElement.focus()}me.SetIsEmptyTextVisible(listNode,false);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(id).Trigger(me.GetHasMoreItems(id),itemNodes)})}}},MoveItemByNode:function(itemNode,moveToItemNode,isBefore){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;
var newList=moveToItemNode.parentNode;var sourceList=itemNode.parentNode;if(isBefore)newList.insertBefore(itemNode,moveToItemNode);else D2L.LP.Web.UI.Html.Dom.InsertElementAfter(itemNode,moveToItemNode);me.AdjustLastVisibleChild(newList);if(sourceList!==newList){var sourceListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(sourceList.parentNode.getAttribute("id"));me.AdjustLastVisibleChild(sourceList);if(!me.GetHasVisibleItem(sourceListId))me.SetIsEmptyTextVisible(sourceList,true)}},RemoveItem:function(itemId){if(itemId===
null)return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());me.RemoveItemByNode(itemNode)},RemoveItemByNode:function(itemNode){if(itemNode===null)return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var listNode=itemNode.parentNode;var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(listNode.parentNode.getAttribute("id"));listNode.removeChild(itemNode);if(!me.GetHasVisibleItem(dataListId))me.SetIsEmptyTextVisible(listNode,true);
me.AdjustLastVisibleChild(listNode);me.GetOnRemoveItemEvent(dataListId).Trigger(itemNode)},ReplaceItem:function(itemId,placeholderId,provider){if(placeholderId===null||provider===null)return;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null)return;itemNode.setAttribute("id",placeholderId.GetValue());var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.parentNode.parentNode.getAttribute("id"));var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());
if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0"))return;var me=D2L.LP.Web.UI.Desktop.Controls.DataList;provider.call(provider).AddListener(function(){var listNode=me.GetListNode(dataListId);me.AdjustLastVisibleChild(listNode);me.GetOnLoadMoreCompletedEvent(dataListId).Trigger(me.GetHasMoreItems(dataListId));D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),"0")})},ReplaceItemContent:function(itemId,placeholderId,provider){var me=
D2L.LP.Web.UI.Desktop.Controls.DataList;if(placeholderId===null||provider===null)return;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode===null)return;var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-content",itemNode);contentNode.setAttribute("id",placeholderId.GetValue());D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-placeholder-inner",contentNode);var dataListId=me.GetDataListIdByItemId(itemId);var rc=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId.GetValue());
if(rc===null)if(!D2L.LP.Web.UI.ObjectRepository.TryClone(dataListId.GetValue(),"0",placeholderId.GetValue(),"0"))return;provider.call(provider).AddListener(function(){D2L.LP.Web.UI.ObjectRepository.Remove(placeholderId.GetValue(),"0")})},RemoveItemClassNames:function(node,className){if(node!==undefined&&className.length>0)node.className=node.className.replace(" "+className,"")},ScrollToFirstItem:function(dataListId){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var itemNode=me.GetFirstItemNode(dataListId,
false);if(!itemNode)return;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisibleInContainer(itemNode);if(isVisible)return;D2L.LP.Web.UI.Html.Dom.ScrollToElement(itemNode,0,false)},SetIsEmptyTextVisible:function(listNode,isVisible){var emptyTextNode=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(listNode);if(isVisible){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",listNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",emptyTextNode)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",emptyTextNode);
D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",listNode)}},SetItemIsVisible:function(id,isVisible){var item=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(item,isVisible);D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(item.parentNode)},SetIsNewItems:function(itemNodes,isNew){if(isNew)for(var i=0;i<itemNodes.length;i++)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-newitem",itemNodes[i]);else for(var j=0;j<itemNodes.length;j++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-newitem",
itemNodes[j])},TryFocusFirstItem:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var firstItemNode=me.GetFirstItemNode(id);if(!firstItemNode)return false;var focusableElements=$(firstItemNode).find(":focusable");if(!focusableElements||focusableElements.length===0)return false;focusableElements[0].focus();return true},TryGetSelectionUpdatedEvent:function(id){var summaryNode=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSummaryNode(id);if(summaryNode===null)return null;var e=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary.GetSelectionUpdatedEvent(id);
return e},OnLoadEvents:{},OnLoadCompletedEvents:{},OnLoadMoreCompletedEvents:{},OnPageEvents:{},OnPageCompletedEvents:{},OnRemoveItemEvents:{},CaptureOnClickRules:{"A":true,"BUTTON":true,"INPUT":true,"LABEL":true,"SELECT":true,"TEXTAREA":true}};
D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop={AddAcceptableDragGroup:function(dragObject,acceptableGroup){if(dragObject.GetDragNode().d2l_DroppableSettings)dragObject.GetDragNode().d2l_DroppableSettings.AddAcceptableDragGroup(acceptableGroup)},AddItem:function(dataListId,dragObject){var itemNode=dragObject.GetDragNode();var listNode=D2L.LP.Web.UI.Desktop.Controls.DataList.GetListNode(dataListId);if(itemNode==null||listNode==null)return;D2L.LP.Web.UI.Desktop.Controls.DataList.AddItemByNode(listNode,
itemNode)},GetDraggedKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_draggedNodeKey},GetParentDataList:function(childNode){return D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-datalist",childNode).parentNode},GetDragGroupFunction:function(dragObject){if(dragObject&&dragObject.GetDraggableSettings())return dragObject.GetDraggableSettings().GetDragGroup();else return null},GetDragParam:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
return node.d2l_dragObjectParam},GetDragObject:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_dragObject},GetDroppedOnKey:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_droppedOnNodeKey},GetDroppedOnHtmlId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_droppedOnNodeHtmlId},GetDropPosition:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_itemDragPosition},
MoveItem:function(dragObject,moveToItemId,dropPositon){var moveToItemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(moveToItemId.GetValue());var itemNode=dragObject.GetDragNode();if(moveToItemNode==null||itemNode==null)return;var isBefore=dropPositon==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;D2L.LP.Web.UI.Desktop.Controls.DataList.MoveItemByNode(itemNode,moveToItemNode,isBefore)},RemoveItem:function(dragObject){var itemNode=dragObject.GetDragNode();D2L.LP.Web.UI.Desktop.Controls.DataList.RemoveItemByNode(itemNode)},
SetAcceptableDragGroups:function(dragObject,acceptableGroups){if(dragObject.GetDragNode().d2l_DroppableSettings)dragObject.GetDragNode().d2l_DroppableSettings.SetAcceptableDragGroups(acceptableGroups)}};D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType={None:0,OnlyDropOn:1,OnlyDropBeforeAfter:2,All:3};
D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop={m_droppedOnKey:null,m_droppedOnHtmlId:null,m_dropPosition:null,m_droppedFiles:null,GetDroppedOnKey:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedOnKey},GetDroppedOnHtmlId:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedOnHtmlId},GetDropPosition:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_dropPosition},GetDroppedFiles:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop.m_droppedFiles},
OnFilesDrop:function(key,htmlId,files){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.FileDragDrop;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);node.d2l_previousFileDropPosition=null;var dataListId=D2L.LP.Web.UI.Desktop.Controls.DataList.GetDataListIdByItemId(htmlId);me.m_droppedOnKey=key;me.m_droppedOnHtmlId=htmlId;me.m_dropPosition=node.d2l_fileDropPosition;me.m_droppedFiles=files;var dataListOnFilesDrop=
D2L.LP.Web.UI.ObjectRepository.TryGet(dataListId.GetValue(),"OnFilesDrop");if(dataListOnFilesDrop)dataListOnFilesDrop.call(this)},OnFileOver:function(htmlId,verticalDragPosition,supportsAllDropTypes){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;if(supportsAllDropTypes)if(verticalDragPosition<0.25)node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;else{if(verticalDragPosition>0.75)node.d2l_fileDropPosition=
D2L.LP.Web.UI.Html.DragDrop.DropPosition.After}else if(verticalDragPosition<0.5)node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;else node.d2l_fileDropPosition=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;if(node.d2l_previousFileDropPosition!==node.d2l_fileDropPosition)D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.UpdateDragOverEffect(node,node.d2l_fileDropPosition);node.d2l_previousFileDropPosition=node.d2l_fileDropPosition},OnFileLeave:function(htmlId){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(htmlId.GetValue());D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);node.d2l_previousFileDropPosition=null}};
D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder={GetOrderedKeysNode:function(dataListNode){var result=[];var hiddens=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder-hidden",dataListNode);for(var i=0;i<hiddens.length;i++)result.push(hiddens[i].value);return result},GetUpDownLinkIds:function(itemNode){var updownLinks=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-draghandle-reorder-updownlinks",itemNode);var upLinkId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(updownLinks,
"data-upLinkId"));var downLinkId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(updownLinks,"data-downLinkId"));return{UpLinkId:upLinkId,DownLinkId:downLinkId}},InstallKeyboardEvents:function(itemNode){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(itemNode);var dragHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-draghandle-handle",itemNode);var moveItemTo=function(item,isBefore){if(item&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-datalist-item-dragdrop-reorder",
item)){D2L.LP.Web.UI.Desktop.Controls.DataList.MoveItemByNode(itemNode,item,isBefore);D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList);if(isBefore)if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabled(upLinkId))D2L.LP.Web.UI.Html.Dom.Focus(upLinkId);else D2L.LP.Web.UI.Html.Dom.Focus(downLinkId);else if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabled(downLinkId))D2L.LP.Web.UI.Html.Dom.Focus(downLinkId);else D2L.LP.Web.UI.Html.Dom.Focus(upLinkId)}};var close=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",
updownLinks)};var moveUp=function(){moveItemTo(D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(itemNode),true)};var moveDown=function(){moveItemTo(D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode),false)};var onFocus=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-offscreen",updownLinks)};var onBlur=function(){setTimeout(function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(dragHandle,activeNode))close()})};var onKeyPress=function(kpArgs){if(kpArgs.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());moveUp()}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());moveDown()}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)try{var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();activeNode.blur()}catch(e){}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(dragHandle,
function(kpArgs){onKeyPress(kpArgs)});var updownLinks=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist-item-draghandle-reorder-updownlinks",itemNode);var dragHandleIcon=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-draghandle-handle-icon",dragHandle);dragHandleIcon.appendChild(updownLinks);var upDownLinkIds=D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.GetUpDownLinkIds(itemNode);var upLinkId=upDownLinkIds.UpLinkId;var downLinkId=upDownLinkIds.DownLinkId;D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(upLinkId,
moveUp);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(downLinkId,moveDown);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnFocus(upLinkId,onFocus);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnFocus(downLinkId,onFocus);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnBlur(upLinkId,onBlur);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnBlur(downLinkId,onBlur);D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList)},UpdateDataListReorderState:function(dataList){D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(dataList);
if(dataList.d2l_reorderChangeEvent)dataList.d2l_reorderChangeEvent.Trigger();var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder",dataList);for(var i=0;i<items.length;i++){var item=items[i];var upDownLinkIds=D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.GetUpDownLinkIds(item);if(i==0){D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.UpLinkId,false);D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.DownLinkId,true)}else if(i==
items.length-1){D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.DownLinkId,false);D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.UpLinkId,true)}else{D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.UpLinkId,true);D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(upDownLinkIds.DownLinkId,true)}}}};
D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop={InstallDragDropEvents:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;var dragDropKey=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"DragDropKey");if(dragDropKey==null)return;node.d2l_itemKey=dragDropKey;var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;var dragHandleKey=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"DragDropHandle");if(dragHandleKey){var dragHandle=D2L.LP.Web.UI.Html.Dom.GetElementById(dragHandleKey);
if(dragHandle)dragSettings.SetHandle(dragHandle)}var dragGroup=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"DragGroup");if(dragGroup)dragSettings.SetDragGroup(dragGroup);var param=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"DragParam");node.d2l_DraggableSettings=dragSettings;dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.CloneShadow);dragSettings.SetKey(dragDropKey);dragSettings.SetParam(param);dragSettings.SetIsAutoScroll(true);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,
dragSettings);var dropType=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"DropType");if(dropType!=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.None){var droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings;droppableSettings.SetDropEffect(D2L.LP.Web.UI.Html.DragDrop.DropEffect.None);var acceptableDragGroups=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"AcceptableDragGroups");if(acceptableDragGroups)for(var i=0;i<acceptableDragGroups.length;i++)droppableSettings.AddAcceptableDragGroup(acceptableDragGroups[i]);
var unacceptableDragGroupsDropOn=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"UnacceptableDragGroupsDropOn");node.d2l_unacceptableDragGroupsDropOn=[];if(unacceptableDragGroupsDropOn)for(var i=0;i<unacceptableDragGroupsDropOn.length;i++)node.d2l_unacceptableDragGroupsDropOn[unacceptableDragGroupsDropOn[i]]=true;var unacceptableDragGroupsDropBeforeAfter=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"UnacceptableDragGroupsDropBeforeAfter");node.d2l_unacceptableDragGroupsDropBeforeAfter=[];if(unacceptableDragGroupsDropBeforeAfter)for(var i=
0;i<unacceptableDragGroupsDropBeforeAfter.length;i++)node.d2l_unacceptableDragGroupsDropBeforeAfter[unacceptableDragGroupsDropBeforeAfter[i]]=true;droppableSettings.SetEventPropagation(false);droppableSettings.GetDropEvent().AddListener(function(dragObject){me.DragDropHandler(node,dragSettings,dragObject)});droppableSettings.GetDragOverEvent().AddListener(function(dragObject,mouseDeltas){me.DragOverHandler(node,mouseDeltas,dragObject,dropType)});droppableSettings.GetDragOutEvent().AddListener(function(dragObject){me.DragOutHandler(node,
dragObject)});D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings);node.d2l_DroppableSettings=droppableSettings}},DragOverHandler:function(node,mouseDeltas,dragObject,dropType){var itemNode=dragObject.GetDragNode();var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;if(me.IsDescendantOf(node,itemNode))return;var position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Invalid;var isInvalidDragForDropOn=false;var isInvalidDragForDropBeforeAfter=false;var dragGroup=dragObject.GetDraggableSettings().GetDragGroup();
if(dragGroup){isInvalidDragForDropOn=node.d2l_unacceptableDragGroupsDropOn[dragGroup]||false;isInvalidDragForDropBeforeAfter=node.d2l_unacceptableDragGroupsDropBeforeAfter[dragGroup]||false}if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.All)if(!isInvalidDragForDropOn&&!isInvalidDragForDropBeforeAfter)if(mouseDeltas.topDelta/mouseDeltas.nodeHeight<0.25)position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;else if(mouseDeltas.bottomDelta/mouseDeltas.nodeHeight<0.25)position=
D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;else position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;else if(!isInvalidDragForDropBeforeAfter&&isInvalidDragForDropOn)if(mouseDeltas.topDelta<mouseDeltas.bottomDelta)position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;else position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;else{if(!isInvalidDragForDropOn&&isInvalidDragForDropBeforeAfter)position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On}else if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.OnlyDropBeforeAfter&&
!isInvalidDragForDropBeforeAfter)if(mouseDeltas.topDelta<mouseDeltas.bottomDelta)position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before;else position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.After;else if(dropType==D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.DropType.OnlyDropOn&&!isInvalidDragForDropOn)position=D2L.LP.Web.UI.Html.DragDrop.DropPosition.On;else return;itemNode.d2l_itemDropPosition=position;D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.UpdateDragOverEffect(node,position)},
DragOutHandler:function(node){D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node)},DragDropHandler:function(node,nodeDragSettings,dragObject){var me=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;me.DragOutHandler(node,dragObject);var itemNode=dragObject.GetDragNode();if(itemNode.d2l_itemDropPosition==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Invalid)return;if(me.IsDescendantOf(node,itemNode))return;var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(node);
dataList.d2l_itemDragPosition=itemNode.d2l_itemDropPosition;var draggedNodeSettings=dragObject.GetDraggableSettings();dataList.d2l_draggedNodeKey=draggedNodeSettings.GetKey();dataList.d2l_droppedOnNodeKey=nodeDragSettings.GetKey();dataList.d2l_droppedOnNodeHtmlId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);dataList.d2l_dragObjectParam=draggedNodeSettings.GetParam();dataList.d2l_dragObject=dragObject;var dataListOnDrop=D2L.LP.Web.UI.ObjectRepository.TryGet(dataList.id,"OnItemDrop");if(dataListOnDrop)dataListOnDrop.call(this)},
IsDescendantOf:function(node,dragNode){var className="d2l-datalist-item";var parentItems=D2L.LP.Web.UI.Html.Dom.GetAncestorElementsByClassName(className,node);for(var i=0;i<parentItems.length;i++){var parentNode=parentItems[i];if(dragNode.id===parentNode.id)return true}return false},RemoveDragOverEffect:function(node){var removeTargetIndicator=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-drop-target-visible");D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-drop-target-visible",
removeTargetIndicator);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-drag-over",node)},UpdateDragOverEffect:function(node,position){var dropIndicator=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist-item-drop-target",node);var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist-item-content",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-drop-target-top",dropIndicator);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-drop-target-bottom",
dropIndicator);D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop.RemoveDragOverEffect(node);if(position==D2L.LP.Web.UI.Html.DragDrop.DropPosition.Before){dropIndicator.parentNode.insertBefore(dropIndicator,contentNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-drop-target-top",dropIndicator);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-drop-target-visible",dropIndicator)}else if(position==D2L.LP.Web.UI.Html.DragDrop.DropPosition.After){D2L.LP.Web.UI.Html.Dom.InsertElementAfter(dropIndicator,
contentNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-drop-target-bottom",dropIndicator);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-drop-target-visible",dropIndicator)}else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-drag-over",node)}};
D2L.LP.Web.UI.Desktop.Controls.DataList.SimpleItems={SetIsSelected:function(itemId,isSelected){var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode==null)return;if(isSelected)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-selected",itemNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-datalist-item-selected",itemNode)}};
D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems={ClearSelection:function(clearSelectAll){if(clearSelectAll!=null)clearSelectAll.call(clearSelectAll)},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems},GetCheckboxNode:function(itemNode){return D2L.LP.Web.UI.Common.Controls.Checkbox.GetFirstChildCheckboxInputNode(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode))},GetItemSelectedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var dataList=
D2L.LP.Web.UI.Desktop.Controls.DataList;return dataList.GetEvent(id.GetValue(),me.OnItemSelectedEvent)},GetOnLoadCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadCompletedEvent(id)},GetOnLoadMoreCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadMoreCompletedEvent(id)},GetOnPageEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnPageEvent(id)},GetOnPageCompletedEvent:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnPageCompletedEvent(id)},
GetParam:function(selectionProvider){if(selectionProvider==null)return null;return new D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.Param(selectionProvider.call(selectionProvider))},GetSelectedValues:function(id){return D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.GetValues(id,true)},GetValues:function(id,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-checkboxitem");var values=
[];for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null)if(isSelected===undefined||checkboxNode.checked==isSelected)values.push(checkboxNode.value)}return values},HighlightItemByNode:function(itemNode){D2L.LP.Web.UI.Desktop.Controls.DataList.HighlightItemByNode(itemNode)},InitializeCheckboxItem:function(itemNode,groupName){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var checkboxNode=
me.GetCheckboxNode(itemNode);if(checkboxNode===null)return;var setItemStyles=function(cbNode){if(!cbNode.disabled)if(cbNode.checked)dataList.AddItemClassNames(itemNode,"d2l-datalist-item-selected");else dataList.RemoveItemClassNames(itemNode,"d2l-datalist-item-selected")};setItemStyles(checkboxNode);if(groupName===undefined){var listNode=itemNode.parentNode;if(listNode!==null&&listNode.parentNode!==null)groupName=listNode.parentNode.getAttribute("id")}var itemMarginNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);
var checkboxContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemMarginNode);var expandedClickHandler=function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget===itemNode||eventTarget===itemMarginNode||eventTarget===checkboxContainerNode)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",checkboxNode)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",itemNode,expandedClickHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",checkboxNode,function(){if(checkboxNode.d2l_checked!==
undefined&&checkboxNode.d2l_checked!==null&&checkboxNode.d2l_checked!==checkboxNode.checked)checkboxNode.checked=checkboxNode.d2l_checked;checkboxNode.d2l_checked=null;if(!checkboxNode.disabled){setItemStyles(checkboxNode);var evt=me.GetItemSelectedEvent(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(groupName));evt.Trigger(checkboxNode.value,checkboxNode.checked)}})},OnItemSelectedEvent:{},SetIsSelectionReadOnly:function(id,isReadOnly){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isReadOnly&&
!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node))D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-readonly",node);else if(!isReadOnly&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-readonly",node)},SetSelection:function(id,type,values){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-checkboxitem");var getIsSelectionValue=function(value){for(var i=
0;i<values.length;i++)if(values[i]==value)return true;return false};var setSelection=function(isSelectedDelegate){for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!checkboxNode.disabled){var isSelected=isSelectedDelegate.call(isSelectedDelegate,checkboxNode);if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",checkboxNode)}}}};if(type==D2L.LP.LayeredArch.SelectionFilterType.All)setSelection(function(){return true});
else if(type==D2L.LP.LayeredArch.SelectionFilterType.None)setSelection(function(){return false});else if(type==D2L.LP.LayeredArch.SelectionFilterType.AllExcept)setSelection(function(checkboxNode){return!getIsSelectionValue(checkboxNode.value)});else if(type==D2L.LP.LayeredArch.SelectionFilterType.Some)setSelection(function(checkboxNode){return getIsSelectionValue(checkboxNode.value)})},SetIsSelected:function(id,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;var itemNodes=
D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-checkboxitem");for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&checkboxNode.value==value&&!checkboxNode.disabled)if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",checkboxNode);return}}},SetIsAllSelected:function(id,isSelected,itemNodes){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems;if(itemNodes===
undefined)itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-checkboxitem");for(var i=0;i<itemNodes.length;i++){var checkboxNode=me.GetCheckboxNode(itemNodes[i]);if(checkboxNode!=null&&!checkboxNode.disabled)if(checkboxNode.checked!=isSelected){checkboxNode.d2l_checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",checkboxNode)}}}};
D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.Param=D2L.Class.Create({Construct:function(selection){this.m_selection=selection},_serialize:function(serializer){serializer.AddMember("selection",this.m_selection)},GetSelection:function(){return this.m_selection}});
D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems={GetRadioNode:function(itemNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode))},GetSelectedValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-radioitem");for(var i=0;i<itemNodes.length;i++){var radioNode=me.GetRadioNode(itemNodes[i]);if(radioNode!=null&&radioNode.checked)return radioNode.value}return null},
InitializeRadioItem:function(itemNode,groupName){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var radioNode=me.GetRadioNode(itemNode);if(radioNode==null)return;if(groupName===undefined){var listNode=itemNode.parentNode;if(listNode!=null&&listNode.parentNode!=null)groupName=listNode.parentNode.getAttribute("id")}if(groupName!==undefined)D2L.LP.Web.UI.Html.Dom.SetAttribute(radioNode,"name",groupName);var itemMarginNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);
var expandedClickHandler=function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget===itemNode||eventTarget===itemMarginNode)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",radioNode)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",itemNode,expandedClickHandler);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",radioNode,function(){var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-selected",itemNode.parentNode);for(var i=0;i<itemNodes.length;i++)dataList.RemoveItemClassNames(itemNodes[i],
"d2l-datalist-item-selected");if(!radioNode.disabled)if(radioNode.checked)dataList.AddItemClassNames(itemNode,"d2l-datalist-item-selected")})},SetIsSelected:function(id,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNodes=D2L.LP.Web.UI.Desktop.Controls.DataList.GetItemsNodes(id,"d2l-datalist-radioitem");me.SetIsSelectedByItemNodes(itemNodes,value,isSelected)},SetIsSelectedByItemNodes:function(itemNodes,value,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;
for(var i=0;i<itemNodes.length;i++){var radioNode=me.GetRadioNode(itemNodes[i]);if(radioNode!=null&&radioNode.value==value&&!radioNode.disabled)if(radioNode.checked!=isSelected){radioNode.checked=isSelected;D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",radioNode);return}}},SetIsSelectedByItemId:function(itemId,isSelected){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());if(itemNode==null)return;var radioNode=me.GetRadioNode(itemNode);
if(radioNode==null)return;var listNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-datalist",itemNode);if(listNode==null)return;var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-radioitem",listNode);me.SetIsSelectedByItemNodes(itemNodes,radioNode.value,isSelected)}};
D2L.LP.Web.UI.Desktop.Controls.DataList.Summary={GetSelectAllIdByDataListId:function(dataListId){var me=D2L.LP.Web.UI.Desktop.Controls.DataList.Summary;var summaryNode=me.GetSummaryNode(dataListId);if(summaryNode==null)return null;var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-selectall",summaryNode);if(selectAllNode==null)return null;return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute("id"))},GetSelectionInfo:function(provider){if(provider==
null)return null;return provider.call(provider)},GetSummaryNode:function(dataListId){var dataListNode=D2L.LP.Web.UI.Html.Dom.GetElementById(dataListId.GetValue());var summaryNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist-summary",dataListNode);return summaryNode},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event;events[id]=evt}return evt},OnSelectionUpdatedEvents:{},GetSelectionUpdatedEvent:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.DataList.Summary;return me.GetEvent(id.GetValue(),me.OnSelectionUpdatedEvents)}};
D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder={Init:function(startId,endId,autoShiftDates){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var trb=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var startNodes=dts.GetNodes(startId);var endNodes=dts.GetNodes(endId);var isSameDay=function(){var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);return me.IsSameDay(startDate,endDate)};var validate=
function(){var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=me.Validate(startNodes,endNodes);if(isValid){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",endNodes.edit);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",startNodes.edit)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",endNodes.edit);if(!isVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",startNodes.edit)}};var startDateChange=function(date,
prevDate){var endDate=dts.GetSelectedDateTimeNodes(endNodes);var jsDate=D2L.LocalDateTime.ToJavaScriptDate(date);var jsPrevDate=D2L.LocalDateTime.ToJavaScriptDate(prevDate);var jsEndDate=D2L.LocalDateTime.ToJavaScriptDate(endDate);var isValid=jsEndDate.getTime()-jsPrevDate.getTime()>=0;if(isValid&&autoShiftDates){var diff=jsDate.getTime()-jsPrevDate.getTime();var jsNewEndDate=new Date(jsEndDate.getTime()+diff);var newEndDate=D2L.LocalDateTime.FromJavaScriptDate(jsNewEndDate);dts.SetSelectedDateTimeByNode(endNodes,
newEndDate)}validate()};var startTimeChange=function(time,prevTime){var hasTime=dts.GetHasTimeNodes(startNodes);if(!hasTime)return;trb.OnStartChange(startNodes.timeNodes,endNodes.timeNodes,time,prevTime,isSameDay(),autoShiftDates)};var endTimeChange=function(){var hasTime=dts.GetHasTimeNodes(endNodes);if(!hasTime)return;trb.RenderValidation(startNodes.timeNodes,endNodes.timeNodes,isSameDay())};startNodes.container.d2l_onChange.AddListener(startDateChange);startNodes.timeNodes.container.d2l_onChange.AddListener(startTimeChange);
endNodes.container.d2l_onChange.AddListener(function(){validate()});endNodes.timeNodes.container.d2l_onChange.AddListener(endTimeChange)},IsSameDay:function(startDate,endDate){return startDate.GetYear()==endDate.GetYear()&&startDate.GetMonth()==endDate.GetMonth()&&startDate.GetDay()==endDate.GetDay()},ValidateIds:function(startId,endId){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var me=D2L.LP.Web.UI.Desktop.Controls.DateRangeBinder;var startNodes=dts.GetNodes(startId);var endNodes=dts.GetNodes(endId);
var isDateValid=me.Validate(startNodes,endNodes);if(!isDateValid)return false;var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);var hasTime=dts.GetHasTimeNodes(endNodes);if(!hasTime)return true;var isSameDay=me.IsSameDay(startDate,endDate);if(!isSameDay)return true;var trb=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var isTimeValid=trb.ValidateNodes(startNodes.timeNodes,endNodes.timeNodes);return isTimeValid},Validate:function(startNodes,
endNodes){var dts=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var startDate=dts.GetSelectedDateTimeNodes(startNodes);var endDate=dts.GetSelectedDateTimeNodes(endNodes);var startIsEnabled=dts.IsEnabledNodes(startNodes);var endIsEnabled=dts.IsEnabledNodes(endNodes);if(!startIsEnabled||!endIsEnabled)return true;if(endDate.GetYear()!==startDate.GetYear())return endDate.GetYear()>startDate.GetYear();if(endDate.GetMonth()!==startDate.GetMonth())return endDate.GetMonth()>startDate.GetMonth();return endDate.GetDay()>=
startDate.GetDay()}};
D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector={IsEnabledNodes:function(nodes){return!nodes.edit.disabled},SetHasTime:function(id,hasTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsVisibleNode(nodes.timeNodes.container,hasTime);nodes.hasTime.value=hasTime?"1":"0"},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetIsEnabledNodes(nodes,isEnabled)},
GetIsEnabled:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.IsEnabledNodes(nodes)},SetIsEnabledNodes:function(nodes,isEnabled){nodes.isEnabled.value=isEnabled?"1":"0";nodes.edit.disabled=!isEnabled;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(nodes.calendarLink,isEnabled);D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetIsEnabledNodes(nodes.timeNodes,isEnabled);var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var dateTime=me.GetSelectedDateTimeNodes(nodes);
nodes.container.d2l_onChange.Trigger(dateTime,dateTime)},SetSelectedDateTime:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);me.SetSelectedDateTimeByNode(nodes,selectedDateTime)},SetSelectedDateTimeByNode:function(nodes,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var prevDateTime=me.GetSelectedDateTimeNodes(nodes);var formatter=D2L.LP.Globalization.Locale.GetDateTimeFormatter();nodes.edit.value=formatter.FormatInputDate(selectedDateTime);
nodes.edit.d2l_lastGoodDate=selectedDateTime;nodes.year.value=selectedDateTime.GetYear();nodes.month.value=selectedDateTime.GetMonth();nodes.day.value=selectedDateTime.GetDay();var time=new D2L.LocalTime(selectedDateTime.GetHour(),selectedDateTime.GetMinute());D2L.LP.Web.UI.Desktop.Controls.TimeSelector.SetTimeNodes(nodes.timeNodes,time);setTimeout(function(){var miniCalPartialRenderFunction=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,"CalPartial");me.RefreshMiniCalendar(miniCalPartialRenderFunction)});
nodes.container.d2l_onChange.Trigger(selectedDateTime,prevDateTime)},SetSelectedDateByInputNodeId:function(id,selectedDateTime){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);var dateTime=me.GetSelectedDateTimeNodes(nodes);selectedDateTime=new D2L.LocalDateTime(selectedDateTime.GetYear(),selectedDateTime.GetMonth(),selectedDateTime.GetDay(),dateTime.GetHour(),dateTime.GetMinute(),0);me.SetSelectedDateTimeByNode(nodes,selectedDateTime)},GetSelectedDateTime:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var nodes=me.GetNodes(id);return me.GetSelectedDateTimeNodes(nodes)},GetSelectedDateTimeNodes:function(nodes){var year=parseInt(nodes.year.value);var month=parseInt(nodes.month.value);var day=parseInt(nodes.day.value);var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);return new D2L.LocalDateTime(year,month,day,time.GetHour(),time.GetMinute(),time.GetSecond())},GetNodes:function(id,phid){var idVal=id.GetValue();var edit=
D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(edit===null)throw"DateTimeSelector not found:'"+idVal+"'.";var container=edit.parentNode.parentNode;var timeContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-time-selector",container);var timeEdit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(timeContainer);var timeNodes=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(timeEdit.id));var hiddens=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-hiddens",
container);var calendarLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-calendar-link",container);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container",container);var placeholderContainer;if(phid==undefined||phid==null)placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-placeholder",floatingContainer);else{placeholderContainer=D2L.LP.Web.UI.Html.Dom.GetElementById(phid);floatingContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-floating-container",
placeholderContainer)}var miniCalendar;if(placeholderContainer==null||placeholderContainer==undefined)miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",floatingContainer);else miniCalendar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini",placeholderContainer);var year=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(hiddens);var month=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(year);var day=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(month);var hasTime=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(day);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hasTime);return{container:container,edit:edit,timeNodes:timeNodes,year:year,month:month,day:day,hasTime:hasTime,isEnabled:isEnabled,calendarLink:calendarLink,floatingContainer:floatingContainer,miniCalendar:miniCalendar}},OpenMiniCalendar:function(floatingContainerId,dateInputId,openerId,focus,focusOnOpenTargetId){if(!D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(floatingContainerId)){var openerNode=
D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(floatingContainerId,openerId,{AttachToBody:false,AutoCloseExclusions:[openerNode],FocusOnOpen:focus,FocusOnOpenTargetControlId:focusOnOpenTargetId,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TargetId:dateInputId})}},RefreshMiniCalendar:function(partialRenderFunction){partialRenderFunction.call(partialRenderFunction)},GetHasTimeNodes:function(nodes){var hasTime=nodes.hasTime.value==
"1";return hasTime},ValidateRange:function(id,ignoreTime,earliest,latest){var selectedDate=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector.GetSelectedDateTime(id);if(earliest!==null&&latest!==null){var isEarly=D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)<0;var isLate=D2L.LocalDateTime.Compare(selectedDate,latest,ignoreTime)>0;return!isEarly&&!isLate}else if(earliest!==null)return D2L.LocalDateTime.Compare(selectedDate,earliest,ignoreTime)>=0;else return D2L.LocalDateTime.Compare(selectedDate,
latest,ignoreTime)<=0}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace={Click:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,false)},ClickHelper:function(node,autoResize){var id=node.id;$("#"+id).parent().attr("data-isOpen","true");var targetId=D2L.LP.Web.UI.ObjectRepository.TryGet(id);if(targetId==null)return;var targetIdValue=targetId.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetIdValue);target.d2l_opener=node;if(autoResize){var rect=
D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);target.style.width=Math.max(rect.width,100)+"px";target.style.minHeight=rect.height+"px"}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,true);if(D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdValue,"edit")){var onEdit=D2L.LP.Web.UI.ObjectRepository.Get(targetIdValue,"edit");onEdit()}},Finish:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target)},
FinishHelper:function(target,doTrigger,isEmpty){var targetIdVal=target.id;var opener=target.d2l_opener;var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(opener);target.d2l_opener=null;if(isEmpty!==undefined)D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(opener,isEmpty);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(opener,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(target,false);if(doTrigger){var hasFinish=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,"finish");if(hasFinish){var onFinish=
D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,"finish");var ret=onFinish();ret.AddListener(function(){var editable=$(target).prev()[0];D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(editable)})}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-editable-changed",opener)}else{var hasAbort=D2L.LP.Web.UI.ObjectRepository.HasKeys(targetIdVal,"abort");if(hasAbort){var onAbort=D2L.LP.Web.UI.ObjectRepository.Get(targetIdVal,"abort");onAbort()}}setTimeout(function(){D2L.LP.Web.UI.Html.Dom.FocusNode(anchor)},
0);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-editable-changed",opener)},1500)},GetHtmlEditorContent:function(id){var htmlEditorId=$("#"+id.GetValue()).attr("data-d2l-htmleditorid");var htmlParam=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(htmlEditorId));return htmlParam},IsEditorOpen:function(id){return $("#"+id.GetValue()).attr("data-isOpen")},ModifyAnchors:function(node){$(node).find("a").attr("target","_blank")},SetIsEmpty:function(id,
isEmpty){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.EditInPlace.SetIsEmptyHelper(node,isEmpty)},SetIsEmptyHelper:function(node,isEmpty){var empty=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-editable-empty",node);if(empty!==null)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(empty,isEmpty);var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-editable-content",node);if(container!==null)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(container,
!isEmpty)}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Edit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-edit",target);D2L.LP.Web.UI.Common.Controls.Edit.ClearValueNode(edit)},OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;edit.select()}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace.EditUrl={OnEdit:function(id){var edit=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());edit.d2l_value=edit.value;if(edit.value=="")edit.value="http://";edit.select()}};D2L.LP.Web.UI.Desktop.Controls.EditInPlace.LongEdit={Clear:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-longedit",target);D2L.LP.Web.UI.Common.Controls.LongEdit.ClearValueNode(edit)}};
D2L.LP.Web.UI.Desktop.Controls.EditInPlace.HtmlEditor={Cancel:function(editorId,targetId){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId.GetValue());D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetHtml(editorId,target.d2l_html);D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target)},GetHtml:function(id){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(target.d2l_html!==undefined)return target.d2l_html;else return""},GetEditorLoadedEvent:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);
var targetId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-targetId");var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId);return target.d2l_editorLoadedEvt},OnEdit:function(id,editorId,html){var targetId=id.GetValue();var target=D2L.LP.Web.UI.Html.Dom.GetElementById(targetId);if(target.d2l_initialized==true)D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId);else{if(target.d2l_html===undefined)target.d2l_html=html;var evt=target.d2l_editorLoadedEvt;var initializeEditor=D2L.LP.Web.UI.ObjectRepository.TryGet(targetId,
"initializeEditor");if(initializeEditor!=null){initializeEditor.call(initializeEditor).AddListener(function(){evt.Trigger(editorId);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Focus(editorId)});target.d2l_initialized=true}}},Update:function(id,param){var target=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var hasChanged=false;var newHtml=param.GetHtml();if(target.d2l_html!=newHtml){target.d2l_html=newHtml;hasChanged=true}var isEmpty=newHtml==null||newHtml.length==0;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(target,
hasChanged,isEmpty)}};
D2L.LP.Web.UI.Desktop.Controls.EditableEditUrl={SetUrl:function(id,url){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href",url)},SetUrlDisplay:function(id,url,displayWithProtocol){if(!displayWithProtocol)url=D2L.LP.Web.UI.Desktop.Controls.EditableEditUrl.StripProtocol(url);D2L.LP.Web.UI.Common.Controls.TextBlock.SetText(id,url)},StripProtocol:function(url){var seperator="://";if(url.indexOf(seperator)!=-1)url=url.substring(url.indexOf(seperator)+seperator.length);
return url}};D2L.LP.Web.UI.Desktop.Controls.EquationEditor={};
D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor={SetMath:function(node,math){if(math!=null){math=math.replace(/&#x9;/g,"\t");math=math.replace(/&#xA;/g,"\n");math=math.replace(/&#xD;/g,"\r")}var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);latexnode.value=math},GetMath:function(node,callback){var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);callback.call(callback,latexnode.value)},AreLatexDelimitersSpecified:function(latex){if(/^\\\(/.test(latex)&&
/\\\)$/.test(latex))return true;else if(/^\$\$/.test(latex)&&/\$\$$/.test(latex))return true;else if(/^\\\[/.test(latex)&&/\\\]$/.test(latex))return true;else return false},GetMathML:function(node,callback){var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);var hiddennode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",node);var latex=latexnode.value;latex=latex.replace(/^\s+/,"").replace(/\s+$/,"");if(latex!=""){if(D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.AreLatexDelimitersSpecified(latex))hiddennode.innerHTML=
latex;else hiddennode.innerHTML="$$"+latex+"$$";D2L.LP.Web.UI.Html.Math.UpdateNode(hiddennode);D2L.LP.Web.UI.Html.Math.GetMath(hiddennode,function(math){if(math!=null&&math.length>0)if(math.length==1)callback.call(callback,math[0].mathML);else{var decodeCharRef=function(match){return match.replace("&amp;","&")};var multiLineMathML="";for(var i=0;i<math.length;i++){multiLineMathML+="<mtr><mtd>";multiLineMathML+=math[i].mathML.replace(/&amp;[\S]*?;/g,decodeCharRef).replace(/<math[^>]*(.|\n|\r)*?>/gi,
"").replace(/<\/math>/gi,"");multiLineMathML+="</mtd></mtr>"}multiLineMathML='<math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable>'+multiLineMathML+"</mtable></math>";callback.call(callback,multiLineMathML)}else callback.call(callback,"")})}else callback.call(callback,"")},SetPreviewMathML:function(previewNode,mathml){previewNode.innerHTML=mathml;D2L.LP.Web.UI.Html.Math.UpdateNode(previewNode)},GetAnnotatedMathML:function(node,callback){var me=this;me.GetMathML(node,function(mathml){me.GetMath(node,
function(math){var format="latex";if(math.indexOf("<math")==0)format="mathml";var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML(format,"",math,mathml);callback.call(callback,annotatedMathML)})})}};
D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor={SetMath:function(node,math){if(math==null)return;math=D2L.LP.Web.UI.Html.Math.DecodeMathML(math);var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);if(graphicalEditor!=null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",graphicalEditor))D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetGraphicalMath(node,math);var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",
node);if(mathmleditor!=null&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",mathmleditor))D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetMathMLMath(node,math)},SetGraphicalMath:function(node,math){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var editor=com.wiris.jsEditor.JsEditor.getInstance(graphicalEditor);editor.setMathML(math)},SetMathMLMath:function(node,math){var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",
node);mathmleditor.value=math},ReplaceSelfClosingTags:function(text){var selfClosingRegex=/<\w+(\s+[^\\>]*)?\/>/gim;return text.replace(selfClosingRegex,function(match){var regexp=/<(\w+)(\s+([^\\>]*)?)?\/>/gim;var result=regexp.exec(match);if(result[3]==null)return"<"+result[1]+"></"+result[1]+">";else return"<"+result[1]+" "+result[3]+"></"+result[1]+">"})},GetWirisMath:function(node,callback){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);
var editor=com.wiris.jsEditor.JsEditor.getInstance(graphicalEditor);var mathml=editor.getMathML();callback.call(callback,D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.ReplaceSelfClosingTags(mathml))},GetMath:function(node,callback){var graphicalEditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor");var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmlequationeditor");if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",graphicalEditor))D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetMathML(mathmleditor,
function(mathml){callback.call(callback,mathml)});else D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetWirisMath(function(mathml){callback.call(callback,mathml)})},GetMathML:function(node,callback){var mathmleditor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",node);hidden.innerHTML=mathmleditor.value;D2L.LP.Web.UI.Html.Math.UpdateNode(hidden);D2L.LP.Web.UI.Html.Math.GetMath(hidden,
function(math){callback.call(callback,math)})},ToggleEditor:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor;var dom=D2L.LP.Web.UI.Html.Dom;var graphical=dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var mathml=dom.GetFirstElementByClassName("d2l-mathmlequationeditor",node);if(dom.HasClassName("d2l-hidden",graphical)){me.GetMathML(node,function(math){if(math.length==1)me.SetGraphicalMath(node,me.ReplaceSelfClosingTags(math[0].mathML))});dom.RemoveClassName("d2l-hidden",
graphical);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.HideMathML(node,true)}else{me.GetWirisMath(node,function(math){me.SetMathMLMath(node,math)});dom.AddClassName("d2l-hidden",graphical);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.HideMathML(node,false)}},HideMathML:function(node,hide){var editor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathmleditorarea",node);var preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);
var previewError=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview-error",node);var generatePreview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-showequationpreview",node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,false);if(hide){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(generatePreview,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(editor,true);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",editor);
if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",preview))D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",preview);preview.innerHTML="";D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(previewError,false)}else{D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(editor,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(generatePreview,true)}},GeneratePreview:function(node){var preview=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);var hidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-hiddenmath",
node);var previewError=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview-error",node);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.GetMathML(node,function(mathml){if(mathml==null||mathml.length==0){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,false);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(previewError,true)}else{hidden.innerHTML=mathml[0].mathML;D2L.LP.Web.UI.Html.Math.UpdateNode(hidden,
function(){preview.innerHTML=hidden.innerHTML;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(previewError,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(preview,true);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(preview,true)})}})},UpdateDialogSize:function(node,adjust){var heightAdjust=0;if(adjust){var nodeSize=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);heightAdjust=nodeSize.height}var win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-frame",
win.parent.document);var dialog=null;for(var i=0;i<dialogs.length;i++)if(dialogs[i].contentWindow==win)dialog=dialogs[i].parentNode.parentNode;if(dialog!=null&&dialog.d2l_handle!=null){var eqnEditor=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-equationeditor",node);var height=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(eqnEditor,"data-d2l-initialheight"));D2L.LP.Web.UI.Desktop.MasterPages.Dialog.SetSize(dialog.d2l_handle,dialog.d2l_handle.width,height+heightAdjust)}},HidePreview:function(node){var preview=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);preview.innerHTML="";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",preview);D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.UpdateDialogSize(preview)},GetAnnotatedMathML:function(node,callback){var ret=new D2L.LP.Web.UI.Events.Event;var me=this;var editor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);if(editor==null||D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",editor))me.GetMathML(node,
function(mathml){var math=mathml[0].mathML;var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("mathml","",math,math);ret.Trigger(annotatedMathML);callback.call(callback,annotatedMathML)});else me.GetWirisMath(node,function(mathml){var annotatedMathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("wiris","",mathml,mathml);ret.Trigger(annotatedMathML);callback.call(callback,annotatedMathML)});return ret}};
D2L.LP.Web.UI.Desktop.Controls.FileInput={AddFiles:function(id,files){var evt=new D2L.LP.Web.UI.Events.Event;var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var placeholderNode=me.GetFilePlaceholder(node);var listNode=me.GetFileListNode(node);if(placeholderNode==null){evt.Release();return evt}var placeholderId=placeholderNode.getAttribute("id");var onAddFile=D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId,1);if(onAddFile==null){evt.Release();
return evt}node.d2l_addFiles=files;onAddFile.call(onAddFile).AddListener(function(){node.d2l_lastAddedFiles=node.d2l_addFiles;var onAddFilesComplete=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute("id"),"OnAddFilesComplete");if(onAddFilesComplete!==null)onAddFilesComplete.call(onAddFilesComplete);node.d2l_addFiles=undefined;me.SetAddFileVisibility(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",listNode);node.d2l_changeEvent.Trigger();evt.Trigger()});return evt},Clear:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-placeholder",itemNode))me.RemoveFile(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemNode.getAttribute("id")));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}me.SetErrorMessageVisibility(node,"d2l-fileinput-filecount-error",
false);me.SetErrorMessageVisibility(node,"d2l-fileinput-filetype-error",false);me.SetErrorMessageVisibility(node,"d2l-fileinput-filesize-error",false);me.SetErrorMessageVisibility(node,"d2l-fileinput-fileupload-error",false)},GetAbortLinkNodeByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(progressBarNode);return abortLinkNode},GetAddButtonsNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-addbuttons",
node)},GetAddFilesByPlaceholderId:function(placeholderId){var placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-fileinput",placeholderNode);if(node.d2l_addFiles!==undefined)return node.d2l_addFiles;else return[]},GetFileCount:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var fileCount=0;var listNode=me.GetFileListNode(node);var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);
while(itemNode!=null){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",itemNode)&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-placeholder",itemNode))fileCount++;itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return fileCount},GetFileListNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-filelist",node)},GetFilePlaceholder:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-placeholder",node)},
GetFiles:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var listNode=me.GetFileListNode(node);var files=[];var itemNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(listNode);while(itemNode!=null){var fileName=itemNode.getAttribute("data-d2l-name");var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);
var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);files.push(new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value));itemNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(itemNode)}return files},GetLastAddedFiles:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var files=node.d2l_lastAddedFiles;if(node.d2l_lastAddedFiles===undefined&&node.d2l_lastAddedFiles===null)files=
[];return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files)},GetParam:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var files=me.GetFiles(id);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(files)},GetProgressBarNodeByNode:function(node){var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-upload-progress",node);return progressBarNode},GetRemovedFile:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var removedFile=
[];removedFile.push(node.d2l_removedFile);return new D2L.LP.Web.UI.Desktop.Controls.FileInput.Param(removedFile)},GetUploadButtonId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var buttons=D2L.LP.Web.UI.Desktop.Controls.FileInput.GetAddButtonsNode(node);var uploadButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(buttons);return uploadButton.id},HideErrorMessages:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;me.HideErrorMessagesByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},
HideErrorMessagesByNode:function(node){var errorsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-errors",node);var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(errorsNode);while(errorNode!=null){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",errorNode);errorNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(errorNode)}},OnDropAbort:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node)},
OnDropError:function(id,errorNumber){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.ResetUploadByNode(node);if(errorNumber===1)me.SetErrorMessageVisibility(node,"d2l-fileinput-filecount-error",true);else if(errorNumber===2)me.SetErrorMessageVisibility(node,"d2l-fileinput-filetype-error",true);else if(errorNumber===3)me.SetErrorMessageVisibility(node,"d2l-fileinput-filesize-error",true);else me.SetErrorMessageVisibility(node,"d2l-fileinput-fileupload-error",
true)},OnDropFilesComplete:function(id,files){var evt=null;var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(files!=null&&files.length>0){var fileInputFiles=[];for(var i=0;i<files.length;i++)fileInputFiles.push(new D2L.LP.Web.UI.Files.File(files[i].GetId(),files[i].GetFileSystemType(),files[i].GetName(),files[i].GetSize()));evt=me.AddFiles(id,fileInputFiles)}me.UpdateProgressBarByNode(node.getAttribute("data-d2l-msg-uploadcomplete"),100,
me.GetProgressBarNodeByNode(node));me.ResetUploadByNode(node);return evt},OnDropProgress:function(id,progress){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.UpdateProgressBarByNode(progress.GetFileName(),progress.GetTotalPercent(),progressBarNode)},OnDropStarted:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var progressBarNode=me.GetProgressBarNodeByNode(node);
var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=true;me.HideErrorMessagesByNode(node);me.SetAddFileEnabled(node);me.UpdateProgressBarByNode("",0,progressBarNode);setTimeout(function(){if(node.d2l_isUploading){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",progressBarNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",abortLinkNode)}},500)},RemoveFile:function(itemId){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());
var listNode=itemNode.parentNode;var actionTypeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode);if(actionTypeNode.value==="None")actionTypeNode.value="Remove";else if(actionTypeNode.value==="Add")actionTypeNode.value="AddRemove";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",itemNode);var node=listNode.parentNode;me.SetAddFileVisibility(node);var count=me.GetFileCount(node);if(count===0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",listNode);var fileName=itemNode.getAttribute("data-d2l-name");
var pluginKeyNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(actionTypeNode);var idNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pluginKeyNode);var fileSizeNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(idNode);node.d2l_removedFile=new D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam(fileName,actionTypeNode.value,pluginKeyNode.value,idNode.value,fileSizeNode.value);var onRemoveFile=D2L.LP.Web.UI.ObjectRepository.TryGet(node.getAttribute("id"),"OnRemoveFile");if(onRemoveFile!==null)onRemoveFile.call(onRemoveFile);
node.d2l_changeEvent.Trigger()},ResetUploadByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var progressBarNode=me.GetProgressBarNodeByNode(node);var abortLinkNode=me.GetAbortLinkNodeByNode(node);node.d2l_isUploading=false;me.SetAddFileEnabled(node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",abortLinkNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",progressBarNode)},SetAddFileEnabled:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var isEnabled=node.d2l_isAddFileAllowed&&
!node.d2l_isUploading;var addButtonsContainer=me.GetAddButtonsNode(node);var addButtonNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("vui-button",addButtonsContainer);for(var i=0;i<addButtonNodes.length;i++)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(addButtonNodes[i].getAttribute("id")),isEnabled);var browseNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filebrowse-label",addButtonsContainer);if(browseNode!=null)D2L.LP.Web.UI.Html.Files.FileUpload.FileBrowse.Default.SetIsBrowseLabelEnabled(browseNode,
isEnabled)},SetAddFileVisibility:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;node.d2l_isAddFileAllowed=false;if(node.getAttribute("data-d2l-ismultiple")=="true")node.d2l_isAddFileAllowed=true;else node.d2l_isAddFileAllowed=me.GetFileCount(node)==0;var isAddDisplayed=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-fileinput-add",node);if(node.d2l_isAddFileAllowed==isAddDisplayed)return;D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default.SetIsEnabledByNode(node,node.d2l_isAddFileAllowed);
if(node.d2l_isAddFileAllowed)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-fileinput-add",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-fileinput-add",node)},SetErrorMessageVisibility:function(node,className,isVisible){var errorNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(className,node);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(errorNode,isVisible)},UpdateProgressBarByNode:function(text,percent,node){var progressBarTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileinput-upload-progress-bar",
node));var progressBarColourNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(progressBarTextNode);var isPercent=!isNaN(percent);if(isPercent)progressBarTextNode.innerHTML=text+" "+percent.toString()+"%";else progressBarTextNode.innerHTML=text+" - Uploading";if(percent==0||!isPercent){progressBarColourNode.style.width="0px";progressBarColourNode.style.backgroundColor="transparent"}else{if(progressBarColourNode.parentNode.clientWidth==0)progressBarColourNode.style.width="100%";else progressBarColourNode.style.width=
progressBarColourNode.parentNode.clientWidth*percent/100-8+"px";if(progressBarColourNode.style.backgroundColor=="transparent")progressBarColourNode.style.backgroundColor=""}if(isPercent)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuenow",percent.toString())},ValidateRequired:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return me.GetFileCount(node)>0},ValidateUploadInProgress:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
return node.d2l_isUploading===undefined||node.d2l_isUploading===false}};D2L.LP.Web.UI.Desktop.Controls.FileInput.Param=D2L.Class.Create({Construct:function(files){if(files===undefined)files=[];this.m_files=files},_serialize:function(serializer){serializer.AddMember("files",this.m_files)},GetFiles:function(){return this.m_files}});
D2L.LP.Web.UI.Desktop.Controls.FileInput.FileParam=D2L.Class.Create({Construct:function(fileName,actionType,pluginKey,id,fileSize){if(actionType===undefined)actionType="";if(pluginKey===undefined)pluginKey="";if(id===undefined)id="";if(fileSize===undefined)fileSize="";this.m_fileName=fileName;this.m_actionType=actionType;this.m_pluginKey=pluginKey;this.m_id=id;this.m_fileSize=fileSize},_serialize:function(serializer){serializer.AddMember("actionType",this.m_actionType);serializer.AddMember("pluginKey",
this.m_pluginKey);serializer.AddMember("id",this.m_id)},GetActionType:function(){return this.m_actionType},GetPluginKey:function(){return this.m_pluginKey},GetId:function(){return this.m_id},GetFileName:function(){return this.m_fileName},GetFileSize:function(){return this.m_fileSize}});
D2L.LP.Web.UI.Desktop.Controls.FileInput.LegacyAddFile={AddFile:function(fileInputId,openFunction){openFunction.call(openFunction).AddListener(function(files){if(files==null||files.length==0)return;var fileInputFiles=[];for(var i=0;i<files.length;i++)fileInputFiles.push(new D2L.LP.Web.UI.Files.File(files[i].FileId,files[i].FileSystemType,files[i].FileName,files[i].Size));D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFiles)})}};
D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordAudioFile={SaveAudio:function(id,openFunction){openFunction.call(openFunction).AddListener(function(files){D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(id,files)})}};
D2L.LP.Web.UI.Desktop.Controls.FileInput.RecordVideoFile={AddFile:function(fileInputId,openFunction){openFunction.call(openFunction).AddListener(function(file){if(file==null||file.length==0)return;var fileInputFile=new D2L.LP.Web.UI.Files.File(file.FileId,file.FileSystemType,file.FileName,file.Size);D2L.LP.Web.UI.Desktop.Controls.FileInput.AddFiles(fileInputId,fileInputFile)})}};D2L.LP.Web.UI.Desktop.Controls.FileLink={OnChangeEvents:{}};
D2L.LP.Web.UI.Desktop.Controls.FileUpload={CallbackNumber:0,ErrCodeMaxFileSize:1E3,ErrCodeTotalFileSize:1001,ErrCodeRestrictedFile:1002,CheckFileType:function(file){var _type=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileType(file);if(_type===false)return false;for(var i=0;i<D2L.LP.Web.UI.Desktop.Controls.FileUpload.FileTypeWhiteList.length;i++)if(_type===D2L.LP.Web.UI.Desktop.Controls.FileUpload.FileTypeWhiteList[i])return true;return false},GenerateIFrame:function(name,parentNode){var _hiddenIFrame;
if(parentNode.insertAdjacentHTML){parentNode.insertAdjacentHTML("beforeEnd","<iframe id='"+name+"' name='"+name+"' class='d2l-offscreen d2l-hidden "+name+"'></iframe>");_hiddenIFrame=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(name,parentNode)}else{_hiddenIFrame=document.createElement("IFRAME");D2L.LP.Web.UI.Html.Dom.SetAttribute(_hiddenIFrame,"name",name);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen d2l-hidden",_hiddenIFrame);parentNode.appendChild(_hiddenIFrame)}return _hiddenIFrame},
GenerateInputNode:function(filelink,deleteicon,parentNode){var _inputNode;if(parentNode.insertAdjacentHTML){parentNode.insertAdjacentHTML("beforeEnd","<input id='"+id+"' type='file' size='30' class='d2l-fileupload-input d2l-font'>");_inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id)}else{_inputNode=document.createElement("input");D2L.LP.Web.UI.Html.Dom.SetAttribute(_inputNode,"size","30");D2L.LP.Web.UI.Html.Dom.SetAttribute(_inputNode,"type","file");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-fileupload-input d2l-font",
_inputNode);parentNode.appendChild(_inputNode)}return _inputNode},GetAction:function(fileName,callback,controlId,fileInputId,maxFileSize,maxTotalSize,totalSize){var _callbackId=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetUniqueCallbackId(controlId,fileInputId);window[_callbackId]=callback;var _action="/d2l/common/upload/uploadFile.d2l"+"?cb="+_callbackId+"&fileName="+D2L.LP.Web.UI.Desktop.Controls.FileUpload.StripFilePath(fileName)+"&maxFileSize="+(maxFileSize==null||maxFileSize==undefined?0:maxFileSize)+
"&maxTotalSize="+(maxTotalSize==null||maxTotalSize==undefined?0:maxTotalSize)+"&totalSize="+(totalSize==null||totalSize==undefined?0:totalSize);return _action},GetCallbackNumber:function(){D2L.LP.Web.UI.Desktop.Controls.FileUpload.CallbackNumber+=1;return D2L.LP.Web.UI.Desktop.Controls.FileUpload.CallbackNumber},GetUniqueCallbackId:function(controlId,fileInputId){var date=new Date;var _time=date.getTime();date=null;return"d2l_ctrl_"+controlId+"_"+fileInputId+"_"+_time+"_"+D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetCallbackNumber()},
GetInvalidFileExtensionMessage:function(message){return message},GetInvalidFileSizeMessage:function(message){return message},GetInvalidTotalFileSizeMessage:function(message){return message},GetInvalidRestrictedFileMessage:function(message){return message},GetMaxFileSize:function(value){return value},GetTotalFileSize:function(value){return value},GetFileExt:function(fileName){if(!fileName||fileName===undefined)return false;var _index=fileName.lastIndexOf(".");if(_index<0)return false;var _ext=fileName.substring(_index+
1);return _ext},GetFileInfo:function(file){if(file===undefined)return false;var _fileInfo={name:"",type:"",size:"0"};_fileInfo.name=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileName(file);_fileInfo.type=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileType(file);_fileInfo.size=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileSize(file);return _fileInfo},GetFileName:function(file){if(file.fileName===undefined){if(file.name===undefined)return false;return file.name}return file.fileName},GetFileSize:function(file){if(file.fileSize===
undefined){if(file.size===undefined)return false;return file.size}return file.fileSize},GetFileType:function(file){if(file.type===undefined)return false;return file.type},GetTempFileId:function(hiddenInputId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(hiddenInputId);if(node!=null)return node.value;return false},StripFilePath:function(filePath){var _index=filePath.lastIndexOf("\\");var _fileName=filePath.substring(_index+1);return _fileName},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);
if(input!==null)return input.value.length>0;else return true},ValidateFileType:function(id,fileTypesList){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var ext=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetFileExt(node.value);if(fileTypesList!==null&&fileTypesList!==undefined){var fileTypesArr=fileTypesList.split(",");for(var i=0;i<fileTypesArr.length;i++){var _ext=fileTypesArr[i];_ext=D2L.LP.Web.UI.Html.JavaScript.TrimString(0,_ext);if(_ext===ext||_ext==="*")return true}}else return true;return false},
OnChangeEvents:{}};
D2L.LP.Web.UI.Desktop.Controls.FilterInline={Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"FilterInline not found: '"+idVal+"'.";var groups=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-filterinline-group",node);var setFocus=false;for(var i=0;i<groups.length;i++){var isSingle=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filterinline-group-single",groups[i]);if(isSingle)continue;
var nodes=me.GetNodesNode(groups[i]);for(var j=0;j<nodes.anchors.length;j++)me.SetIsSelectedNodes(groups[i].id,nodes,nodes.anchors[j],false,i==groups.length-1&&j==nodes.anchors.length-1);if(!setFocus&&nodes.anchors.length>0){nodes.anchors[0].focus();setFocus=true}}},GetNodes:function(id,noThrow){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null){if(noThrow)return null;throw"FilterInlineGroupMultiple not found: '"+idVal+"'.";}return D2L.LP.Web.UI.Desktop.Controls.FilterInline.GetNodesNode(node)},
GetNodesNode:function(node){var anchors=node.getElementsByTagName("a");return{node:node,anchors:anchors}},GetSelectedKeys:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var noThrow=defaultValue!==undefined;var nodes=me.GetNodes(id,noThrow);if(nodes===null)return defaultValue;var keys=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"keys");var selectedKeys=[];for(var i=0;i<nodes.anchors.length;i++){var isSelected=me.IsSelectedNode(nodes.anchors[i]);if(isSelected)selectedKeys.push(keys[i])}if(selectedKeys.length===
0)return keys;return selectedKeys},GetSelectedKey:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"FilterInlineGroupSingle not found: '"+idVal+"'.";var keys=D2L.LP.Web.UI.ObjectRepository.Get(idVal,"keys");var anchors=node.getElementsByTagName("a");for(var i=0;i<anchors.length;i++){var isSelected=me.IsSelectedNode(anchors[i]);if(isSelected)return keys[i]}throw"FilterInlineGroupSingle error: No items selected.";
},IsNoneSelected:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var noThrow=defaultValue!==undefined;var nodes=me.GetNodes(id,noThrow);if(nodes===null)return defaultValue;return me.IsNoneSelectedNodes(nodes)},IsNoneSelectedNodes:function(nodes){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;for(var i=0;i<nodes.anchors.length;i++){var isSelected=me.IsSelectedNode(nodes.anchors[i]);if(isSelected)return false}return true},IsSelectedNode:function(node){var isSelected=
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filterinline-item-selected",node);return isSelected},RenderClear:function(node){var clear=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filterinline-clear",node);if(clear===null)return;var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var clearSeparator=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(clear);var groups=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-filterinline-group",node);var isNoneSelected=true;for(var i=0;i<groups.length;i++){var groupNodes=
me.GetNodesNode(groups[i]);isNoneSelected=isNoneSelected&&me.IsNoneSelectedNodes(groupNodes)}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(clear,!isNoneSelected);if(clearSeparator&&$(clearSeparator).hasClass("d2l-filterinline-group-sep"))D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(clearSeparator,!isNoneSelected)},SetIsSelectedNodes:function(groupId,nodes,anchor,isSelected,triggerOnChange){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;if(isSelected)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filterinline-item-selected",
anchor);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filterinline-item-selected",anchor);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchor,"checked",isSelected?"true":"false");if(!triggerOnChange)return;me.RenderClear($(nodes.node).closest(".d2l-filterinline").get(0));var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(groupId,"onchange");if(onChange!==null)onChange()}};
D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout={Close:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var flyoutId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-flyout-id"));D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(flyoutId)},SetKey:function(id,key){var hidden=D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKeyHidden(id);if(hidden.value!==key)hidden.value=key;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),
"OnChange")){var onChangeFunc=D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"OnChange");onChangeFunc.call(onChangeFunc)}},SetText:function(id,text){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filterinline-group-flyout-text",node);if(textNode.textContent!==undefined)textNode.textContent=text;else if(textNode.innerText!==undefined)textNode.innerText=text},GetKey:function(id){return D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKeyHidden(id).value},
SetIsSelected:function(id,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var flyoutNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filterinline-group-flyout-item",node);if(isSelected)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filterinline-group-flyout-item-selected",flyoutNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filterinline-group-flyout-item-selected",flyoutNode)},GetKeyHidden:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var keyHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filterinline-group-flyout-key",node);return keyHidden}};
D2L.LP.Web.UI.Desktop.Controls.FileViewer={SetSize:function(node,contentHeight,resizeTarget){var content=$(node).parent().find(resizeTarget);var viewport=$(window).height();var offset=node.offset();var adjustedHeight=viewport-offset.top;var smallestHeight=adjustedHeight;if(adjustedHeight>contentHeight)smallestHeight=contentHeight;content.height(smallestHeight)},OnPluginLoad:function(resizeTarget,contentHeight){var me=D2L.LP.Web.UI.Desktop.Controls.FileViewer;var viewer=$(resizeTarget).closest(".d2l-fileviewer");
var scaleWithViewport=false;if(viewer.attr("data-viewmode")==="ScaleWithViewport")scaleWithViewport=true;if(scaleWithViewport&&resizeTarget){me.SetSize(viewer,contentHeight,resizeTarget);var zoom=document.documentElement.clientWidth/window.innerWidth;$(window).resize(function(){var zoomNew=document.documentElement.clientWidth/window.innerWidth;if(zoom===zoomNew)me.SetSize(viewer,contentHeight,resizeTarget);else zoom=zoomNew})}},TryPrint:function(id){var $node;if(this.IsPrintable(id)){$node=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));
$(document.body).addClass("d2l-fileviewer-nonprintregion");$node.addClass("d2l-fileviewer-printregion");var topWindow=window.top;var topImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileviewer-image",topWindow.contentDocument);if(!topImage){var iFrame=window.frames[$node.find("iframe").get(0).id];iFrame.focus();iFrame.print()}else{window.focus();window.print()}$(document.body).removeClass("d2l-fileviewer-nonprintregion");$node.find(".d2l-fileviewer").add($node).removeClass("d2l-fileviewer-printregion")}},
IsPrintable:function(id){var $node=$(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));return $node.find(".d2l-fileviewer").add($node).find("[data-isprintable=True]").size()>0}};
D2L.LP.Web.UI.Desktop.Controls.FloatingContainer={Open:function(id,openerId,openSettings){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(elem,openerId,openSettings)},OpenNode:function(elem,openerId,openSettings){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-floating-container-autoclose",elem)){if(elem.onFocusHandler===undefined)elem.onFocusHandler=function(evt){var activeNode=
D2L.LP.Web.UI.Html.Dom.GetActiveElement();var isFrameOrBody=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-dialog-frame",activeNode)||D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-body",activeNode);if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(elem,activeNode)&&!isFrameOrBody)me.CloseNode(elem,true)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",document.body,elem.onFocusHandler,true)}openSettings=me.NormalizeOpenSettings(openSettings);var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId.GetValue());if(openerElem===
null)throw"FloatingContainer opener not found: '"+openerId.GetValue()+"'.";var targetElem=openerElem;if(openSettings.TargetId!=null)targetElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.TargetId.GetValue());elem.m_previousParent=elem.parentNode;D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,true);D2L.LP.Web.UI.Html.Dom.OverlayElement(elem,targetElem,openerElem,openSettings.Position,openSettings.VerticalOffset,openSettings.HorizontalOffset,openSettings.IsAutoPosition,openSettings.IsAutoScroll,
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-floating-container-attach-to-body",elem)||openSettings.AttachToBody);elem.style.zIndex=1E3;elem.m_openerId=openerId.GetValue();elem.m_isOpen=true;elem.tabIndex=openSettings.TabIndex;elem.m_openSettings=openSettings;elem.m_ignoreAutoHide=true;elem.m_autoCloseExclusions=openSettings.AutoCloseExclusions;setTimeout(function(){elem.m_ignoreAutoHide=false},0);if(openSettings.FocusOnOpen)if(openSettings.FocusOnOpenTargetControlId!==null)try{var focusTargetNode=D2L.LP.Web.UI.Html.Dom.GetElementById(openSettings.FocusOnOpenTargetControlId.GetValue());
focusTargetNode.focus()}catch(e){}else me.Focus(elem)},NormalizeOpenSettings:function(settings){if(settings===undefined||settings===null)settings={};settings.TargetId=settings.TargetId||null;settings.Position=settings.Position||D2L.LP.Web.UI.Html.Style.OverlayPosition.Right;settings.VerticalOffset=settings.VerticalOffset||0;settings.HorizontalOffset=settings.HorizontalOffset||0;settings.IsAutoScroll=settings.IsAutoScroll||false;settings.IsAutoPosition=settings.IsAutoPosition||true;settings.FocusOnOpen=
settings.FocusOnOpen||true;settings.FocusOnOpenTargetControlId=settings.FocusOnOpenTargetControlId||null;settings.TabIndex=settings.TabIndex||0;settings.AttachToBody=settings.AttachToBody||false;settings.AutoCloseExclusions=settings.AutoCloseExclusions||[];return settings},RefreshOpenNode:function(node){if(node.m_isOpen){var openSettings=node.m_openSettings;openSettings.FocusOnOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(node,new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.m_openerId),
openSettings)}},Focus:function(node){var focusableElems={"a":true,"input":true,"select":true,"textarea":true,"button":true};var allNodes=node.all?node.all:node.getElementsByTagName("*");for(var i=0;i<allNodes.length;i++){var cNode=allNodes[i];if(focusableElems[cNode.tagName.toLowerCase()]&&D2L.LP.Web.UI.Html.Css.GetStyle(cNode,"display")!=="none"&&!(cNode.type=="hidden"||cNode.disabled===true)&&cNode.className.indexOf("d2l-floating-container-close")<0){try{cNode.focus()}catch(e){}break}}},Close:function(id,
ignoreFocus){var elem=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,ignoreFocus)},CloseNode:function(elem,ignoreFocus){if(!elem.m_isOpen)return;if(elem.d2l_onClose===undefined)elem.d2l_onClose=D2L.LP.Web.UI.ObjectRepository.TryGet(elem.getAttribute("id"),"onClose");if(elem.d2l_onClose!==null)elem.d2l_onClose.call(elem.d2l_onClose);if(elem.onFocusHandler!==undefined)D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",document.body,
elem.onFocusHandler,true);if(ignoreFocus===undefined)ignoreFocus=false;var openerId=elem.m_openerId;var openerElem=D2L.LP.Web.UI.Html.Dom.GetElementById(openerId);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(elem,false);if(openerElem&&openerElem.focus&&!ignoreFocus)try{openerElem.focus()}catch(e){}elem.m_isOpen=false;D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.MoveToOriginalParent(elem)},MoveToOriginalParent:function(elem){if(elem.m_previousParent)elem.m_previousParent.appendChild(elem)},IsOpen:function(id){var elem=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(elem)},IsOpenNode:function(elem){if(elem.m_isOpen===undefined)return false;return elem.m_isOpen},Toggle:function(id,openerId,openSettings){if(D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpen(id))D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Close(id);else D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.Open(id,openerId,openSettings)},Init:function(){var me=D2L.LP.Web.UI.Desktop.Controls.FloatingContainer;
var dom=D2L.LP.Web.UI.Html.Dom;if(me.m_initialized)return;me.m_initialized=true;D2L.LP.Web.UI.Events.OnClick.AddListener(function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var autoCloseContainers=dom.GetElementsByClassName("d2l-floating-container-autoclose");for(var i=0;i<autoCloseContainers.length;i++){var container=autoCloseContainers[i];if(container.m_isOpen&&!container.m_ignoreAutoHide){var exclusions=container.m_autoCloseExclusions||[];var ancestor=dom.IsAncestor(container,
eventTarget);if(!ancestor)for(var j=0;j<exclusions.length;j++)if(exclusions[j]==eventTarget||dom.IsAncestor(exclusions[j],eventTarget)){ancestor=true;break}if(!ancestor)me.CloseNode(container,true)}}});var floatingContainerNodesInsidePartial={};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(function(form){var floatingContainerNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-floating-container",form);for(var i=0;i<floatingContainerNodes.length;i++){var fcNode=floatingContainerNodes[i];
if(me.IsOpenNode(fcNode))me.MoveToOriginalParent(fcNode)}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore.AddListener(function(placeholderId){var placeholder=dom.GetElementById(placeholderId.GetValue());floatingContainerNodesInsidePartial[placeholderId.GetValue()]=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-floating-container",placeholder);for(var i=0;i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];
if(me.IsOpenNode(fcNode))me.MoveToOriginalParent(fcNode)}});D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(placeholderId){for(var i=0;floatingContainerNodesInsidePartial[placeholderId.GetValue()]!==undefined&&i<floatingContainerNodesInsidePartial[placeholderId.GetValue()].length;i++){var fcNode=floatingContainerNodesInsidePartial[placeholderId.GetValue()][i];if(me.IsOpenNode(fcNode))try{me.RefreshOpenNode(fcNode)}catch(e){}}})}};
D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.m_mouseEvent=null;
D2L.LP.Web.UI.Common.Controls.Form.Validate=function(balloonContainer,validators,showErrors){if(showErrors===undefined)showErrors=true;var ret=new D2L.LP.Web.UI.Events.Event;var errors=[];var handleResult=function(result,index,validator){var isError=result===undefined||result===null||result===false;if(isError)errors.push(validator);if(result.AddListener!==undefined)result.AddListener(function(r){handleResult(r,index,validator)});else validate(++index)};var validate=function(index){if(index==validators.length){if(errors.length>
0&&showErrors)D2L.LP.Web.UI.Common.Controls.MessageArea.ShowErrors(errors);ret.Trigger(errors.length===0);return}var validator=validators[index];var result=validator.validation.apply(validator.validation);handleResult(result,index,validator)};D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(balloonContainer);setTimeout(function(){validate(0)},0);return ret};
D2L.LP.Web.UI.Desktop.Controls.Fragment={Build:function(name,doc){doc=doc||document;var me=D2L.LP.Web.UI.Desktop.Controls.Fragment;var node=doc.createElement("span");D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-fragment",node);var anchor=doc.createElement("a");D2L.LP.Web.UI.Html.Dom.SetAttribute(anchor,"name",name);node.appendChild(anchor);me.Init(node);return node},Init:function(node){var minibar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-minibar-placeholder");if(minibar===null)return;var rect=
D2L.LP.Web.UI.Html.Dom.GetBoundingRect(minibar);node.firstChild.style.top="-"+(rect.height+10)+"px"}};
D2L.LP.Web.UI.Desktop.Controls.Grid={m_sortFields:[],m_selectionState:[],m_currentReload:null,m_onLoadCompletedEvents:{},m_onLoadMoreCompletedEvents:{},AddOrUpdateSelectionStateAndStyle:function(id,node){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var key=node.value;var isSelected=node.checked;if(me.m_selectionState[id.GetValue()]===undefined)me.m_selectionState[id.GetValue()]=[];me.m_selectionState[id.GetValue()][key]=isSelected;if(!isSelected){var gridNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-grid-wrapper",
node);var selectAllInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-sel-page-input",gridNode);if(selectAllInput)selectAllInput.checked=false}me.UpdateSelectionStyle(node)},ApplyRememberedSelection:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-grid-sel-input",node);if(inputs)for(var i=0;i<inputs.length;i++){var input=inputs[i];var key=input.value;if(me.m_selectionState[id.GetValue()]!==
undefined&&me.m_selectionState[id.GetValue()][key]!==undefined){input.checked=me.m_selectionState[id.GetValue()][key];me.UpdateSelectionStyle(input)}}},ClearSelection:function(id){D2L.LP.Web.UI.Desktop.Controls.Grid.ResetSelectionState(id);D2L.LP.Web.UI.Desktop.Controls.Grid.SetAllPageIsSelected(id,false)},IsEmpty:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-empty",node)!==null},Get:function(){return D2L.LP.Web.UI.Desktop.Controls.Grid},
GetEvent:function(id,eventDictionary){if(eventDictionary[id.GetValue()]===undefined)eventDictionary[id.GetValue()]=new D2L.LP.Web.UI.Events.Event;return eventDictionary[id.GetValue()]},GetGridIdByDescendantNode:function(node){var gridNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-grid-wrapper",node);return new D2L.LP.Web.UI.Html.AbsoluteHtmlId(gridNode.id)},GetHasMoreItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context)return context.HasMoreItems;
else return null},GetIsLoadMore:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.m_isLoadMore||false},GetNumericPagerId:function(id){return D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"NumericPagerId")},GetLoadMoreContext:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-loadmore-wrapper",node);if(!loadMoreWrapperNode)return null;var placeholderId=
D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,"data-d2l-loadmore-placeholder-id");return D2L.LP.Web.UI.ObjectRepository.TryGet(placeholderId+"_LoadMoreContext")},GetLoadMoreExclusiveValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context)return context.ExclusiveValue;else return null},GetLoadMoreAddtionalExclusiveValues:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var context=me.GetLoadMoreContext(id);if(context)return context.AdditionalExclusiveValues;
else return null},GetLoadMorePlaceholderId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-loadmore-wrapper",node);if(!loadMoreWrapperNode)return null;return D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,"data-d2l-loadmore-placeholder-id")},GetOnLoadCompletedEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;return me.GetEvent(id,me.m_onLoadCompletedEvents)},GetOnLoadMoreCompletedEvent:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.Grid;return me.GetEvent(id,me.m_onLoadMoreCompletedEvents)},GetPageNumber:function(id){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId)return D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetPageNumber(numericPagerId);else return null},GetPageSize:function(id){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId)return D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetPageSize(numericPagerId);
else return null},GetSelectionInfo:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var keys=[];var keysTracker=[];var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-grid-sel-input",node);for(var i=0;i<inputs.length;i++)if(inputs[i].checked){keys.push(inputs[i].value);keysTracker[inputs[i].value]=true}var state=me.m_selectionState[id.GetValue()];if(state!==undefined)for(var key in state)if(state[key]===true&&!keysTracker[key])keys.push(key);
var selectionFilterType=D2L.LP.LayeredArch.SelectionFilterType.Some;if(keys.length==0)selectionFilterType=D2L.LP.LayeredArch.SelectionFilterType.None;var result=new D2L.LP.Web.UI.Desktop.Controls.Grid.SelectionInfo(selectionFilterType,keys);return result},GetSingleSelectionSelectedKey:function(id){var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.Grid.GetSelectionInfo(id);var keys=selectionInfo.GetKeys();if(keys.length===1)return keys[0];return null},GetSortField:function(id){if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]!==
undefined)return D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()].field;else return null},GetSortDirection:function(id){if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]!==undefined)return D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()].direction;else return null},GetTableNodeByWrapperNode:function(wrapperNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid",wrapperNode)},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-loadmore-wrapper",node);node.m_isLoadMore=true;var tableNode=me.GetTableNodeByWrapperNode(node);var placeholderRow=tableNode.insertRow(-1);placeholderRow.style.display="none";var placeholderCell=placeholderRow.insertCell(-1);var placeholder=document.createElement("div");placeholder.className="d2l-placeholder-inner";placeholderCell.appendChild(placeholder);
var placeholderId=D2L.LP.Web.UI.Html.Dom.GetAttribute(loadMoreWrapperNode,"data-d2l-loadmore-placeholder-id");placeholder.id=placeholderId;var loadMoreFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"LoadMoreHandler");var ret=loadMoreFunction.call(loadMoreFunction);me.m_currentReload=ret;ret.AddListener(function(){var newTable=placeholder.getElementsByTagName("table")[0];var newRows=[];if(newTable){for(var i=0;i<newTable.rows.length;i++)newRows.push(newTable.rows[i]);var tBody=tableNode.getElementsByTagName("tbody")[0];
for(var i=0;i<newRows.length;i++)tBody.appendChild(newRows[i])}var selectAllInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-sel-page-input",node);if(selectAllInput)selectAllInput.checked=false;D2L.LP.Web.UI.Desktop.Controls.Grid.ApplyRememberedSelection(id);placeholderRow.parentNode.removeChild(placeholderRow);var hasMoreItems=me.GetHasMoreItems(id);me.GetOnLoadMoreCompletedEvent(id).Trigger(hasMoreItems);D2L.LP.Web.UI.Desktop.Controls.Grid.SetFooterIsVisible(id,hasMoreItems);node.m_isLoadMore=
false;me.m_currentReload=null})},Reload:function(id,keepSelection,pageNumber){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;if(me.m_currentReload!==null){me.m_currentReload.AddListener(function(){me.Reload(id,keepSelection,pageNumber)});return}if(!keepSelection)me.ResetSelectionState(id);var partialFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"PartialHandler");if(partialFunction===null)throw"PartialHandler for Grid: "+id.GetValue()+" could not be found";if(pageNumber)me.SetPageNumber(id,
pageNumber);var ret=partialFunction.call(partialFunction);me.m_currentReload=ret;ret.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.Grid.ApplyRememberedSelection(id);D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=false;me.m_currentReload=null})},ResetSelectionState:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;me.m_selectionState[id.GetValue()]=[]},SetAllPageIsSelected:function(id,isSelected){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-grid-sel-input",
node);for(var i=0;i<inputs.length;i++){var input=inputs[i];input.checked=isSelected;D2L.LP.Web.UI.Desktop.Controls.Grid.AddOrUpdateSelectionStateAndStyle(id,input)}var pageInput=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-sel-page-input",node);if(pageInput)pageInput.checked=isSelected;D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(id);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(id)},SetFooterIsVisible:function(id,isVisible){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var loadMoreWrapperNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-footer-wrapper",node);if(loadMoreWrapperNode)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(loadMoreWrapperNode,isVisible)},SetPageNumber:function(id,pageNumber){var numericPagerId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetNumericPagerId(id);if(numericPagerId)D2L.LP.Web.UI.Desktop.Controls.NumericPager.SetPageNumber(numericPagerId,pageNumber)},SetSortField:function(id,fieldName,direction){D2L.LP.Web.UI.Desktop.Controls.Grid.m_sortFields[id.GetValue()]=
{field:fieldName,direction:direction}},SetSortFieldAndReload:function(id,fieldName,direction){D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=true;D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(id,fieldName,direction);D2L.LP.Web.UI.Desktop.Controls.Grid.Reload(id,true)},UpdateActionButtons:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var actionWrapperNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-grid-action-container-actions-action",
node);var hasSelectedItems=me.GetSelectionInfo(id).GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None;for(var i=0;i<actionWrapperNodes.length;i++){var isItemsAction=D2L.LP.Web.UI.Html.Dom.GetAttribute(actionWrapperNodes[i],"data-isItemsAction")=="1";if(isItemsAction){var buttonIdStr=D2L.LP.Web.UI.Html.Dom.GetAttribute(actionWrapperNodes[i],"data-buttonId");var buttonId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(buttonIdStr);D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(buttonId,hasSelectedItems)}}var actionGroupNode=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-actions-actiongroup",node);if(actionGroupNode){var buttonMenuId=D2L.LP.Web.UI.Html.Dom.GetAttribute(actionGroupNode,"data-buttonId");var itemActionItems=D2L.LP.Web.UI.ObjectRepository.Get(buttonMenuId+"_or","GroupItemsActionsKeys");for(var i=0;i<itemActionItems.length;i++)D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.SetItemIsEnabled(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(buttonMenuId),itemActionItems[i],hasSelectedItems)}},UpdateCountText:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.Grid;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var countNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-count",node);if(countNode){var searchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-count-search",countNode);var noSearchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-count-nosearch",countNode);var selectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-count-selected",
countNode);var selectionInfo=me.GetSelectionInfo(id);if(selectionInfo.GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None){if(selectedTextNode.innerHTML.indexOf("{count}")>0)selectedTextNode.innerHTML=selectedTextNode.innerHTML.replace("{count}",'<span class="d2l-grid-action-container-count-selected-counter"></span>');var numSelectedFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(selectionInfo.GetKeys().length);var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-action-container-count-selected-counter",
selectedTextNode);if(counterNode.textContent!==undefined)counterNode.textContent=numSelectedFormatted;else if(counterNode.innerText!==undefined)counterNode.innerText=numSelectedFormatted;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",noSearchTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",searchTextNode)}else{var isSearched=false;var searchControlId=D2L.LP.Web.UI.Html.Dom.GetAttribute(countNode,"data-searchControlId");
if(searchControlId)isSearched=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.IsSearched(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(searchControlId));if(isSearched){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",noSearchTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",searchTextNode)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectedTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",noSearchTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",
searchTextNode)}}}},UpdateSelectionStyle:function(node){var tr=node.parentNode.parentNode;if(node.checked)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-grid-row-selected",tr);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-grid-row-selected",tr)},UpdateSelectionStyleForAllInputs:function(gridId){var gridNode=D2L.LP.Web.UI.Html.Dom.GetElementById(gridId.GetValue());var inputs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-grid-sel-input",gridNode);for(var i=0;i<inputs.length;i++)D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateSelectionStyle(inputs[i])}};
D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection={Ascending:0,Descending:1};D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort=false;
D2L.LP.Web.UI.Desktop.Controls.Grid.SelectionInfo=D2L.Class.Create({Construct:function(type,keys){if(type===undefined)type=D2L.LP.LayeredArch.SelectionFilterType.None;if(keys===undefined)keys=[];this.m_type=type;this.m_keys=keys},_deserialize:function(deserializer){this.m_type=deserializer.GetMember("type");this.m_keys=deserializer.GetMember("keys")},_serialize:function(serializer){serializer.AddMember("type",this.m_type);serializer.AddMember("keys",this.m_keys)},GetType:function(){return this.m_type},
GetKeys:function(){return this.m_keys}});D2L.LP.Web.UI.Desktop.Controls.GridLoadMorePagingInfo={};
D2L.LP.Web.UI.Desktop.Controls.GridLoadMorePagingInfo.Args=D2L.Class.Create({Construct:function(){this.m_loadMoreExclusiveValue=null;this.m_isLoadMorePagerCall=null;this.m_loadMorePlaceholderId=null;this.m_loadMoreExclusiveValues=null},_serialize:function(serializer){if(this.m_loadMorePlaceholderId!==null){serializer.AddMember("LoadMoreExclusiveValue",this.m_loadMoreExclusiveValue);serializer.AddMember("IsLoadMorePagerCall",this.m_isLoadMorePagerCall);serializer.AddMember("LoadMorePlaceholderId",
this.m_loadMorePlaceholderId);serializer.AddMember("LoadMoreAdditionalExclusiveValues",this.m_loadMoreExclusiveValues)}},_deserialize:function(deserializer){this.m_loadMoreExclusiveValue=deserializer.GetMember("LoadMoreExclusiveValue");this.m_isLoadMorePagerCall=deserializer.GetMember("IsLoadMorePagerCall");this.m_loadMorePlaceholderId=deserializer.GetMember("LoadMorePlaceholderId");this.m_loadMoreExclusiveValues=deserializer.GetMember("LoadMoreAdditionalExclusiveValues")}});
D2L.LP.Web.UI.Desktop.Controls.GridNumericPagingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridNumericPagingInfo.Args=D2L.Class.Create({Construct:function(){this.m_pageNumber=null;this.m_pageSize=null},_serialize:function(serializer){if(this.m_pageNumber!=null){serializer.AddMember("PageNumber",this.m_pageNumber);serializer.AddMember("PageSize",this.m_pageSize)}},_deserialize:function(deserializer){this.m_pageNumber=deserializer.GetMember("PageNumber");this.m_pageSize=deserializer.GetMember("PageSize")}});
D2L.LP.Web.UI.Desktop.Controls.GridSearchingInfo={};D2L.LP.Web.UI.Desktop.Controls.GridSearchingInfo.Args=D2L.Class.Create({Construct:function(){this.m_searchKeyword=null},_serialize:function(serializer){if(this.m_searchKeyword!=null)serializer.AddMember("SearchKeyword",this.m_searchKeyword)},_deserialize:function(deserializer){this.m_searchKeyword=deserializer.GetMember("SearchKeyword")}});D2L.LP.Web.UI.Desktop.Controls.GridSortingInfo={};
D2L.LP.Web.UI.Desktop.Controls.GridSortingInfo.Args=D2L.Class.Create({Construct:function(){this.m_sortField=null;this.m_sortDirection=null},_serialize:function(serializer){if(this.m_sortField!=null){serializer.AddMember("SortField",this.m_sortField);serializer.AddMember("SortDirection",this.m_sortDirection)}},_deserialize:function(deserializer){this.m_sortField=deserializer.GetMember("SortField");this.m_sortDirection=deserializer.GetMember("SortDirection")}});
D2L.LP.Web.UI.Desktop.Controls.HourRangeBinder={ValidateIds:function(startId,endId){var startNode=D2L.LP.Web.UI.Html.Dom.GetElementById(startId.GetValue());var endNode=D2L.LP.Web.UI.Html.Dom.GetElementById(endId.GetValue());var startHour=parseInt(startNode.value);var endHour=parseInt(endNode.value);return endHour>=startHour}};
(function(win){var whiteSpaceRe=/^\s*|\s*$/g,undef,isRegExpBroken="B".replace(/A(.)|B/,"$1")==="$1";var tinymce={majorVersion:"3",minorVersion:"5.6",releaseDate:"2012-07-26",_init:function(){var t=this,d=document,na=navigator,ua=na.userAgent,i,nl,n,base,p,v;t.isOpera=win.opera&&opera.buildNumber;t.isWebKit=/WebKit/.test(ua);t.isIE=!t.isWebKit&&!t.isOpera&&/MSIE/gi.test(ua)&&/Explorer/gi.test(na.appName);t.isIE6=t.isIE&&/MSIE [56]/.test(ua);t.isIE7=t.isIE&&/MSIE [7]/.test(ua);t.isIE8=t.isIE&&/MSIE [8]/.test(ua);
t.isIE9=t.isIE&&/MSIE [9]/.test(ua);t.isGecko=!t.isWebKit&&/Gecko/.test(ua);t.isMac=ua.indexOf("Mac")!=-1;t.isAir=/adobeair/i.test(ua);t.isIDevice=/(iPad|iPhone)/.test(ua);t.isIOS5=t.isIDevice&&ua.match(/AppleWebKit\/(\d*)/)[1]>=534;if(win.tinyMCEPreInit){t.suffix=tinyMCEPreInit.suffix;t.baseURL=tinyMCEPreInit.base;t.query=tinyMCEPreInit.query;return}t.suffix="_src";nl=d.getElementsByTagName("base");for(i=0;i<nl.length;i++){v=nl[i].href;if(v){if(/^https?:\/\/[^\/]+$/.test(v))v+="/";base=v?v.match(/.*\//)[0]:
""}}function getBase(n){if(n.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(n.src)){if(/_(src|dev)\.js/g.test(n.src))t.suffix="_src";if((p=n.src.indexOf("?"))!=-1)t.query=n.src.substring(p+1);t.baseURL=n.src.substring(0,n.src.lastIndexOf("/"));if(base&&t.baseURL.indexOf("://")==-1&&t.baseURL.indexOf("/")!==0)t.baseURL=base+t.baseURL;return t.baseURL}return null}nl=d.getElementsByTagName("script");for(i=0;i<nl.length;i++)if(getBase(nl[i]))return;n=d.getElementsByTagName("head")[0];
if(n){nl=n.getElementsByTagName("script");for(i=0;i<nl.length;i++)if(getBase(nl[i]))return}return},is:function(o,t){if(!t)return o!==undef;if(t=="array"&&o.hasOwnProperty&&o instanceof Array)return true;return typeof o==t},makeMap:function(items,delim,map){var i;items=items||[];delim=delim||",";if(typeof items=="string")items=items.split(delim);map=map||{};i=items.length;while(i--)map[items[i]]={};return map},each:function(o,cb,s){var n,l;if(!o)return 0;s=s||o;if(o.length!==undef)for(n=0,l=o.length;n<
l;n++){if(cb.call(s,o[n],n,o)===false)return 0}else for(n in o)if(o.hasOwnProperty(n))if(cb.call(s,o[n],n,o)===false)return 0;return 1},map:function(a,f){var o=[];tinymce.each(a,function(v){o.push(f(v))});return o},grep:function(a,f){var o=[];tinymce.each(a,function(v){if(!f||f(v))o.push(v)});return o},inArray:function(a,v){var i,l;if(a)for(i=0,l=a.length;i<l;i++)if(a[i]===v)return i;return-1},extend:function(obj,ext){var i,l,name,args=arguments,value;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext)if(ext.hasOwnProperty(name)){value=
ext[name];if(value!==undef)obj[name]=value}}return obj},trim:function(s){return(s?""+s:"").replace(whiteSpaceRe,"")},create:function(s,p,root){var t=this,sp,ns,cn,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);cn=s[3].match(/(^|\.)(\w+)$/i)[2];ns=t.createNS(s[3].replace(/\.\w+$/,""),root);if(ns[cn])return;if(s[2]=="static"){ns[cn]=p;if(this.onCreate)this.onCreate(s[2],s[3],ns[cn]);return}if(!p[cn]){p[cn]=function(){};de=1}ns[cn]=p[cn];t.extend(ns[cn].prototype,p);if(s[5]){sp=t.resolve(s[5]).prototype;
scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de)ns[cn]=function(){return sp[scn].apply(this,arguments)};else ns[cn]=function(){this.parent=sp[scn];return c.apply(this,arguments)};ns[cn].prototype[cn]=ns[cn];t.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]});t.each(p,function(f,n){if(sp[n])ns[cn].prototype[n]=function(){this.parent=sp[n];return f.apply(this,arguments)};else if(n!=cn)ns[cn].prototype[n]=f})}t.each(p["static"],function(f,n){ns[cn][n]=f});if(this.onCreate)this.onCreate(s[2],s[3],ns[cn].prototype)},
walk:function(o,f,n,s){s=s||this;if(o){if(n)o=o[n];tinymce.each(o,function(o,i){if(f.call(s,o,i,n)===false)return false;tinymce.walk(o,f,n,s)})}},createNS:function(n,o){var i,v;o=o||win;n=n.split(".");for(i=0;i<n.length;i++){v=n[i];if(!o[v])o[v]={};o=o[v]}return o},resolve:function(n,o){var i,l;o=o||win;n=n.split(".");for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o)break}return o},addUnload:function(f,s){var t=this,unload;unload=function(){var li=t.unloads,o,n;if(li){for(n in li){o=li[n];if(o&&o.func)o.func.call(o.scope,
1)}if(win.detachEvent){win.detachEvent("onbeforeunload",fakeUnload);win.detachEvent("onunload",unload)}else if(win.removeEventListener)win.removeEventListener("unload",unload,false);t.unloads=o=li=w=unload=0;if(win.CollectGarbage)CollectGarbage()}};function fakeUnload(){var d=document;function stop(){d.detachEvent("onstop",stop);if(unload)unload();d=0}if(d.readyState=="interactive"){if(d)d.attachEvent("onstop",stop);win.setTimeout(function(){if(d)d.detachEvent("onstop",stop)},0)}}f={func:f,scope:s||
this};if(!t.unloads){if(win.attachEvent){win.attachEvent("onunload",unload);win.attachEvent("onbeforeunload",fakeUnload)}else if(win.addEventListener)win.addEventListener("unload",unload,false);t.unloads=[f]}else t.unloads.push(f);return f},removeUnload:function(f){var u=this.unloads,r=null;tinymce.each(u,function(o,i){if(o&&o.func==f){u.splice(i,1);r=f;return false}});return r},explode:function(s,d){if(!s||tinymce.is(s,"array"))return s;return tinymce.map(s.split(d||","),tinymce.trim)},_addVer:function(u){var v;
if(!this.query)return u;v=(u.indexOf("?")==-1?"?":"&")+this.query;if(u.indexOf("#")==-1)return u+v;return u.replace("#",v+"#")},_replace:function(find,replace,str){if(isRegExpBroken)return str.replace(find,function(){var val=replace,args=arguments,i;for(i=0;i<args.length-2;i++)if(args[i]===undef)val=val.replace(new RegExp("\\$"+i,"g"),"");else val=val.replace(new RegExp("\\$"+i,"g"),args[i]);return val});return str.replace(find,replace)}};tinymce._init();win.tinymce=win.tinyMCE=tinymce})(window);
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,inDispatch:false,Dispatcher:function(scope){this.scope=scope||this;this.listeners=[]},add:function(callback,scope){this.listeners.push({cb:callback,scope:scope||this.scope});return callback},addToTop:function(callback,scope){var self=this,listener={cb:callback,scope:scope||self.scope};if(self.inDispatch)self.listeners=[listener].concat(self.listeners);else self.listeners.unshift(listener);return callback},remove:function(callback){var listeners=
this.listeners,output=null;tinymce.each(listeners,function(listener,i){if(callback==listener.cb){output=listener;listeners.splice(i,1);return false}});return output},dispatch:function(){var self=this,returnValue,args=arguments,i,listeners=self.listeners,listener;self.inDispatch=true;for(i=0;i<listeners.length;i++){listener=listeners[i];returnValue=listener.cb.apply(listener.scope,args.length>0?args:[listener.scope]);if(returnValue===false)break}self.inDispatch=false;return returnValue}});
(function(){var each=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(u,s){var t=this,o,a,b,base_url;u=tinymce.trim(u);s=t.settings=s||{};if(/^([\w\-]+):([^\/]{2})/i.test(u)||/^\s*#/.test(u)){t.source=u;return}if(u.indexOf("/")===0&&u.indexOf("//")!==0)u=(s.base_uri?s.base_uri.protocol||"http":"http")+"://mce_host"+u;if(!/^[\w\-]*:?\/\//.test(u)){base_url=s.base_uri?s.base_uri.path:(new tinymce.util.URI(location.href)).directory;u=(s.base_uri&&s.base_uri.protocol||"http")+"://mce_host"+
t.toAbsPath(base_url,u)}u=u.replace(/@@/g,"(mce_at)");u=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(u);each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(v,i){var s=u[i];if(s)s=s.replace(/\(mce_at\)/g,"@@");t[v]=s});b=s.base_uri;if(b){if(!t.protocol)t.protocol=
b.protocol;if(!t.userInfo)t.userInfo=b.userInfo;if(!t.port&&t.host==="mce_host")t.port=b.port;if(!t.host||t.host==="mce_host")t.host=b.host;t.source=""}},setPath:function(p){var t=this;p=/^(.*?)\/?(\w+)?$/.exec(p);t.path=p[0];t.directory=p[1];t.file=p[2];t.source="";t.getURI()},toRelative:function(u){var t=this,o;if(u==="./")return u;u=new tinymce.util.URI(u,{base_uri:t});if(u.host!="mce_host"&&t.host!=u.host&&u.host||t.port!=u.port||t.protocol!=u.protocol)return u.getURI();var tu=t.getURI(),uu=u.getURI();
if(tu==uu||tu.charAt(tu.length-1)=="/"&&tu.substr(0,tu.length-1)==uu)return tu;o=t.toRelPath(t.path,u.path);if(u.query)o+="?"+u.query;if(u.anchor)o+="#"+u.anchor;return o},toAbsolute:function(u,nh){u=new tinymce.util.URI(u,{base_uri:this});return u.getURI(this.host==u.host&&this.protocol==u.protocol?nh:0)},toRelPath:function(base,path){var items,bp=0,out="",i,l;base=base.substring(0,base.lastIndexOf("/"));base=base.split("/");items=path.split("/");if(base.length>=items.length)for(i=0,l=base.length;i<
l;i++)if(i>=items.length||base[i]!=items[i]){bp=i+1;break}if(base.length<items.length)for(i=0,l=items.length;i<l;i++)if(i>=base.length||base[i]!=items[i]){bp=i+1;break}if(bp===1)return path;for(i=0,l=base.length-(bp-1);i<l;i++)out+="../";for(i=bp-1,l=items.length;i<l;i++)if(i!=bp-1)out+="/"+items[i];else out+=items[i];return out},toAbsPath:function(base,path){var i,nb=0,o=[],tr,outPath;tr=/\/$/.test(path)?"/":"";base=base.split("/");path=path.split("/");each(base,function(k){if(k)o.push(k)});base=
o;for(i=path.length-1,o=[];i>=0;i--){if(path[i].length===0||path[i]===".")continue;if(path[i]===".."){nb++;continue}if(nb>0){nb--;continue}o.push(path[i])}i=base.length-nb;if(i<=0)outPath=o.reverse().join("/");else outPath=base.slice(0,i).join("/")+"/"+o.reverse().join("/");if(outPath.indexOf("/")!==0)outPath="/"+outPath;if(tr&&outPath.lastIndexOf("/")!==outPath.length-1)outPath+=tr;return outPath},getURI:function(nh){var s,t=this;if(!t.source||nh){s="";if(!nh){if(t.protocol)s+=t.protocol+"://";if(t.userInfo)s+=
t.userInfo+"@";if(t.host)s+=t.host;if(t.port)s+=":"+t.port}if(t.path)s+=t.path;if(t.query)s+="?"+t.query;if(t.anchor)s+="#"+t.anchor;t.source=s}return t.source}})})();
(function(){var each=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(n){var v=this.get(n),h;if(v)each(v.split("&"),function(v){v=v.split("=");h=h||{};h[unescape(v[0])]=unescape(v[1])});return h},setHash:function(n,v,e,p,d,s){var o="";each(v,function(v,k){o+=(!o?"":"&")+escape(k)+"="+escape(v)});this.set(n,o,e,p,d,s)},get:function(n){var c=document.cookie,e,p=n+"=",b;if(!c)return;b=c.indexOf("; "+p);if(b==-1){b=c.indexOf(p);if(b!==0)return null}else b+=2;e=c.indexOf(";",
b);if(e==-1)e=c.length;return unescape(c.substring(b+p.length,e))},set:function(n,v,e,p,d,s){document.cookie=n+"="+escape(v)+(e?"; expires="+e.toGMTString():"")+(p?"; path="+escape(p):"")+(d?"; domain="+d:"")+(s?"; secure":"")},remove:function(name,path,domain){var date=new Date;date.setTime(date.getTime()-1E3);this.set(name,"",date,path,domain)}})})();
(function(){function serialize(o,quote){var i,v,t,name;quote=quote||'"';if(o==null)return"null";t=typeof o;if(t=="string"){v="\u0008b\tt\nn\u000cf\rr\"\"''\\\\";return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(quote==='"'&&a==="'")return a;i=v.indexOf(b);if(i+1)return"\\"+v.charAt(i+1);a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+quote}if(t=="object"){if(o.hasOwnProperty&&o instanceof Array){for(i=0,v="[";i<o.length;i++)v+=(i>0?",":"")+serialize(o[i],
quote);return v+"]"}v="{";for(name in o)if(o.hasOwnProperty(name))v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):"";return v+"}"}return""+o}tinymce.util.JSON={serialize:serialize,parse:function(s){try{return eval("("+s+")")}catch(ex){}}}})();
tinymce.create("static tinymce.util.XHR",{send:function(o){var x,t,w=window,c=0;function ready(){if(!o.async||x.readyState==4||c++>1E4){if(o.success&&c<1E4&&x.status==200)o.success.call(o.success_scope,""+x.responseText,x,o);else if(o.error)o.error.call(o.error_scope,c>1E4?"TIMED_OUT":"GENERAL",x,o);x=null}else w.setTimeout(ready,10)}o.scope=o.scope||this;o.success_scope=o.success_scope||o.scope;o.error_scope=o.error_scope||o.scope;o.async=o.async===false?false:true;o.data=o.data||"";function get(s){x=
0;try{x=new ActiveXObject(s)}catch(ex){}return x}x=w.XMLHttpRequest?new XMLHttpRequest:get("Microsoft.XMLHTTP")||get("Msxml2.XMLHTTP");if(x){if(x.overrideMimeType)x.overrideMimeType(o.content_type);x.open(o.type||(o.data?"POST":"GET"),o.url,o.async);if(o.content_type)x.setRequestHeader("Content-Type",o.content_type);x.setRequestHeader("X-Requested-With","XMLHttpRequest");x.send(o.data);if(!o.async)return ready();t=w.setTimeout(ready,10)}}});
(function(){var extend=tinymce.extend,JSON=tinymce.util.JSON,XHR=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(s){this.settings=extend({},s);this.count=0},send:function(o){var ecb=o.error,scb=o.success;o=extend(this.settings,o);o.success=function(c,x){c=JSON.parse(c);if(typeof c=="undefined")c={error:"JSON Parse error."};if(c.error)ecb.call(o.error_scope||o.scope,c.error,x);else scb.call(o.success_scope||o.scope,c.result)};o.error=function(ty,x){if(ecb)ecb.call(o.error_scope||
o.scope,ty,x)};o.data=JSON.serialize({id:o.id||"c"+this.count++,method:o.method,params:o.params});o.content_type="application/json";XHR.send(o)},"static":{sendRPC:function(o){return(new tinymce.util.JSONRequest).send(o)}}})})();(function(tinymce){tinymce.VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey},metaKeyPressed:function(e){return tinymce.isMac?e.metaKey:e.ctrlKey&&!e.altKey}}})(tinymce);
tinymce.util.Quirks=function(editor){var VK=tinymce.VK,BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings;function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,false,state)}catch(ex){}}function getDocumentMode(){var documentMode=editor.getDoc().documentMode;return documentMode?documentMode:6}function cleanupStylesWhenDeleting(){function removeMergedFormatSpans(isDelete){var rng,blockElm,node,clonedSpan;rng=selection.getRng();
blockElm=dom.getParent(rng.startContainer,dom.isBlock);if(isDelete)blockElm=dom.getNext(blockElm,dom.isBlock);if(blockElm){node=blockElm.firstChild;while(node&&node.nodeType==3&&node.nodeValue.length===0)node=node.nextSibling;if(node&&node.nodeName==="SPAN")clonedSpan=node.cloneNode(false)}editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);blockElm=dom.getParent(rng.startContainer,dom.isBlock);tinymce.each(dom.select("span.Apple-style-span,font.Apple-style-span",blockElm),function(span){var bm=
selection.getBookmark();if(clonedSpan)dom.replace(clonedSpan.cloneNode(false),span,true);else dom.remove(span,true);selection.moveToBookmark(bm)})}editor.onKeyDown.add(function(editor,e){var isDelete;isDelete=e.keyCode==DELETE;if(!e.isDefaultPrevented()&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){e.preventDefault();removeMergedFormatSpans(isDelete)}});editor.addCommand("Delete",function(){removeMergedFormatSpans()})}function emptyEditorWhenDeleting(){function serializeRng(rng){var body=
dom.create("body");var contents=rng.cloneContents();body.appendChild(contents);return selection.serializer.serialize(body,{format:"html"})}function allContentsSelected(rng){var selection=serializeRng(rng);var allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection}editor.onKeyDown.add(function(editor,e){var keyCode=e.keyCode,isCollapsed;if(!e.isDefaultPrevented()&&(keyCode==DELETE||keyCode==BACKSPACE)){isCollapsed=editor.selection.isCollapsed();
if(isCollapsed&&!dom.isEmpty(editor.getBody()))return;if(tinymce.isIE&&!isCollapsed)return;if(!isCollapsed&&!allContentsSelected(editor.selection.getRng()))return;editor.setContent("");editor.selection.setCursorLocation(editor.getBody(),0);editor.nodeChanged()}})}function selectAll(){editor.onKeyDown.add(function(editor,e){if(e.keyCode==65&&VK.metaKeyPressed(e)){e.preventDefault();editor.execCommand("SelectAll")}})}function inputMethodFocus(){if(!editor.settings.content_editable){dom.bind(editor.getDoc(),
"focusin",function(e){selection.setRng(selection.getRng())});dom.bind(editor.getDoc(),"mousedown",function(e){if(e.target==editor.getDoc().documentElement){editor.getWin().focus();selection.setRng(selection.getRng())}})}}function removeHrOnBackspace(){editor.onKeyDown.add(function(editor,e){if(!e.isDefaultPrevented()&&e.keyCode===BACKSPACE)if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var node=selection.getNode();var previousSibling=node.previousSibling;if(previousSibling&&previousSibling.nodeName&&
previousSibling.nodeName.toLowerCase()==="hr"){dom.remove(previousSibling);tinymce.dom.Event.cancel(e)}}})}function focusBody(){if(!Range.prototype.getClientRects)editor.onMouseDown.add(function(editor,e){if(e.target.nodeName==="HTML"){var body=editor.getBody();body.blur();setTimeout(function(){body.focus()},0)}})}function selectControlElements(){editor.onClick.add(function(editor,e){e=e.target;if(/^(IMG|HR)$/.test(e.nodeName))selection.getSel().setBaseAndExtent(e,0,e,1);if(e.nodeName=="A"&&dom.hasClass(e,
"mceItemAnchor"))selection.select(e);editor.nodeChanged()})}function removeStylesWhenDeletingAccrossBlockElements(){function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(false));return function(){var target=selection.getStart();if(target!==editor.getBody()){dom.setAttrib(target,"style",null);tinymce.each(template,function(attr){target.setAttributeNode(attr.cloneNode(true))})}}}function isSelectionAcrossElements(){return!selection.isCollapsed()&&dom.getParent(selection.getStart(),
dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)}function blockEvent(editor,e){e.preventDefault();return false}editor.onKeyPress.add(function(editor,e){var applyAttributes;if((e.keyCode==8||e.keyCode==46)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();editor.getDoc().execCommand("delete",false,null);applyAttributes();e.preventDefault();return false}});dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;if(isSelectionAcrossElements()){applyAttributes=
getAttributeApplyFunction();editor.onKeyUp.addToTop(blockEvent);setTimeout(function(){applyAttributes();editor.onKeyUp.remove(blockEvent)},0)}})}function selectionChangeNodeChanged(){var lastRng,selectionTimer;dom.bind(editor.getDoc(),"selectionchange",function(){if(selectionTimer){clearTimeout(selectionTimer);selectionTimer=0}selectionTimer=window.setTimeout(function(){var rng=selection.getRng();if(!lastRng||!tinymce.dom.RangeUtils.compareRanges(rng,lastRng)){editor.nodeChanged();lastRng=rng}},50)})}
function ensureBodyHasRoleApplication(){document.body.setAttribute("role","application")}function disableBackspaceIntoATable(){editor.onKeyDown.add(function(editor,e){if(!e.isDefaultPrevented()&&e.keyCode===BACKSPACE)if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="table")return tinymce.dom.Event.cancel(e)}})}function addNewLinesBeforeBrInPre(){if(getDocumentMode()>
7)return;setEditorCommandState("RespectVisibilityInDesign",true);editor.contentStyles.push(".mceHideBrInPre pre br {display: none}");dom.addClass(editor.getBody(),"mceHideBrInPre");editor.parser.addNodeFilter("pre",function(nodes,name){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type===3&&sibling.value.charAt(sibling.value-1)!="\n")sibling.value+="\n";else brElm.parent.insert(new tinymce.html.Node("#text",
3),brElm,true).value="\n"}}});editor.serializer.addNodeFilter("pre",function(nodes,name){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type==3)sibling.value=sibling.value.replace(/\r?\n$/,"")}}})}function removePreSerializedStylesWhenSelectingControls(){dom.bind(editor.getBody(),"mouseup",function(e){var value,node=selection.getNode();if(node.nodeName=="IMG"){if(value=dom.getStyle(node,
"width")){dom.setAttrib(node,"width",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"width","")}if(value=dom.getStyle(node,"height")){dom.setAttrib(node,"height",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"height","")}}})}function keepInlineElementOnDeleteBackspace(){editor.onKeyDown.add(function(editor,e){var isDelete,rng,container,offset,brElm,sibling,collapsed;isDelete=e.keyCode==DELETE;if(!e.isDefaultPrevented()&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){rng=selection.getRng();
container=rng.startContainer;offset=rng.startOffset;collapsed=rng.collapsed;if(container.nodeType==3&&container.nodeValue.length>0&&(offset===0&&!collapsed||collapsed&&offset===(isDelete?0:1))){nonEmptyElements=editor.schema.getNonEmptyElements();e.preventDefault();brElm=dom.create("br",{id:"__tmp"});container.parentNode.insertBefore(brElm,container);editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);container=selection.getRng().startContainer;sibling=container.previousSibling;
if(sibling&&sibling.nodeType==1&&!dom.isBlock(sibling)&&dom.isEmpty(sibling)&&!nonEmptyElements[sibling.nodeName.toLowerCase()])dom.remove(sibling);dom.remove("__tmp")}}})}function removeBlockQuoteOnBackSpace(){editor.onKeyDown.add(function(editor,e){var rng,container,offset,root,parent;if(e.isDefaultPrevented()||e.keyCode!=VK.BACKSPACE)return;rng=selection.getRng();container=rng.startContainer;offset=rng.startOffset;root=dom.getRoot();parent=container;if(!rng.collapsed||offset!==0)return;while(parent&&
parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root)parent=parent.parentNode;if(parent.tagName==="BLOCKQUOTE"){editor.formatter.toggle("blockquote",null,parent);rng.setStart(container,0);rng.setEnd(container,0);selection.setRng(rng);selection.collapse(false)}})}function setGeckoEditingOptions(){function setOpts(){editor._refreshContentEditable();setEditorCommandState("StyleWithCSS",false);setEditorCommandState("enableInlineTableEditing",false);if(!settings.object_resizing)setEditorCommandState("enableObjectResizing",
false)}if(!settings.readonly){editor.onBeforeExecCommand.add(setOpts);editor.onMouseDown.add(setOpts)}}function addBrAfterLastLinks(){function fixLinks(editor,o){tinymce.each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){while(parentNode&&!dom.isBlock(parentNode)){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root)return;parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}editor.onExecCommand.add(function(editor,
cmd){if(cmd==="CreateLink")fixLinks(editor)});editor.onSetContent.add(selection.onSetContent.add(fixLinks))}function setDefaultBlockType(){if(settings.forced_root_block)editor.onInit.add(function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}function removeGhostSelection(){function repaint(sender,args){if(!sender||!args.initial)editor.execCommand("mceRepaint")}editor.onUndo.add(repaint);editor.onRedo.add(repaint);editor.onSetContent.add(repaint)}function deleteControlItemOnBackSpace(){editor.onKeyDown.add(function(editor,
e){var rng;if(!e.isDefaultPrevented()&&e.keyCode==BACKSPACE){rng=editor.getDoc().selection.createRange();if(rng&&rng.item){e.preventDefault();editor.undoManager.beforeChange();dom.remove(rng.item(0));editor.undoManager.add()}}})}function renderEmptyBlocksFix(){var emptyBlocksCSS;if(getDocumentMode()>=10){emptyBlocksCSS="";tinymce.each("p div h1 h2 h3 h4 h5 h6".split(" "),function(name,i){emptyBlocksCSS+=(i>0?",":"")+name+":empty"});editor.contentStyles.push(emptyBlocksCSS+"{padding-right: 1px !important}")}}
function fakeImageResize(){var selectedElmX,selectedElmY,selectedElm,selectedElmGhost,selectedHandle,startX,startY,startW,startH,ratio,resizeHandles,width,height,rootDocument=document,editableDoc=editor.getDoc();if(!settings.object_resizing||settings.webkit_fake_resize===false)return;setEditorCommandState("enableObjectResizing",false);resizeHandles={n:[0.5,0,0,-1],e:[1,0.5,1,0],s:[0.5,1,0,1],w:[0,0.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};function resizeElement(e){var deltaX,
deltaY;deltaX=e.screenX-startX;deltaY=e.screenY-startY;width=deltaX*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;width=width<5?5:width;height=height<5?5:height;if(VK.modifierPressed(e)||selectedElm.nodeName=="IMG"&&selectedHandle[2]*selectedHandle[3]!==0){width=Math.round(height/ratio);height=Math.round(width*ratio)}dom.setStyles(selectedElmGhost,{width:width,height:height});if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width)dom.setStyle(selectedElmGhost,"left",selectedElmX+
(startW-width));if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height)dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height))}function endResize(){function setSizeProp(name,value){if(value)if(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name))dom.setStyle(selectedElm,name,value);else dom.setAttrib(selectedElm,name,value)}setSizeProp("width",width);setSizeProp("height",height);dom.unbind(editableDoc,"mousemove",resizeElement);dom.unbind(editableDoc,
"mouseup",endResize);if(rootDocument!=editableDoc){dom.unbind(rootDocument,"mousemove",resizeElement);dom.unbind(rootDocument,"mouseup",endResize)}dom.remove(selectedElmGhost);showResizeRect(selectedElm)}function showResizeRect(targetElm){var position,targetWidth,targetHeight;hideResizeRect();position=dom.getPos(targetElm);selectedElmX=position.x;selectedElmY=position.y;targetWidth=targetElm.offsetWidth;targetHeight=targetElm.offsetHeight;if(selectedElm!=targetElm){selectedElm=targetElm;width=height=
0}tinymce.each(resizeHandles,function(handle,name){var handleElm;handleElm=dom.get("mceResizeHandle"+name);if(!handleElm){handleElm=dom.add(editableDoc.documentElement,"div",{id:"mceResizeHandle"+name,"class":"mceResizeHandle",style:"cursor:"+name+"-resize; margin:0; padding:0"});dom.bind(handleElm,"mousedown",function(e){e.preventDefault();endResize();startX=e.screenX;startY=e.screenY;startW=selectedElm.clientWidth;startH=selectedElm.clientHeight;ratio=startH/startW;selectedHandle=handle;selectedElmGhost=
selectedElm.cloneNode(true);dom.addClass(selectedElmGhost,"mceClonedResizable");dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});editableDoc.documentElement.appendChild(selectedElmGhost);dom.bind(editableDoc,"mousemove",resizeElement);dom.bind(editableDoc,"mouseup",endResize);if(rootDocument!=editableDoc){dom.bind(rootDocument,"mousemove",resizeElement);dom.bind(rootDocument,"mouseup",endResize)}})}else dom.show(handleElm);dom.setStyles(handleElm,{left:targetWidth*handle[0]+
selectedElmX-handleElm.offsetWidth/2,top:targetHeight*handle[1]+selectedElmY-handleElm.offsetHeight/2})});if(!tinymce.isOpera&&selectedElm.nodeName=="IMG")selectedElm.setAttribute("data-mce-selected","1")}function hideResizeRect(){if(selectedElm)selectedElm.removeAttribute("data-mce-selected");for(var name in resizeHandles)dom.hide("mceResizeHandle"+name)}editor.contentStyles.push(".mceResizeHandle {"+"position: absolute;"+"border: 1px solid black;"+"background: #FFF;"+"width: 5px;"+"height: 5px;"+
"z-index: 10000"+"}"+".mceResizeHandle:hover {"+"background: #000"+"}"+"img[data-mce-selected] {"+"outline: 1px solid black"+"}"+"img.mceClonedResizable, table.mceClonedResizable {"+"position: absolute;"+"outline: 1px dashed black;"+"opacity: .5;"+"z-index: 10000"+"}");function updateResizeRect(){var controlElm=dom.getParent(selection.getNode(),"table,img");tinymce.each(dom.select("img[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")});if(controlElm)showResizeRect(controlElm);
else hideResizeRect()}editor.onNodeChange.add(updateResizeRect);dom.bind(editableDoc,"selectionchange",updateResizeRect);editor.serializer.addAttributeFilter("data-mce-selected",function(nodes,name){var i=nodes.length;while(i--)nodes[i].attr(name,null)})}disableBackspaceIntoATable();removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();if(tinymce.isWebKit){keepInlineElementOnDeleteBackspace();cleanupStylesWhenDeleting();inputMethodFocus();selectControlElements();setDefaultBlockType();if(tinymce.isIDevice)selectionChangeNodeChanged();
else{fakeImageResize();selectAll()}}if(tinymce.isIE){removeHrOnBackspace();ensureBodyHasRoleApplication();addNewLinesBeforeBrInPre();removePreSerializedStylesWhenSelectingControls();deleteControlItemOnBackSpace();renderEmptyBlocksFix()}if(tinymce.isGecko){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAccrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();removeGhostSelection()}if(tinymce.isOpera)fakeImageResize()};
(function(tinymce){var namedEntities,baseEntities,reverseEntities,attrsCharsRegExp=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&(#x|#)?([\w]+);/g,asciiMap={128:"\u20ac",130:"\u201a",131:"\u0192",132:"\u201e",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02c6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017d",145:"\u2018",146:"\u2019",147:"\u201c",
148:"\u201d",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02dc",153:"\u2122",154:"\u0161",155:"\u203a",156:"\u0153",158:"\u017e",159:"\u0178"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function nativeDecode(text){var elm;elm=document.createElement("div");elm.innerHTML=text;return elm.textContent||elm.innerText||text}function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){items=
items.split(",");radix=radix||10;for(i=0;i<items.length;i+=2){chr=String.fromCharCode(parseInt(items[i],radix));if(!baseEntities[chr]){entity="&"+items[i+1]+";";lookup[chr]=entity;lookup[entity]=chr}}return lookup}}namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,"+"5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,"+"5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,"+
"5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,"+"68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,"+"6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,"+"6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,"+"75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,"+"7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,"+
"7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,"+"sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,"+"st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,"+"t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,"+"tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,"+"u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,"+
"81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,"+"8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,"+"8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,"+"8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,"+"8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,"+"nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,"+
"rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,"+"Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,"+"80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,"+"811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);tinymce.html=tinymce.html||{};tinymce.html.Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||
chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(chr.length>1)return"&#"+((chr.charCodeAt(0)-55296)*1024+(chr.charCodeAt(1)-56320)+65536)+";";return baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){entities=entities||namedEntities;return text.replace(attr?attrsCharsRegExp:textCharsRegExp,
function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){var Entities=tinymce.html.Entities;entities=buildEntitiesLookup(entities)||namedEntities;function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||"&#"+chr.charCodeAt(0)+";"||chr})}function encodeCustomNamed(text,attr){return Entities.encodeNamed(text,attr,entities)}name=tinymce.makeMap(name.replace(/\+/g,
","));if(name.named&&name.numeric)return encodeNamedAndNumeric;if(name.named){if(entities)return encodeCustomNamed;return Entities.encodeNamed}if(name.numeric)return Entities.encodeNumeric;return Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric,value){if(numeric){value=parseInt(value,numeric.length===2?16:10);if(value>65535){value-=65536;return String.fromCharCode(55296+(value>>10),56320+(value&1023))}else return asciiMap[value]||String.fromCharCode(value)}return reverseEntities[all]||
namedEntities[all]||nativeDecode(all)})}}})(tinymce);
tinymce.html.Styles=function(settings,schema){var rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,urlColorRegExp=/rgb/,undef,i,encodingLookup={},encodingItems;settings=settings||{};encodingItems="\\\" \\' \\; \\: ; : \ufeff".split(" ");for(i=0;i<encodingItems.length;i++){encodingLookup[encodingItems[i]]=
"\ufeff"+i;encodingLookup["\ufeff"+i]=encodingItems[i]}function toHex(match,r,g,b){function hex(val){val=parseInt(val).toString(16);return val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var styles={},matches,name,value,isEncoded,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope||this;function compress(prefix,suffix){var top,right,bottom,left;top=styles[prefix+"-top"+suffix];
if(!top)return;right=styles[prefix+"-right"+suffix];if(top!=right)return;bottom=styles[prefix+"-bottom"+suffix];if(right!=bottom)return;left=styles[prefix+"-left"+suffix];if(bottom!=left)return;styles[prefix+suffix]=left;delete styles[prefix+"-top"+suffix];delete styles[prefix+"-right"+suffix];delete styles[prefix+"-bottom"+suffix];delete styles[prefix+"-left"+suffix]}function canCompress(key){var value=styles[key],i;if(!value||value.indexOf(" ")<0)return;value=value.split(" ");i=value.length;while(i--)if(value[i]!==
value[0])return false;styles[key]=value[0];return true}function compress2(target,a,b,c){if(!canCompress(a))return;if(!canCompress(b))return;if(!canCompress(c))return;styles[target]=styles[a]+" "+styles[b]+" "+styles[c];delete styles[a];delete styles[b];delete styles[c]}function encode(str){isEncoded=true;return encodingLookup[str]}function decode(str,keep_slashes){if(isEncoded)str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]});if(!keep_slashes)str=str.replace(/\\([\'\";:])/g,
"$1");return str}function processUrl(match,url,url2,url3,str,str2){str=str||str2;if(str){str=decode(str);return"'"+str.replace(/\'/g,"\\'")+"'"}url=decode(url||url2||url3);if(urlConverter)url=urlConverter.call(urlConverterScope,url,"style");return"url('"+url.replace(/\'/g,"\\'")+"')"}if(css){css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});while(matches=styleRegExp.exec(css)){name=matches[1].replace(trimRightRegExp,"").toLowerCase();
value=matches[2].replace(trimRightRegExp,"");if(name&&value.length>0){if(name==="font-weight"&&value==="700")value="bold";else if(name==="color"||name==="background-color")value=value.toLowerCase();value=value.replace(rgbRegExp,toHex);value=value.replace(urlOrStrRegExp,processUrl);styles[name]=isEncoded?decode(value,true):value}styleRegExp.lastIndex=matches.index+matches[0].length}compress("border","");compress("border","-width");compress("border","-color");compress("border","-style");compress("padding",
"");compress("margin","");compress2("border","border-width","border-style","border-color");if(styles.border==="medium none")delete styles.border}return styles},serialize:function(styles,element_name){var css="",name,value;function serializeStyles(name){var styleList,i,l,value;styleList=schema.styles[name];if(styleList)for(i=0,l=styleList.length;i<l;i++){name=styleList[i];value=styles[name];if(value!==undef&&value.length>0)css+=(css.length>0?" ":"")+name+": "+value+";"}}if(element_name&&schema&&schema.styles){serializeStyles("*");
serializeStyles(element_name)}else for(name in styles){value=styles[name];if(value!==undef&&value.length>0)css+=(css.length>0?" ":"")+name+": "+value+";"}return css}}};
(function(tinymce){var mapCache={},makeMap=tinymce.makeMap,each=tinymce.each;function split(str,delim){return str.split(delim||",")}function unpack(lookup,data){var key,elements={};function replace(value){return value.replace(/[A-Z]+/g,function(key){return replace(lookup[key])})}for(key in lookup)if(lookup.hasOwnProperty(key))lookup[key]=replace(lookup[key]);replace(data).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(str,name,attributes,children){attributes=split(attributes,
"|");elements[name]={attributes:makeMap(attributes),attributesOrder:attributes,children:makeMap(children,"|",{"#comment":{}})}});return elements}function getHTML5(){var html5=mapCache.html5;if(!html5)html5=mapCache.html5=unpack({A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|"+
"meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video|wbr",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|"+"figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|"+"p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"},
"html[A|manifest][body|head]"+"head[A][base|command|link|meta|noscript|script|style|title]"+"title[A][#]"+"base[A|href|target][]"+"link[A|href|rel|media|type|sizes][]"+"meta[A|http-equiv|name|content|charset][]"+"style[A|type|media|scoped][#]"+"script[A|charset|type|src|defer|async][#]"+"noscript[A][C]"+"body[A][C]"+"section[A][C]"+"nav[A][C]"+"article[A][C]"+"aside[A][C]"+"h1[A][B]"+"h2[A][B]"+"h3[A][B]"+"h4[A][B]"+"h5[A][B]"+"h6[A][B]"+"hgroup[A][h1|h2|h3|h4|h5|h6]"+"header[A][C]"+"footer[A][C]"+
"address[A][C]"+"p[A][B]"+"br[A][]"+"pre[A][B]"+"dialog[A][dd|dt]"+"blockquote[A|cite][C]"+"ol[A|start|reversed][li]"+"ul[A][li]"+"li[A|value][C]"+"dl[A][dd|dt]"+"dt[A][B]"+"dd[A][C]"+"a[A|href|target|ping|rel|media|type][B]"+"em[A][B]"+"strong[A][B]"+"small[A][B]"+"cite[A][B]"+"q[A|cite][B]"+"dfn[A][B]"+"abbr[A][B]"+"code[A][B]"+"var[A][B]"+"samp[A][B]"+"kbd[A][B]"+"sub[A][B]"+"sup[A][B]"+"i[A][B]"+"b[A][B]"+"mark[A][B]"+"progress[A|value|max][B]"+"meter[A|value|min|max|low|high|optimum][B]"+"time[A|datetime][B]"+
"ruby[A][B|rt|rp]"+"rt[A][B]"+"rp[A][B]"+"bdo[A][B]"+"span[A][B]"+"ins[A|cite|datetime][B]"+"del[A|cite|datetime][B]"+"figure[A][C|legend|figcaption]"+"figcaption[A][C]"+"img[A|alt|src|height|width|usemap|ismap][]"+"iframe[A|name|src|height|width|sandbox|seamless][]"+"embed[A|src|height|width|type][]"+"object[A|data|type|height|width|usemap|name|form|classid][param]"+"param[A|name|value][]"+"details[A|open][C|legend]"+"command[A|type|label|icon|disabled|checked|radiogroup][]"+"menu[A|type|label][C|li]"+
"legend[A][C|B]"+"div[A][C]"+"source[A|src|type|media][]"+"audio[A|src|autobuffer|autoplay|loop|controls][source]"+"video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]"+"hr[A][]"+"form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]"+"fieldset[A|disabled|form|name][C|legend]"+"label[A|form|for][B]"+"input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|"+
"multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value|name][]"+"button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]"+"select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]"+"datalist[A][B|option]"+"optgroup[A|disabled|label][option]"+"option[A|disabled|selected|label|value][]"+"textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]"+"keygen[A|autofocus|challenge|disabled|form|keytype|name][]"+
"output[A|for|form|name][B]"+"canvas[A|width|height][]"+"map[A|name][B|C]"+"area[A|shape|coords|href|alt|target|media|rel|ping|type][]"+"mathml[A][]"+"svg[A][]"+"table[A|border][caption|colgroup|thead|tfoot|tbody|tr]"+"caption[A][C]"+"colgroup[A|span][col]"+"col[A|span][]"+"thead[A][tr]"+"tfoot[A][tr]"+"tbody[A][tr]"+"tr[A][th|td]"+"th[A|headers|rowspan|colspan|scope][B]"+"td[A|headers|rowspan|colspan][C]"+"wbr[A][]");return html5}function getHTML4(){var html4=mapCache.html4;if(!html4)html4=mapCache.html4=
unpack({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",
O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]"+"style[B|id|type|media|title|xml:space][]"+
"object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]"+"param[id|name|value|valuetype|type][]"+"p[E|align][#|S]"+"a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]"+"br[A|clear][]"+"span[E][#|S]"+"bdo[A|C|B][#|S]"+"applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]"+"h1[E|align][#|S]"+"img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]"+
"map[B|C|A|name][X|form|Q|area]"+"h2[E|align][#|S]"+"iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]"+"h3[E|align][#|S]"+"tt[E][#|S]"+"i[E][#|S]"+"b[E][#|S]"+"u[E][#|S]"+"s[E][#|S]"+"strike[E][#|S]"+"big[E][#|S]"+"small[E][#|S]"+"font[A|B|size|color|face][#|S]"+"basefont[id|size|color|face][]"+"em[E][#|S]"+"strong[E][#|S]"+"dfn[E][#|S]"+"code[E][#|S]"+"q[E|cite][#|S]"+"samp[E][#|S]"+"kbd[E][#|S]"+"var[E][#|S]"+"cite[E][#|S]"+"abbr[E][#|S]"+"acronym[E][#|S]"+
"sub[E][#|S]"+"sup[E][#|S]"+"input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]"+"select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]"+"optgroup[E|disabled|label][option]"+"option[E|selected|disabled|label|value][]"+"textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]"+"label[E|for|accesskey|onfocus|onblur][#|S]"+"button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]"+
"h4[E|align][#|S]"+"ins[E|cite|datetime][#|Y]"+"h5[E|align][#|S]"+"del[E|cite|datetime][#|Y]"+"h6[E|align][#|S]"+"div[E|align][#|Y]"+"ul[E|type|compact][li]"+"li[E|type|value][#|Y]"+"ol[E|type|compact|start][li]"+"dl[E|compact][dt|dd]"+"dt[E][#|S]"+"dd[E][#|Y]"+"menu[E|compact][li]"+"dir[E|compact][li]"+"pre[E|width|xml:space][#|ZA]"+"hr[E|align|noshade|size|width][]"+"blockquote[E|cite][#|Y]"+"address[E][#|S|p]"+"center[E][#|Y]"+"noframes[E][#|Y]"+"isindex[A|B|prompt][]"+"fieldset[E][#|legend|Y]"+
"legend[E|accesskey|align][#|S]"+"table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]"+"caption[E|align][#|S]"+"col[ZG][]"+"colgroup[ZG][col]"+"thead[ZF][tr]"+"tr[ZF|bgcolor][th|td]"+"th[E|ZE][#|Y]"+"form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]"+"noscript[E][#|Y]"+"td[E|ZE][#|Y]"+"tfoot[ZF][tr]"+"tbody[ZF][tr]"+"area[E|D|shape|coords|href|nohref|alt|target][]"+"base[id|href|target][]"+
"body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]");return html4}tinymce.html.Schema=function(settings){var self=this,elements={},children={},patternElements=[],validStyles,schemaItems;var whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap,blockElementsMap,nonEmptyElementsMap,customElementsMap={};function createLookupTable(option,default_value,extend){var value=settings[option];if(!value){value=mapCache[option];if(!value){value=makeMap(default_value,
" ",makeMap(default_value.toUpperCase()," "));value=tinymce.extend(value,extend);mapCache[option]=value}}else value=makeMap(value,",",makeMap(value.toUpperCase()," "));return value}settings=settings||{};schemaItems=settings.schema=="html5"?getHTML5():getHTML4();if(settings.verify_html===false)settings.valid_elements="*[*]";if(settings.valid_styles){validStyles={};each(settings.valid_styles,function(value,key){validStyles[key]=tinymce.explode(value)})}whiteSpaceElementsMap=createLookupTable("whitespace_elements",
"pre script style textarea");selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr");boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");nonEmptyElementsMap=createLookupTable("non_empty_elements",
"td th iframe video audio object",shortEndedElementsMap);blockElementsMap=createLookupTable("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot "+"th tr td li ol ul caption blockquote center dl dt dd dir fieldset "+"noscript menu isindex samp header footer article section hgroup aside nav figure option datalist select optgroup");function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(valid_elements){var ei,
el,ai,al,yl,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,transElement,key,childKey,value,elementRuleRegExp=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(valid_elements){valid_elements=split(valid_elements);if(elements["@"]){globalAttributes=elements["@"].attributes;globalAttributesOrder=elements["@"].attributesOrder}for(ei=
0,el=valid_elements.length;ei<el;ei++){matches=elementRuleRegExp.exec(valid_elements[ei]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[4];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==="#")element.paddEmpty=true;if(prefix==="-")element.removeEmpty=true;if(globalAttributes){for(key in globalAttributes)attributes[key]=globalAttributes[key];attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData){attrData=
split(attrData,"|");for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/::/g,":");prefix=matches[3];value=matches[4];if(attrType==="!"){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true}if(attrType==="-"){delete attributes[attrName];attributesOrder.splice(tinymce.inArray(attributesOrder,attrName),1);continue}if(prefix){if(prefix===
"="){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value}if(prefix===":"){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value}if(prefix==="<")attr.validValues=makeMap(value,"?")}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=patternToRegExp(attrName);element.attributePatterns.push(attr)}else{if(!attributes[attrName])attributesOrder.push(attrName);
attributes[attrName]=attr}}}}if(!globalAttributes&&elementName=="@"){globalAttributes=attributes;globalAttributesOrder=attributesOrder}if(outputName){element.outputName=elementName;elements[outputName]=element}if(hasPatternsRegExp.test(elementName)){element.pattern=patternToRegExp(elementName);patternElements.push(element)}else elements[elementName]=element}}}}function setValidElements(valid_elements){elements={};patternElements=[];addValidElements(valid_elements);each(schemaItems,function(element,
name){children[name]=element.children})}function addCustomElements(custom_elements){var customElementRegExp=/^(~)?(.+)$/;if(custom_elements)each(split(custom_elements),function(rule){var matches=customElementRegExp.exec(rule),inline=matches[1]==="~",cloneName=inline?"span":"div",name=matches[2];children[name]=children[cloneName];customElementsMap[name]=cloneName;if(!inline)blockElementsMap[name]={};each(children,function(element,child){if(element[cloneName])element[name]=element[cloneName]})})}function addValidChildren(valid_children){var childRuleRegExp=
/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(valid_children)each(split(valid_children),function(rule){var matches=childRuleRegExp.exec(rule),parent,prefix;if(matches){prefix=matches[1];if(prefix)parent=children[matches[2]];else parent=children[matches[2]]={"#comment":{}};parent=children[matches[2]];each(split(matches[3],"|"),function(child){if(prefix==="-")delete parent[child];else parent[child]={}})}})}function getElementRule(name){var element=elements[name],i;if(element)return element;i=patternElements.length;
while(i--){element=patternElements[i];if(element.pattern.test(name))return element}}if(!settings.valid_elements){each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder};children[name]=element.children});if(settings.schema!="html5")each(split("strong/b,em/i"),function(item){item=split(item,"/");elements[item[1]].outputName=item[0]});elements.img.attributesDefault=[{name:"alt",value:""}];each(split("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),
function(name){if(elements[name])elements[name].removeEmpty=true});each(split("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(name){elements[name].paddEmpty=true})}else setValidElements(settings.valid_elements);addCustomElements(settings.custom_elements);addValidChildren(settings.valid_children);addValidElements(settings.extended_valid_elements);addValidChildren("+ol[ul|ol],+ul[ul|ol]");if(settings.invalid_elements)tinymce.each(tinymce.explode(settings.invalid_elements),function(item){if(elements[item])delete elements[item]});
if(!getElementRule("span"))addValidElements("span[!data-mce-type|*]");self.children=children;self.styles=validStyles;self.getBoolAttrs=function(){return boolAttrMap};self.getBlockElements=function(){return blockElementsMap};self.getShortEndedElements=function(){return shortEndedElementsMap};self.getSelfClosingElements=function(){return selfClosingElementsMap};self.getNonEmptyElements=function(){return nonEmptyElementsMap};self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap};self.isValidChild=
function(name,child){var parent=children[name];return!!(parent&&parent[child])};self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule)if(attr){if(rule.attributes[attr])return true;attrPatterns=rule.attributePatterns;if(attrPatterns){i=attrPatterns.length;while(i--)if(attrPatterns[i].pattern.test(name))return true}}else return true;return false};self.getElementRule=getElementRule;self.getCustomElements=function(){return customElementsMap};self.addValidElements=addValidElements;
self.setValidElements=setValidElements;self.addCustomElements=addCustomElements;self.addValidChildren=addValidChildren}})(tinymce);
(function(tinymce){tinymce.html.SaxParser=function(settings,schema){var self=this,noop=function(){};settings=settings||{};self.schema=schema=schema||new tinymce.html.Schema;if(settings.fix_self_closing!==false)settings.fix_self_closing=true;tinymce.each("comment cdata text start end pi doctype".split(" "),function(name){if(name)self[name]=settings[name]||noop});self.parse=function(html){var self=this,matches,index=0,value,endRegExp,stack=[],attrList,i,text,name,isInternalElement,removeInternalElements,
shortEndedElements,fillAttrsMap,isShortEnded,validate,elementRule,isValidElement,attr,attribsValue,invalidPrefixRegExp,validAttributesMap,validAttributePatterns,attributesRequired,attributesDefault,attributesForced,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,idCount=0,decode=tinymce.html.Entities.decode,fixSelfClosing,isIE;function processEndTag(name){var pos,i;pos=stack.length;while(pos--)if(stack[pos].name===name)break;if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid)self.end(name.name)}stack.length=
pos}}function parseAttribute(match,name,value,val2,val3){var attrRule,i;name=name.toLowerCase();value=name in fillAttrsMap?name:decode(value||val2||val3||"");if(validate&&!isInternalElement&&name.indexOf("data-")!==0){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name))break}if(i===-1)attrRule=null}if(!attrRule)return;if(attrRule.validValues&&!(value in attrRule.validValues))return}attrList.map[name]=
value;attrList.push({name:name,value:value})}tokenRegExp=new RegExp("<(?:"+"(?:!--([\\w\\W]*?)--\>)|"+"(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|"+"(?:!DOCTYPE([\\w\\W]*?)>)|"+"(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|"+"(?:\\/([^>]+)>)|"+"(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>)"+")","g");attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;specialElements={"script":/<\/script[^>]*>/gi,"style":/<\/style[^>]*>/gi,
"noscript":/<\/noscript[^>]*>/gi};shortEndedElements=schema.getShortEndedElements();selfClosing=settings.self_closing_elements||schema.getSelfClosingElements();fillAttrsMap=schema.getBoolAttrs();validate=settings.validate;removeInternalElements=settings.remove_internals;fixSelfClosing=settings.fix_self_closing;isIE=tinymce.isIE;invalidPrefixRegExp=/^:/;while(matches=tokenRegExp.exec(html)){if(index<matches.index)self.text(decode(html.substr(index,matches.index-index)));if(value=matches[6]){value=
value.toLowerCase();if(isIE&&invalidPrefixRegExp.test(value))value=value.substr(1);processEndTag(value)}else if(value=matches[7]){value=value.toLowerCase();if(isIE&&invalidPrefixRegExp.test(value))value=value.substr(1);isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value)processEndTag(value);if(!validate||(elementRule=schema.getElementRule(value))){isValidElement=true;if(validate){validAttributesMap=elementRule.attributes;
validAttributePatterns=elementRule.attributePatterns}if(attribsValue=matches[8]){isInternalElement=attribsValue.indexOf("data-mce-type")!==-1;if(isInternalElement&&removeInternalElements)isValidElement=false;attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute)}else{attrList=[];attrList.map={}}if(validate&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;if(attributesForced){i=
attributesForced.length;while(i--){attr=attributesForced[i];name=attr.name;attrValue=attr.value;if(attrValue==="{$uid}")attrValue="mce_"+idCount++;attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];name=attr.name;if(!(name in attrList.map)){attrValue=attr.value;if(attrValue==="{$uid}")attrValue="mce_"+idCount++;attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}}if(attributesRequired){i=
attributesRequired.length;while(i--)if(attributesRequired[i]in attrList.map)break;if(i===-1)isValidElement=false}if(attrList.map["data-mce-bogus"])isValidElement=false}if(isValidElement)self.start(value,attrList,isShortEnded)}else isValidElement=false;if(endRegExp=specialElements[value]){endRegExp.lastIndex=index=matches.index+matches[0].length;if(matches=endRegExp.exec(html)){if(isValidElement)text=html.substr(index,matches.index-index);index=matches.index+matches[0].length}else{text=html.substr(index);
index=html.length}if(isValidElement&&text.length>0)self.text(text,true);if(isValidElement)self.end(value);tokenRegExp.lastIndex=index;continue}if(!isShortEnded)if(!attribsValue||attribsValue.indexOf("/")!=attribsValue.length-1)stack.push({name:value,valid:isValidElement});else if(isValidElement)self.end(value)}else if(value=matches[1])self.comment(value);else if(value=matches[2])self.cdata(value);else if(value=matches[3])self.doctype(value);else if(value=matches[4])self.pi(value,matches[5]);index=
matches.index+matches[0].length}if(index<html.length)self.text(decode(html.substr(index)));for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid)self.end(value.name)}}}})(tinymce);
(function(tinymce){var whiteSpaceRegExp=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};function walk(node,root_node,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName])return node[startName];if(node!==root_node){sibling=node[siblingName];if(sibling)return sibling;for(parent=node.parent;parent&&parent!==root_node;parent=parent.parent){sibling=parent[siblingName];if(sibling)return sibling}}}
function Node(name,type){this.name=name;this.type=type;if(type===1){this.attributes=[];this.attributes.map={}}}tinymce.extend(Node.prototype,{replace:function(node){var self=this;if(node.parent)node.remove();self.insert(node,self);self.remove();return self},attr:function(name,value){var self=this,attrs,i,undef;if(typeof name!=="string"){for(i in name)self.attr(i,name[i]);return self}if(attrs=self.attributes)if(value!==undef){if(value===null){if(name in attrs.map){delete attrs.map[name];i=attrs.length;
while(i--)if(attrs[i].name===name){attrs=attrs.splice(i,1);return self}}return self}if(name in attrs.map){i=attrs.length;while(i--)if(attrs[i].name===name){attrs[i].value=value;break}}else attrs.push({name:name,value:value});attrs.map[name]=value;return self}else return attrs.map[name]},clone:function(){var self=this,clone=new Node(self.name,self.type),i,l,selfAttrs,selfAttr,cloneAttrs;if(selfAttrs=self.attributes){cloneAttrs=[];cloneAttrs.map={};for(i=0,l=selfAttrs.length;i<l;i++){selfAttr=selfAttrs[i];
if(selfAttr.name!=="id"){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value}}clone.attributes=cloneAttrs}clone.value=self.value;clone.shortEnded=self.shortEnded;return clone},wrap:function(wrapper){var self=this;self.parent.insert(wrapper,self);wrapper.append(self);return self},unwrap:function(){var self=this,node,next;for(node=self.firstChild;node;){next=node.next;self.insert(node,self,true);node=next}self.remove()},remove:function(){var self=
this,parent=self.parent,next=self.next,prev=self.prev;if(parent){if(parent.firstChild===self){parent.firstChild=next;if(next)next.prev=null}else prev.next=next;if(parent.lastChild===self){parent.lastChild=prev;if(prev)prev.next=null}else next.prev=prev;self.parent=self.next=self.prev=null}return self},append:function(node){var self=this,last;if(node.parent)node.remove();last=self.lastChild;if(last){last.next=node;node.prev=last;self.lastChild=node}else self.lastChild=self.firstChild=node;node.parent=
self;return node},insert:function(node,ref_node,before){var parent;if(node.parent)node.remove();parent=ref_node.parent||this;if(before){if(ref_node===parent.firstChild)parent.firstChild=node;else ref_node.prev.next=node;node.prev=ref_node.prev;node.next=ref_node;ref_node.prev=node}else{if(ref_node===parent.lastChild)parent.lastChild=node;else ref_node.next.prev=node;node.next=ref_node.next;node.prev=ref_node;ref_node.next=node}node.parent=parent;return node},getAll:function(name){var self=this,node,
collection=[];for(node=self.firstChild;node;node=walk(node,self))if(node.name===name)collection.push(node);return collection},empty:function(){var self=this,nodes,i,node;if(self.firstChild){nodes=[];for(node=self.firstChild;node;node=walk(node,self))nodes.push(node);i=nodes.length;while(i--){node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}}self.firstChild=self.lastChild=null;return self},isEmpty:function(elements){var self=this,node=self.firstChild,i,name;if(node){do{if(node.type===
1){if(node.attributes.map["data-mce-bogus"])continue;if(elements[node.name])return false;i=node.attributes.length;while(i--){name=node.attributes[i].name;if(name==="name"||name.indexOf("data-")===0)return false}}if(node.type===8)return false;if(node.type===3&&!whiteSpaceRegExp.test(node.value))return false}while(node=walk(node,self))}return true},walk:function(prev){return walk(this,null,prev)}});tinymce.extend(Node,{create:function(name,attrs){var node,attrName;node=new Node(name,typeLookup[name]||
1);if(attrs)for(attrName in attrs)node.attr(attrName,attrs[attrName]);return node}});tinymce.html.Node=Node})(tinymce);
(function(tinymce){var Node=tinymce.html.Node;tinymce.html.DomParser=function(settings,schema){var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{};settings.validate="validate"in settings?settings.validate:true;settings.root_name=settings.root_name||"body";self.schema=schema=schema||new tinymce.html.Schema;function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i,childClone,nonEmptyElements,nonSplitableElements,
sibling,nextNode;nonSplitableElements=tinymce.makeMap("tr,td,th,tbody,thead,tfoot,table");nonEmptyElements=schema.getNonEmptyElements();for(ni=0;ni<nodes.length;ni++){node=nodes[ni];if(!node.parent)continue;parents=[node];for(parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent)parents.push(parent);if(parent&&parents.length>1){parents.reverse();newParent=currentNode=self.filterNode(parents[0].clone());for(i=0;i<parents.length-
1;i++){if(schema.isValidChild(currentNode.name,parents[i].name)){tempNode=self.filterNode(parents[i].clone());currentNode.append(tempNode)}else tempNode=currentNode;for(childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode}currentNode=tempNode}if(!newParent.isEmpty(nonEmptyElements)){parent.insert(newParent,parents[0],true);parent.insert(node,newParent)}else parent.insert(node,parents[0],true);parent=parents[0];if(parent.isEmpty(nonEmptyElements)||
parent.firstChild===parent.lastChild&&parent.firstChild.name==="br")parent.empty().remove()}else if(node.parent){if(node.name==="li"){sibling=node.prev;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.append(node);continue}sibling=node.next;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.insert(node,sibling.firstChild,true);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}if(schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name))node.wrap(self.filterNode(new Node("div",
1)));else if(node.name==="style"||node.name==="script")node.empty().remove();else node.unwrap()}}}self.filterNode=function(node){var i,name,list;if(name in nodeFilters){list=matchedNodes[name];if(list)list.push(node);else matchedNodes[name]=[node]}i=attributeFilters.length;while(i--){name=attributeFilters[i].name;if(name in node.attributes.map){list=matchedAttributes[name];if(list)list.push(node);else matchedAttributes[name]=[node]}}return node};self.addNodeFilter=function(name,callback){tinymce.each(tinymce.explode(name),
function(name){var list=nodeFilters[name];if(!list)nodeFilters[name]=list=[];list.push(callback)})};self.addAttributeFilter=function(name,callback){tinymce.each(tinymce.explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++)if(attributeFilters[i].name===name){attributeFilters[i].callbacks.push(callback);return}attributeFilters.push({name:name,callbacks:[callback]})})};self.parse=function(html,args){var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate,blockElements,startWhiteSpaceRegExp,
invalidChildren=[],isInWhiteSpacePreservedElement,endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements,children,nonEmptyElements,rootBlockName;args=args||{};matchedNodes={};matchedAttributes={};blockElements=tinymce.extend(tinymce.makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements());nonEmptyElements=schema.getNonEmptyElements();children=schema.children;validate=settings.validate;rootBlockName="forced_root_block"in args?args.forced_root_block:
settings.forced_root_block;whiteSpaceElements=schema.getWhiteSpaceElements();startWhiteSpaceRegExp=/^[ \t\r\n]+/;endWhiteSpaceRegExp=/[ \t\r\n]+$/;allWhiteSpaceRegExp=/[ \t\r\n]+/g;isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;function addRootBlocks(){var node=rootNode.firstChild,next,rootBlockNode;while(node){next=node.next;if(node.type==3||node.type==1&&node.name!=="p"&&!blockElements[node.name]&&!node.attr("data-mce-type"))if(!rootBlockNode){rootBlockNode=createNode(rootBlockName,1);rootNode.insert(rootBlockNode,
node);rootBlockNode.append(node)}else rootBlockNode.append(node);else rootBlockNode=null;node=next}}function createNode(name,type){var node=new Node(name,type),list;if(name in nodeFilters){list=matchedNodes[name];if(list)list.push(node);else matchedNodes[name]=[node]}return node}function removeWhitespaceBefore(node){var textNode,textVal,sibling;for(textNode=node.prev;textNode&&textNode.type===3;){textVal=textNode.value.replace(endWhiteSpaceRegExp,"");if(textVal.length>0){textNode.value=textVal;textNode=
textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling}}}function cloneAndExcludeBlocks(input){var name,output={};for(name in input)if(name!=="li"&&name!="p")output[name]=input[name];return output}parser=new tinymce.html.SaxParser({validate:validate,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;if(!isInWhiteSpacePreservedElement){text=text.replace(allWhiteSpaceRegExp,
" ");if(node.lastChild&&blockElements[node.lastChild.name])text=text.replace(startWhiteSpaceRegExp,"")}if(text.length!==0){textNode=createNode("#text",3);textNode.raw=!!raw;node.append(textNode).value=text}},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text;removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10));newNode.value=text;removeWhitespaceBefore(node)},
start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,textNode,attrName,text,sibling,parent;elementRule=validate?schema.getElementRule(name):{};if(elementRule){newNode=createNode(elementRule.outputName||name,1);newNode.attributes=attrs;newNode.shortEnded=empty;node.append(newNode);parent=children[node.name];if(parent&&children[newNode.name]&&!parent[newNode.name])invalidChildren.push(newNode);attrFiltersLen=attributeFilters.length;while(attrFiltersLen--){attrName=attributeFilters[attrFiltersLen].name;
if(attrName in attrs.map){list=matchedAttributes[attrName];if(list)list.push(newNode);else matchedAttributes[attrName]=[newNode]}}if(blockElements[name])removeWhitespaceBefore(newNode);if(!empty)node=newNode;if(!isInWhiteSpacePreservedElement&&whiteSpaceElements[name])isInWhiteSpacePreservedElement=true}},end:function(name){var textNode,elementRule,text,sibling,tempNode;elementRule=validate?schema.getElementRule(name):{};if(elementRule){if(blockElements[name]){if(!isInWhiteSpacePreservedElement){textNode=
node.firstChild;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.next}else{sibling=textNode.next;textNode.remove();textNode=sibling}while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.next;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}textNode=node.lastChild;if(textNode&&textNode.type===3){text=textNode.value.replace(endWhiteSpaceRegExp,
"");if(text.length>0){textNode.value=text;textNode=textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling}while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.prev;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}textNode=node.prev;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0)textNode.value=text;else textNode.remove()}}if(isInWhiteSpacePreservedElement&&
whiteSpaceElements[name])isInWhiteSpacePreservedElement=false;if(elementRule.removeEmpty||elementRule.paddEmpty)if(node.isEmpty(nonEmptyElements))if(elementRule.paddEmpty)node.empty().append(new Node("#text","3")).value="\u00a0";else if(!node.attributes.map.name&&!node.attributes.map.id){tempNode=node.parent;node.empty().remove();node=tempNode;return}node=node.parent}}},schema);rootNode=node=new Node(args.context||settings.root_name,11);parser.parse(html);if(validate&&invalidChildren.length)if(!args.context)fixInvalidChildren(invalidChildren);
else args.invalid=true;if(rootBlockName&&rootNode.name=="body")addRootBlocks();if(!args.invalid){for(name in matchedNodes){list=nodeFilters[name];nodes=matchedNodes[name];fi=nodes.length;while(fi--)if(!nodes[fi].parent)nodes.splice(fi,1);for(i=0,l=list.length;i<l;i++)list[i](nodes,name,args)}for(i=0,l=attributeFilters.length;i<l;i++){list=attributeFilters[i];if(list.name in matchedAttributes){nodes=matchedAttributes[list.name];fi=nodes.length;while(fi--)if(!nodes[fi].parent)nodes.splice(fi,1);for(fi=
0,fl=list.callbacks.length;fi<fl;fi++)list.callbacks[fi](nodes,list.name,args)}}}return rootNode};if(settings.remove_trailing_brs)self.addNodeFilter("br",function(nodes,name){var i,l=nodes.length,node,blockElements=tinymce.extend({},schema.getBlockElements()),nonEmptyElements=schema.getNonEmptyElements(),parent,lastParent,prev,prevName;blockElements.body=1;for(i=0;i<l;i++){node=nodes[i];parent=node.parent;if(blockElements[node.parent.name]&&node===parent.lastChild){prev=node.prev;while(prev){prevName=
prev.name;if(prevName!=="span"||prev.attr("data-mce-type")!=="bookmark"){if(prevName!=="br")break;if(prevName==="br"){node=null;break}}prev=prev.prev}if(node){node.remove();if(parent.isEmpty(nonEmptyElements)){elementRule=schema.getElementRule(parent.name);if(elementRule)if(elementRule.removeEmpty)parent.remove();else if(elementRule.paddEmpty)parent.empty().append(new tinymce.html.Node("#text",3)).value="\u00a0"}}}else{lastParent=node;while(parent.firstChild===lastParent&&parent.lastChild===lastParent){lastParent=
parent;if(blockElements[parent.name])break;parent=parent.parent}if(lastParent===parent){textNode=new tinymce.html.Node("#text",3);textNode.value="\u00a0";node.replace(textNode)}}}});if(!settings.allow_html_in_named_anchor)self.addAttributeFilter("id,name",function(nodes,name){var i=nodes.length,sibling,prevSibling,parent,node;while(i--){node=nodes[i];if(node.name==="a"&&node.firstChild&&!node.attr("href")){parent=node.parent;sibling=node.lastChild;do{prevSibling=sibling.prev;parent.insert(sibling,
node);sibling=prevSibling}while(sibling)}}})}})(tinymce);
tinymce.html.Writer=function(settings){var html=[],indent,indentBefore,indentAfter,encode,htmlOutput;settings=settings||{};indent=settings.indent;indentBefore=tinymce.makeMap(settings.indent_before||"");indentAfter=tinymce.makeMap(settings.indent_after||"");encode=tinymce.html.Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities);htmlOutput=settings.element_format=="html";return{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0){value=
html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}html.push("<",name);if(attrs)for(i=0,l=attrs.length;i<l;i++){attr=attrs[i];html.push(" ",attr.name,'="',encode(attr.value,true),'"')}if(!empty||htmlOutput)html[html.length]=">";else html[html.length]=" />";if(empty&&indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}},end:function(name){var value;html.push("</",name,">");if(indent&&indentAfter[name]&&html.length>0){value=
html[html.length-1];if(value.length>0&&value!=="\n")html.push("\n")}},text:function(text,raw){if(text.length>0)html[html.length]=raw?text:encode(text)},cdata:function(text){html.push("<![CDATA[",text,"]]\>")},comment:function(text){html.push("<\!--",text,"--\>")},pi:function(name,text){if(text)html.push("<?",name," ",text,"?>");else html.push("<?",name,"?>");if(indent)html.push("\n")},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,
"")}}};
(function(tinymce){tinymce.html.Serializer=function(settings,schema){var self=this,writer=new tinymce.html.Writer(settings);settings=settings||{};settings.validate="validate"in settings?settings.validate:true;self.schema=schema=schema||new tinymce.html.Schema;self.writer=writer;self.serialize=function(node){var handlers,validate;validate=settings.validate;handlers={3:function(node,raw){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},
10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if(node=node.firstChild){do walk(node);while(node=node.next)}}};writer.reset();function walk(node){var handler=handlers[node.type],name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!handler){name=node.name;isEmpty=node.shortEnded;attrs=node.attributes;if(validate&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=schema.getElementRule(node.name);for(i=0,
l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}attrs=sortedAttrs}writer.start(node.name,attrs,isEmpty);if(!isEmpty){if(node=
node.firstChild){do walk(node);while(node=node.next)}writer.end(name)}}else handler(node)}if(node.type==1&&!settings.inner)walk(node);else handlers[11](node);return writer.getContent()}}})(tinymce);tinymce.dom={};
(function(namespace,expando){var w3cEventModel=!!document.addEventListener;function addEvent(target,name,callback,capture){if(target.addEventListener)target.addEventListener(name,callback,capture||false);else if(target.attachEvent)target.attachEvent("on"+name,callback)}function removeEvent(target,name,callback,capture){if(target.removeEventListener)target.removeEventListener(name,callback,capture||false);else if(target.detachEvent)target.detachEvent("on"+name,callback)}function fix(original_event,
data){var name,event=data||{};function returnFalse(){return false}function returnTrue(){return true}for(name in original_event)if(name!=="layerX"&&name!=="layerY")event[name]=original_event[name];if(!event.target)event.target=event.srcElement||document;event.preventDefault=function(){event.isDefaultPrevented=returnTrue;if(original_event)if(original_event.preventDefault)original_event.preventDefault();else original_event.returnValue=false};event.stopPropagation=function(){event.isPropagationStopped=
returnTrue;if(original_event)if(original_event.stopPropagation)original_event.stopPropagation();else original_event.cancelBubble=true};event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue;event.stopPropagation()};if(!event.isDefaultPrevented){event.isDefaultPrevented=returnFalse;event.isPropagationStopped=returnFalse;event.isImmediatePropagationStopped=returnFalse}return event}function bindOnReady(win,callback,event_utils){var doc=win.document,event={type:"ready"};
function readyHandler(){if(!event_utils.domLoaded){event_utils.domLoaded=true;callback(event)}}if(w3cEventModel)addEvent(win,"DOMContentLoaded",readyHandler);else{addEvent(doc,"readystatechange",function(){if(doc.readyState==="complete"){removeEvent(doc,"readystatechange",arguments.callee);readyHandler()}});if(doc.documentElement.doScroll&&win===win.top)(function(){try{doc.documentElement.doScroll("left")}catch(ex){setTimeout(arguments.callee,0);return}readyHandler()})()}addEvent(win,"load",readyHandler)}
function EventUtils(proxy){var self=this,events={},count,isFocusBlurBound,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave;hasMouseEnterLeave="onmouseenter"in document.documentElement;hasFocusIn="onfocusin"in document.documentElement;mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"};count=1;self.domLoaded=false;self.events=events;function executeHandlers(evt,id){var callbackList,i,l,callback;callbackList=events[id][evt.type];if(callbackList)for(i=0,l=callbackList.length;i<l;i++){callback=
callbackList[i];if(callback&&callback.func.call(callback.scope,evt)===false)evt.preventDefault();if(evt.isImmediatePropagationStopped())return}}self.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;function defaultNativeHandler(evt){executeHandlers(fix(evt||win.event),id)}if(!target||target.nodeType===3||target.nodeType===8)return;if(!target[expando]){id=count++;target[expando]=id;events[id]={}}else{id=target[expando];if(!events[id])events[id]=
{}}scope=scope||target;names=names.split(" ");i=names.length;while(i--){name=names[i];nativeHandler=defaultNativeHandler;fakeName=capture=false;if(name==="DOMContentLoaded")name="ready";if((self.domLoaded||target.readyState=="complete")&&name==="ready"){self.domLoaded=true;callback.call(scope,fix({type:name}));continue}if(!hasMouseEnterLeave){fakeName=mouseEnterLeave[name];if(fakeName)nativeHandler=function(evt){var current,related;current=evt.currentTarget;related=evt.relatedTarget;if(related&&current.contains)related=
current.contains(related);else while(related&&related!==current)related=related.parentNode;if(!related){evt=fix(evt||win.event);evt.type=evt.type==="mouseout"?"mouseleave":"mouseenter";evt.target=current;executeHandlers(evt,id)}}}if(!hasFocusIn&&(name==="focusin"||name==="focusout")){capture=true;fakeName=name==="focusin"?"focus":"blur";nativeHandler=function(evt){evt=fix(evt||win.event);evt.type=evt.type==="focus"?"focusin":"focusout";executeHandlers(evt,id)}}callbackList=events[id][name];if(!callbackList){events[id][name]=
callbackList=[{func:callback,scope:scope}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(!w3cEventModel)callbackList.proxyHandler=proxy(id);if(name==="ready")bindOnReady(target,nativeHandler,self);else addEvent(target,fakeName||name,w3cEventModel?nativeHandler:callbackList.proxyHandler,capture)}else callbackList.push({func:callback,scope:scope})}target=callbackList=0;return callback};self.unbind=function(target,names,callback){var id,callbackList,
i,ci,name,eventMap;if(!target||target.nodeType===3||target.nodeType===8)return self;id=target[expando];if(id){eventMap=events[id];if(names){names=names.split(" ");i=names.length;while(i--){name=names[i];callbackList=eventMap[name];if(callbackList){if(callback){ci=callbackList.length;while(ci--)if(callbackList[ci].func===callback)callbackList.splice(ci,1)}if(!callback||callbackList.length===0){delete eventMap[name];removeEvent(target,callbackList.fakeName||name,w3cEventModel?callbackList.nativeHandler:
callbackList.proxyHandler,callbackList.capture)}}}}else{for(name in eventMap){callbackList=eventMap[name];removeEvent(target,callbackList.fakeName||name,w3cEventModel?callbackList.nativeHandler:callbackList.proxyHandler,callbackList.capture)}eventMap={}}for(name in eventMap)return self;delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self};self.fire=function(target,name,args){var id,event;if(!target||target.nodeType===3||target.nodeType===8)return self;event=fix(null,
args);event.type=name;do{id=target[expando];if(id)executeHandlers(event,id);target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow}while(target&&!event.isPropagationStopped());return self};self.clean=function(target){var i,children,unbind=self.unbind;if(!target||target.nodeType===3||target.nodeType===8)return self;if(target[expando])unbind(target);if(!target.getElementsByTagName)target=target.document;if(target&&target.getElementsByTagName){unbind(target);children=
target.getElementsByTagName("*");i=children.length;while(i--){target=children[i];if(target[expando])unbind(target)}}return self};self.callNativeHandler=function(id,evt){if(events)events[id][evt.type].nativeHandler(evt)};self.destory=function(){events={}};self.add=function(target,events,func,scope){if(typeof target==="string")target=document.getElementById(target);if(target&&target instanceof Array){var i=target.length;while(i--)self.add(target[i],events,func,scope);return}if(events==="init")events=
"ready";return self.bind(target,events instanceof Array?events.join(" "):events,func,scope)};self.remove=function(target,events,func,scope){if(!target)return self;if(typeof target==="string")target=document.getElementById(target);if(target instanceof Array){var i=target.length;while(i--)self.remove(target[i],events,func,scope);return self}return self.unbind(target,events instanceof Array?events.join(" "):events,func)};self.clear=function(target){if(typeof target==="string")target=document.getElementById(target);
return self.clean(target)};self.cancel=function(e){if(e){self.prevent(e);self.stop(e)}return false};self.prevent=function(e){if(!e.preventDefault)e=fix(e);e.preventDefault();return false};self.stop=function(e){if(!e.stopPropagation)e=fix(e);e.stopPropagation();return false}}namespace.EventUtils=EventUtils;namespace.Event=new EventUtils(function(id){return function(evt){tinymce.dom.Event.callNativeHandler(id,evt)}});namespace.Event.bind(window,"ready",function(){});namespace=0})(tinymce.dom,"data-mce-expando");
tinymce.dom.TreeWalker=function(start_node,root_node){var node=start_node;function findSibling(node,start_name,sibling_name,shallow){var sibling,parent;if(node){if(!shallow&&node[start_name])return node[start_name];if(node!=root_node){sibling=node[sibling_name];if(sibling)return sibling;for(parent=node.parentNode;parent&&parent!=root_node;parent=parent.parentNode){sibling=parent[sibling_name];if(sibling)return sibling}}}}this.current=function(){return node};this.next=function(shallow){return node=
findSibling(node,"firstChild","nextSibling",shallow)};this.prev=function(shallow){return node=findSibling(node,"lastChild","previousSibling",shallow)}};
(function(tinymce){var each=tinymce.each,is=tinymce.is,isWebKit=tinymce.isWebKit,isIE=tinymce.isIE,Entities=tinymce.html.Entities,simpleSelectorRe=/^([a-z0-9],?)+$/i,whiteSpaceRegExp=/^[ \t\r\n]*$/;tinymce.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",
id:"id",name:"name",type:"type"},DOMUtils:function(d,s){var t=this,globalStyle,name,blockElementsMap;t.doc=d;t.win=window;t.files={};t.cssFlicker=false;t.counter=0;t.stdMode=!tinymce.isIE||d.documentMode>=8;t.boxModel=!tinymce.isIE||d.compatMode=="CSS1Compat"||t.stdMode;t.hasOuterHTML="outerHTML"in d.createElement("a");t.settings=s=tinymce.extend({keep_values:false,hex_colors:1},s);t.schema=s.schema;t.styles=new tinymce.html.Styles({url_converter:s.url_converter,url_converter_scope:s.url_converter_scope},
s.schema);if(tinymce.isIE6)try{d.execCommand("BackgroundImageCache",false,true)}catch(e){t.cssFlicker=true}t.fixDoc(d);t.events=s.ownEvents?new tinymce.dom.EventUtils(s.proxy):tinymce.dom.Event;tinymce.addUnload(t.destroy,t);blockElementsMap=s.schema?s.schema.getBlockElements():{};t.isBlock=function(node){var type=node.nodeType;if(type)return!!(type===1&&blockElementsMap[node.nodeName]);return!!blockElementsMap[node]}},fixDoc:function(doc){var settings=this.settings,name;if(isIE&&settings.schema){("abbr article aside audio canvas "+
"details figcaption figure footer "+"header hgroup mark menu meter nav "+"output progress section summary "+"time video").replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements())doc.createElement(name)}},clone:function(node,deep){var self=this,clone,doc;if(!isIE||node.nodeType!==1||deep)return node.cloneNode(deep);doc=self.doc;if(!deep){clone=doc.createElement(node.nodeName);each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,
self.getAttrib(node,attr.nodeName))});return clone}return clone.firstChild},getRoot:function(){var t=this,s=t.settings;return s&&t.get(s.root_element)||t.doc.body},getViewPort:function(w){var d,b;w=!w?this.win:w;d=w.document;b=this.boxModel?d.documentElement:d.body;return{x:w.pageXOffset||b.scrollLeft,y:w.pageYOffset||b.scrollTop,w:w.innerWidth||b.clientWidth,h:w.innerHeight||b.clientHeight}},getRect:function(e){var p,t=this,sr;e=t.get(e);p=t.getPos(e);sr=t.getSize(e);return{x:p.x,y:p.y,w:sr.w,h:sr.h}},
getSize:function(e){var t=this,w,h;e=t.get(e);w=t.getStyle(e,"width");h=t.getStyle(e,"height");if(w.indexOf("px")===-1)w=0;if(h.indexOf("px")===-1)h=0;return{w:parseInt(w,10)||e.offsetWidth||e.clientWidth,h:parseInt(h,10)||e.offsetHeight||e.clientHeight}},getParent:function(n,f,r){return this.getParents(n,f,r,false)},getParents:function(n,f,r,c){var t=this,na,se=t.settings,o=[];n=t.get(n);c=c===undefined;if(se.strict_root)r=r||t.getRoot();if(is(f,"string")){na=f;if(f==="*")f=function(n){return n.nodeType==
1};else f=function(n){return t.is(n,na)}}while(n){if(n==r||!n.nodeType||n.nodeType===9)break;if(!f||f(n))if(c)o.push(n);else return n;n=n.parentNode}return c?o:null},get:function(e){var n;if(e&&this.doc&&typeof e=="string"){n=e;e=this.doc.getElementById(e);if(e&&e.id!==n)return this.doc.getElementsByName(n)[1]}return e},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(pa,
s){var t=this;return tinymce.dom.Sizzle(pa,t.get(s)||t.get(t.settings.root_element)||t.doc,[])},is:function(n,selector){var i;if(n.length===undefined){if(selector==="*")return n.nodeType==1;if(simpleSelectorRe.test(selector)){selector=selector.toLowerCase().split(/,/);n=n.nodeName.toLowerCase();for(i=selector.length-1;i>=0;i--)if(selector[i]==n)return true;return false}}return tinymce.dom.Sizzle.matches(selector,n.nodeType?[n]:n).length>0},add:function(p,n,a,h,c){var t=this;return this.run(p,function(p){var e,
k;e=is(n,"string")?t.doc.createElement(n):n;t.setAttribs(e,a);if(h)if(h.nodeType)e.appendChild(h);else t.setHTML(e,h);return!c?p.appendChild(e):e})},create:function(n,a,h){return this.add(this.doc.createElement(n),n,a,h,1)},createHTML:function(n,a,h){var o="",t=this,k;o+="<"+n;for(k in a)if(a.hasOwnProperty(k))o+=" "+k+'="'+t.encode(a[k])+'"';if(typeof h!="undefined")return o+">"+h+"</"+n+">";return o+" />"},remove:function(node,keep_children){return this.run(node,function(node){var child,parent=
node.parentNode;if(!parent)return null;if(keep_children)while(child=node.firstChild)if(!tinymce.isIE||child.nodeType!==3||child.nodeValue)parent.insertBefore(child,node);else node.removeChild(child);return parent.removeChild(node)})},setStyle:function(n,na,v){var t=this;return t.run(n,function(e){var s,i;s=e.style;na=na.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(t.pixelStyles.test(na)&&(tinymce.is(v,"number")||/^[\-0-9\.]+$/.test(v)))v+="px";switch(na){case "opacity":if(isIE){s.filter=
v===""?"":"alpha(opacity="+v*100+")";if(!n.currentStyle||!n.currentStyle.hasLayout)s.display="inline-block"}s[na]=s["-moz-opacity"]=s["-khtml-opacity"]=v||"";break;case "float":isIE?s.styleFloat=v:s.cssFloat=v;break;default:s[na]=v||""}if(t.settings.update_styles)t.setAttrib(e,"data-mce-style")})},getStyle:function(n,na,c){n=this.get(n);if(!n)return;if(this.doc.defaultView&&c){na=na.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(n,null).getPropertyValue(na)}catch(ex){return null}}na=
na.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(na=="float")na=isIE?"styleFloat":"cssFloat";if(n.currentStyle&&c)return n.currentStyle[na];return n.style?n.style[na]:undefined},setStyles:function(e,o){var t=this,s=t.settings,ol;ol=s.update_styles;s.update_styles=0;each(o,function(v,n){t.setStyle(e,n,v)});s.update_styles=ol;if(s.update_styles)t.setAttrib(e,s.cssText)},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--)e.removeAttributeNode(attrs.item(i))})},
setAttrib:function(e,n,v){var t=this;if(!e||!n)return;if(t.settings.strict)n=n.toLowerCase();return this.run(e,function(e){var s=t.settings;var originalValue=e.getAttribute(n);if(v!==null)switch(n){case "style":if(!is(v,"string")){each(v,function(v,n){t.setStyle(e,n,v)});return}if(s.keep_values)if(v&&!t._isRes(v))e.setAttribute("data-mce-style",v,2);else e.removeAttribute("data-mce-style",2);e.style.cssText=v;break;case "class":e.className=v||"";break;case "src":case "href":if(s.keep_values){if(s.url_converter)v=
s.url_converter.call(s.url_converter_scope||t,v,n,e);t.setAttrib(e,"data-mce-"+n,v,2)}break;case "shape":e.setAttribute("data-mce-style",v);break}if(is(v)&&v!==null&&v.length!==0)e.setAttribute(n,""+v,2);else e.removeAttribute(n,2);if(tinyMCE.activeEditor&&originalValue!=v){var ed=tinyMCE.activeEditor;ed.onSetAttrib.dispatch(ed,e,n,v)}})},setAttribs:function(e,o){var t=this;return this.run(e,function(e){each(o,function(v,n){t.setAttrib(e,n,v)})})},getAttrib:function(e,n,dv){var v,t=this,undef;e=t.get(e);
if(!e||e.nodeType!==1)return dv===undef?false:dv;if(!is(dv))dv="";if(/^(src|href|style|coords|shape)$/.test(n)){v=e.getAttribute("data-mce-"+n);if(v)return v}if(isIE&&t.props[n]){v=e[t.props[n]];v=v&&v.nodeValue?v.nodeValue:v}if(!v)v=e.getAttribute(n,2);if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(n)){if(e[t.props[n]]===true&&v==="")return n;return v?n:""}if(e.nodeName==="FORM"&&e.getAttributeNode(n))return e.getAttributeNode(n).nodeValue;
if(n==="style"){v=v||e.style.cssText;if(v){v=t.serializeStyle(t.parseStyle(v),e.nodeName);if(t.settings.keep_values&&!t._isRes(v))e.setAttribute("data-mce-style",v)}}if(isWebKit&&n==="class"&&v)v=v.replace(/(apple|webkit)\-[a-z\-]+/gi,"");if(isIE)switch(n){case "rowspan":case "colspan":if(v===1)v="";break;case "size":if(v==="+0"||v===20||v===0)v="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":if(v===0)v="";break;case "hspace":if(v===-1)v="";break;case "maxlength":case "tabindex":if(v===
32768||v===2147483647||v==="32768")v="";break;case "multiple":case "compact":case "noshade":case "nowrap":if(v===65535)return n;return dv;case "shape":v=v.toLowerCase();break;default:if(n.indexOf("on")===0&&v)v=tinymce._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+v)}return v!==undef&&v!==null&&v!==""?""+v:dv},getPos:function(n,ro){var t=this,x=0,y=0,e,d=t.doc,r;n=t.get(n);ro=ro||d.body;if(n){if(n.getBoundingClientRect){n=n.getBoundingClientRect();e=t.boxModel?d.documentElement:d.body;
x=n.left+(d.documentElement.scrollLeft||d.body.scrollLeft)-e.clientTop;y=n.top+(d.documentElement.scrollTop||d.body.scrollTop)-e.clientLeft;return{x:x,y:y}}r=n;while(r&&r!=ro&&r.nodeType){x+=r.offsetLeft||0;y+=r.offsetTop||0;r=r.offsetParent}r=n.parentNode;while(r&&r!=ro&&r.nodeType){x-=r.scrollLeft||0;y-=r.scrollTop||0;r=r.parentNode}}return{x:x,y:y}},parseStyle:function(st){return this.styles.parse(st)},serializeStyle:function(o,name){return this.styles.serialize(o,name)},addStyle:function(cssText){var doc=
this.doc,head;styleElm=doc.getElementById("mceDefaultStyles");if(!styleElm){styleElm=doc.createElement("style"),styleElm.id="mceDefaultStyles";styleElm.type="text/css";head=doc.getElementsByTagName("head")[0];if(head.firstChild)head.insertBefore(styleElm,head.firstChild);else head.appendChild(styleElm)}if(styleElm.styleSheet)styleElm.styleSheet.cssText+=cssText;else styleElm.appendChild(doc.createTextNode(cssText))},loadCSS:function(u){var t=this,d=t.doc,head;if(!u)u="";head=d.getElementsByTagName("head")[0];
each(u.split(","),function(u){var link;if(t.files[u])return;t.files[u]=true;link=t.create("link",{rel:"stylesheet",href:tinymce._addVer(u)});if(isIE&&d.documentMode&&d.recalc)link.onload=function(){if(d.recalc)d.recalc();link.onload=null};head.appendChild(link)})},addClass:function(e,c){return this.run(e,function(e){var o;if(!c)return 0;if(this.hasClass(e,c))return e.className;o=this.removeClass(e,c);return e.className=(o!=""?o+" ":"")+c})},removeClass:function(e,c){var t=this,re;return t.run(e,function(e){var v;
if(t.hasClass(e,c)){if(!re)re=new RegExp("(^|\\s+)"+c+"(\\s+|$)","g");v=e.className.replace(re," ");v=tinymce.trim(v!=" "?v:"");e.className=v;if(!v){e.removeAttribute("class");e.removeAttribute("className")}return v}return e.className})},hasClass:function(n,c){n=this.get(n);if(!n||!c)return false;return(" "+n.className+" ").indexOf(" "+c+" ")!==-1},show:function(e){return this.setStyle(e,"display","block")},hide:function(e){return this.setStyle(e,"display","none")},isHidden:function(e){e=this.get(e);
return!e||e.style.display=="none"||this.getStyle(e,"display")=="none"},uniqueId:function(p){return(!p?"mce_":p)+this.counter++},setHTML:function(element,html){var self=this;return self.run(element,function(element){if(isIE){while(element.firstChild)element.removeChild(element.firstChild);try{element.innerHTML="<br />"+html;element.removeChild(element.firstChild)}catch(ex){var newElement=self.create("div");newElement.innerHTML="<br />"+html;each(tinymce.grep(newElement.childNodes),function(node,i){if(i&&
element.canHaveHTML)element.appendChild(node)})}}else element.innerHTML=html;return html})},getOuterHTML:function(elm){var doc,self=this;elm=self.get(elm);if(!elm)return null;if(elm.nodeType===1&&self.hasOuterHTML)return elm.outerHTML;doc=(elm.ownerDocument||self.doc).createElement("body");doc.appendChild(elm.cloneNode(true));return doc.innerHTML},setOuterHTML:function(e,h,d){var t=this;function setHTML(e,h,d){var n,tp;tp=d.createElement("body");tp.innerHTML=h;n=tp.lastChild;while(n){t.insertAfter(n.cloneNode(true),
e);n=n.previousSibling}t.remove(e)}return this.run(e,function(e){e=t.get(e);if(e.nodeType==1){d=d||e.ownerDocument||t.doc;if(isIE)try{if(isIE&&e.nodeType==1)e.outerHTML=h;else setHTML(e,h,d)}catch(ex){setHTML(e,h,d)}else setHTML(e,h,d)}})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,reference_node){reference_node=this.get(reference_node);return this.run(node,function(node){var parent,nextSibling;parent=reference_node.parentNode;nextSibling=reference_node.nextSibling;
if(nextSibling)parent.insertBefore(node,nextSibling);else parent.appendChild(node);return node})},replace:function(n,o,k){var t=this;if(is(o,"array"))n=n.cloneNode(true);return t.run(o,function(o){if(k)each(tinymce.grep(o.childNodes),function(c){n.appendChild(c)});return o.parentNode.replaceChild(n,o)})},rename:function(elm,name){var t=this,newElm;if(elm.nodeName!=name.toUpperCase()){newElm=t.create(name);each(t.getAttribs(elm),function(attr_node){t.setAttrib(newElm,attr_node.nodeName,t.getAttrib(elm,
attr_node.nodeName))});t.replace(newElm,elm,1)}return newElm||elm},findCommonAncestor:function(a,b){var ps=a,pe;while(ps){pe=b;while(pe&&ps!=pe)pe=pe.parentNode;if(ps==pe)break;ps=ps.parentNode}if(!ps&&a.ownerDocument)return a.ownerDocument.documentElement;return ps},toHex:function(s){var c=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(s);function hex(s){s=parseInt(s,10).toString(16);return s.length>1?s:"0"+s}if(c){s="#"+hex(c[1])+hex(c[2])+hex(c[3]);return s}return s},
getClasses:function(){var t=this,cl=[],i,lo={},f=t.settings.class_filter,ov;if(t.classes)return t.classes;function addClasses(s){each(s.imports,function(r){addClasses(r)});each(s.cssRules||s.rules,function(r){switch(r.type||1){case 1:if(r.selectorText)each(r.selectorText.split(","),function(v){v=v.replace(/^\s*|\s*$|^\s\./g,"");if(/\.mce/.test(v)||!/\.[\w\-]+$/.test(v))return;ov=v;v=tinymce._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",v);if(f&&!(v=f(v,ov)))return;if(!lo[v]){cl.push({"class":v});lo[v]=1}});
break;case 3:addClasses(r.styleSheet);break}})}try{each(t.doc.styleSheets,addClasses)}catch(ex){}if(cl.length>0)t.classes=cl;return cl},run:function(e,f,s){var t=this,o;if(t.doc&&typeof e==="string")e=t.get(e);if(!e)return false;s=s||this;if(!e.nodeType&&(e.length||e.length===0)){o=[];each(e,function(e,i){if(e){if(typeof e=="string")e=t.doc.getElementById(e);o.push(f.call(s,e,i))}});return o}return f.call(s,e)},getAttribs:function(n){var o;n=this.get(n);if(!n)return[];if(isIE){o=[];if(n.nodeName==
"OBJECT")return n.attributes;if(n.nodeName==="OPTION"&&this.getAttrib(n,"selected"))o.push({specified:1,nodeName:"selected"});n.cloneNode(false).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(a){o.push({specified:1,nodeName:a})});return o}return n.attributes},isEmpty:function(node,elements){var self=this,i,attributes,type,walker,name,brCount=0;node=node.firstChild;if(node){walker=new tinymce.dom.TreeWalker(node,node.parentNode);elements=
elements||self.schema?self.schema.getNonEmptyElements():null;do{type=node.nodeType;if(type===1){if(node.getAttribute("data-mce-bogus"))continue;name=node.nodeName.toLowerCase();if(elements&&elements[name]){if(name==="br"){brCount++;continue}return false}attributes=self.getAttribs(node);i=node.attributes.length;while(i--){name=node.attributes[i].nodeName;if(name==="name"||name==="data-mce-bookmark")return false}}if(type==8)return false;if(type===3&&!whiteSpaceRegExp.test(node.nodeValue))return false}while(node=
walker.next())}return brCount<=1},destroy:function(s){var t=this;t.win=t.doc=t.root=t.events=t.frag=null;if(!s)tinymce.removeUnload(t.destroy)},createRng:function(){var d=this.doc;return d.createRange?d.createRange():new tinymce.dom.Range(this)},nodeIndex:function(node,normalized){var idx=0,lastNodeType,lastNode,nodeType;if(node)for(lastNodeType=node.nodeType,node=node.previousSibling,lastNode=node;node;node=node.previousSibling){nodeType=node.nodeType;if(normalized&&nodeType==3)if(nodeType==lastNodeType||
!node.nodeValue.length)continue;idx++;lastNodeType=nodeType}return idx},split:function(pe,e,re){var t=this,r=t.createRng(),bef,aft,pa;function trim(node){var i,children=node.childNodes,type=node.nodeType;function surroundedBySpans(node){var previousIsSpan=node.previousSibling&&node.previousSibling.nodeName=="SPAN";var nextIsSpan=node.nextSibling&&node.nextSibling.nodeName=="SPAN";return previousIsSpan&&nextIsSpan}if(type==1&&node.getAttribute("data-mce-type")=="bookmark")return;for(i=children.length-
1;i>=0;i--)trim(children[i]);if(type!=9){if(type==3&&node.nodeValue.length>0){var trimmedLength=tinymce.trim(node.nodeValue).length;if(!t.isBlock(node.parentNode)||trimmedLength>0||trimmedLength===0&&surroundedBySpans(node))return}else if(type==1){children=node.childNodes;if(children.length==1&&children[0]&&children[0].nodeType==1&&children[0].getAttribute("data-mce-type")=="bookmark")node.parentNode.insertBefore(children[0],node);if(children.length||/^(br|hr|input|img)$/i.test(node.nodeName))return}t.remove(node)}return node}
if(pe&&e){r.setStart(pe.parentNode,t.nodeIndex(pe));r.setEnd(e.parentNode,t.nodeIndex(e));bef=r.extractContents();r=t.createRng();r.setStart(e.parentNode,t.nodeIndex(e)+1);r.setEnd(pe.parentNode,t.nodeIndex(pe)+1);aft=r.extractContents();pa=pe.parentNode;pa.insertBefore(trim(bef),pe);if(re)pa.replaceChild(re,e);else pa.insertBefore(e,pe);pa.insertBefore(trim(aft),pe);t.remove(pe);return re||e}},bind:function(target,name,func,scope){return this.events.add(target,name,func,scope||this)},unbind:function(target,
name,func){return this.events.remove(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;if(node.nodeType!=1)return null;contentEditable=node.getAttribute("data-mce-contenteditable");if(contentEditable&&contentEditable!=="inherit")return contentEditable;return node.contentEditable!=="inherit"?node.contentEditable:null},_findSib:function(node,selector,name){var t=this,f=selector;if(node){if(is(f,"string"))f=
function(node){return t.is(node,selector)};for(node=node[name];node;node=node[name])if(f(node))return node}return null},_isRes:function(c){return/^(top|left|bottom|right|width|height)/i.test(c)||/;\s*(top|left|bottom|right|width|height)/i.test(c)}});tinymce.DOM=new tinymce.dom.DOMUtils(document,{process_html:0})})(tinymce);
(function(ns){function Range(dom){var t=this,doc=dom.doc,EXTRACT=0,CLONE=1,DELETE=2,TRUE=true,FALSE=false,START_OFFSET="startOffset",START_CONTAINER="startContainer",END_CONTAINER="endContainer",END_OFFSET="endOffset",extend=tinymce.extend,nodeIndex=dom.nodeIndex;extend(t,{startContainer:doc,startOffset:0,endContainer:doc,endOffset:0,collapsed:TRUE,commonAncestorContainer:doc,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:setStart,setEnd:setEnd,setStartBefore:setStartBefore,
setStartAfter:setStartAfter,setEndBefore:setEndBefore,setEndAfter:setEndAfter,collapse:collapse,selectNode:selectNode,selectNodeContents:selectNodeContents,compareBoundaryPoints:compareBoundaryPoints,deleteContents:deleteContents,extractContents:extractContents,cloneContents:cloneContents,insertNode:insertNode,surroundContents:surroundContents,cloneRange:cloneRange,toStringIE:toStringIE});function createDocumentFragment(){return doc.createDocumentFragment()}function setStart(n,o){_setEndPoint(TRUE,
n,o)}function setEnd(n,o){_setEndPoint(FALSE,n,o)}function setStartBefore(n){setStart(n.parentNode,nodeIndex(n))}function setStartAfter(n){setStart(n.parentNode,nodeIndex(n)+1)}function setEndBefore(n){setEnd(n.parentNode,nodeIndex(n))}function setEndAfter(n){setEnd(n.parentNode,nodeIndex(n)+1)}function collapse(ts){if(ts){t[END_CONTAINER]=t[START_CONTAINER];t[END_OFFSET]=t[START_OFFSET]}else{t[START_CONTAINER]=t[END_CONTAINER];t[START_OFFSET]=t[END_OFFSET]}t.collapsed=TRUE}function selectNode(n){setStartBefore(n);
setEndAfter(n)}function selectNodeContents(n){setStart(n,0);setEnd(n,n.nodeType===1?n.childNodes.length:n.nodeValue.length)}function compareBoundaryPoints(h,r){var sc=t[START_CONTAINER],so=t[START_OFFSET],ec=t[END_CONTAINER],eo=t[END_OFFSET],rsc=r.startContainer,rso=r.startOffset,rec=r.endContainer,reo=r.endOffset;if(h===0)return _compareBoundaryPoints(sc,so,rsc,rso);if(h===1)return _compareBoundaryPoints(ec,eo,rsc,rso);if(h===2)return _compareBoundaryPoints(ec,eo,rec,reo);if(h===3)return _compareBoundaryPoints(sc,
so,rec,reo)}function deleteContents(){_traverse(DELETE)}function extractContents(){return _traverse(EXTRACT)}function cloneContents(){return _traverse(CLONE)}function insertNode(n){var startContainer=this[START_CONTAINER],startOffset=this[START_OFFSET],nn,o;if((startContainer.nodeType===3||startContainer.nodeType===4)&&startContainer.nodeValue)if(!startOffset)startContainer.parentNode.insertBefore(n,startContainer);else if(startOffset>=startContainer.nodeValue.length)dom.insertAfter(n,startContainer);
else{nn=startContainer.splitText(startOffset);startContainer.parentNode.insertBefore(n,nn)}else{if(startContainer.childNodes.length>0)o=startContainer.childNodes[startOffset];if(o)startContainer.insertBefore(n,o);else startContainer.appendChild(n)}}function surroundContents(n){var f=t.extractContents();t.insertNode(n);n.appendChild(f);t.selectNode(n)}function cloneRange(){return extend(new Range(dom),{startContainer:t[START_CONTAINER],startOffset:t[START_OFFSET],endContainer:t[END_CONTAINER],endOffset:t[END_OFFSET],
collapsed:t.collapsed,commonAncestorContainer:t.commonAncestorContainer})}function _getSelectedNode(container,offset){var child;if(container.nodeType==3)return container;if(offset<0)return container;child=container.firstChild;while(child&&offset>0){--offset;child=child.nextSibling}if(child)return child;return container}function _isCollapsed(){return t[START_CONTAINER]==t[END_CONTAINER]&&t[START_OFFSET]==t[END_OFFSET]}function _compareBoundaryPoints(containerA,offsetA,containerB,offsetB){var c,offsetC,
n,cmnRoot,childA,childB;if(containerA==containerB){if(offsetA==offsetB)return 0;if(offsetA<offsetB)return-1;return 1}c=containerB;while(c&&c.parentNode!=containerA)c=c.parentNode;if(c){offsetC=0;n=containerA.firstChild;while(n!=c&&offsetC<offsetA){offsetC++;n=n.nextSibling}if(offsetA<=offsetC)return-1;return 1}c=containerA;while(c&&c.parentNode!=containerB)c=c.parentNode;if(c){offsetC=0;n=containerB.firstChild;while(n!=c&&offsetC<offsetB){offsetC++;n=n.nextSibling}if(offsetC<offsetB)return-1;return 1}cmnRoot=
dom.findCommonAncestor(containerA,containerB);childA=containerA;while(childA&&childA.parentNode!=cmnRoot)childA=childA.parentNode;if(!childA)childA=cmnRoot;childB=containerB;while(childB&&childB.parentNode!=cmnRoot)childB=childB.parentNode;if(!childB)childB=cmnRoot;if(childA==childB)return 0;n=cmnRoot.firstChild;while(n){if(n==childA)return-1;if(n==childB)return 1;n=n.nextSibling}}function _setEndPoint(st,n,o){var ec,sc;if(st){t[START_CONTAINER]=n;t[START_OFFSET]=o}else{t[END_CONTAINER]=n;t[END_OFFSET]=
o}ec=t[END_CONTAINER];while(ec.parentNode)ec=ec.parentNode;sc=t[START_CONTAINER];while(sc.parentNode)sc=sc.parentNode;if(sc==ec){if(_compareBoundaryPoints(t[START_CONTAINER],t[START_OFFSET],t[END_CONTAINER],t[END_OFFSET])>0)t.collapse(st)}else t.collapse(st);t.collapsed=_isCollapsed();t.commonAncestorContainer=dom.findCommonAncestor(t[START_CONTAINER],t[END_CONTAINER])}function _traverse(how){var c,endContainerDepth=0,startContainerDepth=0,p,depthDiff,startNode,endNode,sp,ep;if(t[START_CONTAINER]==
t[END_CONTAINER])return _traverseSameContainer(how);for(c=t[END_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[START_CONTAINER])return _traverseCommonStartContainer(c,how);++endContainerDepth}for(c=t[START_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[END_CONTAINER])return _traverseCommonEndContainer(c,how);++startContainerDepth}depthDiff=startContainerDepth-endContainerDepth;startNode=t[START_CONTAINER];while(depthDiff>0){startNode=startNode.parentNode;depthDiff--}endNode=t[END_CONTAINER];
while(depthDiff<0){endNode=endNode.parentNode;depthDiff++}for(sp=startNode.parentNode,ep=endNode.parentNode;sp!=ep;sp=sp.parentNode,ep=ep.parentNode){startNode=sp;endNode=ep}return _traverseCommonAncestors(startNode,endNode,how)}function _traverseSameContainer(how){var frag,s,sub,n,cnt,sibling,xferNode,start,len;if(how!=DELETE)frag=createDocumentFragment();if(t[START_OFFSET]==t[END_OFFSET])return frag;if(t[START_CONTAINER].nodeType==3){s=t[START_CONTAINER].nodeValue;sub=s.substring(t[START_OFFSET],
t[END_OFFSET]);if(how!=CLONE){n=t[START_CONTAINER];start=t[START_OFFSET];len=t[END_OFFSET]-t[START_OFFSET];if(start===0&&len>=n.nodeValue.length-1)n.parentNode.removeChild(n);else n.deleteData(start,len);t.collapse(TRUE)}if(how==DELETE)return;if(sub.length>0)frag.appendChild(doc.createTextNode(sub));return frag}n=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]);cnt=t[END_OFFSET]-t[START_OFFSET];while(n&&cnt>0){sibling=n.nextSibling;xferNode=_traverseFullySelected(n,how);if(frag)frag.appendChild(xferNode);
--cnt;n=sibling}if(how!=CLONE)t.collapse(TRUE);return frag}function _traverseCommonStartContainer(endAncestor,how){var frag,n,endIdx,cnt,sibling,xferNode;if(how!=DELETE)frag=createDocumentFragment();n=_traverseRightBoundary(endAncestor,how);if(frag)frag.appendChild(n);endIdx=nodeIndex(endAncestor);cnt=endIdx-t[START_OFFSET];if(cnt<=0){if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}n=endAncestor.previousSibling;while(cnt>0){sibling=n.previousSibling;xferNode=_traverseFullySelected(n,
how);if(frag)frag.insertBefore(xferNode,frag.firstChild);--cnt;n=sibling}if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}function _traverseCommonEndContainer(startAncestor,how){var frag,startIdx,n,cnt,sibling,xferNode;if(how!=DELETE)frag=createDocumentFragment();n=_traverseLeftBoundary(startAncestor,how);if(frag)frag.appendChild(n);startIdx=nodeIndex(startAncestor);++startIdx;cnt=t[END_OFFSET]-startIdx;n=startAncestor.nextSibling;while(n&&cnt>0){sibling=n.nextSibling;xferNode=
_traverseFullySelected(n,how);if(frag)frag.appendChild(xferNode);--cnt;n=sibling}if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseCommonAncestors(startAncestor,endAncestor,how){var n,frag,commonParent,startOffset,endOffset,cnt,sibling,nextSibling;if(how!=DELETE)frag=createDocumentFragment();n=_traverseLeftBoundary(startAncestor,how);if(frag)frag.appendChild(n);commonParent=startAncestor.parentNode;startOffset=nodeIndex(startAncestor);endOffset=nodeIndex(endAncestor);
++startOffset;cnt=endOffset-startOffset;sibling=startAncestor.nextSibling;while(cnt>0){nextSibling=sibling.nextSibling;n=_traverseFullySelected(sibling,how);if(frag)frag.appendChild(n);sibling=nextSibling;--cnt}n=_traverseRightBoundary(endAncestor,how);if(frag)frag.appendChild(n);if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseRightBoundary(root,how){var next=_getSelectedNode(t[END_CONTAINER],t[END_OFFSET]-1),parent,clonedParent,prevSibling,clonedChild,
clonedGrandParent,isFullySelected=next!=t[END_CONTAINER];if(next==root)return _traverseNode(next,isFullySelected,FALSE,how);parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,FALSE,how);while(parent){while(next){prevSibling=next.previousSibling;clonedChild=_traverseNode(next,isFullySelected,FALSE,how);if(how!=DELETE)clonedParent.insertBefore(clonedChild,clonedParent.firstChild);isFullySelected=TRUE;next=prevSibling}if(parent==root)return clonedParent;next=parent.previousSibling;parent=
parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,FALSE,how);if(how!=DELETE)clonedGrandParent.appendChild(clonedParent);clonedParent=clonedGrandParent}}function _traverseLeftBoundary(root,how){var next=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]),isFullySelected=next!=t[START_CONTAINER],parent,clonedParent,nextSibling,clonedChild,clonedGrandParent;if(next==root)return _traverseNode(next,isFullySelected,TRUE,how);parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,TRUE,
how);while(parent){while(next){nextSibling=next.nextSibling;clonedChild=_traverseNode(next,isFullySelected,TRUE,how);if(how!=DELETE)clonedParent.appendChild(clonedChild);isFullySelected=TRUE;next=nextSibling}if(parent==root)return clonedParent;next=parent.nextSibling;parent=parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,TRUE,how);if(how!=DELETE)clonedGrandParent.appendChild(clonedParent);clonedParent=clonedGrandParent}}function _traverseNode(n,isFullySelected,isLeft,how){var txtValue,
newNodeValue,oldNodeValue,offset,newNode;if(isFullySelected)return _traverseFullySelected(n,how);if(n.nodeType==3){txtValue=n.nodeValue;if(isLeft){offset=t[START_OFFSET];newNodeValue=txtValue.substring(offset);oldNodeValue=txtValue.substring(0,offset)}else{offset=t[END_OFFSET];newNodeValue=txtValue.substring(0,offset);oldNodeValue=txtValue.substring(offset)}if(how!=CLONE)n.nodeValue=oldNodeValue;if(how==DELETE)return;newNode=dom.clone(n,FALSE);newNode.nodeValue=newNodeValue;return newNode}if(how==
DELETE)return;return dom.clone(n,FALSE)}function _traverseFullySelected(n,how){if(how!=DELETE)return how==CLONE?dom.clone(n,TRUE):n;n.parentNode.removeChild(n)}function toStringIE(){return dom.create("body",null,cloneContents()).outerText}return t}ns.Range=Range;Range.prototype.toString=function(){return this.toStringIE()}})(tinymce.dom);
(function(){function Selection(selection){var self=this,dom=selection.dom,TRUE=true,FALSE=false;function getPosition(rng,start){var checkRng,startIndex=0,endIndex,inside,children,child,offset,index,position=-1,parent;checkRng=rng.duplicate();checkRng.collapse(start);parent=checkRng.parentElement();if(parent.ownerDocument!==selection.dom.doc)return;while(parent.contentEditable==="false")parent=parent.parentNode;if(!parent.hasChildNodes())return{node:parent,inside:1};children=parent.children;endIndex=
children.length-1;while(startIndex<=endIndex){index=Math.floor((startIndex+endIndex)/2);child=children[index];checkRng.moveToElementText(child);position=checkRng.compareEndPoints(start?"StartToStart":"EndToEnd",rng);if(position>0)endIndex=index-1;else if(position<0)startIndex=index+1;else return{node:child}}if(position<0){if(!child){checkRng.moveToElementText(parent);checkRng.collapse(true);child=parent;inside=true}else checkRng.collapse(false);offset=0;while(checkRng.compareEndPoints(start?"StartToStart":
"StartToEnd",rng)!==0){if(checkRng.move("character",1)===0||parent!=checkRng.parentElement())break;offset++}}else{checkRng.collapse(true);offset=0;while(checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)!==0){if(checkRng.move("character",-1)===0||parent!=checkRng.parentElement())break;offset++}}return{node:child,position:position,offset:offset,inside:inside}}function getRange(){var ieRange=selection.getRng(),domRange=dom.createRng(),element,collapsed,tmpRange,element2,bookmark,fail;
element=ieRange.item?ieRange.item(0):ieRange.parentElement();if(element.ownerDocument!=dom.doc)return domRange;collapsed=selection.isCollapsed();if(ieRange.item){domRange.setStart(element.parentNode,dom.nodeIndex(element));domRange.setEnd(domRange.startContainer,domRange.startOffset+1);return domRange}function findEndPoint(start){var endPoint=getPosition(ieRange,start),container,offset,textNodeOffset=0,sibling,undef,nodeValue;container=endPoint.node;offset=endPoint.offset;if(endPoint.inside&&!container.hasChildNodes()){domRange[start?
"setStart":"setEnd"](container,0);return}if(offset===undef){domRange[start?"setStartBefore":"setEndAfter"](container);return}if(endPoint.position<0){sibling=endPoint.inside?container.firstChild:container.nextSibling;if(!sibling){domRange[start?"setStartAfter":"setEndAfter"](container);return}if(!offset){if(sibling.nodeType==3)domRange[start?"setStart":"setEnd"](sibling,0);else domRange[start?"setStartBefore":"setEndBefore"](sibling);return}while(sibling){nodeValue=sibling.nodeValue;textNodeOffset+=
nodeValue.length;if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;textNodeOffset=nodeValue.length-textNodeOffset;break}sibling=sibling.nextSibling}}else{sibling=container.previousSibling;if(!sibling)return domRange[start?"setStartBefore":"setEndBefore"](container);if(!offset){if(container.nodeType==3)domRange[start?"setStart":"setEnd"](sibling,container.nodeValue.length);else domRange[start?"setStartAfter":"setEndAfter"](sibling);return}while(sibling){textNodeOffset+=sibling.nodeValue.length;
if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;break}sibling=sibling.previousSibling}}domRange[start?"setStart":"setEnd"](container,textNodeOffset)}try{findEndPoint(true);if(!collapsed)findEndPoint()}catch(ex){if(ex.number==-2147024809){bookmark=self.getBookmark(2);tmpRange=ieRange.duplicate();tmpRange.collapse(true);element=tmpRange.parentElement();if(!collapsed){tmpRange=ieRange.duplicate();tmpRange.collapse(false);element2=tmpRange.parentElement();element2.innerHTML=element2.innerHTML}element.innerHTML=
element.innerHTML;self.moveToBookmark(bookmark);ieRange=selection.getRng();findEndPoint(true);if(!collapsed)findEndPoint()}else throw ex;}return domRange}this.getBookmark=function(type){var rng=selection.getRng(),start,end,bookmark={};function getIndexes(node){var parent,root,children,i,indexes=[];parent=node.parentNode;root=dom.getRoot().parentNode;while(parent!=root&&parent.nodeType!==9){children=parent.children;i=children.length;while(i--)if(node===children[i]){indexes.push(i);break}node=parent;
parent=parent.parentNode}return indexes}function getBookmarkEndPoint(start){var position;position=getPosition(rng,start);if(position)return{position:position.position,offset:position.offset,indexes:getIndexes(position.node),inside:position.inside}}if(type===2)if(!rng.item){bookmark.start=getBookmarkEndPoint(true);if(!selection.isCollapsed())bookmark.end=getBookmarkEndPoint()}else bookmark.start={ctrl:true,indexes:getIndexes(rng.item(0))};return bookmark};this.moveToBookmark=function(bookmark){var rng,
body=dom.doc.body;function resolveIndexes(indexes){var node,i,idx,children;node=dom.getRoot();for(i=indexes.length-1;i>=0;i--){children=node.children;idx=indexes[i];if(idx<=children.length-1)node=children[idx]}return node}function setBookmarkEndPoint(start){var endPoint=bookmark[start?"start":"end"],moveLeft,moveRng,undef;if(endPoint){moveLeft=endPoint.position>0;moveRng=body.createTextRange();moveRng.moveToElementText(resolveIndexes(endPoint.indexes));offset=endPoint.offset;if(offset!==undef){moveRng.collapse(endPoint.inside||
moveLeft);moveRng.moveStart("character",moveLeft?-offset:offset)}else moveRng.collapse(start);rng.setEndPoint(start?"StartToStart":"EndToStart",moveRng);if(start)rng.collapse(true)}}if(bookmark.start)if(bookmark.start.ctrl){rng=body.createControlRange();rng.addElement(resolveIndexes(bookmark.start.indexes));rng.select()}else{rng=body.createTextRange();setBookmarkEndPoint(true);setBookmarkEndPoint();rng.select()}};this.addRange=function(rng){var ieRng,ctrlRng,startContainer,startOffset,endContainer,
endOffset,sibling,doc=selection.dom.doc,body=doc.body,nativeRng,ctrlElm;function setEndPoint(start){var container,offset,marker,tmpRng,nodes;marker=dom.create("a");container=start?startContainer:endContainer;offset=start?startOffset:endOffset;tmpRng=ieRng.duplicate();if(container==doc||container==doc.documentElement){container=body;offset=0}if(container.nodeType==3){container.parentNode.insertBefore(marker,container);tmpRng.moveToElementText(marker);tmpRng.moveStart("character",offset);dom.remove(marker);
ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng)}else{nodes=container.childNodes;if(nodes.length){if(offset>=nodes.length)dom.insertAfter(marker,nodes[nodes.length-1]);else container.insertBefore(marker,nodes[offset]);tmpRng.moveToElementText(marker)}else if(container.canHaveHTML){container.innerHTML="<span>\ufeff</span>";marker=container.firstChild;tmpRng.moveToElementText(marker);tmpRng.collapse(FALSE)}ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng);dom.remove(marker)}}startContainer=
rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset;ieRng=body.createTextRange();if(startContainer==endContainer&&startContainer.nodeType==1){if(startOffset==endOffset&&!startContainer.hasChildNodes())if(startContainer.canHaveHTML){sibling=startContainer.previousSibling;if(sibling&&!sibling.hasChildNodes()&&dom.isBlock(sibling))sibling.innerHTML="\ufeff";else sibling=null;startContainer.innerHTML="<span>\ufeff</span><span>\ufeff</span>";ieRng.moveToElementText(startContainer.lastChild);
ieRng.select();dom.doc.selection.clear();startContainer.innerHTML="";if(sibling)sibling.innerHTML="";return}else{startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode}if(startOffset==endOffset-1)try{ctrlElm=startContainer.childNodes[startOffset];ctrlRng=body.createControlRange();ctrlRng.addElement(ctrlElm);ctrlRng.select();nativeRng=selection.getRng();if(nativeRng.item&&ctrlElm===nativeRng.item(0))return}catch(ex){}}setEndPoint(true);setEndPoint();ieRng.select()};this.getRangeAt=
getRange}tinymce.dom.TridentSelection=Selection})();
(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,expando="sizcache",done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rReturn=/\r\n/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==
1&&context.nodeType!==9)return[];if(!selector||typeof selector!=="string")return results;var m,set,checkSet,extra,ret,cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector))if(parts.length===2&&Expr.relative[parts[0]])set=posProcess(parts[0]+parts[1],context,seed);else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),
context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])selector+=parts.shift();set=posProcess(selector,set,seed)}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]===
"~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):ret.set;if(parts.length>0)checkSet=makeArray(set);else prune=false;while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur])cur="";else pop=parts.pop();if(pop==null)pop=context;Expr.relative[cur](checkSet,pop,contextXML)}}else checkSet=parts=[]}if(!checkSet)checkSet=set;if(!checkSet)Sizzle.error(cur||selector);if(toString.call(checkSet)==="[object Array]")if(!prune)results.push.apply(results,
checkSet);else if(context&&context.nodeType===1)for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i])))results.push(set[i])}else for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1)results.push(set[i])}else makeArray(checkSet,results);if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;
results.sort(sortOrder);if(hasDuplicate)for(var i=1;i<results.length;i++)if(results[i]===results[i-1])results.splice(i--,1)}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set,i,len,match,type,left;if(!expr)return[];for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if(match=Expr.leftMatch[type].exec(expr)){left=match[1];
match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set)set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[];return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,type,found,item,filter,left,i,pass,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);
while(expr&&set.length){for(type in Expr.filter)if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){filter=Expr.filter[type];left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\")continue;if(curLoop===result)result=[];if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match)anyFound=found=true;else if(match===true)continue}if(match)for(i=0;(item=curLoop[i])!=null;i++)if(item){found=filter(item,match,i,curLoop);
pass=not^found;if(inplace&&found!=null)if(pass)anyFound=true;else curLoop[i]=false;else if(pass){result.push(item);anyFound=true}}if(found!==undefined){if(!inplace)curLoop=result;expr=expr.replace(Expr.match[type],"");if(!anyFound)return[];break}}if(expr===old)if(anyFound==null)Sizzle.error(expr);else break;old=expr}return curLoop};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};var getText=Sizzle.getText=function(elem){var i,node,nodeType=elem.nodeType,
ret="";if(nodeType)if(nodeType===1||nodeType===9||nodeType===11)if(typeof elem.textContent==="string")return elem.textContent;else if(typeof elem.innerText==="string")return elem.innerText.replace(rReturn,"");else for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem);else{if(nodeType===3||nodeType===4)return elem.nodeValue}else for(i=0;node=elem[i];i++)if(node.nodeType!==8)ret+=getText(node);return ret};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,
CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},
leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag)part=part.toLowerCase();for(var i=0,l=checkSet.length,elem;i<l;i++)if(elem=checkSet[i]){while((elem=elem.previousSibling)&&elem.nodeType!==1);checkSet[i]=isPartStrNotTag||
elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}if(isPartStrNotTag)Sizzle.filter(part,checkSet,true)},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem)checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===
part}if(isPartStr)Sizzle.filter(part,checkSet,true)}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",
part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++)if(results[i].getAttribute("name")===match[1])ret.push(results[i]);return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!==
"undefined")return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,"")+" ";if(isXML)return match;for(var i=0,elem;(elem=curLoop[i])!=null;i++)if(elem)if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace)result.push(elem)}else if(inplace)curLoop[i]=false;return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,
"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2])Sizzle.error(match[0]);match[2]=match[2].replace(/^\+|\s*/g,"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=test[1]+(test[2]||1)-0;match[3]=test[3]-0}else if(match[2])Sizzle.error(match[0]);match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,
"");if(!isXML&&Expr.attrMap[name])match[1]=Expr.attrMap[name];match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~=")match[4]=" "+match[4]+" ";return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not")if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3]))match[3]=Sizzle(match[3],null,null,curLoop);else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace)result.push.apply(result,ret);return false}else if(Expr.match.POS.test(match[0])||
Expr.match.CHILD.test(match[0]))return true;return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode)elem.parentNode.selectedIndex;return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},has:function(elem,
i,match){return!!Sizzle(match[3],elem).length},header:function(elem){return/h\d/i.test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()===
"input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();
return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName)},focus:function(elem){return elem===elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,
i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];if(filter)return filter(elem,i,match,array);else if(name==="contains")return(elem.textContent||elem.innerText||getText([elem])||"").indexOf(match[3])>=0;else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++)if(not[j]===elem)return false;return true}else Sizzle.error(name)},CHILD:function(elem,match){var first,last,
doneName,parent,cache,count,diff,type=match[1],node=elem;switch(type){case "only":case "first":while(node=node.previousSibling)if(node.nodeType===1)return false;if(type==="first")return true;node=elem;case "last":while(node=node.nextSibling)if(node.nodeType===1)return false;return true;case "nth":first=match[2];last=match[3];if(first===1&&last===0)return true;doneName=match[0];parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.nodeIndex)){count=0;for(node=parent.firstChild;node;node=
node.nextSibling)if(node.nodeType===1)node.nodeIndex=++count;parent[expando]=doneName}diff=elem.nodeIndex-last;if(first===0)return diff===0;else return diff%first===0&&diff/first>=0}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return match==="*"&&elem.nodeType===1||!!elem.nodeName&&elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,
match){var name=match[1],result=Sizzle.attr?Sizzle.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),value=result+"",type=match[2],check=match[4];return result==null?type==="!=":!type&&Sizzle.attr?result!=null:type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-
check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=Expr.setFilters[name];if(filter)return filter(elem,i,match,array)}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,
fescape))}Expr.match.globalPOS=origPOS;var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]")Array.prototype.push.apply(ret,array);else if(typeof array.length==="number")for(var l=array.length;i<l;i++)ret.push(array[i]);
else for(;array[i];i++)ret.push(array[i]);return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition)sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1};else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var al,bl,ap=[],bp=[],aup=a.parentNode,
bup=b.parentNode,cur=aup;if(aup===bup)return siblingCheck(a,b);else if(!aup)return-1;else if(!bup)return 1;while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++)if(ap[i]!==bp[i])return siblingCheck(ap[i],bp[i]);return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b)return ret;var cur=a.nextSibling;while(cur){if(cur===b)return-1;cur=cur.nextSibling}return 1}}(function(){var form=
document.createElement("div"),id="script"+(new Date).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=
typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0)Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++)if(results[i].nodeType===1)tmp.push(results[i]);results=
tmp}return results};div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!=="#")Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)};div=null})();if(document.querySelectorAll)(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0)return;Sizzle=function(query,context,
extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===1||context.nodeType===9))if(match[1])return makeArray(context.getElementsByTagName(query),extra);else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName)return makeArray(context.getElementsByClassName(match[2]),extra);if(context.nodeType===9){if(query==="body"&&context.body)return makeArray([context.body],extra);else if(match&&match[3]){var elem=
context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3])return makeArray([elem],extra)}else return makeArray([],extra)}try{return makeArray(context.querySelectorAll(query),extra)}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old)context.setAttribute("id",nid);else nid=nid.replace(/'/g,
"\\$&");if(relativeHierarchySelector&&hasParent)context=context.parentNode;try{if(!relativeHierarchySelector||hasParent)return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}catch(pseudoError){}finally{if(!old)oldContext.removeAttribute("id")}}}return oldSizzle(query,context,extra,seed)};for(var prop in oldSizzle)Sizzle[prop]=oldSizzle[prop];div=null})();(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||
html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!Sizzle.isXML(node))try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==
11)return ret}}catch(e){}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0)return;div.lastChild.className="e";if(div.getElementsByClassName("e").length===1)return;Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML)return context.getElementsByClassName(match[1])};
div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1&&!isXML){elem[expando]=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<
l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem[expando]=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else if(Sizzle.filter(cur,[elem]).length>0){match=elem;break}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains)Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)};else if(document.documentElement.compareDocumentPosition)Sizzle.contains=
function(a,b){return!!(a.compareDocumentPosition(b)&16)};else Sizzle.contains=function(){return false};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};var posProcess=function(selector,context,seed){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while(match=Expr.match.PSEUDO.exec(selector)){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?
selector+"*":selector;for(var i=0,l=root.length;i<l;i++)Sizzle(selector,root[i],tmpSet,seed);return Sizzle.filter(later,tmpSet)};window.tinymce.dom.Sizzle=Sizzle})();
(function(tinymce){tinymce.dom.Element=function(id,settings){var t=this,dom,el;t.settings=settings=settings||{};t.id=id;t.dom=dom=settings.dom||tinymce.DOM;if(!tinymce.isIE)el=dom.get(t.id);tinymce.each(("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,"+"setAttrib,setAttribs,getAttrib,addClass,removeClass,"+"hasClass,getOuterHTML,setOuterHTML,remove,show,hide,"+"isHidden,setHTML,get").split(/,/),function(k){t[k]=function(){var a=[id],i;for(i=0;i<arguments.length;i++)a.push(arguments[i]);
a=dom[k].apply(dom,a);t.update(k);return a}});tinymce.extend(t,{on:function(n,f,s){return tinymce.dom.Event.add(t.id,n,f,s)},getXY:function(){return{x:parseInt(t.getStyle("left")),y:parseInt(t.getStyle("top"))}},getSize:function(){var n=dom.get(t.id);return{w:parseInt(t.getStyle("width")||n.clientWidth),h:parseInt(t.getStyle("height")||n.clientHeight)}},moveTo:function(x,y){t.setStyles({left:x,top:y})},moveBy:function(x,y){var p=t.getXY();t.moveTo(p.x+x,p.y+y)},resizeTo:function(w,h){t.setStyles({width:w,
height:h})},resizeBy:function(w,h){var s=t.getSize();t.resizeTo(s.w+w,s.h+h)},update:function(k){var b;if(tinymce.isIE6&&settings.blocker){k=k||"";if(k.indexOf("get")===0||k.indexOf("has")===0||k.indexOf("is")===0)return;if(k=="remove"){dom.remove(t.blocker);return}if(!t.blocker){t.blocker=dom.uniqueId();b=dom.add(settings.container||dom.getRoot(),"iframe",{id:t.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'});dom.setStyle(b,"opacity",0)}else b=dom.get(t.blocker);dom.setStyles(b,
{left:t.getStyle("left",1),top:t.getStyle("top",1),width:t.getStyle("width",1),height:t.getStyle("height",1),display:t.getStyle("display",1),zIndex:parseInt(t.getStyle("zIndex",1)||0)-1})}}})}})(tinymce);
(function(tinymce){function trimNl(s){return s.replace(/[\n\r]+/g,"")}var is=tinymce.is,isIE=tinymce.isIE,each=tinymce.each,TreeWalker=tinymce.dom.TreeWalker;tinymce.create("tinymce.dom.Selection",{Selection:function(dom,win,serializer,editor){var t=this;t.dom=dom;t.win=win;t.serializer=serializer;t.editor=editor;each(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(e){t[e]=new tinymce.util.Dispatcher(t)});if(!t.win.getSelection)t.tridentSel=new tinymce.dom.TridentSelection(t);
if(tinymce.isIE&&dom.boxModel)this._fixIESelection();tinymce.addUnload(t.destroy,t)},setCursorLocation:function(node,offset){var t=this;var r=t.dom.createRng();r.setStart(node,offset);r.setEnd(node,offset);t.setRng(r);t.collapse(false)},getContent:function(s){var t=this,r=t.getRng(),e=t.dom.create("body"),se=t.getSel(),wb,wa,n;s=s||{};wb=wa="";s.get=true;s.format=s.format||"html";s.forced_root_block="";t.onBeforeGetContent.dispatch(t,s);if(s.format=="text")return t.isCollapsed()?"":r.text||(se.toString?
se.toString():"");if(r.cloneContents){n=r.cloneContents();if(n)e.appendChild(n)}else if(is(r.item)||is(r.htmlText)){e.innerHTML="<br>"+(r.item?r.item(0).outerHTML:r.htmlText);e.removeChild(e.firstChild)}else e.innerHTML=r.toString();if(/^\s/.test(e.innerHTML))wb=" ";if(/\s+$/.test(e.innerHTML))wa=" ";s.getInner=true;s.content=t.isCollapsed()?"":wb+t.serializer.serialize(e,s)+wa;t.onGetContent.dispatch(t,s);return s.content},setContent:function(content,args){var self=this,rng=self.getRng(),caretNode,
doc=self.win.document,frag,temp;args=args||{format:"html"};args.set=true;content=args.content=content;if(!args.no_events)self.onBeforeSetContent.dispatch(self,args);content=args.content;if(rng.insertNode){content+='<span id="__caret">_</span>';if(rng.startContainer==doc&&rng.endContainer==doc)doc.body.innerHTML=content;else{rng.deleteContents();if(doc.body.childNodes.length===0)doc.body.innerHTML=content;else if(rng.createContextualFragment)rng.insertNode(rng.createContextualFragment(content));else{frag=
doc.createDocumentFragment();temp=doc.createElement("div");frag.appendChild(temp);temp.outerHTML=content;rng.insertNode(frag)}}caretNode=self.dom.get("__caret");rng=doc.createRange();rng.setStartBefore(caretNode);rng.setEndBefore(caretNode);self.setRng(rng);self.dom.remove("__caret");try{self.setRng(rng)}catch(ex){}}else{if(rng.item){doc.execCommand("Delete",false,null);rng=self.getRng()}if(/^\s+/.test(content)){rng.pasteHTML('<span id="__mce_tmp">_</span>'+content);self.dom.remove("__mce_tmp")}else rng.pasteHTML(content)}if(!args.no_events)self.onSetContent.dispatch(self,
args)},getStart:function(){var self=this,rng=self.getRng(),startElement,parentElement,checkRng,node;if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);checkRng=rng.duplicate();checkRng.collapse(1);startElement=checkRng.parentElement();if(startElement.ownerDocument!==self.dom.doc)startElement=self.dom.getRoot();parentElement=node=rng.parentElement();while(node=node.parentNode)if(node==startElement){startElement=parentElement;break}return startElement}else{startElement=rng.startContainer;if(startElement.nodeType==
1&&startElement.hasChildNodes())startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)];if(startElement&&startElement.nodeType==3)return startElement.parentNode;return startElement}},getEnd:function(){var self=this,rng=self.getRng(),endElement,endOffset;if(rng.duplicate||rng.item){if(rng.item)return rng.item(0);rng=rng.duplicate();rng.collapse(0);endElement=rng.parentElement();if(endElement.ownerDocument!==self.dom.doc)endElement=self.dom.getRoot();if(endElement&&
endElement.nodeName=="BODY")return endElement.lastChild||endElement;return endElement}else{endElement=rng.endContainer;endOffset=rng.endOffset;if(endElement.nodeType==1&&endElement.hasChildNodes())endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset];if(endElement&&endElement.nodeType==3)return endElement.parentNode;return endElement}},getBookmark:function(type,normalized){var t=this,dom=t.dom,rng,rng2,id,collapsed,name,element,index,chr="\ufeff",styles;function findIndex(name,element){var index=
0;each(dom.select(name),function(node,i){if(node==element)index=i});return index}function normalizeTableCellSelection(rng){function moveEndPoint(start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"];offset=rng[prefix+"Offset"];if(container.nodeType==1&&container.nodeName=="TR"){childNodes=container.childNodes;container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)];if(container){offset=start?0:container.childNodes.length;rng["set"+(start?
"Start":"End")](container,offset)}}}moveEndPoint(true);moveEndPoint();return rng}function getLocation(){var rng=t.getRng(true),root=dom.getRoot(),bookmark={};function getPoint(rng,start){var container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],node,childNodes,after=0;if(container.nodeType==3){if(normalized)for(node=container.previousSibling;node&&node.nodeType==3;node=node.previousSibling)offset+=node.nodeValue.length;point.push(offset)}else{childNodes=
container.childNodes;if(offset>=childNodes.length&&childNodes.length){after=1;offset=Math.max(0,childNodes.length-1)}point.push(t.dom.nodeIndex(childNodes[offset],normalized)+after)}for(;container&&container!=root;container=container.parentNode)point.push(t.dom.nodeIndex(container,normalized));return point}bookmark.start=getPoint(rng,true);if(!t.isCollapsed())bookmark.end=getPoint(rng);return bookmark}if(type==2){if(t.tridentSel)return t.tridentSel.getBookmark(type);return getLocation()}if(type)return{rng:t.getRng()};
rng=t.getRng();id=dom.uniqueId();collapsed=tinyMCE.activeEditor.selection.isCollapsed();styles="overflow:hidden;line-height:0px";if(rng.duplicate||rng.item)if(!rng.item){rng2=rng.duplicate();try{rng.collapse();rng.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_start" style="'+styles+'">'+chr+"</span>");if(!collapsed){rng2.collapse(false);rng.moveToElementText(rng2.parentElement());if(rng.compareEndPoints("StartToEnd",rng2)===0)rng2.move("character",-1);rng2.pasteHTML('<span data-mce-type="bookmark" id="'+
id+'_end" style="'+styles+'">'+chr+"</span>")}}catch(ex){return null}}else{element=rng.item(0);name=element.nodeName;return{name:name,index:findIndex(name,element)}}else{element=t.getNode();name=element.nodeName;if(name=="IMG")return{name:name,index:findIndex(name,element)};rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(false);rng2.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr))}rng=normalizeTableCellSelection(rng);rng.collapse(true);
rng.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr))}t.moveToBookmark({id:id,keep:1});return{id:id}},moveToBookmark:function(bookmark){var t=this,dom=t.dom,marker1,marker2,rng,root,startContainer,endContainer,startOffset,endOffset;function setEndPoint(start){var point=bookmark[start?"start":"end"],i,node,offset,children;if(point){offset=point[0];for(node=root,i=point.length-1;i>=1;i--){children=node.childNodes;if(point[i]>children.length-1)return;node=children[point[i]]}if(node.nodeType===
3)offset=Math.min(point[0],node.nodeValue.length);if(node.nodeType===1)offset=Math.min(point[0],node.childNodes.length);if(start)rng.setStart(node,offset);else rng.setEnd(node,offset)}return true}function restoreEndPoint(suffix){var marker=dom.get(bookmark.id+"_"+suffix),node,idx,next,prev,keep=bookmark.keep;if(marker){node=marker.parentNode;if(suffix=="start"){if(!keep)idx=dom.nodeIndex(marker);else{node=marker.firstChild;idx=1}startContainer=endContainer=node;startOffset=endOffset=idx}else{if(!keep)idx=
dom.nodeIndex(marker);else{node=marker.firstChild;idx=1}endContainer=node;endOffset=idx}if(!keep){prev=marker.previousSibling;next=marker.nextSibling;each(tinymce.grep(marker.childNodes),function(node){if(node.nodeType==3)node.nodeValue=node.nodeValue.replace(/\uFEFF/g,"")});while(marker=dom.get(bookmark.id+"_"+suffix))dom.remove(marker,1);if(prev&&next&&prev.nodeType==next.nodeType&&prev.nodeType==3&&!tinymce.isOpera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);dom.remove(next);if(suffix==
"start"){startContainer=endContainer=prev;startOffset=endOffset=idx}else{endContainer=prev;endOffset=idx}}}}}function addBogus(node){if(dom.isBlock(node)&&!node.innerHTML&&!isIE)node.innerHTML='<br data-mce-bogus="1" />';return node}if(bookmark)if(bookmark.start){rng=dom.createRng();root=dom.getRoot();if(t.tridentSel)return t.tridentSel.moveToBookmark(bookmark);if(setEndPoint(true)&&setEndPoint())t.setRng(rng)}else if(bookmark.id){restoreEndPoint("start");restoreEndPoint("end");if(startContainer){rng=
dom.createRng();rng.setStart(addBogus(startContainer),startOffset);rng.setEnd(addBogus(endContainer),endOffset);t.setRng(rng)}}else if(bookmark.name)t.select(dom.select(bookmark.name)[bookmark.index]);else if(bookmark.rng)t.setRng(bookmark.rng)},select:function(node,content){var t=this,dom=t.dom,rng=dom.createRng(),idx;function setPoint(node,start){var walker=new TreeWalker(node,node);do{if(node.nodeType==3&&tinymce.trim(node.nodeValue).length!==0){if(start)rng.setStart(node,0);else rng.setEnd(node,
node.nodeValue.length);return}if(node.nodeName=="BR"){if(start)rng.setStartBefore(node);else rng.setEndBefore(node);return}}while(node=start?walker.next():walker.prev())}if(node){idx=dom.nodeIndex(node);rng.setStart(node.parentNode,idx);rng.setEnd(node.parentNode,idx+1);if(content){setPoint(node,1);setPoint(node)}t.setRng(rng)}return node},isCollapsed:function(){var t=this,r=t.getRng(),s=t.getSel();if(!r||r.item)return false;if(r.compareEndPoints)return r.compareEndPoints("StartToEnd",r)===0;return!s||
r.collapsed},collapse:function(to_start){var self=this,rng=self.getRng(),node;if(rng.item){node=rng.item(0);rng=self.win.document.body.createTextRange();rng.moveToElementText(node)}rng.collapse(!!to_start);self.setRng(rng)},getSel:function(){var t=this,w=this.win;return w.getSelection?w.getSelection():w.document.selection},getRng:function(w3c){var self=this,selection,rng,elm,doc=self.win.document;if(w3c&&self.tridentSel)return self.tridentSel.getRangeAt(0);try{if(selection=self.getSel())rng=selection.rangeCount>
0?selection.getRangeAt(0):selection.createRange?selection.createRange():doc.createRange()}catch(ex){}if(tinymce.isIE&&rng&&rng.setStart&&doc.selection.createRange().item){elm=doc.selection.createRange().item(0);rng=doc.createRange();rng.setStartBefore(elm);rng.setEndAfter(elm)}if(!rng)rng=doc.createRange?doc.createRange():doc.body.createTextRange();if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=self.dom.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0)}if(self.selectedRange&&self.explicitRange)if(rng.compareBoundaryPoints(rng.START_TO_START,
self.selectedRange)===0&&rng.compareBoundaryPoints(rng.END_TO_END,self.selectedRange)===0)rng=self.explicitRange;else{self.selectedRange=null;self.explicitRange=null}return rng},setRng:function(r,forward){var s,t=this;if(!t.tridentSel){s=t.getSel();if(s){t.explicitRange=r;try{s.removeAllRanges()}catch(ex){}s.addRange(r);if(forward===false&&s.extend){s.collapse(r.endContainer,r.endOffset);s.extend(r.startContainer,r.startOffset)}t.selectedRange=s.rangeCount>0?s.getRangeAt(0):null}}else{if(r.cloneRange)try{t.tridentSel.addRange(r);
return}catch(ex){}try{r.select()}catch(ex){}}},setNode:function(n){var t=this;t.setContent(t.dom.getOuterHTML(n));return n},getNode:function(){var t=this,rng=t.getRng(),sel=t.getSel(),elm,start=rng.startContainer,end=rng.endContainer;function skipEmptyTextNodes(n,forwards){var orig=n;while(n&&n.nodeType===3&&n.length===0)n=forwards?n.nextSibling:n.previousSibling;return n||orig}if(!rng)return t.dom.getRoot();if(rng.setStart){elm=rng.commonAncestorContainer;if(!rng.collapsed){if(rng.startContainer==
rng.endContainer)if(rng.endOffset-rng.startOffset<2)if(rng.startContainer.hasChildNodes())elm=rng.startContainer.childNodes[rng.startOffset];if(start.nodeType===3&&end.nodeType===3){if(start.length===rng.startOffset)start=skipEmptyTextNodes(start.nextSibling,true);else start=start.parentNode;if(rng.endOffset===0)end=skipEmptyTextNodes(end.previousSibling,false);else end=end.parentNode;if(start&&start===end)return start}}if(elm&&elm.nodeType==3)return elm.parentNode;return elm}return rng.item?rng.item(0):
rng.parentElement()},getSelectedBlocks:function(st,en){var t=this,dom=t.dom,sb,eb,n,bl=[];sb=dom.getParent(st||t.getStart(),dom.isBlock);eb=dom.getParent(en||t.getEnd(),dom.isBlock);if(sb)bl.push(sb);if(sb&&eb&&sb!=eb){n=sb;var walker=new TreeWalker(sb,dom.getRoot());while((n=walker.next())&&n!=eb)if(dom.isBlock(n))bl.push(n)}if(eb&&sb!=eb)bl.push(eb);return bl},isForward:function(){var dom=this.dom,sel=this.getSel(),anchorRange,focusRange;if(!sel||sel.anchorNode==null||sel.focusNode==null)return true;
anchorRange=dom.createRng();anchorRange.setStart(sel.anchorNode,sel.anchorOffset);anchorRange.collapse(true);focusRange=dom.createRng();focusRange.setStart(sel.focusNode,sel.focusOffset);focusRange.collapse(true);return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0},normalize:function(){var self=this,rng,normalized,collapsed,node,sibling;function normalizeEndPoint(start){var container,offset,walker,dom=self.dom,body=dom.getRoot(),node,nonEmptyElementsMap,nodeName;function hasBrBeforeAfter(node,
left){var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||body);while(node=walker[left?"prev":"next"]())if(node.nodeName==="BR")return true}function findTextNodeRelative(left,startNode){var walker,lastInlineElement;startNode=startNode||container;walker=new TreeWalker(startNode,dom.getParent(startNode.parentNode,dom.isBlock)||body);while(node=walker[left?"prev":"next"]()){if(node.nodeType===3&&node.nodeValue.length>0){container=node;offset=left?node.nodeValue.length:0;normalized=
true;return}if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()])return;lastInlineElement=node}if(collapsed&&lastInlineElement){container=lastInlineElement;normalized=true;offset=0}}container=rng[(start?"start":"end")+"Container"];offset=rng[(start?"start":"end")+"Offset"];nonEmptyElementsMap=dom.schema.getNonEmptyElements();if(container.nodeType===9){container=dom.getRoot();offset=0}if(container===body){if(start){node=container.childNodes[offset>0?offset-1:0];if(node){nodeName=
node.nodeName.toLowerCase();if(nonEmptyElementsMap[node.nodeName]||node.nodeName=="TABLE")return}}if(container.hasChildNodes()){container=container.childNodes[Math.min(!start&&offset>0?offset-1:offset,container.childNodes.length-1)];offset=0;if(container.hasChildNodes()&&!/TABLE/.test(container.nodeName)){node=container;walker=new TreeWalker(container,body);do{if(node.nodeType===3&&node.nodeValue.length>0){offset=start?0:node.nodeValue.length;container=node;normalized=true;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){offset=
dom.nodeIndex(node);container=node.parentNode;if(node.nodeName=="IMG"&&!start)offset++;normalized=true;break}}while(node=start?walker.next():walker.prev())}}}if(collapsed){if(container.nodeType===3&&offset===0)findTextNodeRelative(true);if(container.nodeType===1){node=container.childNodes[offset];if(node&&node.nodeName==="BR"&&!hasBrBeforeAfter(node)&&!hasBrBeforeAfter(node,true))findTextNodeRelative(true,container.childNodes[offset])}}if(start&&!collapsed&&container.nodeType===3&&offset===container.nodeValue.length)findTextNodeRelative(false);
if(normalized)rng["set"+(start?"Start":"End")](container,offset)}if(tinymce.isIE)return;rng=self.getRng();collapsed=rng.collapsed;normalizeEndPoint(true);if(!collapsed)normalizeEndPoint();if(normalized){if(collapsed)rng.collapse(true);self.setRng(rng,self.isForward())}},selectorChanged:function(selector,callback){var self=this,currentSelectors;if(!self.selectorChangedData){self.selectorChangedData={};currentSelectors={};self.editor.onNodeChange.addToTop(function(ed,cm,node){var dom=self.dom,parents=
dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){if(dom.is(node,selector)){if(!currentSelectors[selector]){each(callbacks,function(callback){callback(true,{node:node,selector:selector,parents:parents})});currentSelectors[selector]=callbacks}matchedSelectors[selector]=callbacks;return false}})});each(currentSelectors,function(callbacks,selector){if(!matchedSelectors[selector]){delete currentSelectors[selector];
each(callbacks,function(callback){callback(false,{node:node,selector:selector,parents:parents})})}})})}if(!self.selectorChangedData[selector])self.selectorChangedData[selector]=[];self.selectorChangedData[selector].push(callback);return self},destroy:function(manual){var self=this;self.win=null;if(!manual)tinymce.removeUnload(self.destroy)},_fixIESelection:function(){var dom=this.dom,doc=dom.doc,body=doc.body,started,startRng,htmlElm;function rngFromPoint(x,y){var rng=body.createTextRange();try{rng.moveToPoint(x,
y)}catch(ex){rng=null}return rng}function selectionChange(e){var pointRng;if(e.button){pointRng=rngFromPoint(e.x,e.y);if(pointRng){if(pointRng.compareEndPoints("StartToStart",startRng)>0)pointRng.setEndPoint("StartToStart",startRng);else pointRng.setEndPoint("EndToEnd",startRng);pointRng.select()}}else endSelection()}function endSelection(){var rng=doc.selection.createRange();if(startRng&&!rng.item&&rng.compareEndPoints("StartToEnd",rng)===0)startRng.select();dom.unbind(doc,"mouseup",endSelection);
dom.unbind(doc,"mousemove",selectionChange);startRng=started=0}doc.documentElement.unselectable=true;dom.bind(doc,["mousedown","contextmenu"],function(e){if(e.target.nodeName==="HTML"){if(started)endSelection();htmlElm=doc.documentElement;if(htmlElm.scrollHeight>htmlElm.clientHeight)return;started=1;startRng=rngFromPoint(e.x,e.y);if(startRng){dom.bind(doc,"mouseup",endSelection);dom.bind(doc,"mousemove",selectionChange);dom.win.focus();startRng.select()}}})}})})(tinymce);
(function(tinymce){tinymce.dom.Serializer=function(settings,dom,schema){var onPreProcess,onPostProcess,isIE=tinymce.isIE,each=tinymce.each,htmlParser;if(!settings.apply_source_formatting)settings.indent=false;dom=dom||tinymce.DOM;schema=schema||new tinymce.html.Schema(settings);settings.entity_encoding=settings.entity_encoding||"named";settings.remove_trailing_brs="remove_trailing_brs"in settings?settings.remove_trailing_brs:true;onPreProcess=new tinymce.util.Dispatcher(self);onPostProcess=new tinymce.util.Dispatcher(self);
htmlParser=new tinymce.html.DomParser(settings,schema);htmlParser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,value,internalName="data-mce-"+name,urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope,undef;while(i--){node=nodes[i];value=node.attributes.map[internalName];if(value!==undef){node.attr(name,value.length>0?value:null);node.attr(internalName,null)}else{value=node.attributes.map[name];if(name==="style")value=dom.serializeStyle(dom.parseStyle(value),
node.name);else if(urlConverter)value=urlConverter.call(urlConverterScope,value,name,node.name);node.attr(name,value.length>0?value:null)}}});htmlParser.addAttributeFilter("class",function(nodes,name){var i=nodes.length,node,value;while(i--){node=nodes[i];value=node.attr("class").replace(/(?:^|\s)mce(Item\w+|Selected)(?!\S)/g,"");node.attr("class",value.length>0?value:null)}});htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){var i=nodes.length,node;while(i--){node=nodes[i];
if(node.attributes.map["data-mce-type"]==="bookmark"&&!args.cleanup)node.remove()}});htmlParser.addAttributeFilter("data-mce-expando",function(nodes,name,args){var i=nodes.length;while(i--)nodes[i].attr(name,null)});htmlParser.addNodeFilter("script,style",function(nodes,name){var i=nodes.length,node,value;function trim(value){return value.replace(/(<\!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<\!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<\!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<\!--|\/\*\s*<\!--\s*\*\/)\s*[\r\n]*/gi,
"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(--\>)?|\s*\/\/\s*\]\]>(--\>)?|\/\/\s*(--\>)?|\]\]>|\/\*\s*--\>\s*\*\/|\s*--\>\s*)\s*$/g,"")}while(i--){node=nodes[i];value=node.firstChild?node.firstChild.value:"";if(name==="script"){node.attr("type",(node.attr("type")||"text/javascript").replace(/^mce\-/,""));if(value.length>0)node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]\>"}else if(value.length>0)node.firstChild.value="<\!--\n"+trim(value)+"\n--\>"}});htmlParser.addNodeFilter("#comment",function(nodes,
name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.value.indexOf("[CDATA[")===0){node.name="#cdata";node.type=4;node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(node.value.indexOf("mce:protected ")===0){node.name="#text";node.type=3;node.raw=true;node.value=unescape(node.value).substr(14)}}});htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.type===7)node.remove();else if(node.type===1)if(name==="input"&&
!("type"in node.attributes.map))node.attr("type","text")}});if(settings.fix_list_elements)htmlParser.addNodeFilter("ul,ol",function(nodes,name){var i=nodes.length,node,parentNode;while(i--){node=nodes[i];parentNode=node.parent;if(parentNode.name==="ul"||parentNode.name==="ol")if(node.prev&&node.prev.name==="li")node.prev.append(node)}});htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(nodes,name){var i=nodes.length;while(i--)nodes[i].attr(name,null)});return{schema:schema,
addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,onPreProcess:onPreProcess,onPostProcess:onPostProcess,serialize:function(node,args){var impl,doc,oldDoc,htmlSerializer,content;if(isIE&&dom.select("script,style,select,map").length>0){content=node.innerHTML;node=node.cloneNode(false);dom.setHTML(node,content)}else node=node.cloneNode(true);impl=node.ownerDocument.implementation;if(impl.createHTMLDocument){doc=impl.createHTMLDocument("");each(node.nodeName=="BODY"?
node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,true))});if(node.nodeName!="BODY")node=doc.body.firstChild;else node=doc.body;oldDoc=dom.doc;dom.doc=doc}args=args||{};args.format=args.format||"html";if(!args.no_events){args.node=node;onPreProcess.dispatch(self,args)}htmlSerializer=new tinymce.html.Serializer(settings,schema);args.content=htmlSerializer.serialize(htmlParser.parse(tinymce.trim(args.getInner?node.innerHTML:dom.getOuterHTML(node)),args));if(!args.cleanup)args.content=
args.content.replace(/\uFEFF/g,"");if(!args.no_events)onPostProcess.dispatch(self,args);if(oldDoc)dom.doc=oldDoc;args.node=null;return args.content},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)}}}})(tinymce);
(function(tinymce){tinymce.dom.ScriptLoader=function(settings){var QUEUED=0,LOADING=1,LOADED=2,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0,undef;function loadScript(url,callback){var t=this,dom=tinymce.DOM,elm,uri,loc,id;function done(){dom.remove(id);if(elm)elm.onreadystatechange=elm.onload=elm=null;callback()}function error(){if(typeof console!=="undefined"&&console.log)console.log("Failed to load: "+url)}id=dom.uniqueId();if(tinymce.isIE6){uri=new tinymce.util.URI(url);
loc=location;if(uri.host==loc.hostname&&uri.port==loc.port&&uri.protocol+":"==loc.protocol&&uri.protocol.toLowerCase()!="file"){tinymce.util.XHR.send({url:tinymce._addVer(uri.getURI()),success:function(content){var script=dom.create("script",{type:"text/javascript"});script.text=content;document.getElementsByTagName("head")[0].appendChild(script);dom.remove(script);done()},error:error});return}}elm=document.createElement("script");elm.id=id;elm.type="text/javascript";elm.src=tinymce._addVer(url);
if(!tinymce.isIE)elm.onload=done;elm.onerror=error;if(!tinymce.isOpera)elm.onreadystatechange=function(){var state=elm.readyState;if(state=="complete"||state=="loaded")done()};(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)}this.isDone=function(url){return states[url]==LOADED};this.markDone=function(url){states[url]=LOADED};this.add=this.load=function(url,callback,scope){var item,state=states[url];if(state==undef){queue.push(url);states[url]=QUEUED}if(callback){if(!scriptLoadedCallbacks[url])scriptLoadedCallbacks[url]=
[];scriptLoadedCallbacks[url].push({func:callback,scope:scope||this})}};this.loadQueue=function(callback,scope){this.loadScripts(queue,callback,scope)};this.loadScripts=function(scripts,callback,scope){var loadScripts;function execScriptLoadedCallbacks(url){tinymce.each(scriptLoadedCallbacks[url],function(callback){callback.func.call(callback.scope)});scriptLoadedCallbacks[url]=undef}queueLoadedCallbacks.push({func:callback,scope:scope||this});loadScripts=function(){var loadingScripts=tinymce.grep(scripts);
scripts.length=0;tinymce.each(loadingScripts,function(url){if(states[url]==LOADED){execScriptLoadedCallbacks(url);return}if(states[url]!=LOADING){states[url]=LOADING;loading++;loadScript(url,function(){states[url]=LOADED;loading--;execScriptLoadedCallbacks(url);loadScripts()})}});if(!loading){tinymce.each(queueLoadedCallbacks,function(callback){callback.func.call(callback.scope)});queueLoadedCallbacks.length=0}};loadScripts()}};tinymce.ScriptLoader=new tinymce.dom.ScriptLoader})(tinymce);
(function(tinymce){tinymce.dom.RangeUtils=function(dom){var INVISIBLE_CHAR="\ufeff";this.walk=function(rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ancestor,startPoint,endPoint,node,parent,siblings,nodes;nodes=dom.select("td.mceSelected,th.mceSelected");if(nodes.length>0){tinymce.each(nodes,function(node){callback([node])});return}function exclude(nodes){var node;node=nodes[0];if(node.nodeType===3&&node===startContainer&&
startOffset>=node.nodeValue.length)nodes.splice(0,1);node=nodes[nodes.length-1];if(endOffset===0&&nodes.length>0&&node===endContainer&&node.nodeType===3)nodes.splice(nodes.length-1,1);return nodes}function collectSiblings(node,name,end_node){var siblings=[];for(;node&&node!=end_node;node=node[name])siblings.push(node);return siblings}function findEndPoint(node,root){do{if(node.parentNode==root)return node;node=node.parentNode}while(node)}function walkBoundary(start_node,end_node,next){var siblingName=
next?"nextSibling":"previousSibling";for(node=start_node,parent=node.parentNode;node&&node!=end_node;node=parent){parent=node.parentNode;siblings=collectSiblings(node==start_node?node:node[siblingName],siblingName);if(siblings.length){if(!next)siblings.reverse();callback(exclude(siblings))}}}if(startContainer.nodeType==1&&startContainer.hasChildNodes())startContainer=startContainer.childNodes[startOffset];if(endContainer.nodeType==1&&endContainer.hasChildNodes())endContainer=endContainer.childNodes[Math.min(endOffset-
1,endContainer.childNodes.length-1)];if(startContainer==endContainer)return callback(exclude([startContainer]));ancestor=dom.findCommonAncestor(startContainer,endContainer);for(node=startContainer;node;node=node.parentNode){if(node===endContainer)return walkBoundary(startContainer,ancestor,true);if(node===ancestor)break}for(node=endContainer;node;node=node.parentNode){if(node===startContainer)return walkBoundary(endContainer,ancestor);if(node===ancestor)break}startPoint=findEndPoint(startContainer,
ancestor)||startContainer;endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,true);siblings=collectSiblings(startPoint==startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint==endContainer?endPoint.nextSibling:endPoint);if(siblings.length)callback(exclude(siblings));walkBoundary(endContainer,endPoint)};this.split=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;
function splitText(node,offset){return node.splitText(offset)}if(startContainer==endContainer&&startContainer.nodeType==3){if(startOffset>0&&startOffset<startContainer.nodeValue.length){endContainer=splitText(startContainer,startOffset);startContainer=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;startContainer=endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0}else endOffset=0}}else{if(startContainer.nodeType==
3&&startOffset>0&&startOffset<startContainer.nodeValue.length){startContainer=splitText(startContainer,startOffset);startOffset=0}if(endContainer.nodeType==3&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length}}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}};tinymce.dom.RangeUtils.compareRanges=function(rng1,rng2){if(rng1&&rng2)if(rng1.item||
rng1.duplicate){if(rng1.item&&rng2.item&&rng1.item(0)===rng2.item(0))return true;if(rng1.isEqual&&rng2.isEqual&&rng2.isEqual(rng1))return true}else return rng1.startContainer==rng2.startContainer&&rng1.startOffset==rng2.startOffset;return false}})(tinymce);
(function(tinymce){var Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(settings,dom){var t=this,root=settings.root,items=settings.items,enableUpDown=settings.enableUpDown,enableLeftRight=settings.enableLeftRight||!settings.enableUpDown,excludeFromTabOrder=settings.excludeFromTabOrder,itemFocussed,itemBlurred,rootKeydown,rootFocussed,focussedId;dom=dom||tinymce.DOM;itemFocussed=function(evt){focussedId=evt.target.id};itemBlurred=
function(evt){dom.setAttrib(evt.target.id,"tabindex","-1")};rootFocussed=function(evt){var item=dom.get(focussedId);dom.setAttrib(item,"tabindex","0");item.focus()};t.focus=function(){dom.get(focussedId).focus()};t.destroy=function(){each(items,function(item){var elm=dom.get(item.id);dom.unbind(elm,"focus",itemFocussed);dom.unbind(elm,"blur",itemBlurred)});var rootElm=dom.get(root);dom.unbind(rootElm,"focus",rootFocussed);dom.unbind(rootElm,"keydown",rootKeydown);items=dom=root=t.focus=itemFocussed=
itemBlurred=rootKeydown=rootFocussed=null;t.destroy=function(){}};t.moveFocus=function(dir,evt){var idx=-1,controls=t.controls,newFocus;if(!focussedId)return;each(items,function(item,index){if(item.id===focussedId){idx=index;return false}});idx+=dir;if(idx<0)idx=items.length-1;else if(idx>=items.length)idx=0;newFocus=items[idx];dom.setAttrib(focussedId,"tabindex","-1");dom.setAttrib(newFocus.id,"tabindex","0");dom.get(newFocus.id).focus();if(settings.actOnFocus)settings.onAction(newFocus.id);if(evt)Event.cancel(evt)};
rootKeydown=function(evt){var DOM_VK_LEFT=37,DOM_VK_RIGHT=39,DOM_VK_UP=38,DOM_VK_DOWN=40,DOM_VK_ESCAPE=27,DOM_VK_ENTER=14,DOM_VK_RETURN=13,DOM_VK_SPACE=32;switch(evt.keyCode){case DOM_VK_LEFT:if(enableLeftRight)t.moveFocus(-1);break;case DOM_VK_RIGHT:if(enableLeftRight)t.moveFocus(1);break;case DOM_VK_UP:if(enableUpDown)t.moveFocus(-1);break;case DOM_VK_DOWN:if(enableUpDown)t.moveFocus(1);break;case DOM_VK_ESCAPE:if(settings.onCancel){settings.onCancel();Event.cancel(evt)}break;case DOM_VK_ENTER:case DOM_VK_RETURN:case DOM_VK_SPACE:if(settings.onAction){settings.onAction(focussedId);
Event.cancel(evt)}break}};each(items,function(item,idx){var tabindex,elm;if(!item.id)item.id=dom.uniqueId("_mce_item_");elm=dom.get(item.id);if(excludeFromTabOrder){dom.bind(elm,"blur",itemBlurred);tabindex="-1"}else tabindex=idx===0?"0":"-1";elm.setAttribute("tabindex",tabindex);dom.bind(elm,"focus",itemFocussed)});if(items[0])focussedId=items[0].id;dom.setAttrib(root,"tabindex","-1");var rootElm=dom.get(root);dom.bind(rootElm,"focus",rootFocussed);dom.bind(rootElm,"keydown",rootKeydown)}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,is=tinymce.is;tinymce.create("tinymce.ui.Control",{Control:function(id,s,editor){this.id=id;this.settings=s=s||{};this.rendered=false;this.onRender=new tinymce.util.Dispatcher(this);this.classPrefix="";this.scope=s.scope||this;this.disabled=0;this.active=0;this.editor=editor},setAriaProperty:function(property,value){var element=DOM.get(this.id+"_aria")||DOM.get(this.id);if(element)DOM.setAttrib(element,"aria-"+property,!!value)},focus:function(){DOM.get(this.id).focus()},
setDisabled:function(s){if(s!=this.disabled){this.setAriaProperty("disabled",s);this.setState("Disabled",s);this.setState("Enabled",!s);this.disabled=s}},isDisabled:function(){return this.disabled},setActive:function(s){if(s!=this.active){this.setState("Active",s);this.active=s;this.setAriaProperty("pressed",s)}},isActive:function(){return this.active},setState:function(c,s){var n=DOM.get(this.id);c=this.classPrefix+c;if(s)DOM.addClass(n,c);else DOM.removeClass(n,c)},isRendered:function(){return this.rendered},
renderHTML:function(){},renderTo:function(n){DOM.setHTML(n,this.renderHTML())},postRender:function(){var t=this,b;if(is(t.disabled)){b=t.disabled;t.disabled=-1;t.setDisabled(b)}if(is(t.active)){b=t.active;t.active=-1;t.setActive(b)}},remove:function(){DOM.remove(this.id);this.destroy()},destroy:function(){tinymce.dom.Event.clear(this.id)}})})(tinymce);
tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(id,s,editor){this.parent(id,s,editor);this.controls=[];this.lookup={}},add:function(c){this.lookup[c.id]=c;this.controls.push(c);return c},get:function(n){return this.lookup[n]}});
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(id,s){this.parent(id,s);this.classPrefix="mceSeparator";this.setDisabled(true)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,walk=tinymce.walk;tinymce.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(id,s){this.parent(id,s);this.classPrefix="mceMenuItem"},setSelected:function(s){this.setState("Selected",s);this.setAriaProperty("checked",!!s);this.selected=s},isSelected:function(){return this.selected},postRender:function(){var t=this;t.parent();if(is(t.selected))t.setSelected(t.selected)}})})(tinymce);
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,walk=tinymce.walk;tinymce.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(id,s){var t=this;t.parent(id,s);t.items={};t.collapsed=false;t.menuCount=0;t.onAddItem=new tinymce.util.Dispatcher(this)},expand:function(d){var t=this;if(d)walk(t,function(o){if(o.expand)o.expand()},"items",t);t.collapsed=false},collapse:function(d){var t=this;if(d)walk(t,function(o){if(o.collapse)o.collapse()},"items",t);t.collapsed=true},isCollapsed:function(){return this.collapsed},
add:function(o){if(!o.settings)o=new tinymce.ui.MenuItem(o.id||DOM.uniqueId(),o);this.onAddItem.dispatch(this,o);return this.items[o.id]=o},addSeparator:function(){return this.add({separator:true})},addMenu:function(o){if(!o.collapse)o=this.createMenu(o);this.menuCount++;return this.add(o)},hasMenus:function(){return this.menuCount!==0},remove:function(o){delete this.items[o.id]},removeAll:function(){var t=this;walk(t,function(o){if(o.removeAll)o.removeAll();else o.remove();o.destroy()},"items",t);
t.items={}},createMenu:function(o){var m=new tinymce.ui.Menu(o.id||DOM.uniqueId(),o);m.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return m}})})(tinymce);
(function(tinymce){var is=tinymce.is,DOM=tinymce.DOM,each=tinymce.each,Event=tinymce.dom.Event,Element=tinymce.dom.Element;tinymce.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(id,s){s=s||{};s.container=s.container||DOM.doc.body;s.offset_x=s.offset_x||0;s.offset_y=s.offset_y||0;s.vp_offset_x=s.vp_offset_x||0;s.vp_offset_y=s.vp_offset_y||0;if(is(s.icons)&&!s.icons)s["class"]+=" mceNoIcons";this.parent(id,s);this.onShowMenu=new tinymce.util.Dispatcher(this);this.onHideMenu=new tinymce.util.Dispatcher(this);
this.classPrefix="mceMenu"},createMenu:function(s){var t=this,cs=t.settings,m;s.container=s.container||cs.container;s.parent=t;s.constrain=s.constrain||cs.constrain;s["class"]=s["class"]||cs["class"];s.vp_offset_x=s.vp_offset_x||cs.vp_offset_x;s.vp_offset_y=s.vp_offset_y||cs.vp_offset_y;s.keyboard_focus=cs.keyboard_focus;m=new tinymce.ui.DropMenu(s.id||DOM.uniqueId(),s);m.onAddItem.add(t.onAddItem.dispatch,t.onAddItem);return m},focus:function(){var t=this;if(t.keyboardNav)t.keyboardNav.focus()},
update:function(){var t=this,s=t.settings,tb=DOM.get("menu_"+t.id+"_tbl"),co=DOM.get("menu_"+t.id+"_co"),tw,th;tw=s.max_width?Math.min(tb.offsetWidth,s.max_width):tb.offsetWidth;th=s.max_height?Math.min(tb.offsetHeight,s.max_height):tb.offsetHeight;if(!DOM.boxModel)t.element.setStyles({width:tw+2,height:th+2});else t.element.setStyles({width:tw,height:th});if(s.max_width)DOM.setStyle(co,"width",tw);if(s.max_height){DOM.setStyle(co,"height",th);if(tb.clientHeight<s.max_height)DOM.setStyle(co,"overflow",
"hidden")}},showMenu:function(x,y,px){var t=this,s=t.settings,co,vp=DOM.getViewPort(),w,h,mx,my,ot=2,dm,tb,cp=t.classPrefix;t.collapse(1);if(t.isMenuVisible)return;if(!t.rendered){co=DOM.add(t.settings.container,t.renderNode());each(t.items,function(o){o.postRender()});t.element=new Element("menu_"+t.id,{blocker:1,container:s.container})}else co=DOM.get("menu_"+t.id);if(!tinymce.isOpera)DOM.setStyles(co,{left:-65535,top:-65535});DOM.show(co);t.update();x+=s.offset_x||0;y+=s.offset_y||0;vp.w-=4;vp.h-=
4;if(s.constrain){w=co.clientWidth-ot;h=co.clientHeight-ot;mx=vp.x+vp.w;my=vp.y+vp.h;if(x+s.vp_offset_x+w>mx)x=px?px-w:Math.max(0,mx-s.vp_offset_x-w);if(y+s.vp_offset_y+h>my)y=Math.max(0,my-s.vp_offset_y-h)}DOM.setStyles(co,{left:x,top:y});t.element.update();t.isMenuVisible=1;t.mouseClickFunc=Event.add(co,"click",function(e){var m;e=e.target;if(e&&(e=DOM.getParent(e,"tr"))&&!DOM.hasClass(e,cp+"ItemSub")){m=t.items[e.id];if(m.isDisabled())return;dm=t;while(dm){if(dm.hideMenu)dm.hideMenu();dm=dm.settings.parent}if(m.settings.onclick)m.settings.onclick(e);
return false}});if(t.hasMenus())t.mouseOverFunc=Event.add(co,"mouseover",function(e){var m,r,mi;e=e.target;if(e&&(e=DOM.getParent(e,"tr"))){m=t.items[e.id];if(t.lastMenu)t.lastMenu.collapse(1);if(m.isDisabled())return;if(e&&DOM.hasClass(e,cp+"ItemSub")){r=DOM.getRect(e);m.showMenu(r.x+r.w-ot,r.y-ot,r.x);t.lastMenu=m;DOM.addClass(DOM.get(m.id).firstChild,cp+"ItemActive")}}});Event.add(co,"keydown",t._keyHandler,t);t.onShowMenu.dispatch(t);if(s.keyboard_focus)t._setupKeyboardNav()},hideMenu:function(c){var t=
this,co=DOM.get("menu_"+t.id),e;if(!t.isMenuVisible)return;if(t.keyboardNav)t.keyboardNav.destroy();Event.remove(co,"mouseover",t.mouseOverFunc);Event.remove(co,"click",t.mouseClickFunc);Event.remove(co,"keydown",t._keyHandler);DOM.hide(co);t.isMenuVisible=0;if(!c)t.collapse(1);if(t.element)t.element.hide();if(e=DOM.get(t.id))DOM.removeClass(e.firstChild,t.classPrefix+"ItemActive");t.onHideMenu.dispatch(t)},add:function(o){var t=this,co;o=t.parent(o);if(t.isRendered&&(co=DOM.get("menu_"+t.id)))t._add(DOM.select("tbody",
co)[0],o);return o},collapse:function(d){this.parent(d);this.hideMenu(1)},remove:function(o){DOM.remove(o.id);this.destroy();return this.parent(o)},destroy:function(){var t=this,co=DOM.get("menu_"+t.id);if(t.keyboardNav)t.keyboardNav.destroy();Event.remove(co,"mouseover",t.mouseOverFunc);Event.remove(DOM.select("a",co),"focus",t.mouseOverFunc);Event.remove(co,"click",t.mouseClickFunc);Event.remove(co,"keydown",t._keyHandler);if(t.element)t.element.remove();DOM.remove(co)},renderNode:function(){var t=
this,s=t.settings,n,tb,co,w;w=DOM.create("div",{role:"listbox",id:"menu_"+t.id,"class":s["class"],"style":"position:absolute;left:0;top:0;z-index:200000;outline:0"});if(t.settings.parent)DOM.setAttrib(w,"aria-parent","menu_"+t.settings.parent.id);co=DOM.add(w,"div",{role:"presentation",id:"menu_"+t.id+"_co","class":t.classPrefix+(s["class"]?" "+s["class"]:"")});t.element=new Element("menu_"+t.id,{blocker:1,container:s.container});if(s.menu_line)DOM.add(co,"span",{"class":t.classPrefix+"Line"});n=
DOM.add(co,"table",{role:"presentation",id:"menu_"+t.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});tb=DOM.add(n,"tbody");each(t.items,function(o){t._add(tb,o)});t.rendered=true;return w},_setupKeyboardNav:function(){var contextMenu,menuItems,t=this;contextMenu=DOM.get("menu_"+t.id);menuItems=DOM.select("a[role=option]","menu_"+t.id);menuItems.splice(0,0,contextMenu);t.keyboardNav=new tinymce.ui.KeyboardNavigation({root:"menu_"+t.id,items:menuItems,onCancel:function(){t.hideMenu()},enableUpDown:true});
contextMenu.focus()},_keyHandler:function(evt){var t=this,e;switch(evt.keyCode){case 37:if(t.settings.parent){t.hideMenu();t.settings.parent.focus();Event.cancel(evt)}break;case 39:if(t.mouseOverFunc)t.mouseOverFunc(evt);break}},_add:function(tb,o){var n,s=o.settings,a,ro,it,cp=this.classPrefix,ic;if(s.separator){ro=DOM.add(tb,"tr",{id:o.id,"class":cp+"ItemSeparator"});DOM.add(ro,"td",{"class":cp+"ItemSeparator"});if(n=ro.previousSibling)DOM.addClass(n,"mceLast");return}n=ro=DOM.add(tb,"tr",{id:o.id,
"class":cp+"Item "+cp+"ItemEnabled"});n=it=DOM.add(n,s.titleItem?"th":"td");n=a=DOM.add(n,"a",{id:o.id+"_aria",role:s.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"});if(s.parent){DOM.setAttrib(a,"aria-haspopup","true");DOM.setAttrib(a,"aria-owns","menu_"+o.id)}DOM.addClass(it,s["class"]);ic=DOM.add(n,"span",{"class":"mceIcon"+(s.icon?" mce_"+s.icon:"")});if(s.icon_src)DOM.add(ic,"img",{src:s.icon_src,alt:""});n=DOM.add(n,s.element||"span",
{"class":"mceText",title:o.settings.title},o.settings.title);if(o.settings.style){if(typeof o.settings.style=="function")o.settings.style=o.settings.style();DOM.setAttrib(n,"style",o.settings.style)}if(tb.childNodes.length==1)DOM.addClass(ro,"mceFirst");if((n=ro.previousSibling)&&DOM.hasClass(n,cp+"ItemSeparator"))DOM.addClass(ro,"mceFirst");if(o.collapse)DOM.addClass(ro,cp+"ItemSub");if(n=ro.previousSibling)DOM.removeClass(n,"mceLast");DOM.addClass(ro,"mceLast")}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM;tinymce.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(id,s,ed){this.parent(id,s,ed);this.classPrefix="mceButton"},renderHTML:function(){var cp=this.classPrefix,s=this.settings,h,l;l=DOM.encode(s.label||"");h='<a role="button" id="'+this.id+'" href="javascript://" class="'+cp+" "+cp+"Enabled "+s["class"]+(l?" "+cp+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+DOM.encode(s.title)+
'">';if(s.image&&!(this.editor&&this.editor.forcedHighContrastMode))h+='<span class="mceIcon '+s["class"]+'"><img class="mceIcon" src="'+s.image+'" alt="'+DOM.encode(s.title)+'" /></span>'+(l?'<span class="'+cp+'Label">'+l+"</span>":"");else h+='<span class="mceIcon '+s["class"]+'"></span>'+(l?'<span class="'+cp+'Label">'+l+"</span>":"");h+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+s.title+"</span>";h+="</a>";return h},postRender:function(){var t=this,
s=t.settings,imgBookmark;if(tinymce.isIE&&t.editor)tinymce.dom.Event.add(t.id,"mousedown",function(e){var nodeName=t.editor.selection.getNode().nodeName;imgBookmark=nodeName==="IMG"?t.editor.selection.getBookmark():null});tinymce.dom.Event.add(t.id,"click",function(e){if(!t.isDisabled()){if(tinymce.isIE&&t.editor&&imgBookmark!==null)t.editor.selection.moveToBookmark(imgBookmark);return s.onclick.call(s.scope,e)}});tinymce.dom.Event.add(t.id,"keyup",function(e){if(!t.isDisabled()&&e.keyCode==tinymce.VK.SPACEBAR)return s.onclick.call(s.scope,
e)})}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,Dispatcher=tinymce.util.Dispatcher,undef;tinymce.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(id,s,ed){var t=this;t.parent(id,s,ed);t.items=[];t.onChange=new Dispatcher(t);t.onPostRender=new Dispatcher(t);t.onAdd=new Dispatcher(t);t.onRenderMenu=new tinymce.util.Dispatcher(this);t.classPrefix="mceListBox";t.marked={}},select:function(va){var t=this,fv,f;t.marked={};if(va==undef)return t.selectByIndex(-1);if(va&&
typeof va=="function")f=va;else f=function(v){return v==va};if(va!=t.selectedValue){each(t.items,function(o,i){if(f(o.value)){fv=1;t.selectByIndex(i);return false}});if(!fv)t.selectByIndex(-1)}},selectByIndex:function(idx){var t=this,e,o,label;t.marked={};if(idx!=t.selectedIndex){e=DOM.get(t.id+"_text");label=DOM.get(t.id+"_voiceDesc");o=t.items[idx];if(o){t.selectedValue=o.value;t.selectedIndex=idx;DOM.setHTML(e,DOM.encode(o.title));DOM.setHTML(label,t.settings.title+" - "+o.title);DOM.removeClass(e,
"mceTitle");DOM.setAttrib(t.id,"aria-valuenow",o.title)}else{DOM.setHTML(e,DOM.encode(t.settings.title));DOM.setHTML(label,DOM.encode(t.settings.title));DOM.addClass(e,"mceTitle");t.selectedValue=t.selectedIndex=null;DOM.setAttrib(t.id,"aria-valuenow",t.settings.title)}e=0}},mark:function(value){this.marked[value]=true},add:function(n,v,o){var t=this;o=o||{};o=tinymce.extend(o,{title:n,value:v});t.items.push(o);t.onAdd.dispatch(t,o)},getLength:function(){return this.items.length},renderHTML:function(){var h=
"",t=this,s=t.settings,cp=t.classPrefix;h='<span role="listbox" aria-haspopup="true" aria-labelledby="'+t.id+'_voiceDesc" aria-describedby="'+t.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+t.id+'" cellpadding="0" cellspacing="0" class="'+cp+" "+cp+"Enabled"+(s["class"]?" "+s["class"]:"")+'"><tbody><tr>';h+="<td>"+DOM.createHTML("span",{id:t.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},t.settings.title);h+=DOM.createHTML("a",{id:t.id+"_text",tabindex:-1,href:"javascript:;",
"class":"mceText",onclick:"return false;",onmousedown:"return false;"},DOM.encode(t.settings.title))+"</td>";h+="<td>"+DOM.createHTML("a",{id:t.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span></span>')+"</td>";h+="</tr></tbody></table></span>";return h},showMenu:function(){var t=this,p2,e=DOM.get(this.id),m;if(t.isDisabled()||t.items.length===0)return;
if(t.menu&&t.menu.isMenuVisible)return t.hideMenu();if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}p2=DOM.getPos(e);m=t.menu;m.settings.offset_x=p2.x;m.settings.offset_y=p2.y;m.settings.keyboard_focus=!tinymce.isOpera;each(t.items,function(o){if(m.items[o.id])m.items[o.id].setSelected(0)});each(t.items,function(o){if(m.items[o.id]&&t.marked[o.value])m.items[o.id].setSelected(1);if(o.value===t.selectedValue)m.items[o.id].setSelected(1)});m.showMenu(0,e.clientHeight);Event.add(DOM.doc,"mousedown",
t.hideMenu,t);DOM.addClass(t.id,t.classPrefix+"Selected")},hideMenu:function(e){var t=this;if(t.menu&&t.menu.isMenuVisible){DOM.removeClass(t.id,t.classPrefix+"Selected");if(e&&e.type=="mousedown"&&(e.target.id==t.id+"_text"||e.target.id==t.id+"_open"))return;if(!e||!DOM.getParent(e.target,".mceMenu")){DOM.removeClass(t.id,t.classPrefix+"Selected");Event.remove(DOM.doc,"mousedown",t.hideMenu,t);t.menu.hideMenu()}}},renderMenu:function(){var t=this,m;m=t.settings.control_manager.createDropMenu(t.id+
"_menu",{menu_line:1,"class":t.classPrefix+"Menu mceNoIcons",max_width:250,max_height:150});m.onHideMenu.add(function(){t.hideMenu();t.focus()});m.add({title:t.settings.title,"class":"mceMenuItemTitle",onclick:function(){if(t.settings.onselect("")!==false)t.select("")}});each(t.items,function(o){if(o.value===undef)m.add({title:o.title,role:"option","class":"mceMenuItemTitle",onclick:function(){if(t.settings.onselect("")!==false)t.select("")}});else{o.id=DOM.uniqueId();o.role="option";o.onclick=function(){if(t.settings.onselect(o.value)!==
false)t.select(o.value)};m.add(o)}});t.onRenderMenu.dispatch(t,m);t.menu=m},postRender:function(){var t=this,cp=t.classPrefix;Event.add(t.id,"click",t.showMenu,t);Event.add(t.id,"keydown",function(evt){if(evt.keyCode==32){t.showMenu(evt);Event.cancel(evt)}});Event.add(t.id,"focus",function(){if(!t._focused){t.keyDownHandler=Event.add(t.id,"keydown",function(e){if(e.keyCode==40){t.showMenu();Event.cancel(e)}});t.keyPressHandler=Event.add(t.id,"keypress",function(e){var v;if(e.keyCode==13){v=t.selectedValue;
t.selectedValue=null;Event.cancel(e);t.settings.onselect(v)}})}t._focused=1});Event.add(t.id,"blur",function(){Event.remove(t.id,"keydown",t.keyDownHandler);Event.remove(t.id,"keypress",t.keyPressHandler);t._focused=0});if(tinymce.isIE6||!DOM.boxModel){Event.add(t.id,"mouseover",function(){if(!DOM.hasClass(t.id,cp+"Disabled"))DOM.addClass(t.id,cp+"Hover")});Event.add(t.id,"mouseout",function(){if(!DOM.hasClass(t.id,cp+"Disabled"))DOM.removeClass(t.id,cp+"Hover")})}t.onPostRender.dispatch(t,DOM.get(t.id))},
destroy:function(){this.parent();Event.clear(this.id+"_text");Event.clear(this.id+"_open")}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,Dispatcher=tinymce.util.Dispatcher,undef;tinymce.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(id,s){this.parent(id,s);this.classPrefix="mceNativeListBox"},setDisabled:function(s){DOM.get(this.id).disabled=s;this.setAriaProperty("disabled",s)},isDisabled:function(){return DOM.get(this.id).disabled},select:function(va){var t=this,fv,f;if(va==undef)return t.selectByIndex(-1);if(va&&typeof va==
"function")f=va;else f=function(v){return v==va};if(va!=t.selectedValue){each(t.items,function(o,i){if(f(o.value)){fv=1;t.selectByIndex(i);return false}});if(!fv)t.selectByIndex(-1)}},selectByIndex:function(idx){DOM.get(this.id).selectedIndex=idx+1;this.selectedValue=this.items[idx]?this.items[idx].value:null},add:function(n,v,a){var o,t=this;a=a||{};a.value=v;if(t.isRendered())DOM.add(DOM.get(this.id),"option",a,n);o={title:n,value:v,attribs:a};t.items.push(o);t.onAdd.dispatch(t,o)},getLength:function(){return this.items.length},
renderHTML:function(){var h,t=this;h=DOM.createHTML("option",{value:""},"-- "+t.settings.title+" --");each(t.items,function(it){h+=DOM.createHTML("option",{value:it.value},it.title)});h=DOM.createHTML("select",{id:t.id,"class":"mceNativeListBox","aria-labelledby":t.id+"_aria"},h);h+=DOM.createHTML("span",{id:t.id+"_aria","style":"display: none"},t.settings.title);return h},postRender:function(){var t=this,ch,changeListenerAdded=true;t.rendered=true;function onChange(e){var v=t.items[e.target.selectedIndex-
1];if(v&&(v=v.value)){t.onChange.dispatch(t,v);if(t.settings.onselect)t.settings.onselect(v)}}Event.add(t.id,"change",onChange);Event.add(t.id,"keydown",function(e){var bf;Event.remove(t.id,"change",ch);changeListenerAdded=false;bf=Event.add(t.id,"blur",function(){if(changeListenerAdded)return;changeListenerAdded=true;Event.add(t.id,"change",onChange);Event.remove(t.id,"blur",bf)});if(tinymce.isWebKit&&(e.keyCode==37||e.keyCode==39))return Event.prevent(e);if(e.keyCode==13||e.keyCode==32){onChange(e);
return Event.cancel(e)}});t.onPostRender.dispatch(t,DOM.get(t.id))}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(id,s,ed){this.parent(id,s,ed);this.onRenderMenu=new tinymce.util.Dispatcher(this);s.menu_container=s.menu_container||DOM.doc.body},showMenu:function(){var t=this,p1,p2,e=DOM.get(t.id),m;if(t.isDisabled())return;if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}if(t.isMenuVisible)return t.hideMenu();p1=DOM.getPos(t.settings.menu_container);
p2=DOM.getPos(e);m=t.menu;m.settings.offset_x=p2.x;m.settings.offset_y=p2.y;m.settings.vp_offset_x=p2.x;m.settings.vp_offset_y=p2.y;m.settings.keyboard_focus=t._focused;m.showMenu(0,e.firstChild.clientHeight);Event.add(DOM.doc,"mousedown",t.hideMenu,t);t.setState("Selected",1);t.isMenuVisible=1},renderMenu:function(){var t=this,m;m=t.settings.control_manager.createDropMenu(t.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:t.settings.icons});m.onHideMenu.add(function(){t.hideMenu();t.focus()});
t.onRenderMenu.dispatch(t,m);t.menu=m},hideMenu:function(e){var t=this;if(e&&e.type=="mousedown"&&DOM.getParent(e.target,function(e){return e.id===t.id||e.id===t.id+"_open"}))return;if(!e||!DOM.getParent(e.target,".mceMenu")){t.setState("Selected",0);Event.remove(DOM.doc,"mousedown",t.hideMenu,t);if(t.menu)t.menu.hideMenu()}t.isMenuVisible=0},postRender:function(){var t=this,s=t.settings;Event.add(t.id,"click",function(){if(!t.isDisabled()){if(s.onclick)s.onclick(t.value);t.showMenu()}})}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each;tinymce.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(id,s,ed){this.parent(id,s,ed);this.classPrefix="mceSplitButton"},renderHTML:function(){var h,t=this,s=t.settings,h1;h="<tbody><tr>";if(s.image)h1=DOM.createHTML("img ",{src:s.image,role:"presentation","class":"mceAction "+s["class"]});else h1=DOM.createHTML("span",{"class":"mceAction "+s["class"]},"");h1+=DOM.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",
id:t.id+"_voice",style:"display:none;"},s.title);h+="<td >"+DOM.createHTML("a",{role:"button",id:t.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+s["class"],onclick:"return false;",onmousedown:"return false;",title:s.title},h1)+"</td>";h1=DOM.createHTML("span",{"class":"mceOpen "+s["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">\u25bc</span>');h+="<td >"+DOM.createHTML("a",{role:"button",id:t.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+
s["class"],onclick:"return false;",onmousedown:"return false;",title:s.title},h1)+"</td>";h+="</tr></tbody>";h=DOM.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+s["class"],cellpadding:"0",cellspacing:"0",title:s.title},h);return DOM.createHTML("div",{id:t.id,role:"button",tabindex:"0","aria-labelledby":t.id+"_voice","aria-haspopup":"true"},h)},postRender:function(){var t=this,s=t.settings,activate;if(s.onclick){activate=function(evt){if(!t.isDisabled()){s.onclick(t.value);
Event.cancel(evt)}};Event.add(t.id+"_action","click",activate);Event.add(t.id,["click","keydown"],function(evt){var DOM_VK_SPACE=32,DOM_VK_ENTER=14,DOM_VK_RETURN=13,DOM_VK_UP=38,DOM_VK_DOWN=40;if((evt.keyCode===32||evt.keyCode===13||evt.keyCode===14)&&!evt.altKey&&!evt.ctrlKey&&!evt.metaKey){activate();Event.cancel(evt)}else if(evt.type==="click"||evt.keyCode===DOM_VK_DOWN){t.showMenu();Event.cancel(evt)}})}Event.add(t.id+"_open","click",function(evt){t.showMenu();Event.cancel(evt)});Event.add([t.id,
t.id+"_open"],"focus",function(){t._focused=1});Event.add([t.id,t.id+"_open"],"blur",function(){t._focused=0});if(tinymce.isIE6||!DOM.boxModel){Event.add(t.id,"mouseover",function(){if(!DOM.hasClass(t.id,"mceSplitButtonDisabled"))DOM.addClass(t.id,"mceSplitButtonHover")});Event.add(t.id,"mouseout",function(){if(!DOM.hasClass(t.id,"mceSplitButtonDisabled"))DOM.removeClass(t.id,"mceSplitButtonHover")})}},destroy:function(){this.parent();Event.clear(this.id+"_action");Event.clear(this.id+"_open");Event.clear(this.id)}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,is=tinymce.is,each=tinymce.each;tinymce.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(id,s,ed){var t=this;t.parent(id,s,ed);t.settings=s=tinymce.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",
grid_width:8,default_color:"#888888"},t.settings);t.onShowMenu=new tinymce.util.Dispatcher(t);t.onHideMenu=new tinymce.util.Dispatcher(t);t.value=s.default_color},showMenu:function(){var t=this,r,p,e,p2;if(t.isDisabled())return;if(!t.isMenuRendered){t.renderMenu();t.isMenuRendered=true}if(t.isMenuVisible)return t.hideMenu();e=DOM.get(t.id);DOM.show(t.id+"_menu");DOM.addClass(e,"mceSplitButtonSelected");p2=DOM.getPos(e);DOM.setStyles(t.id+"_menu",{left:p2.x,top:p2.y+e.firstChild.clientHeight,zIndex:2E5});
e=0;Event.add(DOM.doc,"mousedown",t.hideMenu,t);t.onShowMenu.dispatch(t);if(t._focused){t._keyHandler=Event.add(t.id+"_menu","keydown",function(e){if(e.keyCode==27)t.hideMenu()});DOM.select("a",t.id+"_menu")[0].focus()}t.keyboardNav=new tinymce.ui.KeyboardNavigation({root:t.id+"_menu",items:DOM.select("a",t.id+"_menu"),onCancel:function(){t.hideMenu();t.focus()}});t.keyboardNav.focus();t.isMenuVisible=1},hideMenu:function(e){var t=this;if(t.isMenuVisible){if(e&&e.type=="mousedown"&&DOM.getParent(e.target,
function(e){return e.id===t.id+"_open"}))return;if(!e||!DOM.getParent(e.target,".mceSplitButtonMenu")){DOM.removeClass(t.id,"mceSplitButtonSelected");Event.remove(DOM.doc,"mousedown",t.hideMenu,t);Event.remove(t.id+"_menu","keydown",t._keyHandler);DOM.hide(t.id+"_menu")}t.isMenuVisible=0;t.onHideMenu.dispatch();t.keyboardNav.destroy()}},renderMenu:function(){var t=this,m,i=0,s=t.settings,n,tb,tr,w,context;w=DOM.add(s.menu_container,"div",{role:"listbox",id:t.id+"_menu","class":s.menu_class+" "+s["class"],
style:"position:absolute;left:0;top:-1000px;"});m=DOM.add(w,"div",{"class":s["class"]+" mceSplitButtonMenu"});DOM.add(m,"span",{"class":"mceMenuLine"});n=DOM.add(m,"table",{role:"presentation","class":"mceColorSplitMenu"});tb=DOM.add(n,"tbody");i=0;each(is(s.colors,"array")?s.colors:s.colors.split(","),function(c){c=c.replace(/^#/,"");if(!i--){tr=DOM.add(tb,"tr");i=s.grid_width-1}n=DOM.add(tr,"td");var settings={href:"javascript:;",style:{backgroundColor:"#"+c},"title":t.editor.getLang("colors."+
c,c),"data-mce-color":"#"+c};if(!tinymce.isIE)settings.role="option";n=DOM.add(n,"a",settings);if(t.editor.forcedHighContrastMode){n=DOM.add(n,"canvas",{width:16,height:16,"aria-hidden":"true"});if(n.getContext&&(context=n.getContext("2d"))){context.fillStyle="#"+c;context.fillRect(0,0,16,16)}else DOM.remove(n)}});if(s.more_colors_func){n=DOM.add(tb,"tr");n=DOM.add(n,"td",{colspan:s.grid_width,"class":"mceMoreColors"});n=DOM.add(n,"a",{role:"option",id:t.id+"_more",href:"javascript:;",onclick:"return false;",
"class":"mceMoreColors"},s.more_colors_title);Event.add(n,"click",function(e){s.more_colors_func.call(s.more_colors_scope||this);return Event.cancel(e)})}DOM.addClass(m,"mceColorSplitMenu");Event.add(t.id+"_menu","mousedown",function(e){return Event.cancel(e)});Event.add(t.id+"_menu","click",function(e){var c;e=DOM.getParent(e.target,"a",tb);if(e&&e.nodeName.toLowerCase()=="a"&&(c=e.getAttribute("data-mce-color")))t.setColor(c);return false});return w},setColor:function(c){this.displayColor(c);this.hideMenu();
this.settings.onselect(c)},displayColor:function(c){var t=this;DOM.setStyle(t.id+"_preview","backgroundColor",c);t.value=c},postRender:function(){var t=this,id=t.id;t.parent();DOM.add(id+"_action","div",{id:id+"_preview","class":"mceColorPreview"});DOM.setStyle(t.id+"_preview","backgroundColor",t.value)},destroy:function(){var self=this;self.parent();Event.clear(self.id+"_menu");Event.clear(self.id+"_more");DOM.remove(self.id+"_menu");if(self.keyboardNav)self.keyboardNav.destroy()}})})(tinymce);
(function(tinymce){var dom=tinymce.DOM,each=tinymce.each,Event=tinymce.dom.Event;tinymce.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var t=this,h=[],controls=t.controls,each=tinymce.each,settings=t.settings;h.push('<div id="'+t.id+'" role="group" aria-labelledby="'+t.id+'_voice">');h.push("<span role='application'>");h.push('<span id="'+t.id+'_voice" class="mceVoiceLabel" style="display:none;">'+dom.encode(settings.name)+"</span>");each(controls,function(toolbar){h.push(toolbar.renderHTML())});
h.push("</span>");h.push("</div>");return h.join("")},focus:function(){var t=this;dom.get(t.id).focus()},postRender:function(){var t=this,items=[];each(t.controls,function(toolbar){each(toolbar.controls,function(control){if(control.id)items.push(control)})});t.keyNav=new tinymce.ui.KeyboardNavigation({root:t.id,items:items,onCancel:function(){if(tinymce.isWebKit)dom.get(t.editor.id+"_ifr").focus();t.editor.focus()},excludeFromTabOrder:!t.settings.tab_focus_toolbar})},destroy:function(){var self=this;
self.parent();self.keyNav.destroy();Event.clear(self.id)}})})(tinymce);
(function(tinymce){var dom=tinymce.DOM,each=tinymce.each;tinymce.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var t=this,h="",c,co,s=t.settings,i,pr,nx,cl;cl=t.controls;for(i=0;i<cl.length;i++){co=cl[i];pr=cl[i-1];nx=cl[i+1];if(i===0){c="mceToolbarStart";if(co.Button)c+=" mceToolbarStartButton";else if(co.SplitButton)c+=" mceToolbarStartSplitButton";else if(co.ListBox)c+=" mceToolbarStartListBox";h+=dom.createHTML("td",{"class":c},dom.createHTML("span",null,"<\!-- IE --\>"))}if(pr&&
co.ListBox)if(pr.Button||pr.SplitButton)h+=dom.createHTML("td",{"class":"mceToolbarEnd"},dom.createHTML("span",null,"<\!-- IE --\>"));if(dom.stdMode)h+='<td style="position: relative">'+co.renderHTML()+"</td>";else h+="<td>"+co.renderHTML()+"</td>";if(nx&&co.ListBox)if(nx.Button||nx.SplitButton)h+=dom.createHTML("td",{"class":"mceToolbarStart"},dom.createHTML("span",null,"<\!-- IE --\>"))}c="mceToolbarEnd";if(co.Button)c+=" mceToolbarEndButton";else if(co.SplitButton)c+=" mceToolbarEndSplitButton";
else if(co.ListBox)c+=" mceToolbarEndListBox";h+=dom.createHTML("td",{"class":c},dom.createHTML("span",null,"<\!-- IE --\>"));return dom.createHTML("table",{id:t.id,"class":"mceToolbar"+(s["class"]?" "+s["class"]:""),cellpadding:"0",cellspacing:"0",align:t.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+h+"</tr></tbody>")}})})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher,each=tinymce.each;tinymce.create("tinymce.AddOnManager",{AddOnManager:function(){var self=this;self.items=[];self.urls={};self.lookup={};self.onAdd=new Dispatcher(self)},get:function(n){if(this.lookup[n])return this.lookup[n].instance;else return undefined},dependencies:function(n){var result;if(this.lookup[n])result=this.lookup[n].dependencies;return result||[]},requireLangPack:function(n){var s=tinymce.settings;if(s&&s.language&&s.language_load!==
false)tinymce.ScriptLoader.add(this.urls[n]+"/langs/"+s.language+".js")},add:function(id,o,dependencies){this.items.push(o);this.lookup[id]={instance:o,dependencies:dependencies};this.onAdd.dispatch(this,id,o);return o},createUrl:function(baseUrl,dep){if(typeof dep==="object")return dep;else return{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];tinymce.each(scripts,function(script){tinymce.ScriptLoader.add(pluginUrl+
"/"+script)})},load:function(n,u,cb,s){var t=this,url=u;function loadDependencies(){var dependencies=t.dependencies(n);tinymce.each(dependencies,function(dep){var newUrl=t.createUrl(u,dep);t.load(newUrl.resource,newUrl,undefined,undefined)});if(cb)if(s)cb.call(s);else cb.call(tinymce.ScriptLoader)}if(t.urls[n])return;if(typeof u==="object")url=u.prefix+u.resource+u.suffix;if(url.indexOf("/")!==0&&url.indexOf("://")==-1)url=tinymce.baseURL+"/"+url;t.urls[n]=url.substring(0,url.lastIndexOf("/"));if(t.lookup[n])loadDependencies();
else tinymce.ScriptLoader.add(url,loadDependencies,s)}});tinymce.PluginManager=new tinymce.AddOnManager;tinymce.ThemeManager=new tinymce.AddOnManager})(tinymce);
(function(tinymce){var each=tinymce.each,extend=tinymce.extend,DOM=tinymce.DOM,Event=tinymce.dom.Event,ThemeManager=tinymce.ThemeManager,PluginManager=tinymce.PluginManager,explode=tinymce.explode,Dispatcher=tinymce.util.Dispatcher,undef,instanceCounter=0;tinymce.documentBaseURL=window.location.href.replace(window.location.pathname,"/d2l/common/tiny_mce");if(!/[\/\\]$/.test(tinymce.documentBaseURL))tinymce.documentBaseURL+="/";tinymce.baseURL=(new tinymce.util.URI(tinymce.documentBaseURL)).toAbsolute(tinymce.baseURL);
tinymce.baseURI=new tinymce.util.URI(tinymce.baseURL);tinymce.onBeforeUnload=new Dispatcher(tinymce);Event.add(window,"beforeunload",function(e){tinymce.onBeforeUnload.dispatch(tinymce,e)});tinymce.onAddEditor=new Dispatcher(tinymce);tinymce.onRemoveEditor=new Dispatcher(tinymce);tinymce.EditorManager=extend(tinymce,{editors:[],i18n:{},activeEditor:null,init:function(s){var t=this,pl,sl=tinymce.ScriptLoader,e,el=[],ed;function createId(elm){var id=elm.id;if(!id){id=elm.name;if(id&&!DOM.get(id))id=
elm.name;else id=DOM.uniqueId();elm.setAttribute("id",id)}return id}function execCallback(se,n,s){var f=se[n];if(!f)return;if(tinymce.is(f,"string")){s=f.replace(/\.\w+$/,"");s=s?tinymce.resolve(s):0;f=tinymce.resolve(f)}return f.apply(s||this,Array.prototype.slice.call(arguments,2))}function hasClass(n,c){return c.constructor===RegExp?c.test(n.className):DOM.hasClass(n,c)}t.settings=s;Event.bind(window,"ready",function(){var l,co;execCallback(s,"onpageload");switch(s.mode){case "exact":l=s.elements||
"";if(l.length>0)each(explode(l),function(v){if(DOM.get(v)){ed=new tinymce.Editor(v,s);el.push(ed);ed.render(1)}else each(document.forms,function(f){each(f.elements,function(e){if(e.name===v){v="mce_editor_"+instanceCounter++;DOM.setAttrib(e,"id",v);ed=new tinymce.Editor(v,s);el.push(ed);ed.render(1)}})})});break;case "textareas":case "specific_textareas":each(DOM.select("textarea"),function(elm){if(s.editor_deselector&&hasClass(elm,s.editor_deselector))return;if(!s.editor_selector||hasClass(elm,
s.editor_selector)){ed=new tinymce.Editor(createId(elm),s);el.push(ed);ed.render(1)}});break;default:if(s.types)each(s.types,function(type){each(DOM.select(type.selector),function(elm){var editor=new tinymce.Editor(createId(elm),tinymce.extend({},s,type));el.push(editor);editor.render(1)})});else if(s.selector)each(DOM.select(s.selector),function(elm){var editor=new tinymce.Editor(createId(elm),s);el.push(editor);editor.render(1)})}if(s.oninit){l=co=0;each(el,function(ed){co++;if(!ed.initialized)ed.onInit.add(function(){l++;
if(l==co)execCallback(s,"oninit")});else l++;if(l==co)execCallback(s,"oninit")})}})},get:function(id){if(id===undef)return this.editors;return this.editors[id]},getInstanceById:function(id){return this.get(id)},add:function(editor){var self=this,editors=self.editors;editors[editor.id]=editor;editors.push(editor);self._setActive(editor);self.onAddEditor.dispatch(self,editor);return editor},remove:function(editor){var t=this,i,editors=t.editors;if(!editors[editor.id])return null;delete editors[editor.id];
for(i=0;i<editors.length;i++)if(editors[i]==editor){editors.splice(i,1);break}if(t.activeEditor==editor)t._setActive(editors[0]);editor.destroy();t.onRemoveEditor.dispatch(t,editor);return editor},execCommand:function(c,u,v){var t=this,ed=t.get(v),w;function clr(){ed.destroy();w.detachEvent("onunload",clr);w=w.tinyMCE=w.tinymce=null}switch(c){case "mceFocus":ed.focus();return true;case "mceAddEditor":case "mceAddControl":if(!t.get(v))(new tinymce.Editor(v,t.settings)).render();return true;case "mceAddFrameControl":w=
v.window;w.tinyMCE=tinyMCE;w.tinymce=tinymce;tinymce.DOM.doc=w.document;tinymce.DOM.win=w;ed=new tinymce.Editor(v.element_id,v);ed.render();if(tinymce.isIE)w.attachEvent("onunload",clr);v.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":if(ed)ed.remove();return true;case "mceToggleEditor":if(!ed){t.execCommand("mceAddControl",0,v);return true}if(ed.isHidden())ed.show();else ed.hide();return true}if(t.activeEditor)return t.activeEditor.execCommand(c,u,v);return false},execInstanceCommand:function(id,
c,u,v){var ed=this.get(id);if(ed)return ed.execCommand(c,u,v);return false},triggerSave:function(){each(this.editors,function(e){e.save()})},addI18n:function(p,o){var lo,i18n=this.i18n;if(!tinymce.is(p,"string"))each(p,function(o,lc){each(o,function(o,g){each(o,function(o,k){if(g==="common")i18n[lc+"."+k]=o;else i18n[lc+"."+g+"."+k]=o})})});else each(o,function(o,k){i18n[p+"."+k]=o})},_setActive:function(editor){this.selectedInstance=this.activeEditor=editor}})})(tinymce);
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,extend=tinymce.extend,each=tinymce.each,isGecko=tinymce.isGecko,isIE=tinymce.isIE,isWebKit=tinymce.isWebKit,is=tinymce.is,ThemeManager=tinymce.ThemeManager,PluginManager=tinymce.PluginManager,explode=tinymce.explode;tinymce.create("tinymce.Editor",{Editor:function(id,settings){var self=this,TRUE=true;self.settings=settings=extend({id:id,language:"en",theme:"advanced",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",
document_base_url:tinymce.documentBaseURL,add_form_submit_trigger:TRUE,submit_patch:TRUE,add_unload_trigger:TRUE,convert_urls:TRUE,relative_urls:TRUE,remove_script_host:TRUE,table_inline_editing:false,object_resizing:TRUE,accessibility_focus:TRUE,doctype:tinymce.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:TRUE,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",
apply_source_formatting:TRUE,directionality:"ltr",forced_root_block:"p",hidden_input:TRUE,padd_empty_editor:TRUE,render_ui:TRUE,indentation:"30px",fix_table_elements:TRUE,inline_styles:TRUE,convert_fonts_to_spans:TRUE,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",
validate:TRUE,entity_encoding:"named",url_converter:self.convertURL,url_converter_scope:self,ie7_compat:TRUE},settings);self.id=self.editorId=id;self.isNotDirty=false;self.plugins={};self.documentBaseURI=new tinymce.util.URI(settings.document_base_url||tinymce.documentBaseURL,{base_uri:tinyMCE.baseURI});self.baseURI=tinymce.baseURI;self.contentCSS=[];self.contentStyles=[];self.setupEvents();self.execCommands={};self.queryStateCommands={};self.queryValueCommands={};self.execCallback("setup",self)},
render:function(nst){var t=this,s=t.settings,id=t.id,sl=tinymce.ScriptLoader;if(!Event.domLoaded){Event.add(window,"ready",function(){t.render()});return}tinyMCE.settings=s;if(!t.getElement())return;if(tinymce.isIDevice&&!tinymce.isIOS5)return;if(!/TEXTAREA|INPUT/i.test(t.getElement().nodeName)&&s.hidden_input&&DOM.getParent(id,"form"))DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id);if(!s.content_editable){t.orgVisibility=t.getElement().style.visibility;t.getElement().style.visibility=
"hidden"}if(tinymce.WindowManager)t.windowManager=new tinymce.WindowManager(t);if(s.encoding=="xml")t.onGetContent.add(function(ed,o){if(o.save)o.content=DOM.encode(o.content)});if(s.add_form_submit_trigger)t.onSubmit.addToTop(function(){if(t.initialized){t.save();t.isNotDirty=1}});if(s.add_unload_trigger)t._beforeUnload=tinyMCE.onBeforeUnload.add(function(){if(t.initialized&&!t.destroyed&&!t.isHidden())t.save({format:"raw",no_events:true})});tinymce.addUnload(t.destroy,t);if(s.submit_patch)t.onBeforeRenderUI.add(function(){var n=
t.getElement().form;if(!n)return;if(n._mceOldSubmit)return;if(!n.submit.nodeType&&!n.submit.length){t.formElement=n;n._mceOldSubmit=n.submit;n.submit=function(){tinymce.triggerSave();t.isNotDirty=1;return t.formElement._mceOldSubmit(t.formElement)}}n=null});function loadScripts(){if(s.language&&s.language_load!==false)sl.add(tinymce.baseURL+"/langs/"+s.language+".js");if(s.theme&&typeof s.theme!="function"&&s.theme.charAt(0)!="-"&&!ThemeManager.urls[s.theme])ThemeManager.load(s.theme,"themes/"+s.theme+
"/editor_template"+tinymce.suffix+".js");each(explode(s.plugins),function(p){if(p&&!PluginManager.urls[p])if(p.charAt(0)=="-"){p=p.substr(1,p.length);var dependencies=PluginManager.dependencies(p);each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/editor_plugin"+tinymce.suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep);PluginManager.load(dep.resource,dep)})}else{if(p=="safari")return;PluginManager.load(p,{prefix:"plugins/",resource:p,suffix:"/editor_plugin"+
tinymce.suffix+".js"})}});sl.loadQueue(function(){if(!t.removed)t.init()})}loadScripts()},init:function(){var n,t=this,s=t.settings,w,h,mh,e=t.getElement(),o,ti,u,bi,bc,re,i,initializedPlugins=[];tinymce.add(t);s.aria_label=s.aria_label||DOM.getAttrib(e,"aria-label",t.getLang("aria.rich_text_area"));if(s.theme)if(typeof s.theme!="function"){s.theme=s.theme.replace(/-/,"");o=ThemeManager.get(s.theme);t.theme=new o;if(t.theme.init)t.theme.init(t,ThemeManager.urls[s.theme]||tinymce.documentBaseURL.replace(/\/$/,
""))}else t.theme=s.theme;function initPlugin(p){var c=PluginManager.get(p),u=PluginManager.urls[p]||tinymce.documentBaseURL.replace(/\/$/,""),po;if(c&&tinymce.inArray(initializedPlugins,p)===-1){each(PluginManager.dependencies(p),function(dep){initPlugin(dep)});po=new c(t,u);t.plugins[p]=po;if(po.init){po.init(t,u);initializedPlugins.push(p)}}}each(explode(s.plugins.replace(/\-/g,"")),initPlugin);if(s.popup_css!==false)if(s.popup_css)s.popup_css=t.documentBaseURI.toAbsolute(s.popup_css);else s.popup_css=
t.baseURI.toAbsolute("themes/"+s.theme+"/skins/"+s.skin+"/dialog.css");if(s.popup_css_add)s.popup_css+=","+t.documentBaseURI.toAbsolute(s.popup_css_add);t.controlManager=new tinymce.ControlManager(t);t.onBeforeRenderUI.dispatch(t,t.controlManager);if(s.render_ui&&t.theme){t.orgDisplay=e.style.display;if(typeof s.theme!="function"){w=s.width||e.style.width||e.offsetWidth;h=s.height||e.style.height||e.offsetHeight;mh=s.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(""+w))w=Math.max(parseInt(w,10)+
(o.deltaWidth||0),100);if(re.test(""+h))h=Math.max(parseInt(h,10)+(o.deltaHeight||0),mh);o=t.theme.renderUI({targetNode:e,width:w,height:h,deltaWidth:s.delta_width,deltaHeight:s.delta_height});DOM.setStyles(o.sizeContainer||o.editorContainer,{width:w,height:h});h=(o.iframeHeight||h)+(typeof h=="number"?o.deltaHeight||0:"");if(h<mh)h=mh}else{o=s.theme(t,e);if(o.editorContainer.nodeType)o.editorContainer=o.editorContainer.id=o.editorContainer.id||t.id+"_parent";if(o.iframeContainer.nodeType)o.iframeContainer=
o.iframeContainer.id=o.iframeContainer.id||t.id+"_iframecontainer";h=o.iframeHeight||e.offsetHeight;if(isIE)t.onInit.add(function(ed){ed.dom.bind(ed.getBody(),"beforedeactivate keydown",function(){ed.lastIERng=ed.selection.getRng()})})}t.editorContainer=o.editorContainer}if(s.content_css)each(explode(s.content_css),function(u){t.contentCSS.push(t.documentBaseURI.toAbsolute(u))});if(s.content_style)t.contentStyles.push(s.content_style);if(s.content_editable){e=n=o=null;return t.initContentBody()}if(document.domain&&
location.hostname!=document.domain)tinymce.relaxedDomain=document.domain;t.iframeHTML=s.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';if(s.document_base_url!=tinymce.documentBaseURL)t.iframeHTML+='<base href="'+t.documentBaseURI.getURI()+'" />';if(s.ie7_compat)t.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />';else t.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=edge" />';t.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';
for(i=0;i<t.contentCSS.length;i++)t.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+t.contentCSS[i]+'" />';t.contentCSS=[];bi=s.body_id||"tinymce";if(bi.indexOf("=")!=-1){bi=t.getParam("body_id","","hash");bi=bi[t.id]||bi}bc=s.body_class||"";if(bc.indexOf("=")!=-1){bc=t.getParam("body_class","","hash");bc=bc[t.id]||""}t.iframeHTML+='</head><body id="'+bi+'" class="mceContentBody '+bc+'" onload="window.parent.tinyMCE.get(\''+t.id+"').onLoad.dispatch();\"><br></body></html>";if(tinymce.relaxedDomain&&
(isIE||tinymce.isOpera&&parseFloat(opera.version())<11))u='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+t.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()';n=DOM.add(o.iframeContainer,"iframe",{id:t.id+"_ifr",src:u||'javascript:""',frameBorder:"0",allowTransparency:"true",title:s.aria_label,style:{width:"100%",height:h,display:"block"}});t.contentAreaContainer=o.iframeContainer;if(o.editorContainer)DOM.get(o.editorContainer).style.display=
t.orgDisplay;e.style.visibility=t.orgVisibility;DOM.get(t.id).style.display="none";DOM.setAttrib(t.id,"aria-hidden",true);if(!tinymce.relaxedDomain||!u)t.initContentBody();e=n=o=null},initContentBody:function(){var self=this,settings=self.settings,targetElm=DOM.get(self.id),doc=self.getDoc(),html,body,contentCssText;if((!isIE||!tinymce.relaxedDomain)&&!settings.content_editable){doc.open();doc.write(self.iframeHTML);doc.close();if(tinymce.relaxedDomain)doc.domain=tinymce.relaxedDomain}if(settings.content_editable){DOM.addClass(targetElm,
"mceContentBody");self.contentDocument=doc=settings.content_document||document;self.contentWindow=settings.content_window||window;self.bodyElement=targetElm;settings.content_document=settings.content_window=null}body=self.getBody();body.disabled=true;if(!settings.readonly)body.contentEditable=self.getParam("content_editable_state",true);body.disabled=false;self.schema=new tinymce.html.Schema(settings);self.dom=new tinymce.dom.DOMUtils(doc,{keep_values:true,url_converter:self.convertURL,url_converter_scope:self,
hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:true,root_element:settings.content_editable?self.id:null,schema:self.schema});self.parser=new tinymce.html.DomParser(settings,self.schema);self.parser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,dom=self.dom,value,internalName;while(i--){node=nodes[i];value=node.attr(name);internalName="data-mce-"+name;if(!node.attributes.map[internalName])if(name==="style")node.attr(internalName,
dom.serializeStyle(dom.parseStyle(value),node.name));else node.attr(internalName,self.convertURL(value,name,node.name))}});self.parser.addNodeFilter("script",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.attr("type","mce-"+(node.attr("type")||"text/javascript"))}});self.parser.addNodeFilter("#cdata",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];node.type=8;node.name="#comment";node.value="[CDATA["+node.value+"]]"}});self.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",
function(nodes,name){var i=nodes.length,node,nonEmptyElements=self.schema.getNonEmptyElements();while(i--){node=nodes[i];if(node.isEmpty(nonEmptyElements))node.empty().append(new tinymce.html.Node("br",1)).shortEnded=true}});self.serializer=new tinymce.dom.Serializer(settings,self.dom,self.schema);self.selection=new tinymce.dom.Selection(self.dom,self.getWin(),self.serializer,self);self.formatter=new tinymce.Formatter(self);self.undoManager=new tinymce.UndoManager(self);self.forceBlocks=new tinymce.ForceBlocks(self);
self.enterKey=new tinymce.EnterKey(self);self.editorCommands=new tinymce.EditorCommands(self);self.onExecCommand.add(function(editor,command){if(!/^(FontName|FontSize)$/.test(command))self.nodeChanged()});self.serializer.onPreProcess.add(function(se,o){return self.onPreProcess.dispatch(self,o,se)});self.serializer.onPostProcess.add(function(se,o){return self.onPostProcess.dispatch(self,o,se)});self.onPreInit.dispatch(self);if(!settings.browser_spellcheck&&!settings.gecko_spellcheck)doc.body.spellcheck=
false;if(!settings.readonly)self.bindNativeEvents();self.controlManager.onPostRender.dispatch(self,self.controlManager);self.onPostRender.dispatch(self);self.quirks=tinymce.util.Quirks(self);if(settings.directionality)body.dir=settings.directionality;if(settings.nowrap)body.style.whiteSpace="nowrap";if(settings.protect)self.onBeforeSetContent.add(function(ed,o){each(settings.protect,function(pattern){o.content=o.content.replace(pattern,function(str){return"<\!--mce:protected "+escape(str)+"--\>"})})});
self.onSetContent.add(function(){self.addVisual(self.getBody())});if(settings.padd_empty_editor)self.onPostProcess.add(function(ed,o){o.content=o.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});self.load({initial:true,format:"html"});self.startContent=self.getContent({format:"raw"});self.initialized=true;self.onInit.dispatch(self);self.execCallback("setupcontent_callback",self.id,body,doc);self.execCallback("init_instance_callback",self);self.focus(true);
self.nodeChanged({initial:true});if(self.contentStyles.length>0){contentCssText="";each(self.contentStyles,function(style){contentCssText+=style+"\r\n"});self.dom.addStyle(contentCssText)}each(self.contentCSS,function(url){self.dom.loadCSS(url)});if(settings.auto_focus)setTimeout(function(){var ed=tinymce.get(settings.auto_focus);ed.selection.select(ed.getBody(),1);ed.selection.collapse(1);ed.getBody().focus();ed.getWin().focus()},100);targetElm=doc=body=null},focus:function(skip_focus){var oed,self=
this,selection=self.selection,contentEditable=self.settings.content_editable,ieRng,controlElm,doc=self.getDoc(),body;if(!skip_focus){if(self.lastIERng)selection.setRng(self.lastIERng);ieRng=selection.getRng();if(ieRng.item)controlElm=ieRng.item(0);self._refreshContentEditable();if(!contentEditable)self.getWin().focus();if(tinymce.isGecko||contentEditable){body=self.getBody();if(body.setActive)body.setActive();else body.focus();if(contentEditable)selection.normalize()}if(controlElm&&controlElm.ownerDocument==
doc){ieRng=doc.body.createControlRange();ieRng.addElement(controlElm);ieRng.select()}}if(tinymce.activeEditor!=self){if((oed=tinymce.activeEditor)!=null)oed.onDeactivate.dispatch(oed,self);self.onActivate.dispatch(self,oed)}tinymce._setActive(self)},execCallback:function(n){var t=this,f=t.settings[n],s;if(!f)return;if(t.callbackLookup&&(s=t.callbackLookup[n])){f=s.func;s=s.scope}if(is(f,"string")){s=f.replace(/\.\w+$/,"");s=s?tinymce.resolve(s):0;f=tinymce.resolve(f);t.callbackLookup=t.callbackLookup||
{};t.callbackLookup[n]={func:f,scope:s}}return f.apply(s||t,Array.prototype.slice.call(arguments,1))},translate:function(s){var c=this.settings.language||"en",i18n=tinymce.i18n;if(!s)return"";return i18n[c+"."+s]||s.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n[c+"."+b]||"{#"+b+"}"})},getLang:function(n,dv){return tinymce.i18n[(this.settings.language||"en")+"."+n]||(is(dv)?dv:"{#"+n+"}")},getParam:function(n,dv,ty){var tr=tinymce.trim,v=is(this.settings[n])?this.settings[n]:dv,o;if(ty==="hash"){o=
{};if(is(v,"string"))each(v.indexOf("=")>0?v.split(/[;,](?![^=;,]*(?:[;,]|$))/):v.split(","),function(v){v=v.split("=");if(v.length>1)o[tr(v[0])]=tr(v[1]);else o[tr(v[0])]=tr(v)});else o=v;return o}return v},nodeChanged:function(o){var self=this,selection=self.selection,node;if(self.initialized){o=o||{};node=selection.getStart()||self.getBody();node=isIE&&node.ownerDocument!=self.getDoc()?self.getBody():node;o.parents=[];self.dom.getParent(node,function(node){if(node.nodeName=="BODY")return true;
o.parents.push(node)});self.onNodeChange.dispatch(self,o?o.controlManager||self.controlManager:self.controlManager,node,selection.isCollapsed(),o)}},addButton:function(name,settings){var self=this;self.buttons=self.buttons||{};self.buttons[name]=settings},addCommand:function(name,callback,scope){this.execCommands[name]={func:callback,scope:scope||this}},addQueryStateHandler:function(name,callback,scope){this.queryStateCommands[name]={func:callback,scope:scope||this}},addQueryValueHandler:function(name,
callback,scope){this.queryValueCommands[name]={func:callback,scope:scope||this}},addShortcut:function(pa,desc,cmd_func,sc){var t=this,c;if(t.settings.custom_shortcuts===false)return false;t.shortcuts=t.shortcuts||{};if(is(cmd_func,"string")){c=cmd_func;cmd_func=function(){t.execCommand(c,false,null)}}if(is(cmd_func,"object")){c=cmd_func;cmd_func=function(){t.execCommand(c[0],c[1],c[2])}}each(explode(pa),function(pa){var o={func:cmd_func,scope:sc||this,desc:t.translate(desc),alt:false,ctrl:false,shift:false};
each(explode(pa,"+"),function(v){switch(v){case "alt":case "ctrl":case "shift":o[v]=true;break;default:o.charCode=v.charCodeAt(0);o.keyCode=v.toUpperCase().charCodeAt(0)}});t.shortcuts[(o.ctrl?"ctrl":"")+","+(o.alt?"alt":"")+","+(o.shift?"shift":"")+","+o.keyCode]=o});return true},execCommand:function(cmd,ui,val,a){var t=this,s=0,o,st;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(cmd)&&(!a||!a.skip_focus))t.focus();a=extend({},a);t.onBeforeExecCommand.dispatch(t,
cmd,ui,val,a);if(a.terminate)return false;if(t.execCallback("execcommand_callback",t.id,t.selection.getNode(),cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}if(o=t.execCommands[cmd]){st=o.func.call(o.scope,ui,val);if(st!==true){t.onExecCommand.dispatch(t,cmd,ui,val,a);return st}}each(t.plugins,function(p){if(p.execCommand&&p.execCommand(cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);s=1;return false}});if(s)return true;if(t.theme&&t.theme.execCommand&&t.theme.execCommand(cmd,
ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}if(t.editorCommands.execCommand(cmd,ui,val)){t.onExecCommand.dispatch(t,cmd,ui,val,a);return true}t.getDoc().execCommand(cmd,ui,val);t.onExecCommand.dispatch(t,cmd,ui,val,a)},queryCommandState:function(cmd){var t=this,o,s;if(t._isHidden())return;if(o=t.queryStateCommands[cmd]){s=o.func.call(o.scope);if(s!==true)return s}o=t.editorCommands.queryCommandState(cmd);if(o!==-1)return o;try{return this.getDoc().queryCommandState(cmd)}catch(ex){}},
queryCommandValue:function(c){var t=this,o,s;if(t._isHidden())return;if(o=t.queryValueCommands[c]){s=o.func.call(o.scope);if(s!==true)return s}o=t.editorCommands.queryCommandValue(c);if(is(o))return o;try{return this.getDoc().queryCommandValue(c)}catch(ex){}},show:function(){var self=this;DOM.show(self.getContainer());DOM.hide(self.id);self.load()},hide:function(){var self=this,doc=self.getDoc();if(isIE&&doc)doc.execCommand("SelectAll");self.save();DOM.hide(self.getContainer());DOM.setStyle(self.id,
"display",self.orgDisplay)},isHidden:function(){return!DOM.isHidden(this.id)},setProgressState:function(b,ti,o){this.onSetProgressState.dispatch(this,b,ti,o);return b},load:function(o){var t=this,e=t.getElement(),h;if(e){o=o||{};o.load=true;h=t.setContent(is(e.value)?e.value:e.innerHTML,o);o.element=e;if(!o.no_events)t.onLoadContent.dispatch(t,o);o.element=e=null;return h}},save:function(o){var t=this,e=t.getElement(),h,f;if(!e||!t.initialized)return;o=o||{};o.save=true;o.element=e;h=o.content=t.getContent(o);
if(!o.no_events)t.onSaveContent.dispatch(t,o);h=o.content;if(!/TEXTAREA|INPUT/i.test(e.nodeName)){e.innerHTML=h;if(f=DOM.getParent(t.id,"form"))each(f.elements,function(e){if(e.name==t.id){e.value=h;return false}})}else e.value=h;o.element=e=null;return h},setContent:function(content,args){var self=this,rootNode,body=self.getBody(),forcedRootBlockName;args=args||{};args.format=args.format||"html";args.set=true;args.content=content;if(!args.no_events)self.onBeforeSetContent.dispatch(self,args);content=
args.content;if(!tinymce.isIE&&(content.length===0||/^\s+$/.test(content))){forcedRootBlockName=self.settings.forced_root_block;if(forcedRootBlockName)content="<"+forcedRootBlockName+'><br data-mce-bogus="1"></'+forcedRootBlockName+">";else content='<br data-mce-bogus="1">';body.innerHTML=content;self.selection.select(body,true);self.selection.collapse(true);return}if(args.format!=="raw")content=(new tinymce.html.Serializer({},self.schema)).serialize(self.parser.parse(content));args.content=tinymce.trim(content);
self.dom.setHTML(body,args.content);if(!args.no_events)self.onSetContent.dispatch(self,args);if(!self.settings.content_editable||document.activeElement===self.getBody())self.selection.normalize();return args.content},getContent:function(args){var self=this,content,body=self.getBody();args=args||{};args.format=args.format||"html";args.get=true;args.getInner=true;if(!args.no_events)self.onBeforeGetContent.dispatch(self,args);if(args.format=="raw")content=body.innerHTML;else if(args.format=="text")content=
body.innerText||body.textContent;else content=self.serializer.serialize(body,args);if(args.format!="text")args.content=tinymce.trim(content);else args.content=content;if(!args.no_events)self.onGetContent.dispatch(self,args);return args.content},isDirty:function(){var self=this;return tinymce.trim(self.startContent)!=tinymce.trim(self.getContent({format:"raw",no_events:1}))&&!self.isNotDirty},getContainer:function(){var self=this;if(!self.container)self.container=DOM.get(self.editorContainer||self.id+
"_parent");return self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return DOM.get(this.settings.content_element||this.id)},getWin:function(){var self=this,elm;if(!self.contentWindow){elm=DOM.get(self.id+"_ifr");if(elm)self.contentWindow=elm.contentWindow}return self.contentWindow},getDoc:function(){var self=this,win;if(!self.contentDocument){win=self.getWin();if(win)self.contentDocument=win.document}return self.contentDocument},getBody:function(){return this.bodyElement||
this.getDoc().body},convertURL:function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback)return self.execCallback("urlconverter_callback",url,elm,true,name);if(!settings.convert_urls||elm&&elm.nodeName=="LINK"||url.indexOf("file:")===0)return url;if(settings.relative_urls)return self.documentBaseURI.toRelative(url);url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url},addVisual:function(elm){var self=this,settings=self.settings,dom=self.dom,
cls;elm=elm||self.getBody();if(!is(self.hasVisual))self.hasVisual=settings.visual;each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case "TABLE":cls=settings.visual_table_class||"mceItemTable";value=dom.getAttrib(elm,"border");if(!value||value=="0")if(self.hasVisual)dom.addClass(elm,cls);else dom.removeClass(elm,cls);return;case "A":if(!dom.getAttrib(elm,"href",false)){value=dom.getAttrib(elm,"name")||elm.id;cls="mceItemAnchor";if(value)if(self.hasVisual)dom.addClass(elm,
cls);else dom.removeClass(elm,cls)}return}});self.onVisualAid.dispatch(self,elm,self.hasVisual)},remove:function(){var self=this,elm=self.getContainer();if(!self.removed){self.removed=1;self.hide();if(!self.settings.content_editable){Event.unbind(self.getWin());Event.unbind(self.getDoc())}Event.unbind(self.getBody());Event.clear(elm);self.execCallback("remove_instance_callback",self);self.onRemove.dispatch(self);self.onExecCommand.listeners=[];tinymce.remove(self);DOM.remove(elm)}},destroy:function(s){var t=
this;if(t.destroyed)return;if(isGecko){Event.unbind(t.getDoc());Event.unbind(t.getWin());Event.unbind(t.getBody())}if(!s){tinymce.removeUnload(t.destroy);tinyMCE.onBeforeUnload.remove(t._beforeUnload);if(t.theme&&t.theme.destroy)t.theme.destroy();t.controlManager.destroy();t.selection.destroy();t.dom.destroy()}if(t.formElement){t.formElement.submit=t.formElement._mceOldSubmit;t.formElement._mceOldSubmit=null}t.contentAreaContainer=t.formElement=t.container=t.settings.content_element=t.bodyElement=
t.contentDocument=t.contentWindow=null;if(t.selection)t.selection=t.selection.win=t.selection.dom=t.selection.dom.doc=null;t.destroyed=1},_refreshContentEditable:function(){var self=this,body,parent;if(self._isHidden()){body=self.getBody();parent=body.parentNode;parent.removeChild(body);parent.appendChild(body);body.focus()}},_isHidden:function(){var s;if(!isGecko)return 0;s=this.selection.getSel();return!s||!s.rangeCount||s.rangeCount===0}})})(tinymce);
(function(tinymce){var each=tinymce.each;tinymce.Editor.prototype.setupEvents=function(){var self=this,settings=self.settings;each(["onPreInit","onBeforeRenderUI","onPostRender","onLoad","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent",
"onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onSetAttrib"],function(name){self[name]=new tinymce.util.Dispatcher(self)});if(settings.cleanup_callback){self.onBeforeSetContent.add(function(ed,o){o.content=ed.execCallback("cleanup_callback","insert_to_editor",o.content,o)});self.onPreProcess.add(function(ed,o){if(o.set)ed.execCallback("cleanup_callback","insert_to_editor_dom",o.node,o);if(o.get)ed.execCallback("cleanup_callback",
"get_from_editor_dom",o.node,o)});self.onPostProcess.add(function(ed,o){if(o.set)o.content=ed.execCallback("cleanup_callback","insert_to_editor",o.content,o);if(o.get)o.content=ed.execCallback("cleanup_callback","get_from_editor",o.content,o)})}if(settings.save_callback)self.onGetContent.add(function(ed,o){if(o.save)o.content=ed.execCallback("save_callback",ed.id,o.content,ed.getBody())});if(settings.handle_event_callback)self.onEvent.add(function(ed,e,o){if(self.execCallback("handle_event_callback",
e,ed,o)===false){e.preventDefault();e.stopPropagation()}});if(settings.handle_node_change_callback)self.onNodeChange.add(function(ed,cm,n){ed.execCallback("handle_node_change_callback",ed.id,n,-1,-1,true,ed.selection.isCollapsed())});if(settings.save_callback)self.onSaveContent.add(function(ed,o){var h=ed.execCallback("save_callback",ed.id,o.content,ed.getBody());if(h)o.content=h});if(settings.onchange_callback)self.onChange.add(function(ed,l){ed.execCallback("onchange_callback",ed,l)})};tinymce.Editor.prototype.bindNativeEvents=
function(){var self=this,i,settings=self.settings,dom=self.dom,nativeToDispatcherMap;nativeToDispatcherMap={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};function eventHandler(evt,args){var type=evt.type;if(self.removed)return;if(self.onEvent.dispatch(self,evt,args)!==false)self[nativeToDispatcherMap[evt.fakeType||evt.type]].dispatch(self,
evt,args)}function doOperaFocus(e){self.focus(true)}function nodeChanged(ed,e){if(e.keyCode!=65||!tinymce.VK.metaKeyPressed(e))self.selection.normalize();self.nodeChanged()}each(nativeToDispatcherMap,function(dispatcherName,nativeName){var root=settings.content_editable?self.getBody():self.getDoc();switch(nativeName){case "contextmenu":dom.bind(root,nativeName,eventHandler);break;case "paste":dom.bind(self.getBody(),nativeName,eventHandler);break;case "submit":case "reset":dom.bind(self.getElement().form||
tinymce.DOM.getParent(self.id,"form"),nativeName,eventHandler);break;default:dom.bind(root,nativeName,eventHandler)}});dom.bind(settings.content_editable?self.getBody():tinymce.isGecko?self.getDoc():self.getWin(),"focus",function(e){self.focus(true)});if(settings.content_editable&&tinymce.isOpera){dom.bind(self.getBody(),"click",doOperaFocus);dom.bind(self.getBody(),"keydown",doOperaFocus)}self.onMouseUp.add(nodeChanged);self.onKeyUp.add(function(ed,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=
36||keyCode>=37&&keyCode<=40||keyCode==13||keyCode==45||keyCode==46||keyCode==8||tinymce.isMac&&(keyCode==91||keyCode==93)||e.ctrlKey)nodeChanged(ed,e)});self.onReset.add(function(){self.setContent(self.startContent,{format:"raw"})});function handleShortcut(e,execute){if(e.altKey||e.ctrlKey||e.metaKey)each(self.shortcuts,function(shortcut){var ctrlState=tinymce.isMac?e.metaKey:e.ctrlKey;if(shortcut.ctrl!=ctrlState||shortcut.alt!=e.altKey||shortcut.shift!=e.shiftKey)return;if(e.keyCode==shortcut.keyCode||
e.charCode&&e.charCode==shortcut.charCode){e.preventDefault();if(execute)shortcut.func.call(shortcut.scope);return true}})}self.onKeyUp.add(function(ed,e){handleShortcut(e)});self.onKeyPress.add(function(ed,e){handleShortcut(e)});self.onKeyDown.add(function(ed,e){handleShortcut(e,true)});if(tinymce.isOpera)self.onClick.add(function(ed,e){e.preventDefault()})}})(tinymce);
(function(tinymce){var each=tinymce.each,undef,TRUE=true,FALSE=false;tinymce.EditorCommands=function(editor){var dom=editor.dom,selection=editor.selection,commands={state:{},exec:{},value:{}},settings=editor.settings,formatter=editor.formatter,bookmark;function execCommand(command,ui,value){var func;command=command.toLowerCase();if(func=commands.exec[command]){func(command,ui,value);return TRUE}return FALSE}function queryCommandState(command){var func;command=command.toLowerCase();if(func=commands.state[command])return func(command);
return-1}function queryCommandValue(command){var func;command=command.toLowerCase();if(func=commands.value[command])return func(command);return FALSE}function addCommands(command_list,type){type=type||"exec";each(command_list,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})}tinymce.extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,addCommands:addCommands});function execNativeCommand(command,
ui,value){if(ui===undef)ui=FALSE;if(value===undef)value=null;return editor.getDoc().execCommand(command,ui,value)}function isFormatMatch(name){return formatter.match(name)}function toggleFormat(name,value){formatter.toggle(name,value?{value:value}:undef)}function storeSelection(type){bookmark=selection.getBookmark(type)}function restoreSelection(){selection.moveToBookmark(bookmark)}addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},
"Cut,Copy,Paste":function(command){var doc=editor.getDoc(),failed;try{execNativeCommand(command)}catch(ex){failed=TRUE}if(failed||!doc.queryCommandSupported(command))if(tinymce.isGecko)editor.windowManager.confirm(editor.getLang("clipboard_msg"),function(state){if(state)open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")});else editor.windowManager.alert(editor.getLang("clipboard_no_support"))},unlink:function(command){if(selection.isCollapsed())selection.select(selection.getNode());
execNativeCommand(command);selection.collapse(FALSE)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var align=command.substring(7);each("left,center,right,full".split(","),function(name){if(align!=name)formatter.remove("align"+name)});toggleFormat("align"+align);execCommand("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command);listElm=dom.getParent(selection.getNode(),"ol,ul");if(listElm){listParent=listElm.parentNode;
if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){storeSelection();dom.split(listParent,listElm);restoreSelection()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;if(value>=1&&value<=7){fontSizes=tinymce.explode(settings.font_size_style_values);fontClasses=tinymce.explode(settings.font_size_classes);
if(fontClasses)value=fontClasses[value-1]||value;else value=fontSizes[value-1]||value}toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(command){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE});selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,
value){var node=value||selection.getNode();if(node!=editor.getBody()){storeSelection();editor.dom.remove(node,TRUE);restoreSelection()}},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){if(node.nodeType==1&&counter++==value){selection.select(node);return FALSE}},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){var parser,serializer,parentNode,rootNode,fragment,
args,marker,nodeRect,viewPortRect,rng,node,node2,bookmarkHtml,viewportBodyElement;parser=editor.parser;serializer=new tinymce.html.Serializer({},editor.schema);bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">\ufeff</span>';args={content:value,format:"html"};selection.onBeforeSetContent.dispatch(selection,args);value=args.content;if(value.indexOf("{$caret}")==-1)value+="{$caret}";value=value.replace(/\{\$caret\}/,bookmarkHtml);if(!selection.isCollapsed())editor.getDoc().execCommand("Delete",
false,null);parentNode=selection.getNode();args={context:parentNode.nodeName.toLowerCase()};fragment=parser.parse(value,args);node=fragment.lastChild;if(node.attr("id")=="mce_marker"){marker=node;for(node=node.prev;node;node=node.walk(true))if(node.type==3||!dom.isBlock(node.name)){node.parent.insert(marker,node,node.name==="br");break}}if(!args.invalid){value=serializer.serialize(fragment);node=parentNode.firstChild;node2=parentNode.lastChild;if(!node||node===node2&&node.nodeName==="BR")dom.setHTML(parentNode,
value);else selection.setContent(value)}else{selection.setContent(bookmarkHtml);parentNode=selection.getNode();rootNode=editor.getBody();if(parentNode.nodeType==9)parentNode=node=rootNode;else node=parentNode;while(node!==rootNode){parentNode=node;node=node.parentNode}value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode);value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)})));
if(parentNode==rootNode)dom.setHTML(rootNode,value);else dom.setOuterHTML(parentNode,value)}marker=dom.get("mce_marker");nodeRect=dom.getRect(marker);viewPortRect=dom.getViewPort(editor.getWin());if(nodeRect.y+nodeRect.h>viewPortRect.y+viewPortRect.h||nodeRect.y<viewPortRect.y||nodeRect.x>viewPortRect.x+viewPortRect.w||nodeRect.x<viewPortRect.x){viewportBodyElement=tinymce.isIE?editor.getDoc().documentElement:editor.getBody();viewportBodyElement.scrollLeft=nodeRect.x;viewportBodyElement.scrollTop=
nodeRect.y-viewPortRect.h+25}rng=dom.createRng();node=marker.previousSibling;if(node&&node.nodeType==3)rng.setStart(node,node.nodeValue.length);else{rng.setStartBefore(marker);rng.setEndBefore(marker)}dom.remove(marker);selection.setRng(rng);selection.onSetContent.dispatch(selection,args);editor.addVisual()},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker");editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,
ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation;indentUnit=/[a-z%]+$/i.exec(intentValue);intentValue=parseInt(intentValue);if(!queryCommandState("InsertUnorderedList")&&!queryCommandState("InsertOrderedList")){if(!settings.forced_root_block&&!dom.getParent(selection.getNode(),dom.isBlock))formatter.apply("div");each(selection.getSelectedBlocks(),function(element){if(command==
"outdent"){value=Math.max(0,parseInt(element.style.paddingLeft||0)-intentValue);dom.setStyle(element,"paddingLeft",value?value+indentUnit:"")}else dom.setStyle(element,"paddingLeft",parseInt(element.style.paddingLeft||0)+intentValue+indentUnit)})}else execNativeCommand(command)},mceRepaint:function(){var bookmark;if(tinymce.isGecko)try{storeSelection(TRUE);if(selection.getSel())selection.getSel().selectAllChildren(editor.getBody());selection.collapse(TRUE);restoreSelection()}catch(ex){}},mceToggleFormat:function(command,
ui,value){formatter.toggle(value)},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual;editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",false,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;if(typeof value=="string")value={href:value};anchor=dom.getParent(selection.getNode(),
"a");value.href=value.href.replace(" ","%20");if(!anchor||!value.href)formatter.remove("link");if(value.href)formatter.apply("link",value,anchor)},selectAll:function(){var root=dom.getRoot(),rng=dom.createRng();if(selection.getRng().setStart){rng.setStart(root,0);rng.setEnd(root,root.childNodes.length);selection.setRng(rng)}else execNativeCommand("SelectAll")}});addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7);var nodes=selection.isCollapsed()?
[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks();var matches=tinymce.map(nodes,function(node){return!!formatter.matchNode(node,name)});return tinymce.inArray(matches,TRUE)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft)>
0)return TRUE;if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft)>0)return TRUE}return queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&(command==="insertunorderedlist"&&list.tagName==="UL"||command==="insertorderedlist"&&list.tagName===
"OL")}},"state");addCommands({"FontSize,FontName":function(command){var value=0,parent;if(parent=dom.getParent(selection.getNode(),"span"))if(command=="fontsize")value=parent.style.fontSize;else value=parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return value}},"value");addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher;tinymce.UndoManager=function(editor){var self,index=0,data=[],beforeBookmark,onAdd,onUndo,onRedo;function getContent(){return tinymce.trim(editor.getContent({format:"raw",no_events:1}).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""))}function addNonTypingUndoLevel(){self.typing=false;self.add()}onBeforeAdd=new Dispatcher(self);onAdd=new Dispatcher(self);onUndo=new Dispatcher(self);onRedo=new Dispatcher(self);onAdd.add(function(undoman,
level){if(undoman.hasUndo())return editor.onChange.dispatch(editor,level,undoman)});onUndo.add(function(undoman,level){return editor.onUndo.dispatch(editor,level,undoman)});onRedo.add(function(undoman,level){return editor.onRedo.dispatch(editor,level,undoman)});editor.onInit.add(function(){self.add()});editor.onBeforeExecCommand.add(function(ed,cmd,ui,val,args){if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"&&(!args||!args.skip_undo))self.beforeChange()});editor.onExecCommand.add(function(ed,cmd,ui,
val,args){if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"&&(!args||!args.skip_undo))self.add()});editor.onSaveContent.add(addNonTypingUndoLevel);editor.dom.bind(editor.dom.getRoot(),"dragend",addNonTypingUndoLevel);editor.dom.bind(editor.getDoc(),tinymce.isGecko?"blur":"focusout",function(e){if(!editor.removed&&self.typing)addNonTypingUndoLevel()});editor.onKeyUp.add(function(editor,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode==45||keyCode==13||e.ctrlKey)addNonTypingUndoLevel()});
editor.onKeyDown.add(function(editor,e){var keyCode=e.keyCode;if(keyCode>=33&&keyCode<=36||keyCode>=37&&keyCode<=40||keyCode==45){if(self.typing)addNonTypingUndoLevel();return}if((keyCode<16||keyCode>20)&&keyCode!=224&&keyCode!=91&&!self.typing){self.beforeChange();self.typing=true;self.add()}});editor.onMouseDown.add(function(editor,e){if(self.typing)addNonTypingUndoLevel()});editor.addShortcut("ctrl+z","undo_desc","Undo");editor.addShortcut("ctrl+y","redo_desc","Redo");self={data:data,typing:false,
onBeforeAdd:onBeforeAdd,onAdd:onAdd,onUndo:onUndo,onRedo:onRedo,beforeChange:function(){beforeBookmark=editor.selection.getBookmark(2,true)},add:function(level){var i,settings=editor.settings,lastLevel;level=level||{};level.content=getContent();self.onBeforeAdd.dispatch(self,level);lastLevel=data[index];if(lastLevel&&lastLevel.content==level.content)return null;if(data[index])data[index].beforeBookmark=beforeBookmark;if(settings.custom_undo_redo_levels)if(data.length>settings.custom_undo_redo_levels){for(i=
0;i<data.length-1;i++)data[i]=data[i+1];data.length--;index=data.length}level.bookmark=editor.selection.getBookmark(2,true);if(index<data.length-1)data.length=index+1;data.push(level);index=data.length-1;self.onAdd.dispatch(self,level);editor.isNotDirty=0;return level},undo:function(){var level,i;if(self.typing){self.add();self.typing=false}if(index>0){level=data[--index];editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.beforeBookmark);self.onUndo.dispatch(self,
level)}return level},redo:function(){var level;if(index<data.length-1){level=data[++index];editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.bookmark);self.onRedo.dispatch(self,level)}return level},clear:function(){data=[];index=0;self.typing=false},hasUndo:function(){return index>0||this.typing},hasRedo:function(){return index<data.length-1&&!this.typing}};return self}})(tinymce);
tinymce.ForceBlocks=function(editor){var settings=editor.settings,dom=editor.dom,selection=editor.selection,blockElements=editor.schema.getBlockElements();function addRootBlocks(){var node=selection.getStart(),rootNode=editor.getBody(),rng,startContainer,startOffset,endContainer,endOffset,rootBlockNode,tempNode,offset=-16777215,wrapped,isInEditorDocument;if(!node||node.nodeType!==1||!settings.forced_root_block)return;while(node&&node!=rootNode){if(blockElements[node.nodeName])return;node=node.parentNode}rng=
selection.getRng();if(rng.setStart){startContainer=rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset}else{if(rng.item){node=rng.item(0);rng=editor.getDoc().body.createTextRange();rng.moveToElementText(node)}isInEditorDocument=rng.parentElement().ownerDocument===editor.getDoc();tmpRng=rng.duplicate();tmpRng.collapse(true);startOffset=tmpRng.move("character",offset)*-1;if(!tmpRng.collapsed){tmpRng=rng.duplicate();tmpRng.collapse(false);endOffset=tmpRng.move("character",
offset)*-1-startOffset}}node=rootNode.firstChild;while(node)if(node.nodeType===3||node.nodeType==1&&!blockElements[node.nodeName]){if(node.nodeType===3&&node.nodeValue.length==0){tempNode=node;node=node.nextSibling;dom.remove(tempNode);continue}if(!rootBlockNode){rootBlockNode=dom.create(settings.forced_root_block);node.parentNode.insertBefore(rootBlockNode,node);wrapped=true}tempNode=node;node=node.nextSibling;rootBlockNode.appendChild(tempNode)}else{rootBlockNode=null;node=node.nextSibling}if(wrapped){if(rng.setStart){rng.setStart(startContainer,
startOffset);rng.setEnd(endContainer,endOffset);selection.setRng(rng)}else if(isInEditorDocument)try{rng=editor.getDoc().body.createTextRange();rng.moveToElementText(rootNode);rng.collapse(true);rng.moveStart("character",startOffset);if(endOffset>0)rng.moveEnd("character",endOffset);rng.select()}catch(ex){}editor.nodeChanged()}}if(settings.forced_root_block){editor.onKeyUp.add(addRootBlocks);editor.onNodeChange.add(addRootBlocks)}};
(function(tinymce){var DOM=tinymce.DOM,Event=tinymce.dom.Event,each=tinymce.each,extend=tinymce.extend;tinymce.create("tinymce.ControlManager",{ControlManager:function(ed,s){var t=this,i;s=s||{};t.editor=ed;t.controls={};t.onAdd=new tinymce.util.Dispatcher(t);t.onPostRender=new tinymce.util.Dispatcher(t);t.prefix=s.prefix||ed.id+"_";t._cls={};t.onPostRender.add(function(){each(t.controls,function(c){c.postRender()})})},get:function(id){return this.controls[this.prefix+id]||this.controls[id]},setActive:function(id,
s){var c=null;if(c=this.get(id))c.setActive(s);return c},setDisabled:function(id,s){var c=null;if(c=this.get(id))c.setDisabled(s);return c},add:function(c){var t=this;if(c){t.controls[c.id]=c;t.onAdd.dispatch(c,t)}return c},createControl:function(name){var ctrl,i,l,self=this,editor=self.editor,factories,ctrlName;if(!self.controlFactories){self.controlFactories=[];each(editor.plugins,function(plugin){if(plugin.createControl)self.controlFactories.push(plugin)})}factories=self.controlFactories;for(i=
0,l=factories.length;i<l;i++){ctrl=factories[i].createControl(name,self);if(ctrl)return self.add(ctrl)}if(name==="|"||name==="separator")return self.createSeparator();if(editor.buttons&&(ctrl=editor.buttons[name]))return self.createButton(name,ctrl);return self.add(ctrl)},createDropMenu:function(id,s,cc){var t=this,ed=t.editor,c,bm,v,cls;s=extend({"class":"mceDropDown",constrain:ed.settings.constrain_menus},s);s["class"]=s["class"]+" "+ed.getParam("skin")+"Skin";if(v=ed.getParam("skin_variant"))s["class"]+=
" "+ed.getParam("skin")+"Skin"+v.substring(0,1).toUpperCase()+v.substring(1);s["class"]+=ed.settings.directionality=="rtl"?" mceRtl":"";id=t.prefix+id;cls=cc||t._cls.dropmenu||tinymce.ui.DropMenu;c=t.controls[id]=new cls(id,s);c.onAddItem.add(function(c,o){var s=o.settings;s.title=ed.getLang(s.title,s.title);if(!s.onclick)s.onclick=function(v){if(s.cmd)ed.execCommand(s.cmd,s.ui||false,s.value)}});ed.onRemove.add(function(){c.destroy()});if(tinymce.isIE){c.onShowMenu.add(function(){ed.focus();bm=ed.selection.getBookmark(1)});
c.onHideMenu.add(function(){if(bm){ed.selection.moveToBookmark(bm);bm=0}})}return t.add(c)},createListBox:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+id,scope:s.scope,control_manager:t},s);id=t.prefix+id;function useNativeListForAccessibility(ed){return ed.settings.use_accessible_selects&&!tinymce.isGecko}
if(ed.settings.use_native_selects||useNativeListForAccessibility(ed))c=new tinymce.ui.NativeListBox(id,s);else{cls=cc||t._cls.listbox||tinymce.ui.ListBox;c=new cls(id,s,ed)}t.controls[id]=c;if(tinymce.isWebKit)c.onPostRender.add(function(c,n){Event.add(n,"mousedown",function(){ed.bookmark=ed.selection.getBookmark(1)});Event.add(n,"focus",function(){ed.selection.moveToBookmark(ed.bookmark);ed.bookmark=null})});if(c.hideMenu)ed.onMouseDown.add(c.hideMenu,c);return t.add(c)},createButton:function(id,
s,cc){var t=this,ed=t.editor,o,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.label=ed.translate(s.label);s.scope=s.scope||ed;if(!s.onclick&&!s.menu_button)s.onclick=function(){ed.execCommand(s.cmd,s.ui||false,s.value)};s=extend({title:s.title,"class":"mce_"+id,unavailable_prefix:ed.getLang("unavailable",""),scope:s.scope,control_manager:t},s);id=t.prefix+id;if(s.menu_button){cls=cc||t._cls.menubutton||tinymce.ui.MenuButton;c=new cls(id,s,ed);ed.onMouseDown.add(c.hideMenu,c)}else{cls=
t._cls.button||tinymce.ui.Button;c=new cls(id,s,ed)}return t.add(c)},createMenuButton:function(id,s,cc){s=s||{};s.menu_button=1;return this.createButton(id,s,cc)},createSplitButton:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onclick)s.onclick=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+
id,scope:s.scope,control_manager:t},s);id=t.prefix+id;cls=cc||t._cls.splitbutton||tinymce.ui.SplitButton;c=t.add(new cls(id,s,ed));ed.onMouseDown.add(c.hideMenu,c);return c},createColorSplitButton:function(id,s,cc){var t=this,ed=t.editor,cmd,c,cls,bm;if(t.get(id))return null;s.title=ed.translate(s.title);s.scope=s.scope||ed;if(!s.onclick)s.onclick=function(v){if(tinymce.isIE)bm=ed.selection.getBookmark(1);ed.execCommand(s.cmd,s.ui||false,v||s.value)};if(!s.onselect)s.onselect=function(v){ed.execCommand(s.cmd,
s.ui||false,v||s.value)};s=extend({title:s.title,"class":"mce_"+id,"menu_class":ed.getParam("skin")+"Skin",scope:s.scope,more_colors_title:ed.getLang("more_colors")},s);id=t.prefix+id;cls=cc||t._cls.colorsplitbutton||tinymce.ui.ColorSplitButton;c=new cls(id,s,ed);ed.onMouseDown.add(c.hideMenu,c);ed.onRemove.add(function(){c.destroy()});if(tinymce.isIE){c.onShowMenu.add(function(){ed.focus();bm=ed.selection.getBookmark(1)});c.onHideMenu.add(function(){if(bm){ed.selection.moveToBookmark(bm);bm=0}})}return t.add(c)},
createToolbar:function(id,s,cc){var c,t=this,cls;id=t.prefix+id;cls=cc||t._cls.toolbar||tinymce.ui.Toolbar;c=new cls(id,s,t.editor);if(t.get(id))return null;return t.add(c)},createToolbarGroup:function(id,s,cc){var c,t=this,cls;id=t.prefix+id;cls=cc||this._cls.toolbarGroup||tinymce.ui.ToolbarGroup;c=new cls(id,s,t.editor);if(t.get(id))return null;return t.add(c)},createSeparator:function(cc){var cls=cc||this._cls.separator||tinymce.ui.Separator;return new cls},setControlType:function(n,c){return this._cls[n.toLowerCase()]=
c},destroy:function(){each(this.controls,function(c){c.destroy()});this.controls=null}})})(tinymce);
(function(tinymce){var Dispatcher=tinymce.util.Dispatcher,each=tinymce.each,isIE=tinymce.isIE,isOpera=tinymce.isOpera;tinymce.create("tinymce.WindowManager",{WindowManager:function(ed){var t=this;t.editor=ed;t.onOpen=new Dispatcher(t);t.onClose=new Dispatcher(t);t.params={};t.features={}},open:function(s,p){var t=this,f="",x,y,mo=t.editor.settings.dialog_type=="modal",w,sw,sh,vp=tinymce.DOM.getViewPort(),u;s=s||{};p=p||{};sw=isOpera?vp.w:screen.width;sh=isOpera?vp.h:screen.height;s.name=s.name||"mc_"+
(new Date).getTime();s.width=parseInt(s.width||320);s.height=parseInt(s.height||240);s.resizable=true;s.left=s.left||parseInt(sw/2)-s.width/2;s.top=s.top||parseInt(sh/2)-s.height/2;p.inline=false;p.mce_width=s.width;p.mce_height=s.height;p.mce_auto_focus=s.auto_focus;if(mo)if(isIE){s.center=true;s.help=false;s.dialogWidth=s.width+"px";s.dialogHeight=s.height+"px";s.scroll=s.scrollbars||false}each(s,function(v,k){if(tinymce.is(v,"boolean"))v=v?"yes":"no";if(!/^(name|url)$/.test(k))if(isIE&&mo)f+=(f?
";":"")+k+":"+v;else f+=(f?",":"")+k+"="+v});t.features=s;t.params=p;t.onOpen.dispatch(t,s,p);u=s.url||s.file;u=tinymce._addVer(u);try{if(isIE&&mo){w=1;window.showModalDialog(u,window,f)}else w=window.open(u,s.name,f)}catch(ex){}if(!w)alert(t.editor.getLang("popup_blocked"))},close:function(w){w.close();this.onClose.dispatch(this)},createInstance:function(cl,a,b,c,d,e){var f=tinymce.resolve(cl);return new f(a,b,c,d,e)},confirm:function(t,cb,s,w){w=w||window;cb.call(s||this,w.confirm(this._decode(this.editor.getLang(t,
t))))},alert:function(tx,cb,s,w){var t=this;w=w||window;w.alert(t._decode(t.editor.getLang(tx,tx)));if(cb)cb.call(s||t)},resizeBy:function(dw,dh,win){win.resizeBy(dw,dh)},_decode:function(s){return tinymce.DOM.decode(s).replace(/\\n/g,"\n")}})})(tinymce);
(function(tinymce){tinymce.Formatter=function(ed){var formats={},each=tinymce.each,dom=ed.dom,selection=ed.selection,TreeWalker=tinymce.dom.TreeWalker,rangeUtils=new tinymce.dom.RangeUtils(dom),isValid=ed.schema.isValidChild,isBlock=dom.isBlock,forcedRootBlock=ed.settings.forced_root_block,nodeIndex=dom.nodeIndex,INVISIBLE_CHAR="\ufeff",MCE_ATTR_RE=/^(src|href|style)$/,FALSE=false,TRUE=true,formatChangeData,undef,getContentEditable=dom.getContentEditable;function isArray(obj){return obj instanceof
Array}function getParents(node,selector){return dom.getParents(node,selector,dom.getRoot())}function isCaretNode(node){return node.nodeType===1&&node.id==="_mce_caret"}function defaultFormats(){register({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},
{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignfull:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",
remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},
wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(node){return true},onformat:function(elm,fmt,vars){each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",
remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});each("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(name){register(name,{block:name,remove:"all"})});register(ed.settings.formats)}function addKeyboardShortcuts(){ed.addShortcut("ctrl+b","bold_desc","Bold");ed.addShortcut("ctrl+i",
"italic_desc","Italic");ed.addShortcut("ctrl+u","underline_desc","Underline");for(var i=1;i<=6;i++)ed.addShortcut("ctrl+"+i,"",["FormatBlock",false,"h"+i]);ed.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);ed.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);ed.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function get(name){return name?formats[name]:formats}function register(name,format){if(name)if(typeof name!=="string")each(name,function(format,name){register(name,format)});else{format=
format.length?format:[format];each(format,function(format){if(format.deep===undef)format.deep=!format.selector;if(format.split===undef)format.split=!format.selector||format.inline;if(format.remove===undef&&format.selector&&!format.inline)format.remove="none";if(format.selector&&format.inline){format.mixed=true;format.block_expand=true}if(typeof format.classes==="string")format.classes=format.classes.split(/\s+/)});formats[name]=format}}var getTextDecoration=function(node){var decoration;ed.dom.getParent(node,
function(n){decoration=ed.dom.getStyle(n,"text-decoration");return decoration&&decoration!=="none"});return decoration};var processUnderlineAndColor=function(node){var textDecoration;if(node.nodeType===1&&node.parentNode&&node.parentNode.nodeType===1){textDecoration=getTextDecoration(node.parentNode);if(ed.dom.getStyle(node,"color")&&textDecoration)ed.dom.setStyle(node,"text-decoration",textDecoration);else if(ed.dom.getStyle(node,"textdecoration")===textDecoration)ed.dom.setStyle(node,"text-decoration",
null)}};function apply(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,rng,i,isCollapsed=selection.isCollapsed();function setElementFormat(elm,fmt){fmt=fmt||format;if(elm){if(fmt.onformat)fmt.onformat(elm,fmt,vars,node);each(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))});each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))});each(fmt.classes,function(value){value=replaceVars(value,vars);if(!dom.hasClass(elm,
value))dom.addClass(elm,value)})}}function adjustSelectionToVisibleSelection(){function findSelectionEnd(start,end){var walker=new TreeWalker(end);for(node=walker.current();node;node=walker.prev())if(node.childNodes.length>1||node==start||node.tagName=="BR")return node}var rng=ed.selection.getRng();var start=rng.startContainer;var end=rng.endContainer;if(start!=end&&rng.endOffset===0){var newEnd=findSelectionEnd(start,end);var endOffset=newEnd.nodeType==3?newEnd.length:newEnd.childNodes.length;rng.setEnd(newEnd,
endOffset)}return rng}function applyStyleToList(node,bookmark,wrapElm,newWrappers,process){var nodes=[],listIndex=-1,list,startIndex=-1,endIndex=-1,currentWrapElm;each(node.childNodes,function(n,index){if(n.nodeName==="UL"||n.nodeName==="OL"){listIndex=index;list=n;return false}});each(node.childNodes,function(n,index){if(n.nodeName==="SPAN"&&dom.getAttrib(n,"data-mce-type")=="bookmark")if(n.id==bookmark.id+"_start")startIndex=index;else if(n.id==bookmark.id+"_end")endIndex=index});if(listIndex<=
0||startIndex<listIndex&&endIndex>listIndex){each(tinymce.grep(node.childNodes),process);return 0}else{currentWrapElm=dom.clone(wrapElm,FALSE);each(tinymce.grep(node.childNodes),function(n,index){if(startIndex<listIndex&&index<listIndex||startIndex>listIndex&&index>listIndex){nodes.push(n);n.parentNode.removeChild(n)}});if(startIndex<listIndex)node.insertBefore(currentWrapElm,list);else if(startIndex>listIndex)node.insertBefore(currentWrapElm,list.nextSibling);newWrappers.push(currentWrapElm);each(nodes,
function(node){currentWrapElm.appendChild(node)});return currentWrapElm}}function applyRngStyle(rng,bookmark,node_specific){var newWrappers=[],wrapName,wrapElm,contentEditable=true;wrapName=format.inline||format.block;wrapElm=dom.create(wrapName);setElementFormat(wrapElm);rangeUtils.walk(rng,function(nodes){var currentWrapElm;function process(node){var nodeName,parentName,found,hasContentEditableState,lastContentEditable;lastContentEditable=contentEditable;nodeName=node.nodeName.toLowerCase();parentName=
node.parentNode.nodeName.toLowerCase();if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}if(isEq(nodeName,"br")){currentWrapElm=0;if(format.block)dom.remove(node);return}if(format.wrapper&&matchNode(node,name,vars)){currentWrapElm=0;return}if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock(nodeName)){node=dom.rename(node,wrapName);setElementFormat(node);
newWrappers.push(node);currentWrapElm=0;return}if(format.selector){each(formatList,function(format){if("collapsed"in format&&format.collapsed!==isCollapsed)return;if(dom.is(node,format.selector)&&!isCaretNode(node)){setElementFormat(node,format);found=true}});if(!format.inline||found){currentWrapElm=0;return}}if(contentEditable&&!hasContentEditableState&&isValid(wrapName,nodeName)&&isValid(parentName,wrapName)&&!(!node_specific&&node.nodeType===3&&node.nodeValue.length===1&&node.nodeValue.charCodeAt(0)===
65279)&&!isCaretNode(node)){if(!currentWrapElm){currentWrapElm=dom.clone(wrapElm,FALSE);node.parentNode.insertBefore(currentWrapElm,node);newWrappers.push(currentWrapElm)}currentWrapElm.appendChild(node)}else if(nodeName=="li"&&bookmark)currentWrapElm=applyStyleToList(node,bookmark,wrapElm,newWrappers,process);else{currentWrapElm=0;each(tinymce.grep(node.childNodes),process);if(hasContentEditableState)contentEditable=lastContentEditable;currentWrapElm=0}}each(nodes,process)});if(format.wrap_links===
false)each(newWrappers,function(node){function process(node){var i,currentWrapElm,children;if(node.nodeName==="A"){currentWrapElm=dom.clone(wrapElm,FALSE);newWrappers.push(currentWrapElm);children=tinymce.grep(node.childNodes);for(i=0;i<children.length;i++)currentWrapElm.appendChild(children[i]);node.appendChild(currentWrapElm)}each(tinymce.grep(node.childNodes),process)}process(node)});each(newWrappers,function(node){var childCount;function getChildCount(node){var count=0;each(node.childNodes,function(node){if(!isWhiteSpaceNode(node)&&
!isBookmarkNode(node))count++});return count}function mergeStyles(node){var child,clone;each(node.childNodes,function(node){if(node.nodeType==1&&!isBookmarkNode(node)&&!isCaretNode(node)){child=node;return FALSE}});if(child&&matchName(child,format)){clone=dom.clone(child,FALSE);setElementFormat(clone);dom.replace(clone,node,TRUE);dom.remove(child,1)}return clone||node}childCount=getChildCount(node);if((newWrappers.length>1||!isBlock(node))&&childCount===0){dom.remove(node,1);return}if(format.inline||
format.wrapper){if(!format.exact&&childCount===1)node=mergeStyles(node);each(formatList,function(format){each(dom.select(format.inline,node),function(child){var parent;if(format.wrap_links===false){parent=child.parentNode;do if(parent.nodeName==="A")return;while(parent=parent.parentNode)}removeFormat(format,vars,child,format.exact?child:null)})});if(matchNode(node.parentNode,name,vars)){dom.remove(node,1);node=0;return TRUE}if(format.merge_with_parents)dom.getParent(node.parentNode,function(parent){if(matchNode(parent,
name,vars)){dom.remove(node,1);node=0;return TRUE}});if(node&&format.merge_siblings!==false){node=mergeSiblings(getNonWhiteSpaceSibling(node),node);node=mergeSiblings(node,getNonWhiteSpaceSibling(node,TRUE))}}})}if(format)if(node)if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);applyRngStyle(expandRng(rng,formatList),null,true)}else applyRngStyle(node,null,true);else if(!isCollapsed||!format.inline||dom.select("td.mceSelected,th.mceSelected").length){var curSelNode=
ed.selection.getNode();if(!forcedRootBlock&&formatList[0].defaultBlock&&!dom.getParent(curSelNode,dom.isBlock))apply(formatList[0].defaultBlock);ed.selection.setRng(adjustSelectionToVisibleSelection());bookmark=selection.getBookmark();applyRngStyle(expandRng(selection.getRng(TRUE),formatList),bookmark);if(format.styles&&(format.styles.color||format.styles.textDecoration)){tinymce.walk(curSelNode,processUnderlineAndColor,"childNodes");processUnderlineAndColor(curSelNode)}selection.moveToBookmark(bookmark);
moveStart(selection.getRng(TRUE));ed.nodeChanged()}else performCaretAction("apply",name,vars)}function remove(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,i,rng,contentEditable=true;function process(node){var children,i,l,localContentEditable,lastContentEditable,hasContentEditableState;if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}children=tinymce.grep(node.childNodes);
if(contentEditable&&!hasContentEditableState)for(i=0,l=formatList.length;i<l;i++)if(removeFormat(formatList[i],vars,node,node))break;if(format.deep)if(children.length){for(i=0,l=children.length;i<l;i++)process(children[i]);if(hasContentEditableState)contentEditable=lastContentEditable}}function findFormatRoot(container){var formatRoot;each(getParents(container.parentNode).reverse(),function(parent){var format;if(!formatRoot&&parent.id!="_start"&&parent.id!="_end"){format=matchNode(parent,name,vars);
if(format&&format.split!==false)formatRoot=parent}});return formatRoot}function wrapAndSplit(format_root,container,target,split){var parent,clone,lastClone,firstClone,i,formatRootParent;if(format_root){formatRootParent=format_root.parentNode;for(parent=container.parentNode;parent&&parent!=formatRootParent;parent=parent.parentNode){clone=dom.clone(parent,FALSE);for(i=0;i<formatList.length;i++)if(removeFormat(formatList[i],vars,clone,clone)){clone=0;break}if(clone){if(lastClone)clone.appendChild(lastClone);
if(!firstClone)firstClone=clone;lastClone=clone}}if(split&&(!format.mixed||!isBlock(format_root)))container=dom.split(format_root,container);if(lastClone){target.parentNode.insertBefore(lastClone,target);firstClone.appendChild(target)}}return container}function splitToFormatRoot(container){return wrapAndSplit(findFormatRoot(container),container,container,true)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];if(isBookmarkNode(out))out=out[start?
"firstChild":"lastChild"];dom.remove(node,true);return out}function removeRngStyle(rng){var startContainer,endContainer,node;rng=expandRng(rng,formatList,TRUE);if(format.split){startContainer=getContainer(rng,TRUE);endContainer=getContainer(rng);if(startContainer!=endContainer){if(/^(TR|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild)startContainer=(startContainer.nodeName=="TD"?startContainer.firstChild:startContainer.firstChild.firstChild)||startContainer;startContainer=wrap(startContainer,
"span",{id:"_start","data-mce-type":"bookmark"});endContainer=wrap(endContainer,"span",{id:"_end","data-mce-type":"bookmark"});splitToFormatRoot(startContainer);splitToFormatRoot(endContainer);startContainer=unwrap(TRUE);endContainer=unwrap()}else startContainer=endContainer=splitToFormatRoot(startContainer);rng.startContainer=startContainer.parentNode;rng.startOffset=nodeIndex(startContainer);rng.endContainer=endContainer.parentNode;rng.endOffset=nodeIndex(endContainer)+1}rangeUtils.walk(rng,function(nodes){each(nodes,
function(node){process(node);if(node.nodeType===1&&ed.dom.getStyle(node,"text-decoration")==="underline"&&node.parentNode&&getTextDecoration(node.parentNode)==="underline")removeFormat({"deep":false,"exact":true,"inline":"span","styles":{"textDecoration":"underline"}},null,node)})})}if(node){if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);removeRngStyle(rng)}else removeRngStyle(node);return}if(!selection.isCollapsed()||!format.inline||dom.select("td.mceSelected,th.mceSelected").length){bookmark=
selection.getBookmark();removeRngStyle(selection.getRng(TRUE));selection.moveToBookmark(bookmark);if(format.inline&&match(name,vars,selection.getStart()))moveStart(selection.getRng(true));ed.nodeChanged()}else performCaretAction("remove",name,vars)}function toggle(name,vars,node){var fmt=get(name);if(match(name,vars,node)&&(!("toggle"in fmt[0])||fmt[0].toggle))remove(name,vars,node);else apply(name,vars,node)}function matchNode(node,name,vars,similar){var formatList=get(name),format,i,classes;function matchItems(node,
format,item_name){var key,value,items=format[item_name],i;if(format.onmatch)return format.onmatch(node,format,item_name);if(items)if(items.length===undef)for(key in items){if(items.hasOwnProperty(key)){if(item_name==="attributes")value=dom.getAttrib(node,key);else value=getStyle(node,key);if(similar&&!value&&!format.exact)return;if((!similar||format.exact)&&!isEq(value,replaceVars(items[key],vars)))return}}else for(i=0;i<items.length;i++)if(item_name==="attributes"?dom.getAttrib(node,items[i]):getStyle(node,
items[i]))return format;return format}if(formatList&&node)for(i=0;i<formatList.length;i++){format=formatList[i];if(matchName(node,format)&&matchItems(node,format,"attributes")&&matchItems(node,format,"styles")){if(classes=format.classes)for(i=0;i<classes.length;i++)if(!dom.hasClass(node,classes[i]))return;return format}}}function match(name,vars,node){var startNode;function matchParents(node){node=dom.getParent(node,function(node){return!!matchNode(node,name,vars,true)});return matchNode(node,name,
vars)}if(node)return matchParents(node);node=selection.getNode();if(matchParents(node))return TRUE;startNode=selection.getStart();if(startNode!=node)if(matchParents(startNode))return TRUE;return FALSE}function matchAll(names,vars){var startElement,matchedFormatNames=[],checkedMap={},i,ni,name;startElement=selection.getStart();dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++){name=names[i];if(!checkedMap[name]&&matchNode(node,name,vars)){checkedMap[name]=true;matchedFormatNames.push(name)}}},
dom.getRoot());return matchedFormatNames}function canApply(name){var formatList=get(name),startNode,parents,i,x,selector;if(formatList){startNode=selection.getStart();parents=getParents(startNode);for(x=formatList.length-1;x>=0;x--){selector=formatList[x].selector;if(!selector)return TRUE;for(i=parents.length-1;i>=0;i--)if(dom.is(parents[i],selector))return TRUE}}return FALSE}function formatChanged(formats,callback,similar){var currentFormats;if(!formatChangeData){formatChangeData={};currentFormats=
{};ed.onNodeChange.addToTop(function(ed,cm,node){var parents=getParents(node),matchedFormats={};each(formatChangeData,function(callbacks,format){each(parents,function(node){if(matchNode(node,format,{},callbacks.similar)){if(!currentFormats[format]){each(callbacks,function(callback){callback(true,{node:node,format:format,parents:parents})});currentFormats[format]=callbacks}matchedFormats[format]=callbacks;return false}})});each(currentFormats,function(callbacks,format){if(!matchedFormats[format]){delete currentFormats[format];
each(callbacks,function(callback){callback(false,{node:node,format:format,parents:parents})})}})})}each(formats.split(","),function(format){if(!formatChangeData[format]){formatChangeData[format]=[];formatChangeData[format].similar=similar}formatChangeData[format].push(callback)});return this}tinymce.extend(this,{get:get,register:register,apply:apply,remove:remove,toggle:toggle,match:match,matchAll:matchAll,matchNode:matchNode,canApply:canApply,formatChanged:formatChanged});defaultFormats();addKeyboardShortcuts();
function matchName(node,format){if(isEq(node,format.inline))return TRUE;if(isEq(node,format.block))return TRUE;if(format.selector)return dom.is(node,format.selector)}function isEq(str1,str2){str1=str1||"";str2=str2||"";str1=""+(str1.nodeName||str1);str2=""+(str2.nodeName||str2);return str1.toLowerCase()==str2.toLowerCase()}function getStyle(node,name){var styleVal=dom.getStyle(node,name);if(name=="color"||name=="backgroundColor")styleVal=dom.toHex(styleVal);if(name=="fontWeight"&&styleVal==700)styleVal=
"bold";return""+styleVal}function replaceVars(value,vars){if(typeof value!="string")value=value(vars);else if(vars)value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str});return value}function isWhiteSpaceNode(node){return node&&node.nodeType===3&&/^([\t \r\n]+|)$/.test(node.nodeValue)}function wrap(node,name,attrs){var wrapper=dom.create(name,attrs);node.parentNode.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper}function expandRng(rng,format,remove){var sibling,
lastIdx,leaf,endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;function findParentContainer(start){var container,parent,child,sibling,siblingName,root;container=parent=start?startContainer:endContainer;siblingName=start?"previousSibling":"nextSibling";root=dom.getRoot();if(container.nodeType==3&&!isWhiteSpaceNode(container))if(start?startOffset>0:endOffset<container.nodeValue.length)return container;for(;;){if(!format[0].block_expand&&
isBlock(parent))return parent;for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName])if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling))return parent;if(parent.parentNode==root){container=parent;break}parent=parent.parentNode}return container}function findLeaf(node,offset){if(offset===undef)offset=node.nodeType===3?node.length:node.childNodes.length;while(node&&node.hasChildNodes()){node=node.childNodes[offset];if(node)offset=node.nodeType===3?node.length:node.childNodes.length}return{node:node,
offset:offset}}if(startContainer.nodeType==1&&startContainer.hasChildNodes()){lastIdx=startContainer.childNodes.length-1;startContainer=startContainer.childNodes[startOffset>lastIdx?lastIdx:startOffset];if(startContainer.nodeType==3)startOffset=0}if(endContainer.nodeType==1&&endContainer.hasChildNodes()){lastIdx=endContainer.childNodes.length-1;endContainer=endContainer.childNodes[endOffset>lastIdx?lastIdx:endOffset-1];if(endContainer.nodeType==3)endOffset=endContainer.nodeValue.length}function findParentContentEditable(node){var parent=
node;while(parent){if(parent.nodeType===1&&getContentEditable(parent))return getContentEditable(parent)==="false"?parent:node;parent=parent.parentNode}return node}function findWordEndPoint(container,offset,start){var walker,node,pos,lastTextNode;function findSpace(node,offset){var pos,pos2,str=node.nodeValue;if(typeof offset=="undefined")offset=start?str.length:0;if(start){pos=str.lastIndexOf(" ",offset);pos2=str.lastIndexOf("\u00a0",offset);pos=pos>pos2?pos:pos2;if(pos!==-1&&!remove)pos++}else{pos=
str.indexOf(" ",offset);pos2=str.indexOf("\u00a0",offset);pos=pos!==-1&&(pos2===-1||pos<pos2)?pos:pos2}return pos}if(container.nodeType===3){pos=findSpace(container,offset);if(pos!==-1)return{container:container,offset:pos};lastTextNode=container}walker=new TreeWalker(container,dom.getParent(container,isBlock)||ed.getBody());while(node=walker[start?"prev":"next"]())if(node.nodeType===3){lastTextNode=node;pos=findSpace(node);if(pos!==-1)return{container:node,offset:pos}}else if(isBlock(node))break;
if(lastTextNode){if(start)offset=0;else offset=lastTextNode.length;return{container:lastTextNode,offset:offset}}}function findSelectorEndPoint(container,sibling_name){var parents,i,y,curFormat;if(container.nodeType==3&&container.nodeValue.length===0&&container[sibling_name])container=container[sibling_name];parents=getParents(container);for(i=0;i<parents.length;i++)for(y=0;y<format.length;y++){curFormat=format[y];if("collapsed"in curFormat&&curFormat.collapsed!==rng.collapsed)continue;if(dom.is(parents[i],
curFormat.selector))return parents[i]}return container}function findBlockEndPoint(container,sibling_name,sibling_name2){var node;if(!format[0].wrapper)node=dom.getParent(container,format[0].block);if(!node)node=dom.getParent(container.nodeType==3?container.parentNode:container,isBlock);if(node&&format[0].wrapper)node=getParents(node,"ul,ol").reverse()[0]||node;if(!node){node=container;while(node[sibling_name]&&!isBlock(node[sibling_name])){node=node[sibling_name];if(isEq(node,"br"))break}}return node||
container}startContainer=findParentContentEditable(startContainer);endContainer=findParentContentEditable(endContainer);if(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer)){startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode;startContainer=startContainer.nextSibling||startContainer;if(startContainer.nodeType==3)startOffset=0}if(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer)){endContainer=isBookmarkNode(endContainer)?
endContainer:endContainer.parentNode;endContainer=endContainer.previousSibling||endContainer;if(endContainer.nodeType==3)endOffset=endContainer.length}if(format[0].inline){if(rng.collapsed){endPoint=findWordEndPoint(startContainer,startOffset,true);if(endPoint){startContainer=endPoint.container;startOffset=endPoint.offset}endPoint=findWordEndPoint(endContainer,endOffset);if(endPoint){endContainer=endPoint.container;endOffset=endPoint.offset}}leaf=findLeaf(endContainer,endOffset);if(leaf.node){while(leaf.node&&
leaf.offset===0&&leaf.node.previousSibling)leaf=findLeaf(leaf.node.previousSibling);if(leaf.node&&leaf.offset>0&&leaf.node.nodeType===3&&leaf.node.nodeValue.charAt(leaf.offset-1)===" ")if(leaf.offset>1){endContainer=leaf.node;endContainer.splitText(leaf.offset-1)}}}if(format[0].inline||format[0].block_expand){if(!format[0].inline||startContainer.nodeType!=3||startOffset===0)startContainer=findParentContainer(true);if(!format[0].inline||endContainer.nodeType!=3||endOffset===endContainer.nodeValue.length)endContainer=
findParentContainer()}if(format[0].selector&&format[0].expand!==FALSE&&!format[0].inline){startContainer=findSelectorEndPoint(startContainer,"previousSibling");endContainer=findSelectorEndPoint(endContainer,"nextSibling")}if(format[0].block||format[0].selector){startContainer=findBlockEndPoint(startContainer,"previousSibling");endContainer=findBlockEndPoint(endContainer,"nextSibling");if(format[0].block){if(!isBlock(startContainer))startContainer=findParentContainer(true);if(!isBlock(endContainer))endContainer=
findParentContainer()}}if(startContainer.nodeType==1){startOffset=nodeIndex(startContainer);startContainer=startContainer.parentNode}if(endContainer.nodeType==1){endOffset=nodeIndex(endContainer)+1;endContainer=endContainer.parentNode}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function removeFormat(format,vars,node,compare_node){var i,attrs,stylesModified;if(!matchName(node,format))return FALSE;if(format.remove!="all"){each(format.styles,
function(value,name){value=replaceVars(value,vars);if(typeof name==="number"){name=value;compare_node=0}if(!compare_node||isEq(getStyle(compare_node,name),value))dom.setStyle(node,name,"");stylesModified=1});if(stylesModified&&dom.getAttrib(node,"style")==""){node.removeAttribute("style");node.removeAttribute("data-mce-style")}each(format.attributes,function(value,name){var valueOut;value=replaceVars(value,vars);if(typeof name==="number"){name=value;compare_node=0}if(!compare_node||isEq(dom.getAttrib(compare_node,
name),value)){if(name=="class"){value=dom.getAttrib(node,name);if(value){valueOut="";each(value.split(/\s+/),function(cls){if(/mce\w+/.test(cls))valueOut+=(valueOut?" ":"")+cls});if(valueOut){dom.setAttrib(node,name,valueOut);return}}}if(name=="class")node.removeAttribute("className");if(MCE_ATTR_RE.test(name))node.removeAttribute("data-mce-"+name);node.removeAttribute(name)}});each(format.classes,function(value){value=replaceVars(value,vars);if(!compare_node||dom.hasClass(compare_node,value))dom.removeClass(node,
value)});attrs=dom.getAttribs(node);for(i=0;i<attrs.length;i++)if(attrs[i].nodeName.indexOf("_")!==0)return FALSE}if(format.remove!="none"){removeNode(node,format);return TRUE}}function removeNode(node,format){var parentNode=node.parentNode,rootBlockElm;function find(node,next,inc){node=getNonWhiteSpaceSibling(node,next,inc);return!node||node.nodeName=="BR"||isBlock(node)}if(format.block)if(!forcedRootBlock){if(isBlock(node)&&!isBlock(parentNode)){if(!find(node,FALSE)&&!find(node.firstChild,TRUE,
1))node.insertBefore(dom.create("br"),node.firstChild);if(!find(node,TRUE)&&!find(node.lastChild,FALSE,1))node.appendChild(dom.create("br"))}}else if(parentNode==dom.getRoot())if(!format.list_block||!isEq(node,format.list_block))each(tinymce.grep(node.childNodes),function(node){if(isValid(forcedRootBlock,node.nodeName.toLowerCase()))if(!rootBlockElm)rootBlockElm=wrap(node,forcedRootBlock);else rootBlockElm.appendChild(node);else rootBlockElm=0});if(format.selector&&format.inline&&!isEq(format.inline,
node))return;dom.remove(node,1)}function getNonWhiteSpaceSibling(node,next,inc){if(node){next=next?"nextSibling":"previousSibling";for(node=inc?node:node[next];node;node=node[next])if(node.nodeType==1||!isWhiteSpaceNode(node))return node}}function isBookmarkNode(node){return node&&node.nodeType==1&&node.getAttribute("data-mce-type")=="bookmark"}function mergeSiblings(prev,next){var marker,sibling,tmpSibling;function compareElements(node1,node2){if(node1.nodeName!=node2.nodeName)return FALSE;function getAttribs(node){var attribs=
{};each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();if(name.indexOf("_")!==0&&name!=="style")attribs[name]=dom.getAttrib(node,name)});return attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1)if(obj1.hasOwnProperty(name)){value=obj2[name];if(value===undef)return FALSE;if(obj1[name]!=value)return FALSE;delete obj2[name]}for(name in obj2)if(obj2.hasOwnProperty(name))return FALSE;return TRUE}if(!compareObjects(getAttribs(node1),getAttribs(node2)))return FALSE;
if(!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style"))))return FALSE;return TRUE}function findElementSibling(node,sibling_name){for(sibling=node;sibling;sibling=sibling[sibling_name]){if(sibling.nodeType==3&&sibling.nodeValue.length!==0)return node;if(sibling.nodeType==1&&!isBookmarkNode(sibling))return sibling}return node}if(prev&&next){prev=findElementSibling(prev,"previousSibling");next=findElementSibling(next,"nextSibling");if(compareElements(prev,
next)){for(sibling=prev.nextSibling;sibling&&sibling!=next;){tmpSibling=sibling;sibling=sibling.nextSibling;prev.appendChild(tmpSibling)}dom.remove(next);each(tinymce.grep(next.childNodes),function(node){prev.appendChild(node)});return prev}}return next}function isTextBlock(name){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(name)}function getContainer(rng,start){var container,offset,lastIdx,walker;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];
if(container.nodeType==1){lastIdx=container.childNodes.length-1;if(!start&&offset)offset--;container=container.childNodes[offset>lastIdx?lastIdx:offset]}if(container.nodeType===3&&start&&offset>=container.nodeValue.length)container=(new TreeWalker(container,ed.getBody())).next()||container;if(container.nodeType===3&&!start&&offset===0)container=(new TreeWalker(container,ed.getBody())).prev()||container;return container}function performCaretAction(type,name,vars){var caretContainerId="_mce_caret",
debug=ed.settings.caret_debug;function createCaretContainer(fill){var caretContainer=dom.create("span",{id:caretContainerId,"data-mce-bogus":true,style:debug?"color:red":""});if(fill)caretContainer.appendChild(ed.getDoc().createTextNode(INVISIBLE_CHAR));return caretContainer}function isCaretContainerEmpty(node,nodes){while(node){if(node.nodeType===3&&node.nodeValue!==INVISIBLE_CHAR||node.childNodes.length>1)return false;if(nodes&&node.nodeType===1)nodes.push(node);node=node.firstChild}return true}
function getParentCaretContainer(node){while(node){if(node.id===caretContainerId)return node;node=node.parentNode}}function findFirstTextNode(node){var walker;if(node){walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next())if(node.nodeType===3)return node}}function removeCaretContainer(node,move_caret){var child,rng;if(!node){node=getParentCaretContainer(selection.getStart());if(!node)while(node=dom.get(caretContainerId))removeCaretContainer(node,false)}else{rng=selection.getRng(true);
if(isCaretContainerEmpty(node)){if(move_caret!==false){rng.setStartBefore(node);rng.setEndBefore(node)}dom.remove(node)}else{child=findFirstTextNode(node);if(child.nodeValue.charAt(0)===INVISIBLE_CHAR)child=child.deleteData(0,1);dom.remove(node,1)}selection.setRng(rng)}}function applyCaretFormat(){var rng,caretContainer,textNode,offset,bookmark,container,text;rng=selection.getRng(true);offset=rng.startOffset;container=rng.startContainer;text=container.nodeValue;caretContainer=getParentCaretContainer(selection.getStart());
if(caretContainer)textNode=findFirstTextNode(caretContainer);if(text&&offset>0&&offset<text.length&&/\w/.test(text.charAt(offset))&&/\w/.test(text.charAt(offset-1))){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name));rng=rangeUtils.split(rng);apply(name,vars,rng);selection.moveToBookmark(bookmark)}else{if(!caretContainer||textNode.nodeValue!==INVISIBLE_CHAR){caretContainer=createCaretContainer(true);textNode=caretContainer.firstChild;rng.insertNode(caretContainer);offset=
1;apply(name,vars,caretContainer)}else apply(name,vars,caretContainer);selection.setCursorLocation(textNode,offset)}}function removeCaretFormat(){var rng=selection.getRng(true),container,offset,bookmark,hasContentAfter,node,formatNode,parents=[],i,caretContainer;container=rng.startContainer;offset=rng.startOffset;node=container;if(container.nodeType==3){if(offset!=container.nodeValue.length||container.nodeValue===INVISIBLE_CHAR)hasContentAfter=true;node=node.parentNode}while(node){if(matchNode(node,
name,vars)){formatNode=node;break}if(node.nextSibling)hasContentAfter=true;parents.push(node);node=node.parentNode}if(!formatNode)return;if(hasContentAfter){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name),true);rng=rangeUtils.split(rng);remove(name,vars,rng);selection.moveToBookmark(bookmark)}else{caretContainer=createCaretContainer();node=caretContainer;for(i=parents.length-1;i>=0;i--){node.appendChild(dom.clone(parents[i],false));node=node.firstChild}node.appendChild(dom.doc.createTextNode(INVISIBLE_CHAR));
node=node.firstChild;dom.insertAfter(caretContainer,formatNode);selection.setCursorLocation(node,1)}}function unmarkBogusCaretParents(){var i,caretContainer,node;caretContainer=getParentCaretContainer(selection.getStart());if(caretContainer&&!dom.isEmpty(caretContainer))tinymce.walk(caretContainer,function(node){if(node.nodeType==1&&node.id!==caretContainerId&&!dom.isEmpty(node))dom.setAttrib(node,"data-mce-bogus",null)},"childNodes")}if(!self._hasCaretEvents){ed.onBeforeGetContent.addToTop(function(){var nodes=
[],i;if(isCaretContainerEmpty(getParentCaretContainer(selection.getStart()),nodes)){i=nodes.length;while(i--)dom.setAttrib(nodes[i],"data-mce-bogus","1")}});tinymce.each("onMouseUp onKeyUp".split(" "),function(name){ed[name].addToTop(function(){removeCaretContainer();unmarkBogusCaretParents()})});ed.onKeyDown.addToTop(function(ed,e){var keyCode=e.keyCode;if(keyCode==8||keyCode==37||keyCode==39)removeCaretContainer(getParentCaretContainer(selection.getStart()));unmarkBogusCaretParents()});selection.onSetContent.add(unmarkBogusCaretParents);
self._hasCaretEvents=true}if(type=="apply")applyCaretFormat();else removeCaretFormat()}function moveStart(rng){var container=rng.startContainer,offset=rng.startOffset,isAtEndOfText,walker,node,nodes,tmpNode;if(container.nodeType==3&&offset>=container.nodeValue.length){offset=nodeIndex(container);container=container.parentNode;isAtEndOfText=true}if(container.nodeType==1){nodes=container.childNodes;container=nodes[Math.min(offset,nodes.length-1)];walker=new TreeWalker(container,dom.getParent(container,
dom.isBlock));if(offset>nodes.length-1||isAtEndOfText)walker.next();for(node=walker.current();node;node=walker.next())if(node.nodeType==3&&!isWhiteSpaceNode(node)){tmpNode=dom.create("a",null,INVISIBLE_CHAR);node.parentNode.insertBefore(tmpNode,node);rng.setStart(node,0);selection.setRng(rng);dom.remove(tmpNode);return}}}}})(tinymce);
tinymce.onAddEditor.add(function(tinymce,ed){var filters,fontSizes,dom,settings=ed.settings;function replaceWithSpan(node,styles){tinymce.each(styles,function(value,name){if(value)dom.setStyle(node,name,value)});dom.rename(node,"span")}function convert(editor,params){dom=editor.dom;if(settings.convert_fonts_to_spans)tinymce.each(dom.select("font,u,strike",params.node),function(node){filters[node.nodeName.toLowerCase()](ed.dom,node)})}if(settings.inline_styles){fontSizes=tinymce.explode(settings.font_size_legacy_values);
filters={font:function(dom,node){replaceWithSpan(node,{backgroundColor:node.style.backgroundColor,color:node.color,fontFamily:node.face,fontSize:fontSizes[parseInt(node.size,10)-1]})},u:function(dom,node){replaceWithSpan(node,{textDecoration:"underline"})},strike:function(dom,node){replaceWithSpan(node,{textDecoration:"line-through"})}};ed.onPreProcess.add(convert);ed.onSetContent.add(convert);ed.onInit.add(function(){ed.selection.onSetContent.add(convert)})}});
(function(tinymce){var TreeWalker=tinymce.dom.TreeWalker;tinymce.EnterKey=function(editor){var dom=editor.dom,selection=editor.selection,settings=editor.settings,undoManager=editor.undoManager,nonEmptyElementsMap=editor.schema.getNonEmptyElements();function handleEnterKey(evt){var rng=selection.getRng(true),tmpRng,editableRoot,container,offset,parentBlock,documentMode,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;function canSplitBlock(node){return node&&
dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&dom.getContentEditable(node)!=="true"}function renderBlockOnIE(block){var oldRng;if(tinymce.isIE&&dom.isBlock(block)){oldRng=selection.getRng();block.appendChild(dom.create("span",null,"\u00a0"));selection.select(block);block.lastChild.outerHTML="";selection.setRng(oldRng)}}function trimInlineElementsOnLeftSideOfBlock(block){var node=block,firstChilds=[],i;while(node=node.firstChild){if(dom.isBlock(node))return;
if(node.nodeType==1&&!nonEmptyElementsMap[node.nodeName.toLowerCase()])firstChilds.push(node)}i=firstChilds.length;while(i--){node=firstChilds[i];if(!node.hasChildNodes()||node.firstChild==node.lastChild&&node.firstChild.nodeValue==="")dom.remove(node);else if(node.nodeName=="A"&&(node.innerText||node.textContent)===" ")dom.remove(node)}}function moveToCaretPosition(root){var walker,node,rng,y,viewPort,lastNode=root,tempElm;rng=dom.createRng();if(root.hasChildNodes()){walker=new TreeWalker(root,root);
while(node=walker.current()){if(node.nodeType==3){rng.setStart(node,0);rng.setEnd(node,0);break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node);rng.setEndBefore(node);break}lastNode=node;node=walker.next()}if(!node){rng.setStart(lastNode,0);rng.setEnd(lastNode,0)}}else if(root.nodeName=="BR")if(root.nextSibling&&dom.isBlock(root.nextSibling)){if(!documentMode||documentMode<9){tempElm=dom.create("br");root.parentNode.insertBefore(tempElm,root)}rng.setStartBefore(root);
rng.setEndBefore(root)}else{rng.setStartAfter(root);rng.setEndAfter(root)}else{rng.setStart(root,0);rng.setEnd(root,0)}selection.setRng(rng);dom.remove(tempElm);viewPort=dom.getViewPort(editor.getWin());y=dom.getPos(root).y;if(y<viewPort.y||y+25>viewPort.y+viewPort.h)editor.getWin().scrollTo(0,y<viewPort.y?y:y-viewPort.h+25)}function createNewBlock(name){var node=container,block,clonedNode,caretNode;block=name||parentBlockName=="TABLE"?dom.create(name||newBlockName):parentBlock.cloneNode(false);caretNode=
block;if(settings.keep_styles!==false){do if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(node.nodeName)){clonedNode=node.cloneNode(false);dom.setAttrib(clonedNode,"id","");if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode)}else{caretNode=clonedNode;block.appendChild(clonedNode)}}while(node=node.parentNode)}if(!tinymce.isIE)caretNode.innerHTML="<br>";return block}function isCaretAtStartOrEndOfBlock(start){var walker,node,name;if(container.nodeType==3&&
(start?offset>0:offset<container.nodeValue.length))return false;if(container.parentNode==parentBlock&&isAfterLastNodeInContainer&&!start)return true;if(start&&container.nodeType==1&&container==parentBlock.firstChild)return true;if(container.nodeName==="TABLE"||container.previousSibling&&container.previousSibling.nodeName=="TABLE")return isAfterLastNodeInContainer&&!start||!isAfterLastNodeInContainer&&start;walker=new TreeWalker(container,parentBlock);if(container.nodeType==3)if(start&&offset==0)walker.prev();
else if(!start&&offset==container.nodeValue.length)walker.next();while(node=walker.current()){if(node.nodeType===1){if(!node.getAttribute("data-mce-bogus")){name=node.nodeName.toLowerCase();if(nonEmptyElementsMap[name]&&name!=="br")return false}}else if(node.nodeType===3&&!/^[ \t\r\n]*$/.test(node.nodeValue))return false;if(start)walker.prev();else walker.next()}return true}function wrapSelfAndSiblingsInDefaultBlock(container,offset){var newBlock,parentBlock,startNode,node,next,blockName=newBlockName||
"P";parentBlock=dom.getParent(container,dom.isBlock);if(!parentBlock||!canSplitBlock(parentBlock)){parentBlock=parentBlock||editableRoot;if(!parentBlock.hasChildNodes()){newBlock=dom.create(blockName);parentBlock.appendChild(newBlock);rng.setStart(newBlock,0);rng.setEnd(newBlock,0);return newBlock}node=container;while(node.parentNode!=parentBlock)node=node.parentNode;while(node&&!dom.isBlock(node)){startNode=node;node=node.previousSibling}if(startNode){newBlock=dom.create(blockName);startNode.parentNode.insertBefore(newBlock,
startNode);node=startNode;while(node&&!dom.isBlock(node)){next=node.nextSibling;newBlock.appendChild(node);node=next}rng.setStart(container,offset);rng.setEnd(container,offset)}}return container}function handleEmptyListItem(){function isFirstOrLastLi(first){var node=containerBlock[first?"firstChild":"lastChild"];while(node){if(node.nodeType==1)break;node=node[first?"nextSibling":"previousSibling"]}return node===parentBlock}newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(true)&&
isFirstOrLastLi())dom.replace(newBlock,containerBlock);else if(isFirstOrLastLi(true))containerBlock.parentNode.insertBefore(newBlock,containerBlock);else if(isFirstOrLastLi()){dom.insertAfter(newBlock,containerBlock);renderBlockOnIE(newBlock)}else{tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock);tmpRng.setEndAfter(containerBlock);fragment=tmpRng.extractContents();dom.insertAfter(fragment,containerBlock);dom.insertAfter(newBlock,containerBlock)}dom.remove(parentBlock);moveToCaretPosition(newBlock);
undoManager.add()}function hasRightSideBr(){var walker=new TreeWalker(container,parentBlock),node;while(node=walker.current()){if(node.nodeName=="BR")return true;node=walker.next()}}function insertBr(){var brElm,extraBr;if(container&&container.nodeType==3&&offset>=container.nodeValue.length)if(!tinymce.isIE&&!hasRightSideBr()){brElm=dom.create("br");rng.insertNode(brElm);rng.setStartAfter(brElm);rng.setEndAfter(brElm);extraBr=true}brElm=dom.create("br");rng.insertNode(brElm);if(tinymce.isIE&&parentBlockName==
"PRE"&&(!documentMode||documentMode<8))brElm.parentNode.insertBefore(dom.doc.createTextNode("\r"),brElm);if(!extraBr){rng.setStartAfter(brElm);rng.setEndAfter(brElm)}else{rng.setStartBefore(brElm);rng.setEndBefore(brElm)}selection.setRng(rng);undoManager.add()}function trimLeadingLineBreaks(node){do{if(node.nodeType===3)node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"");node=node.firstChild}while(node)}function getEditableRoot(node){var root=dom.getRoot(),parent,editableRoot;parent=node;while(parent!==
root&&dom.getContentEditable(parent)!=="false"){if(dom.getContentEditable(parent)==="true")editableRoot=parent;parent=parent.parentNode}return parent!==root?editableRoot:root}function addBrToBlockIfNeeded(block){var lastChild;if(!tinymce.isIE){block.normalize();lastChild=block.lastChild;if(!lastChild||/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",true)))dom.add(block,"br")}}if(!rng.collapsed){editor.execCommand("Delete");return}if(evt.isDefaultPrevented())return;container=rng.startContainer;
offset=rng.startOffset;newBlockName=(settings.force_p_newlines?"p":"")||settings.forced_root_block;newBlockName=newBlockName?newBlockName.toUpperCase():"";documentMode=dom.doc.documentMode;shiftKey=evt.shiftKey;if(container.nodeType==1&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&container.nodeType==3)offset=container.nodeValue.length;
else offset=0}editableRoot=getEditableRoot(container);if(!editableRoot)return;undoManager.beforeChange();if(!dom.isBlock(editableRoot)&&editableRoot!=dom.getRoot()){if(!newBlockName||shiftKey)insertBr();return}if(newBlockName&&!shiftKey||!newBlockName&&shiftKey)container=wrapSelfAndSiblingsInDefaultBlock(container,offset);parentBlock=dom.getParent(container,dom.isBlock);containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():
"";containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"";if(parentBlockName=="LI"){if(!newBlockName&&shiftKey){insertBr();return}if(dom.isEmpty(parentBlock)){if(/^(UL|OL|LI)$/.test(containerBlock.parentNode.nodeName))return false;handleEmptyListItem();return}}if(parentBlockName=="PRE"&&settings.br_in_pre!==false){if(!shiftKey){insertBr();return}}else if(!newBlockName&&!shiftKey&&parentBlockName!="LI"||newBlockName&&shiftKey){insertBr();return}newBlockName=newBlockName||"P";if(isCaretAtStartOrEndOfBlock()){if(/^(H[1-6]|PRE)$/.test(parentBlockName)&&
containerBlockName!="HGROUP")newBlock=createNewBlock(newBlockName);else newBlock=createNewBlock();if(settings.end_container_on_empty_block&&canSplitBlock(containerBlock)&&dom.isEmpty(parentBlock))newBlock=dom.split(containerBlock,parentBlock);else dom.insertAfter(newBlock,parentBlock);moveToCaretPosition(newBlock)}else if(isCaretAtStartOrEndOfBlock(true)){newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock);renderBlockOnIE(newBlock)}else{tmpRng=rng.cloneRange();tmpRng.setEndAfter(parentBlock);
fragment=tmpRng.extractContents();trimLeadingLineBreaks(fragment);newBlock=fragment.firstChild;dom.insertAfter(fragment,parentBlock);trimInlineElementsOnLeftSideOfBlock(newBlock);addBrToBlockIfNeeded(parentBlock);moveToCaretPosition(newBlock)}dom.setAttrib(newBlock,"id","");undoManager.add()}editor.onKeyDown.add(function(ed,evt){if(evt.keyCode==13)if(handleEnterKey(evt)!==false)evt.preventDefault()})}})(tinymce);
(function(){tinymce.create("tinymce.plugins.AutolinkPlugin",{init:function(ed,url){var t=this;ed.onKeyDown.addToTop(function(ed,e){if(e.keyCode==13)return t.handleEnter(ed)});if(tinyMCE.isIE)return;ed.onKeyPress.add(function(ed,e){if(e.which==41)return t.handleEclipse(ed)});ed.onKeyUp.add(function(ed,e){if(e.keyCode==32)return t.handleSpacebar(ed)})},handleEclipse:function(ed){this.parseCurrentLine(ed,-1,"(",true)},handleSpacebar:function(ed){this.parseCurrentLine(ed,0,"",true)},handleEnter:function(ed){this.parseCurrentLine(ed,
-1,"",false)},parseCurrentLine:function(ed,end_offset,delimiter,goback){var r,end,start,endContainer,bookmark,text,matches,prev,len;r=ed.selection.getRng(true).cloneRange();if(r.startOffset<5){prev=r.endContainer.previousSibling;if(prev==null){if(r.endContainer.firstChild==null||r.endContainer.firstChild.nextSibling==null)return;prev=r.endContainer.firstChild.nextSibling}len=prev.length;r.setStart(prev,len);r.setEnd(prev,len);if(r.endOffset<5)return;end=r.endOffset;endContainer=prev}else{endContainer=
r.endContainer;if(endContainer.nodeType!=3&&endContainer.firstChild){while(endContainer.nodeType!=3&&endContainer.firstChild)endContainer=endContainer.firstChild;if(endContainer.nodeType==3){r.setStart(endContainer,0);r.setEnd(endContainer,endContainer.nodeValue.length)}}if(r.endOffset==1)end=2;else end=r.endOffset-1-end_offset}start=end;do{r.setStart(endContainer,end-2);r.setEnd(endContainer,end-1);end-=1}while(r.toString()!=" "&&r.toString()!=""&&r.toString().charCodeAt(0)!=160&&end-2>=0&&r.toString()!=
delimiter);if(r.toString()==delimiter||r.toString().charCodeAt(0)==160){r.setStart(endContainer,end);r.setEnd(endContainer,start);end+=1}else if(r.startOffset==0){r.setStart(endContainer,0);r.setEnd(endContainer,start)}else{r.setStart(endContainer,end);r.setEnd(endContainer,start)}var text=r.toString();if(text.charAt(text.length-1)==".")r.setEnd(endContainer,start-1);text=r.toString();matches=text.match(/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+-]+@)(.+)$/i);if(matches){if(matches[1]==
"www.")matches[1]="http://www.";else if(/@$/.test(matches[1])&&!/^mailto:/.test(matches[1]))matches[1]="mailto:"+matches[1];bookmark=ed.selection.getBookmark();ed.selection.setRng(r);tinyMCE.execCommand("createlink",false,matches[1]+matches[2]);ed.selection.moveToBookmark(bookmark);ed.nodeChanged();if(tinyMCE.isWebKit){ed.selection.collapse(false);var max=Math.min(endContainer.length,start+1);r.setStart(endContainer,max);r.setEnd(endContainer,max);ed.selection.setRng(r)}}},getInfo:function(){return{longname:"Autolink",
author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autolink",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autolink",tinymce.plugins.AutolinkPlugin)})();
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor={ActionIdMap:{},AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);var isInline=me.IsInlineByNode(node);node.d2l_control.AppendHtml(editorId,html,isInline)},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.ExecuteCommand(editorId,name,value)},Focus:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(id);node.d2l_control.FocusByNode(node)},GetActionId:function(editorId,actionName){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.GetActionIdMap(editorId);return actionIdMap[actionName]},GetActionIdMap:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var actionIdMap=me.ActionIdMap[editorId];if(actionIdMap===undefined){actionIdMap={};me.ActionIdMap[editorId]=actionIdMap}return actionIdMap},GetComputedStyle:function(editorId,styleAttribute){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetComputedStyle(editorId,styleAttribute)},GetControlManager:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetControlManager(editorId)},GetEditor:function(editorId){return D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue())},GetEditorInstanceById:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=
me.GetEditor(editorId);return node.d2l_control.GetEditorInstanceByNode(node)},GetFileAdded:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var files=node.d2l_files;if(files.length===0||files.length<node.d2l_files_queued)return;var file=files[files.length-node.d2l_files_queued];node.d2l_files_queued-=1;return new D2L.LP.Web.UI.Files.File(file.GetId(),file.GetFileSystemType(),file.GetName(),file.GetSize())},GetHtml:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());me.UpdateFilesNodeByNode(node);var files=node.d2l_files;return new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param(editorId.GetValue(),node.d2l_control.GetHtml(editorId),node.getAttribute("data-d2l-htmlorgunitid"),files)},GetOnChangeEvent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetOnChangeEventByNode(node)},GetSelectedNode:function(editorId){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectedNode(editorId)},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSelectionContent(editorId)},GetSpellcheckText:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.GetSpellcheckText(editorId)},IsDirty:function(editorId){var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_control.IsDirty(editorId)},IsEmpty:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var html=node.d2l_control.GetHtml(editorId);if(html==null)return true;if(D2L.LP.Web.UI.Html.JavaScript.TrimString(0,html).length<1)return true;return false},InsertDelayed:function(editorId,delayedFunction,selectionProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;me.PasteDelayed(editorId,delayedFunction,
selectionProvider)},IsInline:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return me.IsInlineByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},IsInlineByNode:function(node){return node.getAttribute("data-d2l-editor-isinline")==="true"},MoveToStart:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_control.MoveToStart(editorId)},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(editorId);node.d2l_control.PasteDelayed(editorId,delayedFunction,selectionProvider,htmlProvider)},SetActionId:function(actionName,actionId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorId=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor",D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue())).id;var actionIdMap=me.GetActionIdMap(editorId);actionIdMap[actionName]=actionId},SelectNode:function(editorId,nodeToSelect){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var node=me.GetEditor(editorId);node.d2l_control.SelectNode(editorId,nodeToSelect)},SetHtml:function(editorId,html,baseRelativePath){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var evt=new D2L.LP.Web.UI.Events.Event;var node=me.GetEditor(editorId);var orgUnitId=node.getAttribute("data-d2l-htmlorgunitid");var filterMode=node.getAttribute("data-d2l-filtermode");node.d2l_files=[];node.d2l_files_queued=0;var convertResponseHandler=function(response){node.d2l_control.SetHtml(editorId,response);evt.Trigger()};
var params={filterMode:filterMode,html:html};if(baseRelativePath!==undefined)params.baseRelativePath=baseRelativePath;var options={success:convertResponseHandler,failure:function(){evt.Release()}};D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,(new D2L.LP.Web.Http.UrlLocation("/d2l/lp/htmleditor/converttoabsolute")).WithQueryString("ou",orgUnitId),params,options);return evt},SetIsResizeDisplayedByNode:function(node,isDisplayed){var resizeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
node);if(isDisplayed)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",resizeNode);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",resizeNode)},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);node.d2l_control.SetSize(editorId,height,width)},SetSpellcheckText:function(editorId,response){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=me.GetEditor(editorId);return node.d2l_control.SetSpellcheckText(editorId,response)},
ToggleDisplayComponents:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-hide-components",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide-components",node);me.UpdateComponentVisibilityByNode(node)},TriggerFileAdded:function(editorId,file){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());
node.d2l_files.push(file);node.d2l_files_queued+=1;var onFileAdded=D2L.LP.Web.UI.ObjectRepository.TryGet(editorId.GetValue(),"onFileAdded");if(onFileAdded!=null)onFileAdded.call(onFileAdded)},UpdateComponentVisibilityByNode:function(node){var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",node);var containerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-component-container",node);var visibilityToggleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-component-toggle",
toolbarNode);if(visibilityToggleNode==null)return;var openMenuFlyouts=D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.GetOpenMenuFlyouts(toolbarNode);for(var i=0;i<openMenuFlyouts.length;i++)D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.CloseByNode(openMenuFlyouts[i]);var boundingWidth=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(toolbarNode).width-D2L.LP.Web.UI.Html.Dom.GetBoundingRect(visibilityToggleNode).width-8;if(boundingWidth<=0)return;if(containerNode.d2l_initialized===undefined){var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1",
containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=componentNodes[i];componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+4;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide1-hidden",componentNode)}containerNode.d2l_initialized=true}if(containerNode.scrollWidth>=boundingWidth){var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1",containerNode);var componentNumber=componentNodes.length;while(componentNumber--){var componentNode=
componentNodes[componentNumber];if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide1-hidden",componentNode)){componentNode.d2l_width=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(componentNode).width+4;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-hide1-hidden",componentNode);if(containerNode.scrollWidth<boundingWidth)break}}}else{var componentNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1-hidden",containerNode);for(var i=0;i<componentNodes.length;i++){var componentNode=
componentNodes[i];var componentWidth=componentNode.d2l_width;if(containerNode.scrollWidth+componentWidth<boundingWidth)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-hide1-hidden",componentNode);else break;if(containerNode.scrollWidth>=boundingWidth)break}}if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node)&&D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-hide1-hidden",containerNode).length==0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-disabled",
visibilityToggleNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-disabled",visibilityToggleNode);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-hide-components",node)){var showTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-toolbar-toggle-show");D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(visibilityToggleNode,showTitle);D2L.LP.Web.UI.Common.Controls.Button.SetTitleNode(visibilityToggleNode,showTitle)}else{var hideTitle=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-toolbar-toggle-hide");
D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(visibilityToggleNode,hideTitle);D2L.LP.Web.UI.Common.Controls.Button.SetTitleNode(visibilityToggleNode,hideTitle)}},UpdateFilesNodeByNode:function(node){var filesNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-files",node);D2L.LP.Web.UI.Html.Dom.RemoveChildElements(filesNode);if(node.d2l_files.length===0)return;var files=node.d2l_files;var scope=filesNode.getAttribute("data-d2l-scope");for(var i=0;i<files.length;i++){var fileNumber=
i+1;var idPrefix;if(fileNumber<2)idPrefix=scope+"$files$";else idPrefix=scope+"$files`"+fileNumber+"$";var fsTypeNode=filesNode.appendChild(document.createElement("input"));fsTypeNode.setAttribute("id",idPrefix+"FileSystemType");fsTypeNode.setAttribute("name",idPrefix+"FileSystemType");fsTypeNode.setAttribute("value",files[i].GetFileSystemType());var idNode=filesNode.appendChild(document.createElement("input"));idNode.setAttribute("id",idPrefix+"Id");idNode.setAttribute("name",idPrefix+"Id");idNode.setAttribute("value",
files[i].GetId());var locationNode=filesNode.appendChild(document.createElement("input"));locationNode.setAttribute("id",idPrefix+"Location");locationNode.setAttribute("name",idPrefix+"Location");locationNode.setAttribute("value",files[i].GetLocation())}},ValidateRequired:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return!me.IsEmpty(editorId)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents={};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor={AppendHtml:function(editorId,html,isInline){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var current=me.GetHtml(editorId);var result;if(isInline)result=current+html;else{var loc=current.indexOf("</body>");result=current.substring(0,loc)+html+current.substring(loc,current.length)}me.SetHtml(editorId,result)},ExecuteCommand:function(editorId,name,value){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var node=
tinyMCE.activeEditor.settings.d2l_context.Node;me.MoveToBookmarkByNode(node);tinyMCE.execCommand(name,false,value)},FocusByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);var focus=function(){setTimeout(function(){tinyMCE.execCommand("mceFocus",false,textAreaId)},0)};var editor=me.GetEditorInstanceByNode(node);if(editor===undefined)tinyMCE.onAddEditor.add(function(mgr,ed){if(textAreaId==ed.id)focus()});else focus()},GetComputedStyle:function(editorId,
styleAttribute){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var node=me.GetSelectedNode(editorId);return me.GetComputedStyleByNode(node,styleAttribute)},GetComputedStyleByNode:function(node,styleAttribute){if(node==null)return;if(node.nodeType==9)node=node.body;var getStyleValue=function(node){var value=D2L.LP.Web.UI.Html.Css.GetStyle(node,styleAttribute);if(styleAttribute=="background-color"&&value=="transparent"&&node.parentNode!=null)value=getStyleValue(node.parentNode);return value};
return getStyleValue(node)},GetControlManager:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;return htmlEditor.GetEditorInstanceById(editorId).controlManager},GetEditorInstanceByNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var textAreaId=me.GetTextAreaId(node);return tinymce.get(textAreaId)},GetHtml:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);return editor.getContent({source_view:true})},
GetOnChangeEventByNode:function(node){return node.d2l_changeEvent},GetSelectedNode:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=null;if(tinyMCE.isIE){var node=htmlEditor.GetEditor(editorId).d2l_selectedNode;if(node!=null)return node}var editor=htmlEditor.GetEditorInstanceById(editorId);if(editor.selection!=null)node=editor.selection.getNode();return node},GetSelectionContent:function(editorId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var editor=
me.GetEditorInstanceByNode(editorId);var content="";if(editor.selection)content=tinymce.DOM.decode(editor.selection.getContent());return content},GetSpellcheckText:function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditorInstanceById(editorId);var walk=function(n,f){var d=editor.getDoc();var w;if(d.createTreeWalker){w=d.createTreeWalker(n,NodeFilter.SHOW_TEXT,null,false);while((n=w.nextNode())!=null)f.call(f,n)}else tinymce.walk(n,f,"childNodes")};var tx="";var nodeDic=new D2L.Util.Dictionary;
var nodeIden=0;walk(editor.getBody(),function(n){if(n.nodeType==3&&n.nodeValue.trim()!=""){nodeDic.Add(nodeIden,n);tx+=n.nodeValue+"["+nodeIden+":d2lsciden]";nodeIden++}});editor.d2l_nodeDic=nodeDic;return tx},GetTextAreaId:function(nodeOrId){if(nodeOrId.GetValue)nodeOrId=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeOrId.GetValue());var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",nodeOrId);return textAreaNode.getAttribute("id")},InitializeCallback:function(textAreaId,
body,doc){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor",textAreaNode);var editor=me.GetEditorInstanceByNode(node);var iFrameNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(editor.getContentAreaContainer());var title=node.getAttribute("data-d2l-editor-title");if(title!=null)iFrameNode.title=
title;var labelledById=node.getAttribute("data-d2l-editor-labelledbyid");if(labelledById!=null)D2L.LP.Web.UI.Html.Aria.SetAttribute(iFrameNode,"labelledby",labelledById);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",iFrameNode.contentWindow,function(e){node.d2l_onContentFocus.Trigger();node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-frosted",node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",iFrameNode.contentWindow,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-frosted",
node)},0);node.d2l_changeEvent.Trigger()});if(tinyMCE.isIE){var getBookmark=function(evt){if(editor.selection!=null){node.d2l_selectedNode=editor.selection.getNode();node.d2l_bookmark=editor.selection.getBookmark(1)}else{node.d2l_selectedNode=null;node.d2l_bookmark=null}};var editorBody=editor.getBody();D2L.LP.Web.UI.Html.Dom.AddEventListener("select",editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",editorBody,getBookmark,true);D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",
editorBody,getBookmark);editor.onMouseUp.add(function(ed,e){getBookmark()});if(tinyMCE.isIE){var parentPlaceholders=D2L.LP.Web.UI.Html.Dom.GetParentElementsByClassName("d2l-placeholder-live",iFrameNode);if(parentPlaceholders!==null&&parentPlaceholders!==undefined)for(var i=0;i<parentPlaceholders.length;i++)D2L.LP.Web.UI.Html.Dom.RemoveAttribute(parentPlaceholders[i],"aria-live")}}D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,node.d2l_changeEvent,function(){var value=htmlEditor.GetHtml(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("id")));
var serializer=new D2L.LP.Web.Serialization.Url.Serializer;value._serialize(serializer);return serializer.Serialize()});me.SetSizeByNode(node,node.getAttribute("data-d2l-height"),node.getAttribute("data-d2l-width"));node.style.visibility="visible"},InitializeLayout:function(settings,layoutNode,editorWrapper,parentNode){var pluginLayoutInitializers=settings.d2l_context.PluginLayoutInitializers;if(pluginLayoutInitializers!=null)for(var i=0;i<pluginLayoutInitializers.length;i++){var pluginLayoutInitializer=
pluginLayoutInitializers[i];pluginLayoutInitializer.call(pluginLayoutInitializer)}var iFrameTableRow=layoutNode.appendChild(document.createElement("tr"));var iFrameTableData=iFrameTableRow.appendChild(document.createElement("td"));D2L.LP.Web.UI.Html.Dom.AddClassName("mceIframeContainer",iFrameTableData);var iFrameTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",layoutNode);var editorNode=D2L.LP.Web.UI.Html.Dom.GetElementById(settings.d2l_context.Id);var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
editorNode);var resizeSettings={Handle:resizeHandle,DisplayType:"hidden",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(editorNode,resizeSettings,window,window);var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;onResize.AddListener(function(size){htmlEditor.SetSize(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editorNode.getAttribute("id")),size.height+"px",size.width+"px")});D2L.LP.Web.UI.Events.OnResize.AddListener(function(){htmlEditor.UpdateComponentVisibilityByNode(editorNode)});
return iFrameTableData},IsDirty:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);return editor.isDirty()},MoveToBookmarkByNode:function(node){if(!tinyMCE.isIE)return;var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;if(node.d2l_bookmark!=null){var editor=me.GetEditorInstanceByNode(node);editor.selection.moveToBookmark(node.d2l_bookmark)}},MoveToStart:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
setTimeout(function(){var editor=htmlEditor.GetEditorInstanceById(editorId);tinyMCE.execInstanceCommand(editor.id,"selectall",false,null);editor.selection.collapse(true)},0)},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var editor=me.GetEditorInstanceByNode(node);delayedFunction.call(delayedFunction).AddListener(function(obj){var doInsert=
function(html){if(selectionProvider!=null)selectionProvider.call(selectionProvider);me.MoveToBookmarkByNode(node);if(html!=null)editor.execCommand("mceInsertContent",false,html)};if(htmlProvider!==undefined){var htmlResult=htmlProvider.call(htmlProvider,obj);if(typeof htmlResult==="string")doInsert(htmlResult);else if(typeof htmlResult==="object"&&htmlResult.AddListener!==undefined)htmlResult.AddListener(function(html){doInsert(html)})}else doInsert(obj)})},SelectNode:function(editorId,nodeToSelect){var htmlEditor=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editor=htmlEditor.GetEditorInstanceById(editorId);editor.selection.select(nodeToSelect)},SetHeightByNode:function(node,height){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var editor=me.GetEditorInstanceByNode(node);if(height.substr(height.length-2,2)=="px"){var pixelHeight=parseInt(height.substr(0,height.length));var toolbarHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",
node)).height;var footerHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",node)).height;pixelHeight-=toolbarHeight+footerHeight;if(pixelHeight<120)pixelHeight="120";height=pixelHeight+"px"}var iFrameContainer=editor.contentAreaContainer;iFrameContainer.style.height=height;var bogusTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",iFrameContainer);bogusTable.style.height="100%";iFrameContainer.firstChild.style.height=
"100%";D2L.LP.Web.UI.Events.OnSizingFinished.Trigger()},SetHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var editor=me.GetEditorInstanceByNode(node);editor.setContent(html,{source_view:true})},SetSize:function(editorId,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetSizeByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue()),
height,width)},SetSizeByNode:function(node,height,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;me.SetWidthByNode(node,width);setTimeout(function(){me.SetHeightByNode(node,height)},0)},SetSpellcheckText:function(editorId,response){var editor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetEditorInstanceById(editorId);var nodeDic=editor.d2l_nodeDic;if(nodeDic===undefined||nodeDic===null)return;var phrases=response.split(":d2lsciden]");var dic=new D2L.Util.Dictionary;for(var i=
0;i<phrases.length;i++){var phrase=phrases[i];var iden=phrase.substring(phrase.lastIndexOf("[")+1);var txt=phrase.substring(0,phrase.lastIndexOf("["));dic.Add(iden,txt)}for(var j=0;j<nodeDic.Keys().length;j++){var node=nodeDic.Get(nodeDic.Keys()[j]);var text=dic.Get(nodeDic.Keys()[j]);if(text!==null&&text!==undefined)node.data=text}editor.d2l_nodeDic=undefined},SetWidthByNode:function(node,width){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var editor=me.GetEditorInstanceByNode(node);if(width.substr(width.length-2,2)=="px")if(parseInt(width.substr(0,width.length))<200)width="200px";node.style.width=width;var iFrameContainer=editor.contentAreaContainer;iFrameContainer.style.width=width;var bogusTable=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("mceLayout",iFrameContainer);bogusTable.style.width="100%";htmlEditor.UpdateComponentVisibilityByNode(node);return width},UpdateTextArea:function(textAreaId){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId);
if(textAreaNode)textAreaNode.value=tinymce.get(textAreaId).getContent()}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor={AppendHtml:function(editorId,html){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;me.SetHtml(editorId,me.GetHtml(editorId)+html)},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);textAreaNode.focus()},GetComputedStyle:function(editorId,styleAttribute){},GetControlManager:function(editorId){},GetEditorInstanceByNode:function(node){var me=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;var textAreaId=me.GetTextAreaId(node);return D2L.LP.Web.UI.Html.Dom.GetElementById(textAreaId)},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);return textAreaNode.value},GetOnChangeEventByNode:function(node){return node.d2l_changeEvent},GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return""},
GetSpellcheckText:function(editorId){return this.GetHtml(editorId)},GetTextAreaId:function(node){var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);return textAreaNode.getAttribute("id")},IsDirty:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isDirty},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},
SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);textAreaNode.value=html;node.d2l_isDirty=true},SetSize:function(editorId,height,width){},SetSpellcheckText:function(editorId,response){var editNode=this.SetHtml(editorId,response)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor={AppendHtml:function(editorId,html){},ExecuteCommand:function(editorId,name,value){},FocusByNode:function(node){},GetComputedStyle:function(editorId,styleAttribute){},GetControlManager:function(editorId){},GetEditorInstanceByNode:function(node){},GetHtml:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);return hiddenNode.value},GetOnChangeEventByNode:function(node){},
GetSelectedNode:function(editorId){},GetSelectionContent:function(editorId){return""},IsDirty:function(editorId){},MoveToStart:function(editorId){},PasteDelayed:function(editorId,delayedFunction,selectionProvider,htmlProvider){},SelectNode:function(editorId,nodeToSelect){},SetHtml:function(editorId,html){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var node=htmlEditor.GetEditor(editorId);var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);hiddenNode.value=html},SetSize:function(editorId,
height,width){}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData=D2L.Class.Create({Construct:function(fileSystemType,id,name,size,location){if(fileSystemType===undefined)fileSystemType="";this.m_fileSystemType=fileSystemType;if(id===undefined)id="";this.m_id=id;if(name===undefined)name="";this.m_name=name;if(size===undefined)size=0;this.m_size=size;if(location===undefined)location="";this.m_location=location},_serialize:function(serializer){serializer.AddMember("fileSystemType",this.m_fileSystemType);serializer.AddMember("id",
this.m_id);serializer.AddMember("location",this.m_location)},GetFileSystemType:function(){return this.m_fileSystemType},GetId:function(){return this.m_id},GetName:function(){return this.m_name},GetLocation:function(){return this.m_location},GetSize:function(){return this.m_size}});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.Param=D2L.Class.Create({Construct:function(id,html,htmlOrgUnitId,files){if(id===undefined)id="";this.m_id=id;if(html===undefined)html="";this.m_html=html;if(htmlOrgUnitId===undefined)htmlOrgUnitId=0;this.m_htmlOrgUnitId=htmlOrgUnitId;if(files===undefined)files=[];this.m_files=files},_serialize:function(serializer){serializer.AddMember("id",this.m_id);serializer.AddMember("html",this.m_html);serializer.AddMember("htmlOrgUnitId",this.m_htmlOrgUnitId);serializer.AddMember("files",
this.m_files)},GetFiles:function(){return this.m_files},GetHtml:function(){return this.m_html}});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button={GetOnActiveChangeByNode:function(node){if(node.d2l_onActiveChange===undefined)node.d2l_onActiveChange=new D2L.LP.Web.UI.Events.Event;return node.d2l_onActiveChange},GetOnEnabledChangeByNode:function(node){if(node.d2l_onEnabledChange===undefined)node.d2l_onEnabledChange=new D2L.LP.Web.UI.Events.Event;return node.d2l_onEnabledChange},Initialize:function(){tinyMCE.create("d2l.tinymce.ui.Button:tinymce.ui.Control",{Button:function(id,s){this.parent(id,
s)},node:null,getNode:function(){if(this.node===null)this.node=D2L.LP.Web.UI.Html.Dom.GetElementById(this.settings.Id.GetValue());return this.node},setDisabled:function(value){if(value!=this.disabled){var action=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;if(value)action.SetIsEnabledByNode(this.getNode(),false);else action.SetIsEnabledByNode(this.getNode(),true);this.disabled=value}},setActive:function(value){if(value!=this.active){var action=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;
if(value)action.SetIsActiveByNode(this.getNode(),true);else action.SetIsActiveByNode(this.getNode(),false);this.active=value}}})},InitializeByNode:function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);
if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-onclick");if(!hasOnClick)return;var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);if(!isDisabled)eval(onClick)})},Register:function(name,
id,controlManager){var control=new d2l.tinymce.ui.Button(name,{Id:id});controlManager.add(control)},SetIsActive:function(id,isActive){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var buttonId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(buttonId);me.SetIsActiveByNode(node,isActive)},SetIsActiveByNode:function(node,isActive){if(isActive==D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-active",node))return;if(isActive)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-button-active",
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-button-active",node);if(node.d2l_onActiveChange!==undefined)node.d2l_onActiveChange.Trigger(isActive)},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetIsEnabledByNode(node,isEnabled)},SetIsEnabledByNode:function(node,isEnabled){var isDisabled=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",node);
if(!isEnabled==isDisabled)return;D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled",!isEnabled);if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-button-disabled",node);if(node.d2l_onEnabledChange!==undefined)node.d2l_onEnabledChange.Trigger(isEnabled)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ColorButton={SetColorSample:function(id,value){var sampleNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-color-sample",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));sampleNode.style.background=value},UpdateClassName:function(id,className,addClassName){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(addClassName==D2L.LP.Web.UI.Html.Dom.HasClassName(className,node))return;if(addClassName)D2L.LP.Web.UI.Html.Dom.AddClassName(className,
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName(className,node)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Menu={Register:function(menuId,editorNode){editorNode.d2l_onContentFocus.AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(menuId)})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SelectList={Initialize:function(){tinyMCE.create("d2l.tinymce.ui.SelectList:tinymce.ui.Control",{SelectList:function(id,s){this.parent(id,s)},select:function(value){if(value!=this.selectedValue){var newValue="";var selectList=D2L.LP.Web.UI.Common.Controls.SelectList;if(value!=undefined)if(value.call){var values=selectList.GetValues(this.settings.Id);for(var i=0;i<values.length;i++){var valueObject=values[i];if(this.settings.ValueAdapter)valueObject=
this.settings.ValueAdapter(values[i]);if(value(valueObject)){newValue=values[i];break}}}else newValue=value;selectList.SetSelectedValue(this.settings.Id,newValue);this.selectedValue=value}}})},Register:function(name,id,controlManager,valueAdapter){var settings;if(valueAdapter!==undefined)settings={Id:id,ValueAdapter:valueAdapter};else settings={Id:id};var control=new d2l.tinymce.ui.SelectList(name,settings);controlManager.add(control)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton={DoAction:function(splitButtonId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue());var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var activeItem=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-item-active",menuContainer);D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",activeItem)},SetIsActiveByNode:function(node,isActive){if(isActive)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-button-active",
node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-button-active",node)},SetIsEnabledByNode:function(node,isEnabled){if(isEnabled)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-button-disabled",node);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-button-disabled",node)},SetSelectedItemByNode:function(menuItem){var node=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-htmleditor-toolbar-item",
menuItem));D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,menuItem.getAttribute("data-d2l-key"))},Update:function(splitButtonId,itemKey){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(D2L.LP.Web.UI.Html.Dom.GetElementById(splitButtonId.GetValue()),itemKey)},UpdateByNode:function(node,itemKey){if(node.getAttribute("data-d2l-key")===itemKey)return;var itemData=node.d2l_itemsData[itemKey];if(itemData===undefined)return;var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;
node.setAttribute("title",itemData.title);D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",itemData.title);node.setAttribute("data-d2l-key",itemData.key);var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-button-icon",node);iconNode.src=itemData.src;iconNode.className="d2l-htmleditor-split-button-icon "+itemData.className;var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-buttonmenuitem",
menuContainer);for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute("data-d2l-key");if(key!==itemKey)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-split-item-active",menuItem);else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-split-item-active",menuItem);me.SetIsActiveByNode(node,D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-active",menuItem));me.SetIsEnabledByNode(node,!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-htmleditor-button-disabled",
menuItem))}}}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction={GetAttributesData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName=="BODY"||node.nodeType==9||node.getAttribute===undefined)return null;var title="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"title"))title=node.getAttribute("title");var idValue="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"id"))idValue=node.getAttribute("id");var className=node.className;
var style="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"style"))style=node.getAttribute("style");var textDirection="";if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"dir"))textDirection=node.getAttribute("dir");return{title:title,id:idValue,className:className,style:style,textDirection:textDirection}},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("attributes",buttonId);tinymce.create("d2l.tinymce.plugins.Attributes",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,
"attributes");editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isDisabled=node!=null&&(node.nodeName=="BODY"||node.nodeName=="BR"||node.nodeType==9);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabled(actionId,!isDisabled)})}});tinymce.PluginManager.add("d2l_attributes",d2l.tinymce.plugins.Attributes);return"-d2l_attributes"},SetAttributes:function(editorId,delayedFunction){delayedFunction.call(delayedFunction).AddListener(function(obj){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);
if(node==null)return;var setAttr=function(name,value){if(value=="")node.removeAttribute(name);else node.setAttribute(name,value)};node.className=obj.className;setAttr("title",obj.title);setAttr("id",obj.id);setAttr("style",obj.style);setAttr("dir",obj.textDirection)})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.AttributesAction.View={GetAttributes:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getTitle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getTitle");var title=getTitle.call(getTitle);var getId=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getId");var idValue=getId.call(getId);var getClassName=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getClassName");var className=getClassName.call(getClassName);
className=className.replace(/,[\s]*|;[\s]*/g," ");var getStyle=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getStyle");var style=getStyle.call(getStyle);var getTextDirection=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getTextDirection");var textDirection=getTextDirection.call(getTextDirection);return{title:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,title),id:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,idValue),className:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,className),style:D2L.LP.Web.UI.Html.JavaScript.TrimString(0,
style),textDirection:textDirection}}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-code",function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var textArea=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-dialog-textarea",node);var wordWrap=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node));var wordWrapRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(wordWrap);var resizeTextArea=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);
textArea.style.width=rect.width-46+"px";textArea.style.height=rect.height-wordWrapRect.height-35+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(function(){setTimeout(resizeTextArea,0)})});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.CodeAction.View={GetCode:function(id){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return textArea.value},SetWrap:function(id,isWrap){var textArea=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var wrapType="off";if(isWrap)wrapType="soft";textArea.setAttribute("wrap",wrapType)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction={InitializeLtr:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;me.GetPlugin().LtrButtonId=id;return"-d2l_directionality"},InitializeRtl:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.DirectionalityAction;me.GetPlugin().RtlButtonId=id;return"-d2l_directionality"},GetPlugin:function(){var plugin=tinymce.PluginManager.get("d2l_directionality");if(!plugin){tinymce.create("d2l.tinymce.plugins.Directionality",
{init:function(editor,url){var me=this;editor.onNodeChange.add(function(ed,cm,node){var dom=ed.dom;node=dom.getParent(node,dom.isBlock);var buttonToggle=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;if(!node){buttonToggle.SetIsEnabled(plugin.LtrButtonId,false);buttonToggle.SetIsEnabled(plugin.RtlButtonId,false);return}var direction=dom.getAttrib(node,"dir");buttonToggle.SetIsActive(plugin.LtrButtonId,direction=="ltr");buttonToggle.SetIsEnabled(plugin.LtrButtonId,true);buttonToggle.SetIsActive(plugin.RtlButtonId,
direction=="rtl");buttonToggle.SetIsEnabled(plugin.RtlButtonId,true)},me)}});plugin=tinymce.PluginManager.add("d2l_directionality",d2l.tinymce.plugins.Directionality)}return plugin},SetDirection:function(editorId,direction){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var editorInstance=htmlEditor.GetEditorInstanceById(editorId);var selectedNode=htmlEditor.GetSelectedNode(editorId);var element=editorInstance.dom.getParent(selectedNode,editorInstance.dom.isBlock);if(element)if(editorInstance.dom.getAttrib(element,
"dir")!=direction)editorInstance.dom.setAttrib(element,"dir",direction);else editorInstance.dom.setAttrib(element,"dir","");editorInstance.nodeChanged();editorInstance.focus()}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.EquationActions={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1)if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LatexEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("latex_editor",
buttonId);tinymce.create("d2l.tinymce.plugins.LatexEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"latex_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){isEnabled=node.getAttribute("data-d2l-mathml").indexOf("latex")>
-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_latexequation",d2l.tinymce.plugins.LatexEquation);return"-d2l_latexequation"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.GraphicalEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("graphical_editor",buttonId);tinymce.create("d2l.tinymce.plugins.GraphicalEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"graphical_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());var convertToImages=function(obj){var func=
function(match){var height=80;var width=80;var title=match.match(/title=(\"|\')([^\"]*)(\"|\')/i);if(title!=null&&title.length==4&&title[2]!=null)title=title[2];else title="";var annotationRegex=/<annotation encoding="([^"]*)">/gi;var annotationMatch=annotationRegex.exec(match);var classString="equation";if(annotationMatch==null)classString+=" mathmlequation";else if(annotationMatch[1]=="wiris")classString+=" graphicalequation";else if(annotationMatch[1]=="latex")classString+=" latexequation";else classString+=
" mathmlequation";return'<img class="'+classString+'" title="'+title+'" alt="'+title+'" src="/d2l/img/LP/htmlEditor/eq_trans.gif" width="'+width+'" height="'+height+'" style="vertical-align:middle;" hspace="5" vspace="5" data-d2l-mathml="'+encodeURIComponent(match)+'" />'};var appletFunc=function(match){var math=match.match(/<math[^>]*>(.|\n|\r)*<\/math>/gi);if(math!=null&&math.length>0)math=math[0];return func(D2L.LP.Web.UI.Html.Math.AnnotateMathML("wiris","",math,math))};obj.content=obj.content.replace(/<applet[^>]*>(.|\n|\r)*(<math[^>]*>(.|\n|\r)*<\/math>)(.|\n|\r)*<\/applet>/gi,
appletFunc);obj.content=obj.content.replace(/<math[^>]*>(.|\n|\r)*?<\/math>/gi,func)};var convertToMath=function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);return hack};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func)};editor.onInit.add(function(){editor.selection.onBeforeSetContent.add(function(se,o){convertToImages(o)})});
editor.onBeforeSetContent.add(function(editor,o){convertToImages(o)});editor.onPostProcess.add(function(editor,o){if(o.get)convertToMath(o)});editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){isEnabled=node.getAttribute("data-d2l-mathml").indexOf("wiris")>-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,
isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_graphicalequation",d2l.tinymce.plugins.GraphicalEquation);return"-d2l_graphicalequation"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.MathMLEquationAction={GetSelectedMathML:function(editorId){var mathML="";var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node&&node.nodeName=="IMG"&&node.className=="equation")if(node.attributes.getNamedItem("data-d2l-mathml")!=null){mathML=node.attributes.getNamedItem("data-d2l-mathml").value;var mathML=decodeURIComponent(mathML)}else if(node.attributes.getNamedItem("hack")!=null){var applet=node.attributes.getNamedItem("hack").value;
var appletDecoded=decodeURIComponent(applet);var tempDiv=document.createElement("div");tempDiv.innerHTML=appletDecoded;var math="";if(tempDiv!=null&&tempDiv.firstChild!=null&&tempDiv.firstChild.childNodes.length>0){var params=tempDiv.firstChild.childNodes;for(var i=0;i<params.length;i++)if(params[i].attributes!=null){var paramNameAtt=params[i].attributes.getNamedItem("name");if(paramNameAtt!=null&&paramNameAtt.value=="eq"){var paramValueAtt=params[i].attributes.getNamedItem("value");math=paramValueAtt.value;
mathML=D2L.LP.Web.UI.Html.Math.AnnotateMathML("webeq","",math,math);break}}}}return mathML},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("mathml_editor",buttonId);tinymce.create("d2l.tinymce.plugins.MathMLEquation",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"mathml_editor");var buttonNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionId.GetValue());var convertToImages=function(obj){var func=
function(match){var height=80;var width=80;var title=match.match(/title=(\"|\')([^\"]*)(\"|\')/i);if(title!=null&&title.length==4&&title[2]!=null)title=title[2];else title="";return'<img class="equation" title="'+title+'" alt="'+title+'" src="/d2l/img/LP/htmlEditor/eq_trans.gif" width="'+width+'" height="'+height+'" style="vertical-align:middle;" hspace="5" vspace="5" data-d2l-mathml="'+encodeURIComponent(match)+'" />'};var appletFunc=function(match){var math=match.match(/<math[^>]*>(.|\n|\r)*<\/math>/gi);
if(math!=null&&math.length>0)math=math[0];return func(D2L.LP.Web.UI.Html.Math.AnnotateMathML("mathml","",math,math))};obj.content=obj.content.replace(/<applet[^>]*>(.|\n|\r)*(<math[^>]*>(.|\n|\r)*<\/math>)(.|\n|\r)*<\/applet>/gi,appletFunc);obj.content=obj.content.replace(/<math[^>]*>(.|\n|\r)*?<\/math>/gi,func)};var convertToMath=function(obj){var func=function(match,sub1,sub2){var hackRegEx=/^<img[^>]*\s+data-d2l-mathml=\"([^\"]*)\"(.|\n|\r)*/i;var hackResult=hackRegEx.exec(match);var hack=decodeURIComponent(hackResult[1]);
return hack};obj.content=obj.content.replace(/<img[^>]*\s+data-d2l-mathml=\"[^\"]*\"[^>]*>/gi,func)};editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){var isEnabled=true;var isActive=false;if(!isCollapsed&&node.nodeName=="IMG"&&node.className.indexOf("equation")>-1){var mathml=node.getAttribute("data-d2l-mathml");isEnabled=mathml.indexOf("latex")==-1&&mathml.indexOf("wiris")==-1;isActive=isEnabled;if(isEnabled)D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.SetSelectedItemByNode(buttonNode)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsEnabledByNode(buttonNode,
isEnabled);D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActiveByNode(buttonNode,isActive)})}});tinymce.PluginManager.add("d2l_mathmlequation",d2l.tinymce.plugins.MathMLEquation);return"-d2l_mathmlequation"}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FontSizeAction={AdaptValue:function(value){return{fontSize:value}}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction={IsFullscreen:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());return node.d2l_isFullscreen===true},SetIsFullscreen:function(editorId,buttonId,isFullscreen){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;if(me.IsFullscreen(editorId)==isFullscreen)return;var button=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());
var bodyNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");if(bodyNode==null)bodyNode=document.getElementById("d2l_body");var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-header",node);var footerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",node);if(node.d2l_fullscreenResize===undefined)node.d2l_fullscreenResize=function(){var toolbarRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(toolbarNode);var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footerNode);
var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,viewPort.height+"px",viewPort.width+"px")};if(isFullscreen){var boundingRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);node.d2l_nomralSize={height:boundingRect.height,width:boundingRect.width};var viewPort=D2L.LP.Web.UI.Html.Dom.GetViewportSize();bodyNode.style.overflow="hidden";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-fullscreen",node);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,
viewPort.height+"px",viewPort.width+"px");D2L.LP.Web.UI.Events.OnResize.AddListener(node.d2l_fullscreenResize)}else{D2L.LP.Web.UI.Events.OnResize.RemoveListener(node.d2l_fullscreenResize);D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSize(editorId,node.d2l_nomralSize.height+"px",node.d2l_nomralSize.width+"px");D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-fullscreen",node);bodyNode.style.overflow="visible"}D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetIsResizeDisplayedByNode(node,!isFullscreen);
button.SetIsActive(buttonId,isFullscreen);node.d2l_isFullscreen=isFullscreen},ToggleFullscreen:function(editorId,buttonId){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.FullscreenAction;me.SetIsFullscreen(editorId,buttonId,!me.IsFullscreen(editorId))}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction={GetHorizontalRuleData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="HR")return null;var width=node.style.width;var widthType;if(width.indexOf("%")!=-1){width=width.replace("%","");widthType="%"}else if(width.indexOf("px")!=-1){width=width.replace("px","");widthType="px"}else return null;var height=node.style.height;if(height=="auto"||height.indexOf("px")==
-1)height=0;else height=height.replace("px","");var borderType="inset";if(node.style.borderStyle!="inset")borderType="solid";return{width:width,widthType:widthType,height:height,borderType:borderType}},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("horizontal_rule",buttonId);tinymce.create("d2l.tinymce.plugins.HorizontalRule",{init:function(editor,url){var actionId=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"horizontal_rule");
editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActive(actionId,node.nodeName=="HR")});editor.onClick.add(function(editor,e){e=e.target;if(e.nodeName==="HR")editor.selection.select(e)})}});tinymce.PluginManager.add("d2l_hr",d2l.tinymce.plugins.HorizontalRule);return"-d2l_hr"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.HorizontalRuleAction.View={GetHorizontalRule:function(id){var nodeId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId);var getWidthType=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getWidthType");var widthType=getWidthType.call(getWidthType);if(widthType!="px")widthType="%";var getWidthValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getWidthValue");var widthValue=getWidthValue.call(getWidthValue);if(widthValue==null){widthValue=
100;widthType="%"}var getHeightValue=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getHeightValue");var heightValue=getHeightValue.call(getHeightValue);if(heightValue==null)heightValue="auto";else heightValue=heightValue+"px";var getShadow=D2L.LP.Web.UI.ObjectRepository.TryGet(nodeId,"getShadow");var shadow=getShadow.call(getShadow);var borderStyle="solid";if(shadow)borderStyle="inset";var hr='<hr style="width: '+widthValue+widthType+"; "+"height: "+heightValue+"; "+"color: #ffffff; "+"border-style: "+
borderStyle+"; "+"border-width: 1px; "+'border-color: #cccccc;" />';return hr}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ImageAction={Insert:function(editorId,openFunction,orgUnitPath,tempFilePath){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,openFunction,null,function(responseValues){var files=responseValues[0];var isDecorative=responseValues[1];var altText=responseValues[2];if(isDecorative)altText="";else altText=D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(altText);var src;if(files[0].FileSystemType.toLowerCase()=="content"){src=files[0].FileId;if(src.substr(0,
1)!="/")src=orgUnitPath+src;src=D2L.LP.Web.UI.Html.JavaScript.UrlEncodePath(src);src=src.replace("%2E",".")}else if(files[0].FileSystemType.toLowerCase()=="temp")src=tempFilePath.replace("%7b0%7d",files[0].FileId);else if(files[0].FileSystemType.toLowerCase()=="external")src=files[0].GetFileId();D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TriggerFileAdded(editorId,new D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.FileData(files[0].FileSystemType,files[0].FileId,files[0].FileName,files[0].Size,src));var html=
'<img src="'+D2L.LP.Web.UI.Html.JavaScript.HtmlEncode(src)+'"'+' alt="'+altText+'" title="'+altText+'" />';return html})}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.IsfAction={Initialize:function(isWindowModeOpaque){tinymce.create("d2l.tinymce.plugins.Isf",{init:function(ed,url){var me=this;me.editor=ed;me.url=url;me.mce_href=new RegExp('_mce_href="[^"]*"',"g");me.mce_src=new RegExp('_mce_src="[^"]*"',"g");me.widthReAttribute=new RegExp("width=[\"']{1}[0-9px]+['\"]","gi");me.widthReQueryString=new RegExp("width=[0-9px]+","gi");me.heightReAttribute=new RegExp("height=[\"']{1}[0-9px]+['\"]","gi");me.heightReQueryString=
new RegExp("height=[0-9px]+","gi");ed.onInit.add(function(){ed.selection.onBeforeSetContent.add(function(se,o){me._convertToImages(o)})});ed.onBeforeSetContent.add(function(ed,o){me._convertToImages(o)});ed.onPostProcess.add(function(ed,o){if(o.get){me._convertToElements(o);return}})},_convertToImages:function(context){var me=this;if(context.content!=null&&context.content.length>0&&context.content.search(/(<object|<embed|<iframe)/i)!=-1){var html=context.content;var sb=new D2L.Util.StringBuilder;
var embedStartRe=new RegExp("(<embed)","i");var objectStartRe=new RegExp("(<object)","i");var iFrameStartRe=new RegExp("(<iframe)","i");var scriptStartRe=new RegExp("(<script|<mce:script)","i");var searchRe=new RegExp("(<object|<embed|<iframe|<script|<mce:script)","i");var toIndex=0;while(html.length>0){toIndex=html.search(searchRe);if(toIndex==0){embedStartRe.lastIndex=0;scriptStartRe.lastIndex=0;objectStartRe.lastIndex=0;iFrameStartRe.lastIndex=0;searchRe.lastIndex=toIndex;var match=searchRe.exec(html)[0];
if(scriptStartRe.test(match)){var scriptEndIndex=html.indexOf(">",toIndex);if(html.substr(scriptEndIndex-1,1)=="/")toIndex=scriptEndIndex+1;else{var scriptEndRe=new RegExp("(<\/script>|</mce:script>)","i");scriptEndIndex=html.search(scriptEndRe);if(scriptEndIndex!=-1)toIndex=html.indexOf(">",scriptEndIndex)+1;else toIndex=html.indexOf(">",toIndex)+1}sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}else if(objectStartRe.test(match)){var isValidObject=true;var objectHtml=html.substring(0).toLowerCase();
var objectCount=1;var objectFromIndex=7;var objectStartIndex=0;var objectEndIndex=0;while(objectCount>0){objectStartIndex=objectHtml.indexOf("<object",objectFromIndex);objectEndIndex=objectHtml.indexOf("</object>",objectFromIndex);if(objectStartIndex!=-1&&objectStartIndex<objectEndIndex){objectCount+=1;objectFromIndex=objectStartIndex+7}else if(objectEndIndex!=-1){objectCount-=1;objectFromIndex=objectEndIndex+9}if(objectEndIndex==-1){isValidObject=false;break}}if(isValidObject){sb.Append(me._createImage(html.substring(0,
objectFromIndex)));html=html.substring(objectFromIndex)}else{sb.Append(html);html=""}}else if(embedStartRe.test(match)){var embedEndIndex=html.indexOf(">");if(html.substr(embedEndIndex-1,1)=="/")embedEndIndex=embedEndIndex+1;else{var embedEndRe=new RegExp("</embed>","i");embedEndIndex=html.search(embedEndRe);if(embedEndIndex!=-1)embedEndIndex=embedEndIndex+8;else embedEndIndex=html.indexOf(">")+1}sb.Append(me._createImage(html.substring(0,embedEndIndex)));html=html.substring(embedEndIndex)}else if(iFrameStartRe.test(match)){var iFrameEndIndex=
html.indexOf(">");var iFrameHtml=html.substring(0,iFrameEndIndex+1);var iFrameSrcRe=new RegExp("src=('|\")[^>]*youtube[^'\">]*('|\")","i");iFrameHtml=iFrameHtml.replace(iFrameSrcRe,function(srcHtml){if(isWindowModeOpaque)if(srcHtml.indexOf("wmode")==-1)if(srcHtml.indexOf("?")==-1)return srcHtml.substring(0,srcHtml.length-1)+"?wmode=opaque"+srcHtml.substring(srcHtml.length-1);else return srcHtml.substring(0,srcHtml.length-1)+"&amp;wmode=opaque"+srcHtml.substring(srcHtml.length-1);else return srcHtml.replace(/wmode=([^&#\'\"]*)/,
"wmode=opaque");else if(srcHtml.indexOf("wmode")!=-1)return srcHtml=srcHtml.replace(/wmode=([^&#\'\"]*)/,"wmode=");else return srcHtml});sb.Append(iFrameHtml);html=html.substring(iFrameEndIndex+1)}}else if(toIndex==-1){sb.Append(html);break}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}}context.content=sb.ToString()}},_convertToElements:function(context){var me=this;if(context.content!=null&&context.content.length>0&&context.content.search(/data-isf-content/i)!=-1){var html=
context.content;var sb=new D2L.Util.StringBuilder;var toIndex=0;var imgStartRe=new RegExp("(<img)","i");while(html.length>0){imgStartRe.lastIndex=0;toIndex=html.search(imgStartRe);if(toIndex==0){var imgEndIndex=html.indexOf(">");if(html.substr(imgEndIndex-1,1)=="/")imgEndIndex=imgEndIndex+1;else{var imgEndRe=new RegExp("</img>","i");imgEndIndex=html.search(imgEndRe);if(imgEndIndex!=-1)imgEndIndex=imgEndIndex+6;else imgEndIndex=html.indexOf(">")+1}var imgHtml=html.substring(0,imgEndIndex);if(imgHtml.indexOf("data-isf-content")!=
-1)sb.Append(me._createElement(me._getAttributeValue("data-isf-content",imgHtml),me._getAttributeValue("height",imgHtml),me._getAttributeValue("width",imgHtml)));else sb.Append(imgHtml);html=html.substring(imgEndIndex)}else if(toIndex==-1){sb.Append(html);break}else{sb.Append(html.substring(0,toIndex));html=html.substring(toIndex)}}context.content=sb.ToString()}},_createElement:function(html,height,width){var me=this;if(width==null)width="100px";if(height==null)height="100px";html=decodeURIComponent(html);
html=html.replace(me.mce_href,"");html=html.replace(me.mce_src,"");html=html.replace(me.widthReAttribute,'width="'+width+'"');html=html.replace(me.heightReAttribute,'height="'+height+'"');html=html.replace(me.widthReQueryString,"width="+width);html=html.replace(me.heightReQueryString,"height="+height);return html},_createImage:function(html){var me=this;var dom=me.editor.dom;var width=me._getAttributeValue("width",html);if(width==null)width="100px";var height=me._getAttributeValue("height",html);
if(height==null)height="100px";var classId=me._getAttributeValue("classid",html);if(classId==null)classId=me._getAttributeValue("type",html);return'<img src="/d2l/img/LP/htmlEditor/eq_trans.gif" '+'width="'+width+'" '+'height="'+height+'" '+'class="'+me._getImageClassName(classId)+'" '+'data-isf-content="'+encodeURIComponent(html)+'" />'},_getImageClassName:function(classId){if(classId!=null){classId=classId.toLowerCase();var guidIndex=classId.indexOf(":");if(guidIndex!=-1&&classId.length>guidIndex+
1)classId=classId.substring(guidIndex+1)}else classId="";switch(classId){case "d27cdb6e-ae6d-11cf-96b8-444553540000":case "application/x-shockwave-flash":case "d2l_flash":return"disf_flash";case "166b1bca-3f9c-11cf-8075-444553540000":return"disf_shockwave";case "6bf52a52-394a-11d3-b153-00c04f79faa6":case "22d6f312-b0f6-11d0-94ab-0080c74c7e95":case "05589fa1-c356-11ce-bf01-00aa0055595a":return"disf_windowsmedia";case "02bf25d5-8c17-4b23-bc80-d3488abddc6b":case "d2l_qt":return"disf_quicktime";case "cfcdaa03-8be4-11cf-b84b-0020afbbccfa":return"disf_realmedia";
default:return"disf_default"}},_getAttribute:function(attributeName,html){var attRe=new RegExp(attributeName+"=(\"[^<>\"]*\"|'[^<>']*'|w+)","i");var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>0)return attMatch[0];else return null},_getAttributeValue:function(attributeName,html){var attValue=null;var attRe=new RegExp(attributeName+"=(\"[^<>\"]*\"|'[^<>']*'|w+)","i");var attMatch=attRe.exec(html);if(attMatch!=null&&attMatch.length>1)if(attMatch[1].length>1&&(attMatch[1].substr(0,1)==
"'"||attMatch[1].substr(0,1)=='"'))attValue=attMatch[1].substring(1,attMatch[1].length-1);else attValue=attMatch[1];return attValue}});tinymce.PluginManager.add("d2l_isf",d2l.tinymce.plugins.Isf);return"-d2l_isf"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.LinkAction={GetLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="A")return null;var href=node.getAttribute("href");var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=node.getAttribute("target");if(target=="_top")target=1;else if(target=="_blank")target=2;else target=0;return{href:href,target:target,title:title}},GetLinkSelectedText:function(editorId){var text;
var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==="A")text=D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);else text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);if(text===undefined||text===null)text="";return text},Initialize:function(buttonId){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetActionId("link",buttonId);tinymce.create("d2l.tinymce.plugins.Link",{init:function(editor,url){var actionId=
D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetActionId(editor.settings.d2l_context.Id,"link");editor.onNodeChange.add(function(editor,controlManager,node,isCollapsed){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.SetIsActive(actionId,node.nodeName=="A")});editor.onClick.add(function(editor,e){e=e.target;if(e.nodeName==="A")editor.selection.select(e)})}});tinymce.PluginManager.add("d2l_link",d2l.tinymce.plugins.Link);return"-d2l_link"},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;
var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null)return;if(selectedNode.nodeName=="A")htmlEditor.SelectNode(editorId,selectedNode)}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.PasteAction={PasteWord:function(editorId,pastedContent){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.ExecuteCommand(editorId,"mceInsertClipboardContent",{content:pastedContent,wordContent:true})},InitializePastePlainText:function(notifyAlways){tinymce.create("d2l.tinymce.plugins.PastePlainText",{init:function(editor,url){editor.settings["paste_text_notifyalways"]=notifyAlways}});tinymce.PluginManager.add("d2l_pastePlainText",d2l.tinymce.plugins.PastePlainText);
return"paste,-d2l_pastePlainText"},InitializePasteWord:function(){return"paste"}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-paste",function(node){var doc=node.contentWindow.document;var cssHtml="";doc.open();doc.write("<html><head>"+cssHtml+'</head><body class="mceContentBody" spellcheck="false"></body></html>');doc.close();doc.designMode="on";var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var pasteIntr=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);var pasteIntrRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(pasteIntr);
var resizePasteFrame=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);node.style.width=rect.width-46+"px";node.style.height=rect.height-pasteIntrRect.height-35+"px"};D2L.LP.Web.UI.Events.OnResize.AddListener(function(){setTimeout(resizePasteFrame,0)});window.setTimeout(function(){node.contentWindow.focus()},10)});D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.PasteWordAction={GetContent:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.contentWindow.document.body.innerHTML}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-preview",function(node){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-dialog-body",node);var resizeFrame=function(){setTimeout(function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody);node.style.width="100%";node.style.height=rect.height-8+"px"},50)};D2L.LP.Web.UI.Events.OnResize.AddListener(resizeFrame)});
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SpellcheckAction={Apply:function(editorId,openFunction){openFunction.call(openFunction).AddListener(function(responseValue){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.SetSpellcheckText(editorId,responseValue)})},GetText:function(editorId){return D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSpellcheckText(editorId)}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction={};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View={GetEntityFromString:function(charValue){var entityExp=/&#[^;]*;/g;var result=entityExp.exec(charValue);if(result==null||result[0].length<4)return"";return result[0]},GetSelectedSymbol:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("data-d2l-editId"));var charValue=
D2L.LP.Web.UI.Common.Controls.Edit.GetValue(editId);return me.GetEntityFromString(charValue)},SetSelectedSymbol:function(id,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());me.SetSelectedSymbolByNode(node,charValue)},SetSelectedSymbolByNode:function(node,charValue){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;if(node.d2l_selectedCharacter==charValue)return;charValue=
me.GetEntityFromString(charValue);if(node.d2l_charNodes===undefined)node.d2l_charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-symbol-char",node);var htmlCodeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-htmlcode",node));htmlCodeNode.innerHTML="&nbsp;";for(var i=0;i<node.d2l_charNodes.length;i++){var charNode=node.d2l_charNodes[i];if(charNode.d2l_isSelected){charNode.d2l_isSelected=false;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-symbol-char-selected",
charNode)}if(charNode.getAttribute("data-d2l-numcode")==charValue){charNode.d2l_isSelected=true;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-symbol-char-selected",charNode);htmlCodeNode.innerHTML=charNode.getAttribute("data-d2l-htmlcode").replace("&","&amp;")}}node.d2l_selectedCharacter=charValue;var symbolNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-symbol",node);if(charValue.length==0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-symbol-symbol-invalid",
symbolNode);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-symbol-symbol-invalid",symbolNode);D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(symbolNode).innerHTML=node.d2l_selectedCharacter}};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.TableAction={Initialize:function(buttonId){return"table"}};
D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.ReplaceStringScript={Initialize:function(replace){tinymce.create("d2l.tinymce.plugins.ReplaceString",{init:function(editor,url){var decodeReplaceStrings=function(obj){var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement("div");tempNode.innerHTML=match;var img=tempNode.firstChild;var d2l_src=img.getAttribute("data-d2l-src");if(d2l_src!=""){img.setAttribute("src",decodeURIComponent(d2l_src));
img.removeAttribute("data-d2l-src");if(img.getAttribute("data-mce-src")!=null)img.setAttribute("data-mce-src",decodeURIComponent(d2l_src));return tempNode.innerHTML}else return match};html=html.replace(/<img[^>]*\sdata-d2l-src[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func);obj.content=html.replace(/(%7B(orgId|orgName|orgUnitId|OrgUnitName|OrgUnitCode|OrgUnitPath|UserId|UserName|OrgDefinedId|FirstName|LastName|ExternalEmail|InternalEmail|RoleId)%7D)/gi,"{$2}")}};var encodeReplaceStrings=
function(obj){var html=obj.content;if(html!=null&&html.length>0){var func=function(match){var tempNode=document.createElement("div");tempNode.innerHTML=match;var img=tempNode.firstChild;var mce_src=img.getAttribute("data-mce-src");var src=null;if(mce_src!=null)src=mce_src;else src=img.getAttribute("src");var originalSrc=src;for(var key in replace){var regEx=new RegExp("{"+key+"}","i");src=src.replace(regEx,replace[key])}if(src!=originalSrc){img.setAttribute("src",src);img.setAttribute("data-d2l-src",
encodeURIComponent(originalSrc));if(mce_src!=null)img.setAttribute("mce_src",src);return tempNode.innerHTML}else return match};obj.content=html.replace(/<img[^>]*\ssrc[\s]*=[\s]*(\'([^\']*)\'|\"([^\"]*)\"|([^>^\s^\/]*))[^>]*>/gi,func)}};editor.onInit.add(function(){editor.selection.onBeforeSetContent.add(function(se,obj){encodeReplaceStrings(obj)})});editor.onBeforeSetContent.add(function(ed,obj){encodeReplaceStrings(obj)});editor.onPostProcess.add(function(ed,obj){if(obj.get){decodeReplaceStrings(obj);
return}})}});tinymce.PluginManager.add("d2l_replacestring",d2l.tinymce.plugins.ReplaceString);return"-d2l_replacestring"}};D2L.LP.Web.UI.Desktop.Controls.ListIcon={SetIcon:function(id,icon){var idVal=id.GetValue();var item=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(item===null)throw"ListIconItem not found: '"+idVal+"'.";item.style.backgroundImage="url("+icon+")"}};
D2L.LP.Web.UI.Desktop.Controls.LoadMorePager={Pagers:[],Init:function(id,controlProvider,pageableControlId,showFunction,hideFunction,setLoadingTextFunction,setNormalTextFunction){var pager=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(pager===null)return;var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var pageableControl=controlProvider.call(controlProvider);var info={ControlProvider:controlProvider,IsLoading:false,SetLoadingFunction:setLoadingTextFunction,PageableControl:pageableControl,PageableControlId:pageableControlId};
me.Pagers[id]=info;var setIsVisible=function(isVisible){if(isVisible)showFunction();else hideFunction()};var onLoadCompleteFunction=function(hasMoreItems){setIsVisible(hasMoreItems)};pageableControl.GetOnLoadCompletedEvent(pageableControlId).AddListener(onLoadCompleteFunction);var onLoadMoreCompleteFunction=function(hasMoreItems){me.Pagers[id].IsLoading=false;setNormalTextFunction();setIsVisible(hasMoreItems)};pageableControl.GetOnLoadMoreCompletedEvent(pageableControlId).AddListener(onLoadMoreCompleteFunction);
pager.d2l_onLoadCompleteHandle=onLoadCompleteFunction;pager.d2l_onLoadMoreHandle=onLoadMoreCompleteFunction;pager.d2l_pageableControl=pageableControl;pager.d2l_pageableControlId=pageableControlId;setIsVisible(pageableControl.GetHasMoreItems(pageableControlId))},LoadMore:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.LoadMorePager;var info=me.Pagers[id];if(info===undefined||info.IsLoading)return;info.IsLoading=true;setTimeout(function(){if(info.IsLoading)info.SetLoadingFunction()},1E3);info.PageableControl.LoadMore(info.PageableControlId)}};
D2L.LP.Web.UI.Desktop.Controls.InlineHelp={m_popupLocation:null,Init:function(popupLocation){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;me.m_popupLocation=popupLocation},SetText:function(id,text){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"InlineHelp not found: '"+idVal+"'.";node.innerHTML=text},PopupHelp:function(titleTerm,descriptionTerm){var me=D2L.LP.Web.UI.Desktop.Controls.InlineHelp;var loc=me.m_popupLocation;loc=loc.WithQueryString("titleTerm",
titleTerm);loc=loc.WithQueryString("descriptionTerm",descriptionTerm);var name=titleTerm.toLowerCase().replace(".","_").replace("\\","_");D2L.LP.Web.UI.Html.Dom.OpenWindow("popupHelp_"+name,loc,600,400,false,false)}};
D2L.LP.Web.UI.Desktop.Controls.IntegerSelector={Increment:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);var currentValue=me.TryGetCurrentValue(id);var maxValue=context.MaxValue;var delta=context.Delta;if(currentValue==null)return;if(maxValue==null||currentValue+delta<=maxValue)me.SetEditIntegerValue(id,currentValue+delta);me.UpdateButtons(id)},Decrement:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);
var currentValue=me.TryGetCurrentValue(id);var minValue=context.MinValue;var delta=context.Delta;if(currentValue==null)return;if(minValue==null||currentValue-delta>=minValue)me.SetEditIntegerValue(id,currentValue-delta);me.UpdateButtons(id)},UpdateButtons:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector;var context=me.GetContext(id);var currentValue=me.TryGetCurrentValue(id);var minValue=context.MinValue;var maxValue=context.MaxValue;var moreButtonId=context.MoreButtonId;var lessButtonId=
context.LessButtonId;var delta=context.Delta;if(currentValue==null)return;D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(moreButtonId,true);D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(lessButtonId,true);if(maxValue!=null&&currentValue+delta>maxValue)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(moreButtonId,false);if(minValue!=null&&currentValue-delta<minValue)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(lessButtonId,false)},GetContext:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue()+
"_c")},SetEditIntegerValue:function(id,val){D2L.LP.Web.UI.Common.Controls.EditInteger.SetInteger(id,val);var context=D2L.LP.Web.UI.Desktop.Controls.IntegerSelector.GetContext(id);if(context.TextBlockId!=null)D2L.LP.Web.UI.Common.Controls.TextBlock.SetText(context.TextBlockId,D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(val))},TryGetCurrentValue:function(id){return D2L.LP.Web.UI.Common.Controls.EditInteger.TryGetInteger(id)}};
D2L.LP.Web.UI.Desktop.Controls.Iterator={SetIsEnabled:function(id,isEnabled){var elementId=id;if(id.GetValue)elementId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(elementId);var anchorNodes=node.getElementsByTagName("a");var stateFunction=isEnabled?D2L.LP.Web.UI.Desktop.Controls.Iterator.SetEnabled:D2L.LP.Web.UI.Desktop.Controls.Iterator.SetDisabled;for(var i=0;i<anchorNodes.length;i++)stateFunction(anchorNodes[i])},SetEnabled:function(node){D2L.LP.Web.UI.Desktop.Controls.Iterator.OnClickAttributeHelper(node,
false);$(node).removeClass("d2l-button-disabled d2l-iterator-button-disabled")},SetDisabled:function(node){D2L.LP.Web.UI.Desktop.Controls.Iterator.OnClickAttributeHelper(node,true);$(node).addClass("d2l-button-disabled d2l-iterator-button-disabled")},OnClickAttributeHelper:function(node,isEnabled){var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,isEnabled?"onclick":"data-onclick");if(!hasOnClick)return;var onclick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,isEnabled?"onclick":"data-onclick");
D2L.LP.Web.UI.Html.Dom.SetAttribute(node,isEnabled?"data-onclick":"onclick",onclick);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,isEnabled?"onclick":"data-onclick")}};
D2L.LP.Web.UI.Desktop.Controls.MenuFlyout={Init:function(menuNode,openerNode,contentsNode,textNode,openFunction,openFirstFunction,closeFunction){D2L.LP.Web.UI.Html.Aria.SetRole(openerNode,"button");D2L.LP.Web.UI.Html.Aria.SetAttribute(openerNode,"controls",contentsNode.id);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","true");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(contentsNode,"tabindex","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,
"live",D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);if(textNode!==null){var id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();textNode.id=id;D2L.LP.Web.UI.Html.Aria.SetAttribute(openerNode,"labelledby",id);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"labelledby",id)}var isOpen=false;var opening=false;var isFirst=true;var isAuto=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-contents-left",contentsNode)&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-contents-right",contentsNode);
var onFocus=function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(contentsNode,activeNode)&&!D2L.LP.Web.UI.Html.Dom.IsAncestor(menuNode,activeNode))close()};var open=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-open",menuNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-closed",menuNode);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","false");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","true");
isOpen=true;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",document.body,onFocus,true);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.UpdatePosition(isAuto,contentsNode,menuNode);if(openFunction)openFunction.call(openFunction);if(isFirst&&openFirstFunction){isFirst=false;openFirstFunction.call(openFirstFunction)}D2L.LP.Web.UI.Html.Dom.FocusNode(contentsNode)};var close=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-open",menuNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-closed",
menuNode);D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"hidden","true");D2L.LP.Web.UI.Html.Aria.SetAttribute(contentsNode,"expanded","false");isOpen=false;D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",document.body,onFocus,true);if(closeFunction)closeFunction.call(closeFunction)};menuNode.d2l_closeHandle=close;var onclick=function(){if(isOpen)close();else{opening=true;setTimeout(function(){opening=false},200);open()}};D2L.LP.Web.UI.Events.OnClick.AddListener(function(){if(!isOpen||opening)return;
close()});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",openerNode,onclick);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",contentsNode,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e)});var handleKeyPress=function(arg){if(arg.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape){close();D2L.LP.Web.UI.Html.Dom.FocusNode(openerNode)}else return true;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(arg.GetEventObject());return false};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(contentsNode,
handleKeyPress)},UpdatePosition:function(isAuto,contentsNode,menuNode){if(!isAuto)return;var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-contents-left",contentsNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-contents-right",contentsNode);var parent=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-max-width",contentsNode)||document.body;
var flyoutRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(menuNode);var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parent);var contentsRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(contentsNode);var left=Math.max(flyoutRect.right-parentRect.left,0);var right=Math.max(parentRect.right-flyoutRect.left,0);var rightOverflow;if(isRTL)rightOverflow=left-contentsRect.width;else rightOverflow=right-contentsRect.width;if(rightOverflow>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-contents-right",
contentsNode);else if((isRTL?right:left)-contentsRect.width>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-contents-left",contentsNode);else if(isRTL)contentsNode.style.right=rightOverflow+"px";else contentsNode.style.left=rightOverflow+"px"},Close:function(id){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!flyout)return;D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.CloseByNode(flyout)},CloseByNode:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-open",
node))return;node.d2l_closeHandle.call(node.d2l_closeHandle)},GetOpenMenuFlyouts:function(node){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-menuflyout-open",node)},IsOpen:function(id){var flyout=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!flyout)return;return D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-menuflyout-open",flyout)},SetTitle:function(id,val){var flyout=id.$();if(flyout.length===0)return;var openerAnchor=$(".d2l-menuflyout-opener",flyout);openerAnchor.prop("title",
val);$(".d2l-menuflyout-text",openerAnchor).text(val)}};
D2L.LP.Web.UI.Common.Controls.MessageArea={IsVisible:false,PlaceholderId:null,ErrorLocation:null,Apply:function(delegate){var ma=D2L.LP.Web.UI.Html.Dom.GetElementById(D2L.LP.Web.UI.Common.Controls.MessageArea.PlaceholderId);if(ma!==null)delegate.call(delegate,ma)},CreateBalloon:function(message){var tipNode=document.createElement("div");tipNode.className="d2l-form-balloon-tip";var borderNode=document.createElement("div");borderNode.className="d2l-form-balloon-border";var balloonId=new D2L.LP.Web.UI.Html.UniqueHtmlId;
var balloon=document.createElement("div");balloon.id=balloonId.GetValue();balloon.className="d2l-form-balloon";var balloonChildren=document.createElement("div");balloonChildren.className="d2l-form-balloon-children";var balloonTextSpan=document.createElement("span");balloonTextSpan.className="d2l-form-balloon-text";balloonTextSpan.appendChild(document.createTextNode(message));balloonChildren.appendChild(borderNode);balloonChildren.appendChild(tipNode);balloonChildren.appendChild(balloonTextSpan);balloon.appendChild(balloonChildren);
return balloon},Init:function(placeholderId,errorLocation){var me=D2L.LP.Web.UI.Common.Controls.MessageArea;me.PlaceholderId=placeholderId;me.ErrorLocation=errorLocation},Reset:function(balloonContainer){D2L.LP.Web.UI.Common.Controls.MessageArea.SetIsVisible(false);var balloons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-form-balloon",balloonContainer);for(var i=0;i<balloons.length;i++){if(balloons[i].d2l_input!==undefined){D2L.LP.Web.UI.Html.Aria.SetAttribute(balloons[i].d2l_input,"labelledby",
"");balloons[i].d2l_input.style.marginBottom=balloons[i].d2l_input_original_bottom_margin;balloons[i].d2l_input=null}balloons[i].parentNode.removeChild(balloons[i])}},RpcReceivePayloadProvider:function(data){var me=D2L.LP.Web.UI.Common.Controls.MessageArea;var count=0;var updateVisibility=function(){count++;if(data.Items.length===0||count===data.Items.length)me.Apply(function(node){node.innerHTML=data.Html;D2L.LP.Web.UI.Events.OnViewRender.Trigger(node);me.SetIsVisible(true);D2L.LP.Web.UI.Html.Dom.FocusNode(node)})};
if(data.Items.length===0)updateVisibility();for(var i=0;i<data.Items.length;i++)(function(index){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(data.Items[index].Key);if(input===null){updateVisibility();return}var balloon=me.CreateBalloon(data.Items[i].Message);balloon.d2l_input=input;var balloonChildrenNode=balloon.firstChild;D2L.LP.Web.UI.Html.Dom.InsertElementAfter(balloon,input);D2L.LP.Web.UI.Html.Aria.SetAttribute(input,"labelledby",balloon.id);setTimeout(function(){var bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,
"margin-bottom");if(bottomMargin===undefined){bottomMargin=D2L.LP.Web.UI.Html.Css.GetStyle(input,"marginBottom");if(bottomMargin===undefined)bottomMargin="0px"}balloon.d2l_input_original_bottom_margin=bottomMargin;input.style.marginBottom=balloonChildrenNode.offsetHeight+10+"px";balloon.style.marginTop=-balloonChildrenNode.offsetHeight+"px";balloon.style.height=balloonChildrenNode.offsetHeight+"px";updateVisibility()},0)})(i)},SetIsVisible:function(isVisible){D2L.LP.Web.UI.Common.Controls.MessageArea.Apply(function(ma){var me=
D2L.LP.Web.UI.Common.Controls.MessageArea;if(me.IsVisible==isVisible)return;ma.style.display=isVisible?"block":"none";me.IsVisible=isVisible;D2L.LP.Web.UI.Events.OnContentHeightChange.Trigger()})},ShowErrors:function(errors){D2L.LP.Web.UI.Rpc.Connect(D2L.LP.Web.UI.Rpc.Verbs.POST,D2L.LP.Web.UI.Common.Controls.MessageArea.ErrorLocation,{errors:errors})}};
(function($){if(vui===undefined)if(typeof require==="function")vui=require("../../core");else throw new Error("load vui first");if(typeof module==="object"&&typeof module.exports==="object")module.exports=vui;$.widget("vui.vui_moreless",{options:{height:"4em",lineHeight:"normal",title:{more:"more",less:"less"},color:"#FAFAFA"},_$moreblur:null,_$moreless:null,_$morelink:null,pollingVariable:null,_accessibileButton:function(title,iconClass){var me=this;me._$morelink.empty();me._$morelink.append('<span class="'+
iconClass+'">');if(!this.options.accessible){me._$morelink.attr("aria-hidden","true");me._$morelink.append(title)}else{me._$morelink.attr("aria-role","button");title=$("<span>"+title+"</span>");me._$morelink.append(title)}},_create:function(){var me=this;me._$moreless=$(this.element);me._$morelink=$('<div class="vui-moreless-link vui-link" tabindex="0">');me._$moreless.after(me._$morelink);me.options.title.more=me._$moreless.attr("data-moreless-moretitle")!==undefined?me._$moreless.attr("data-moreless-moretitle"):
me.options.title.more;me.options.title.less=me._$moreless.attr("data-moreless-lesstitle")!==undefined?me._$moreless.attr("data-moreless-lesstitle"):me.options.title.less;me.options.accessible=me._$moreless.attr("data-moreless-accessible")!==undefined&&me._$moreless.attr("data-moreless-accessible")!=="False"?true:false;me.options.color=me._$moreless.attr("data-moreless-blurcolor")!==undefined?me._$moreless.attr("data-moreless-blurcolor"):me.options.color;var lineHeight=me._$moreless.attr("data-moreless-lineHeight")!==
undefined?me._$moreless.attr("data-moreless-lineHeight"):me.options.lineHeight;me._$moreless.css("line-height",lineHeight);var $breakafter=me._$moreless.find(".vui-moreless-breakafter");var height=0;if($breakafter.length){$breakafter=$($breakafter[0]);height=$breakafter.position().top-me._$moreless.position().top+$breakafter.get(0).scrollHeight}else{height=me._$moreless.attr("data-moreless-height")!==undefined?me._$moreless.attr("data-moreless-height"):me.options.height;if(height.indexOf("%")>-1)height=
parseInt(me._$moreless.get(0).scrollHeight*(parseInt(height,10)/100)+0.5,10);me._$moreblur=$('<div class="vui-moreless-blur">');me.BlurColor(me.options.color);me._$moreless.after(me._$moreblur)}me._$moreless.height(height);me._accessibileButton(me.options.title.more,"vui-icon-moreless-chevron-down");me._$morelink.on("click",function(e){me._switchMoreLess(height)});me._$morelink.on("keypress",function(e){var keyCode=e.keyCode||e.which;if(keyCode===13)me._switchMoreLess(height)});var isTab=false;$(document).keydown(function(e){var keyCode=
e.keyCode||e.which;if(keyCode===9)isTab=true;else isTab=false});me._$moreless.focusin(function(event){if(!me._$moreless.hasClass("vui-moreless-more")&&isTab){me._$moreless.get(0).scrollTop=0;me._$morelink.focus();isTab=false}});var moreLessHeight=parseInt(height,10);me._startPolling(125,moreLessHeight)},_hexToRgb:function(inHex){if(inHex.indexOf("#")>-1)inHex=inHex.substring(1);if(inHex.length===3){var shorthandRegex=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;inHex=inHex.replace(shorthandRegex,function(m,
r,g,b){return r+r+g+g+b+b})}var bigint=parseInt(inHex,16);var r=bigint>>16&255;var g=bigint>>8&255;var b=bigint&255;return{red:r,green:g,blue:b}},_startPolling:function(timeout,morelessHeight){var me=this;me._fixMoreLess(morelessHeight);me.pollingVariable=setTimeout(function(){me._startPolling(timeout<1E4?timeout*2:timeout,morelessHeight)},timeout)},_fixMoreLess:function(morelessHeight){var me=this;if(me._$moreless.hasClass("vui-moreless-more"))return;me._hideShowMore(morelessHeight);me._showShowMore(morelessHeight)},
_hideShowMore:function(morelessHeight){var me=this;var scrollHeight=me._$moreless.get(0).scrollHeight;var childrenHeight=me._$moreless.children().height();var h=scrollHeight==morelessHeight?childrenHeight:scrollHeight;if(me._$moreless&&h<morelessHeight){me._$moreless.height(h);me._$morelink.css("display","none");if(me._$moreblur)me._$moreblur.css("display","none")}else if(me._$moreless&&h!=me._$moreless.height())me._$moreless.height(h)},_showShowMore:function(morelessHeight){var me=this;var scrollHeight=
me._$moreless.get(0).scrollHeight;var childrenHeight=me._$moreless.children().height();var h=scrollHeight==morelessHeight?childrenHeight:scrollHeight;if(me._$moreless&&h>=morelessHeight){me._$moreless.height(morelessHeight);me._$morelink.css("display","inherit");if(me._$moreblur)me._$moreblur.css("display","inherit")}},_switchMoreLess:function(inHeight){var me=this;if(!me._$moreless.hasClass("vui-moreless-transition-effect"))me._$moreless.addClass("vui-moreless-transition-effect");if(me._$moreless.hasClass("vui-moreless-more")){me._$moreless.removeClass("vui-moreless-more");
if(me._$moreblur)me._$moreblur.css("display","block");me._$moreless.css("height",inHeight);me._accessibileButton(me.options.title.more,"vui-icon-moreless-chevron-down");me._$moreless.trigger("vui-moreless-collapse")}else{me._$moreless.addClass("vui-moreless-more");if(me._$moreblur)me._$moreblur.css("display","none");me._$moreless.css("height",me._$moreless.get(0).scrollHeight);me._accessibileButton(this.options.title.less,"vui-icon-moreless-chevron-up");me._$moreless.trigger("vui-moreless-expand")}},
_destroy:function(){var me=this;if(me.pollingVariable!==null)clearInterval(me.pollingVariable);me.pollingVariable=false},BlurColor:function(inColor){var me=this;if(me._$moreblur!==null){var rgba0="rgba( 250, 250, 250, 0)";var rgba1="rgba( 250, 250, 250, 1)";if(inColor.indexOf("#")>-1){var rgb=me._hexToRgb(inColor);rgba0="rgba("+rgb.red+","+rgb.green+","+rgb.blue+", 0)";rgba1="rgba("+rgb.red+","+rgb.green+","+rgb.blue+", 1)"}var moz="-moz-linear-gradient(top, "+rgba0+" 0%, "+rgba1+" 100%)";var webkit1=
"-webkit-gradient(linear, left top, left bottom, color-stop(0%, "+rgba0+"), color-stop(100%, "+rgba1+"))";var webkit2="-webkit-linear-gradient(top, "+rgba0+" 0%, "+rgba1+"100%)";var o="-o-linear-gradient(top, "+rgba0+" 0%, "+rgba1+" 100%)";var ms="-ms-linear-gradient(top, "+rgba0+" 0%, "+rgba1+" 100%)";var general="linear-gradient(to bottom, "+rgba0+" 0%, "+rgba1+" 100%)";me._$moreblur.css({"background":"transparent"}).css({"background":moz}).css({"background":webkit1}).css({"background":webkit2}).css({"background":o}).css({"background":ms}).css({"background":general})}},
isExpanded:function(node){return $(node).hasClass("vui-moreless-more")},Refresh:function(inColor){if(inColor!==null)this.BlurColor(inColor);this._fixMoreLess()}});vui.addClassInitializer("vui-moreless",function(node){$(node).vui_moreless()})})(window.jQuery);
D2L.LP.Web.UI.Desktop.Controls.MoreLess={IsExpanded:function(moreLessId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless("isExpanded",node)},ChangeBlurColor:function(moreLessId,newColor){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless("BlurColor",node,newColor)},Refresh:function(moreLessId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(moreLessId.GetValue());return $(window).vui_moreless("Refresh",
node)}};
D2L.LP.Web.UI.Desktop.Controls.MultiSelect={AddItems:function(id,data){for(var i=0;i<data.length;i++)D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnItemAdded(id,data[i].GetValue(),data[i].GetKey(),true)},Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);var items=me.GetAllItems(handle);for(var i=0;i<items.length;i++)me.RemoveItem(handle,items[i])},Focus:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);handle.inputNode.focus()},GetAddedItem:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);var newItem=me.GetLastItem(handle);var hiddens=me.GetHiddenNodes(newItem);var itemParam=new me.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value);return itemParam},GetAllItems:function(handle){var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-multiselect-choice",handle.node);for(var i=items.length;i>=0;i--)if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",items[i]))items.splice(i,1);
return items},GetDataAttribute:function(node,attribute){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,attribute))return null;var value=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,attribute);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,attribute);if(value==="true"||value==="True")value=true;else if(value==="false"||value=="False")value=false;return value},GetHandle:function(nodeId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(nodeId.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-multiselect",
node))node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-multiselect",node);return node.handle},GetHiddenNodes:function(itemNode){var actionHidden=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(itemNode);var keyHidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(actionHidden);var valueHidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(keyHidden);return{actionNode:actionHidden,keyNode:keyHidden,valueNode:valueHidden}},GetItems:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;
var handle=me.GetHandle(id);var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-multiselect-choice",handle.node);var items=[];for(var i=0;i<itemNodes.length;i++){var hiddens=me.GetHiddenNodes(itemNodes[i]);items.push(new me.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value))}var param=new me.Param(items);return param},GetLastItem:function(handle){var items=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetAllItems(handle);var lastItem=items[items.length-1];
return lastItem},GetRemovedItem:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);return handle.removedItem},GetValue:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);return handle.inputNode.value},InitHandle:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle={node:node,inputNode:null,placeholderNode:null,autoCompleteId:null,removedOriginals:[],width:0,onItemAdded:null,onItemRemoved:null,removedItem:null,customParseMode:false};
var inputId=me.GetDataAttribute(handle.node,"data-d2l-input");handle.width=handle.node.scrollWidth-20;handle.inputNode=D2L.LP.Web.UI.Html.Dom.GetElementById(inputId);handle.placeholderNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-multiselect-placeholder",node)[0];handle.autoCompleteId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.inputNode,"aria-owns"));handle.onItemAdded=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,"itemAdded");handle.onItemRemoved=
D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,"itemRemoved");handle.customParseMode=me.GetDataAttribute(handle.node,"data-d2l-customparsemode");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.inputNode,"data-d2l-validatefocus",handle.inputNode.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.inputNode,"data-d2l-validateinput",handle.node.id);node.handle=handle;return handle},Initialize:function(handle){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;handle.inputNode.style.width="2em";var hiddens=
me.GetHiddenNodes(handle.placeholderNode);var hiddenIdParts=hiddens.actionNode.id.split("$");hiddenIdParts.pop();var hiddenItemId=hiddenIdParts.pop();D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,"data-d2l-idprefix",hiddenIdParts.join("$"));D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,"data-d2l-iditem",hiddenItemId);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(handle.inputNode,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Backspace){var newWidth=
me.MeasureInput(handle);if(newWidth<=handle.width)handle.inputNode.style.width=newWidth+"px";if(handle.inputNode.value.length==0){var lastItem=me.GetLastItem(handle);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-multiselect-choice-selected",lastItem))me.RemoveItem(handle,lastItem);else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-multiselect-choice-selected",lastItem)}}});D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener(handle.inputNode,function(kpArgs){if(kpArgs.GetKey()!=D2L.LP.Web.UI.Html.Dom.KeyUpEventArgs.Key.Backspace){var lastItem=
me.GetLastItem(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-multiselect-choice-selected",lastItem);if(handle.inputNode.clientWidth<=handle.width)handle.inputNode.style.width=me.MeasureInput(handle)+"px"}});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",handle.inputNode,function(){var lastItem=me.GetLastItem(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-multiselect-choice-selected",lastItem)});var items=me.GetAllItems(handle);if(items.length>0)for(var i=0;i<items.length;i++){hiddens=me.GetHiddenNodes(items[i]);
D2L.LP.Web.UI.Desktop.Controls.AutoComplete.HideItemByKey(handle.autoCompleteId,hiddens.keyNode.value)}handle.inputNode.style.width=me.MeasureInput(handle)+"px"},IsEmpty:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);var items=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-multiselect-choice",handle.node);for(var i=0;i<items.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",items[i]))return false;return true},MeasureInput:function(handle){var span=
document.createElement("span");var value=handle.inputNode.value;if(value=="")value=handle.inputNode.placeholder;var content=document.createTextNode(value);span.appendChild(content);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-multiselect-offscreen",span);document.body.appendChild(span);var width=span.offsetWidth;document.body.removeChild(span);return width+25},OnClickClearIcon:function(itemId){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(itemId);var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(itemId.GetValue());
D2L.LP.Web.UI.Desktop.Controls.MultiSelect.RemoveItem(handle,itemNode);handle.inputNode.focus()},OnItemAdded:function(id,text,key,isParsed){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.GetHandle(id);if(isParsed===undefined)isParsed=false;if(!isParsed&&handle.customParseMode&&!key){var customParse=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,"customParse");customParse();return}var lastTag=me.GetLastItem(handle);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-multiselect-choice-selected",
lastTag))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-multiselect-choice-selected",lastTag);var newNode=handle.placeholderNode.cloneNode(true);var itemId=new D2L.LP.Web.UI.Html.UniqueHtmlId;var closeIconId=new D2L.LP.Web.UI.Html.UniqueHtmlId;newNode.id=itemId.GetValue();D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-multiselect-placeholder",newNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",newNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-multiselect-choice",newNode);D2L.LP.Web.UI.Html.Dom.RemoveAttribute(newNode,
"aria-hidden");var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(newNode);var textContent=document.createTextNode(text);textNode.appendChild(textContent);var closeIcon=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-multiselect-clearicon",newNode)[0];closeIcon.id=closeIconId.GetValue();D2L.LP.Web.UI.Html.Dom.AddEventListener("click",closeIcon,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(itemId)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(closeIcon,
function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(itemId)});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",closeIcon,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e)});var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(closeIcon,"title");title=title.split("{0}").join(text);D2L.LP.Web.UI.Html.Dom.SetAttribute(closeIcon,"title",title);var closeIconSpan=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(closeIcon);
var closeText=closeIconSpan.childNodes[0];closeText.nodeValue=title;var hiddenIdPrefix=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.placeholderNode,"data-d2l-idprefix");var hiddenItemId=D2L.LP.Web.UI.Html.Dom.GetAttribute(handle.placeholderNode,"data-d2l-iditem");var hiddenId=hiddenIdPrefix+"$"+hiddenItemId+"$";var actionType="Add";for(var i=0;i<handle.removedOriginals.length;i++)if(key==handle.removedOriginals[i].key){actionType="None";var itemNode=D2L.LP.Web.UI.Html.Dom.GetElementById(handle.removedOriginals[i].id);
D2L.LP.Web.UI.Html.Dom.RemoveElement(itemNode);handle.removedOriginals.splice(i,1);break}me.UpdateHiddenNodes(newNode,hiddenId,text,key,actionType);if(hiddenItemId.indexOf("`")!=-1){var hiddenItemIdParts=hiddenItemId.split("`");hiddenItemIdParts[1]=parseInt(hiddenItemIdParts[1])+1;hiddenItemId=hiddenItemIdParts.join("`")}else hiddenItemId+="`1";hiddenId=hiddenIdPrefix+"$"+hiddenItemId+"$";me.UpdateHiddenNodes(handle.placeholderNode,hiddenId);D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.placeholderNode,
"data-d2l-iditem",hiddenItemId);handle.node.insertBefore(newNode,handle.placeholderNode);handle.inputNode.value="";if(handle.onItemAdded)handle.onItemAdded();var newWidth=me.MeasureInput(handle);if(newWidth<=handle.width)handle.inputNode.style.width=newWidth+"px"},RemoveItem:function(handle,item){var hiddens=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHiddenNodes(item);if(hiddens.actionNode.value==="None"){hiddens.actionNode.value="Remove";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",item);
handle.removedOriginals.push({key:hiddens.keyNode.value,id:item.id})}else if(hiddens.actionNode.value==="Add")D2L.LP.Web.UI.Html.Dom.RemoveElement(item);D2L.LP.Web.UI.Desktop.Controls.AutoComplete.ShowItemByKey(handle.autoCompleteId,hiddens.keyNode.value);if(handle.onItemRemoved){handle.removedItem=new D2L.LP.Web.UI.Desktop.Controls.MultiSelect.ItemParam(hiddens.valueNode.value,hiddens.keyNode.value,hiddens.actionNode.value);handle.onItemRemoved()}},SetIsVisible:function(id,isVisible){var handle=
D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);if(isVisible){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",handle.node);handle.width=handle.node.scrollWidth-20}else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",handle.node)},UpdateHiddenNodes:function(listNode,newId,value,key,action){if(value===undefined){value="";key="";action=""}var hiddens=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHiddenNodes(listNode);hiddens.valueNode.id=newId+"Value";hiddens.valueNode.name=newId+"Value";
hiddens.keyNode.id=newId+"Key";hiddens.keyNode.name=newId+"Key";hiddens.actionNode.id=newId+"ActionType";hiddens.actionNode.name=newId+"ActionType";hiddens.valueNode.value=value;hiddens.keyNode.value=key;hiddens.actionNode.value=action},ValidateRequired:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetHandle(id);var items=D2L.LP.Web.UI.Desktop.Controls.MultiSelect.GetAllItems(handle);return items.length!=0}};
D2L.LP.Web.UI.Desktop.Controls.MultiSelectSerializableItem=D2L.Class.Create({Construct:function(value,key,title){if(value===undefined){value="";key="";title=""}this.m_value=value;this.m_key=key;this.m_title=title},_serialize:function(serializer){serializer.AddMember("value",this.m_value);serializer.AddMember("key",this.m_key);serializer.AddMember("title",this.title)},_deserialize:function(deserializer){this.m_value=deserializer.GetMember("Value");this.m_key=deserializer.GetMember("Key");this.m_title=
deserializer.GetMember("Title")},GetValue:function(){return this.m_value},GetKey:function(){return this.m_key},GetTitle:function(){return this.m_title}});
D2L.LP.Web.UI.Desktop.Controls.MultiSelect.ItemParam=D2L.Class.Create({Construct:function(value,key,actionType){if(value===undefined){value="";key="";actionType=""}this.m_value=value;this.m_key=key;this.m_actionType=actionType},_serialize:function(serializer){serializer.AddMember("value",this.m_value);serializer.AddMember("key",this.m_key);serializer.AddMember("actionType",this.m_actionType)},GetValue:function(){return this.m_value},GetKey:function(){return this.m_key},GetActionType:function(){return this.m_actionType}});
D2L.LP.Web.UI.Desktop.Controls.MultiSelect.Param=D2L.Class.Create({Construct:function(items){if(items===undefined)items=[];this.m_items=items},_serialize:function(serializer){serializer.AddMember("items",this.m_items)},GetItems:function(){return this.m_items}});
D2L.LP.Web.UI.Desktop.Controls.NumericPager={GetPage:function(id,pageNumber,pageSize){var pagerId=id.GetValue();var controlProvider=D2L.LP.Web.UI.ObjectRepository.TryGet(pagerId,"controlProvider");if(controlProvider==null)return;var pageableControlId=D2L.LP.Web.UI.ObjectRepository.Get(pagerId,"pageableControlId");var pageableControl=controlProvider.call(controlProvider);pageableControl.GetPage(pageableControlId)},GetPageCount:function(node){return node.d2l_pageCount},GetPageNumber:function(id,defaultValue){var me=
D2L.LP.Web.UI.Desktop.Controls.NumericPager;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){if(defaultValue!==undefined)return defaultValue;throw"NumericPager not found: '"+id.GetValue()+"'.";}var pageNumberNode=me.GetPageNumberNode(node);var pageNumber=pageNumberNode.value;return pageNumber},GetPageNumberNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node)},GetPageSize:function(id,defaultValue){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null){if(defaultValue!==undefined)return defaultValue;throw"NumericPager not found: '"+id.GetValue()+"'.";}var pageSizeNode=me.GetPageSizeNode(node);var pageSize=pageSizeNode.value;return pageSize},GetPageSizeNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node))},NextPage:function(id,editId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node.d2l_isBusy)return;
var pageNumber=D2L.LP.Web.UI.Common.Controls.EditInteger.TryGetInteger(editId);D2L.LP.Web.UI.Common.Controls.EditInteger.SetInteger(editId,pageNumber+1)},OnPageNumberChange:function(id,editId,pageNumber,triggerOnPageRequest){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var pageNumberNode=me.GetPageNumberNode(node);var previousPageNumber=parseInt(pageNumberNode.value,10);var pageCount=node.d2l_pageCount;if(node.d2l_isBusy||pageNumber==
null||pageNumber<1||pageNumber>pageCount){D2L.LP.Web.UI.Common.Controls.EditInteger.SetInteger(editId,previousPageNumber);return}if(pageNumber!==previousPageNumber){pageNumberNode.value=pageNumber;if(triggerOnPageRequest===undefined||triggerOnPageRequest)me.PageRequest(id);me.UpdateNextPrevious(node,pageNumber)}},OnPageSizeChange:function(id,newPageSize){var pagerNode=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var pageSizeHidden=D2L.LP.Web.UI.Desktop.Controls.NumericPager.GetPageSizeNode(pagerNode);
pageSizeHidden.value=newPageSize;D2L.LP.Web.UI.Desktop.Controls.NumericPager.SetPageNumber(id,1,false);D2L.LP.Web.UI.Desktop.Controls.NumericPager.PageRequest(id)},PageRequest:function(id){var pagerId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKeys(pagerId,"onPageRequest"))return;var onPageRequest=D2L.LP.Web.UI.ObjectRepository.Get(pagerId,"onPageRequest");if(onPageRequest==null)return;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(pagerId);node.d2l_isBusy=true;var onCompleted=onPageRequest.call(onPageRequest);
if(onCompleted!==undefined&&typeof onCompleted["AddListener"]==="function")onCompleted.AddListener(function(){node.d2l_isBusy=false});else node.d2l_isBusy=false},PreviousPage:function(id,editId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(node.d2l_isBusy)return;var pageNumber=D2L.LP.Web.UI.Common.Controls.EditInteger.TryGetInteger(editId);D2L.LP.Web.UI.Common.Controls.EditInteger.SetInteger(editId,pageNumber-1)},SetPageCount:function(id,pageCount){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;
var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var pageCountNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-numericpager-pagecount",node)[0];if(node.d2l_pageCount!=pageCount){node.d2l_pageCount=pageCount;me.UpdateNextPrevious(node);pageCountNode.innerHTML=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(pageCount)}},SetPageNumber:function(id,pageNumber,triggerOnPageRequest){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;if(parseInt(me.GetPageNumber(id),10)!=
parseInt(pageNumber,10)){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.d2l_editId);D2L.LP.Web.UI.Common.Controls.EditInteger.SetInteger(editId,pageNumber,triggerOnPageRequest);if(!triggerOnPageRequest)me.OnPageNumberChange(id,editId,pageNumber,triggerOnPageRequest)}},UpdateNextPrevious:function(node,pageNumber){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var pageCount=node.d2l_pageCount;if(pageNumber===undefined)pageNumber=
me.GetPageNumberNode(node).value;var previousId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.d2l_previousId);var nextId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.d2l_nextId);D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(previousId,parseInt(pageNumber,10)>1);D2L.LP.Web.UI.Common.Controls.ImageLink.SetIsEnabled(nextId,parseInt(pageNumber,10)<parseInt(pageCount,10))}};
D2L.LP.Web.UI.Desktop.Controls.OnOff={SetIsEnabled:function(id,isEnabled){id.$().OnOff("setEnabled",isEnabled)},GetStatus:function(id){return id.$().OnOff("checkStatus")},SetStatus:function(id,isOn){return id.$().OnOff("setStatus",isOn)},SetAll:function(isOn,container){var switches;if(container!==null&&container!==undefined)switches=$(container).find(".d2l-onoff");else switches=$(".d2l-onoff");switches.each(function(){if(!$(this).is(":data(d2lOnOff)"))return;$(this).OnOff("setStatus",isOn)})},TriggerLoading:function(id,
isLoading){id.$().OnOff("setLoading",isLoading)}};
$(function(){$.widget("d2l.OnOff",{_isLoading:false,_isEnabled:true,_create:function(){var onOffElem=$(this.element);this._on(onOffElem.find("input[type=radio]"),{change:"switched"});var onElem=onOffElem.find("input[value=on]").first();if(onElem){var isOn=onElem.prop("checked");if(!isOn)onOffElem.addClass("d2l-onoff-off");else onOffElem.addClass("d2l-onoff-on")}var wrapper=$("<div>",{"class":"d2l-onoff-wrapper","aria-hidden":true});var sliderContainer=$("<div>",{"class":"d2l-onoff-container"});var sliderOverflow=
$("<div>",{"class":"d2l-onoff-slider-overflow"});var sliderWrapper=$("<div>",{"class":"d2l-onoff-slider-wrapper"});var onSlider=$("<div>",{"class":"d2l-onoff-slider-on"});var onImage=$("<span>",{"class":"d2l-onoff-slider-on-img"});var sliderButton=$("<div>",{"class":"d2l-onoff-slider"});var sliderButtonImage=$("<div>",{"class":"d2l-onoff-slider-inside"});var offImage=$("<span>",{"class":"d2l-onoff-slider-off-img"});var offSlider=$("<div>",{"class":"d2l-onoff-slider-off"});onImage.appendTo(onSlider);
onSlider.appendTo(sliderWrapper);sliderButton.appendTo(sliderWrapper);sliderButtonImage.appendTo(sliderButton);offImage.appendTo(offSlider);offSlider.appendTo(sliderWrapper);sliderWrapper.appendTo(sliderOverflow);sliderOverflow.appendTo(sliderContainer);sliderContainer.appendTo(wrapper);this._on(sliderContainer,{click:"switched"});var labelId=onOffElem.data("labelby");var label=$(document.getElementById(labelId));if(labelId!==null||label!==undefined){var labelText=label.html();onOffElem.first().prepend("<legend>"+
labelText+"</legend>").wrapInner('<fieldset class="d2l-offscreen"></fieldset>')}if(!onOffElem.data("isenabled")){this._isEnabled=false;var disabledShim=$("<div>",{"class":"d2l-onoff-disabled"});disabledShim.appendTo(wrapper)}onOffElem.find("input[type=radio]").on("focus",function(){onOffElem.addClass("d2l-onoff-focus")}).on("blur",function(){onOffElem.removeClass("d2l-onoff-focus")});wrapper.appendTo(onOffElem);onOffElem.removeClass("d2l-onoff-placeholder")},switched:function(){if(this._isLoading||
!this._isEnabled)return;var onOff=$(this.element);var isOn=false;if(onOff.hasClass("d2l-onoff-on")){onOff.removeClass("d2l-onoff-on");onOff.addClass("d2l-onoff-off");onOff.find("input[value=off]").prop("checked",true)}else if(onOff.hasClass("d2l-onoff-off")){onOff.removeClass("d2l-onoff-off");onOff.addClass("d2l-onoff-on");onOff.find("input[value=on]").prop("checked",true);isOn=true}onOff.trigger("change",{IsOn:isOn})},checkStatus:function(){return $(this.element).hasClass("d2l-onoff-on")},setStatus:function(isOn){if(this._isLoading||
!this._isEnabled)return;var onOff=$(this.element);if(isOn&&!onOff.hasClass("d2l-onoff-on")){onOff.removeClass("d2l-onoff-off");onOff.addClass("d2l-onoff-on");onOff.children("input[value=on]").prop("checked",true)}else if(!isOn&&!onOff.hasClass("d2l-onoff-off")){onOff.addClass("d2l-onoff-off");onOff.removeClass("d2l-onoff-on");onOff.children("input[value=off]").prop("checked",true)}onOff.trigger("change",{IsOn:isOn})},setLoading:function(isLoading){this._isLoading=isLoading;var onOff=$(this.element);
if(isLoading){onOff.addClass("d2l-onoff-slider-loading");onOff.find("input").prop("disabled",true)}else{onOff.removeClass("d2l-onoff-slider-loading");onOff.find("input").prop("disabled",false);var currentStatus=this.checkStatus();if(currentStatus)onOff.find("input[value=on]").focus();else onOff.find("input[value=off]").focus()}},setEnabled:function(isEnabled){if(this._isEnabled==isEnabled)return;this._isEnabled=isEnabled;var onOff=$(this.element);onOff.find("input").prop("disabled",!isEnabled);onOff.data("isenabled",
isEnabled);if(isEnabled)onOff.find(".d2l-onoff-disabled").remove();else{var disabledShim=$("<div>",{"class":"d2l-onoff-disabled"});disabledShim.appendTo($(onOff.find(".d2l-onoff-wrapper")))}}})});
D2L.LP.Web.UI.Desktop.Controls.OrgUnitSelector={ValidateRequired:function(id){var input=D2L.LP.Web.UI.Html.Dom.GetElementById(id);if(input!==null&&D2L.LP.Web.UI.Html.Dom.IsVisible(input))return input.value.length>0;else return true},GetSelectedOrgUnitId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node){var inputId=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-hiddenId");var input=D2L.LP.Web.UI.Html.Dom.GetElementById(inputId);if(input&&input.value!=="")return input.value}return null}};
D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong={Values:{},Cancel:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandle(id);me.CancelHandle(handle,id,true)},CancelHandle:function(handle,id,clearValue){handle.LongEdit.value="";if(clearValue)D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.Values[id]="";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",handle.SaveButton);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",handle.CancelButton);D2L.LP.Web.UI.Common.Controls.LongEdit.SetHeightNode(handle.LongEdit,
null)},FocusHandle:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-offscreen",handle.SaveButton);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-offscreen",handle.CancelButton);D2L.LP.Web.UI.Common.Controls.LongEdit.SetHeightNode(handle.LongEdit,handle.OnFocusHeight)},GetValue:function(id){var values=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.Values;if(values[id]===undefined)return"";return values[id]},GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);return D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong.GetHandleNode(node.parentNode)},
GetHandleNode:function(node){var longEditNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-longedit",node);var saveButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-quickentry-long-save",node);var cancelButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-quickentry-long-cancel",node);var onFocusHeight=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-heightfocus");return{CancelButton:cancelButton,LongEdit:longEditNode,Node:node,OnFocusHeight:onFocusHeight,SaveButton:saveButton}},
Save:function(id,onSave){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandle(id);var value=handle.LongEdit.value;if(value.trim().length===0){me.CancelHandle(handle,id,true);return}me.Values[id]=value;if(onSave!==null)onSave();D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-quickentry-long-animate",handle.Node);me.CancelHandle(handle,id,false);setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-quickentry-long-animate",handle.Node)},0)}};
D2L.LP.Web.UI.Desktop.Controls.RadioList={GetItemsNodes:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-radiolist-item",node)},GetRadioNode:function(itemNode){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(itemNode))},GetSelectedValue:function(id){var radioNodes=document.getElementsByName(id.GetValue());for(var i=0;i<radioNodes.length;i++)if(radioNodes[i].checked==true)return radioNodes[i].value},
SetIsAllEnabled:function(id,isEnabled){var itemNodes=this.GetItemsNodes(id);for(var i=0;i<itemNodes.length;i++){var radioNode=this.GetRadioNode(itemNodes[i]);D2L.LP.Web.UI.Html.Dom.SetIsEnabledNode(radioNode,isEnabled)}},SetSelectedValue:function(id,value){D2L.LP.Web.UI.Common.Controls.RadioButton.SetSelected(id,value)}};
D2L.LP.Web.UI.Desktop.Controls.RatingInput={ClearHoverClass:function(handle){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-hover",handle.node);for(var j=0;j<6;j++)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-hover-"+j,handle.node)},GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node===null)throw"RatingInput control not found: '"+id.GetValue()+"'.";var inputs=node.getElementsByTagName("input");for(var i=0;i<inputs.length;i++)if(inputs[i].checked)return parseInt(inputs[i].value);
return 0},HandleBlur:function(handle,index){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-input-focus",handle.labels[index])},HandleFocus:function(handle,index){if(handle.ignoreFocus)return;D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-input-focus",handle.labels[index])},HandleMouseOverLabel:function(handle,index){var isSaving=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-input-saving",
handle.node);if(isSaving)return;if(index>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-hover",handle.node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-hover-"+index,handle.node)},InitHandle:function(node){var handle={hover:false,ignoreFocus:false,labels:[],node:node,numRatings:0,rating:0,ratingSum:0,distribution:null};if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-count"))handle.numRatings=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-count"));if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,
"data-sum"))handle.ratingSum=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-sum"));if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-1",node))handle.rating=1;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-2",node))handle.rating=2;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-3",node))handle.rating=3;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-4",node))handle.rating=4;else if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-rating-5",node))handle.rating=5;handle.labels=
node.getElementsByTagName("label");D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.InitHandle(node,handle);return handle},SetSelected:function(handle,index,doFocus){var input=handle.labels[index].getElementsByTagName("input")[0];input.checked=true;if(doFocus){handle.ignoreFocus=true;input.focus();setTimeout(function(){handle.ignoreFocus=false},0)}handle.ratingSum=handle.ratingSum-handle.rating+index;if(index===0&&handle.rating>0)handle.numRatings--;else if(handle.rating===0&&index>0)handle.numRatings++;
handle.rating=index;var average=0;if(handle.numRatings>0)average=Math.round(handle.ratingSum/handle.numRatings);for(var j=0;j<6;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-"+j,handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-average-"+j,handle.node)}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-"+index,handle.node);if(average>0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-average-"+average,handle.node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-rating-input-saving",handle.node);
setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-rating-input-saving",handle.node)},2E3);var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id);if(onChange!==null)onChange()}};
D2L.LP.Web.UI.Desktop.Controls.RatingDistribution={ClassInitialize:function(handle){if(handle.distribution===null)return;for(var i=0;i<handle.distribution.items.length;i++){var item=handle.distribution.items[i];D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",item.cellNode,function(t){return function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-offscreen",t)}}(item.textNode));D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",item.cellNode,function(t){return function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-offscreen",
t)}}(item.textNode))}},Hide:function(handle){if(handle.distribution===null||!handle.distribution.isVisible)return;handle.distribution.isVisible=false;for(var i=0;i<handle.distribution.items.length;i++)handle.distribution.items[i].barNode.style.height="0px";setTimeout(function(){if(!handle.distributionIsVisible)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(handle.distribution,false)},300)},InitHandle:function(node,handle){var distribution={node:null,isVisible:false,items:[]};distribution.node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-rating-distribution",
node);if(distribution.node===null)return;for(var i=1;i<distribution.node.rows.length;i++){var cell=distribution.node.rows[i].cells[1];var value=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(cell,"data-val"));var barNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-rating-distribution-val",cell);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-rating-distribution-text",cell);distribution.items.push({barNode:barNode,cellNode:cell,textNode:textNode,value:value})}handle.distribution=
distribution},Show:function(handle){if(handle.distribution===null||handle.distribution.isVisible)return;handle.distribution.isVisible=true;for(var i=0;i<handle.distribution.items.length;i++){var item=handle.distribution.items[i];var height=0;if(item.value<11)height=1;else if(item.value<41)height=4;else if(item.value<71)height=7;else height=10;(function(d,h){setTimeout(function(){d.style.height=h+"px"},0)})(item.barNode,height)}D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(handle.distribution.node,true)}};
D2L.LP.Web.UI.Desktop.Controls.ScrollSpy={SetIsEnabled:function(isEnabled){if(isEnabled)$(window).vui_scrollSpy("enable");else $(window).vui_scrollSpy("disable")}};D2L.LP.Web.UI.Desktop.Controls.ScrollPoint={IsVisible:function(scrollPointId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(scrollPointId.GetValue());return $(window).vui_scrollSpy("isVisible",node)}};
D2L.LP.Web.UI.Desktop.Controls.SearchSimple={Clear:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var searchId=id.GetValue();me.GetInputNode(id).value="";var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);hidden.value="";me.SetClearLinkIsVisible(id,false);if(!D2L.LP.Web.UI.ObjectRepository.HasKey(searchId))return;var onClear=D2L.LP.Web.UI.ObjectRepository.Get(searchId,0);if(onClear==null)return;onClear.call(onClear)},Focus:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;
D2L.LP.Web.UI.Html.Dom.Focus(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(me.GetInputNode(id).id))},GetInputNode:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-searchsimple",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-searchsimple-input",node)[0]},GetInputValue:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;return me.GetInputNode(id).value.trim()},IsSearched:function(id){var searchId=id.GetValue();
var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);return hidden.value!=""},OnBeforeSearch:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var searchId=id.GetValue();var hidden=D2L.LP.Web.UI.Html.Dom.GetElementById(searchId);hidden.value=me.GetInputValue(id);me.SetClearLinkIsVisible(id,true)},Search:function(id){var formNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()));D2L.LP.Web.UI.Common.Controls.Form.DoSubmit(formNode)},
SetValue:function(id,value){var input=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetInputNode(id);input.value=value},SetClearLinkIsVisible:function(id,isVisible){var me=D2L.LP.Web.UI.Desktop.Controls.SearchSimple;var spanNode=me.GetInputNode(id).parentNode;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-searchsimple-clear-visible",spanNode))return;var isCurrentlyVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-searchsimple-clear-hidden",spanNode);if(isVisible){if(!isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-searchsimple-clear-hidden",
spanNode)}else if(isCurrentlyVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-searchsimple-clear-hidden",spanNode)}};
D2L.LP.Web.UI.Desktop.Controls.SelectAll={Get:function(){return D2L.LP.Web.UI.Desktop.Controls.SelectAll},GetCheckboxNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node)},GetEvent:function(id,events){var evt=events[id];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event;events[id]=evt}return evt},GetOnResetEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnResetEvents)},GetOnSelectionFilterTypeUpdateEvent:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnSelectionFilterTypeUpdateEvents)},GetOnSelectionUpdateEvent:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return me.GetEvent(id.GetValue(),me.OnSelectionUpdateEvents)},GetSelectableControlProvider:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id,0)},GetSelectableControlId:function(id){return D2L.LP.Web.UI.ObjectRepository.Get(id,1)},GetSelection:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;
var selectAllId=id.GetValue();var selection=me.Selection[selectAllId];if(selection===undefined){selection={add:function(value){if(this.values[value])return;this.values[value]=true;this.selectedCount+=1;if(this.type!=D2L.LP.LayeredArch.SelectionFilterType.All)this.type=D2L.LP.LayeredArch.SelectionFilterType.Some},reset:function(){this.type=D2L.LP.LayeredArch.SelectionFilterType.None;this.persisted=false;this.selectedCount=0;this.values={}},getValuesArray:function(){var valuesArray=[];for(var value in this.values)if(this.values[value])valuesArray.push(value);
return valuesArray},persisted:false,remove:function(value){if(!this.values[value])return;this.values[value]=false;this.selectedCount-=1;if(this.selectedCount==0)this.type=D2L.LP.LayeredArch.SelectionFilterType.None},selectedCount:0,type:D2L.LP.LayeredArch.SelectionFilterType.None,values:{}};me.Selection[selectAllId]=selection}return selection},GetSelectionInfo:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selection=me.GetSelection(id);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var typeNode=me.GetTypeNode(node);var valuesNode=me.GetValuesNode(node);var valuesArray=selection.getValuesArray();typeNode.value=selection.type;valuesNode.value=D2L.LP.Web.UI.Selection.EncodeKeys(valuesArray);return new D2L.LP.Web.UI.Selection.SelectionInfo(typeNode.value,valuesArray)},GetTypeNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;return D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(me.GetCheckboxNode(node))},GetValuesNode:function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;
return D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(me.GetTypeNode(node))},OnSelectionFilterTypeUpdateEvents:{},OnSelectionUpdateEvents:{},OnResetEvents:{},IsUpdateStateEnabled:function(id){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var isEnabled=me.UpdateStateEnabled[id];if(isEnabled===undefined){isEnabled=true;me.UpdateStateEnabled[id]=isEnabled}return isEnabled},RemoveItem:function(id,value){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selection=me.GetSelection(id);if(!selection.values[value])return;
selection.remove(value);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount)},Selection:{},SetIsSelectionReadOnly:function(id,isReadOnly){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(isReadOnly&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node))D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-readonly",node);else if(!isReadOnly&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-readonly",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-readonly",
node)},SetIsUpdateStateEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;me.UpdateStateEnabled[id]=isEnabled},SelectAll:function(id,selectionType){if(selectionType!=D2L.LP.LayeredArch.SelectionFilterType.Some&&selectionType!=D2L.LP.LayeredArch.SelectionFilterType.All)return;var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selectAllId=id.GetValue();var values="";if(selectionType==D2L.LP.LayeredArch.SelectionFilterType.Some){var controlProvider=me.GetSelectableControlProvider(selectAllId);
var selectableControl=controlProvider.call(controlProvider);values=selectableControl.GetValues(me.GetSelectableControlId(selectAllId))}me.SetSelectionInfo(id,new D2L.LP.Web.UI.Desktop.Controls.SelectAll.SelectionInfo(selectionType,D2L.LP.Web.UI.Selection.EncodeKeys(values)),false);var node=D2L.LP.Web.UI.Html.Dom.GetElementById(selectAllId);var checkboxNode=me.GetCheckboxNode(node);checkboxNode.checked=true;var selection=me.GetSelection(id);var selectionFilterTypeEvent=me.GetOnSelectionFilterTypeUpdateEvent(id);
selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount)},SetSelectionInfo:function(id,selectionInfo,triggerFilterTypeUpdateEvent){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var selectAllId=id.GetValue();if(!D2L.LP.Web.UI.ObjectRepository.HasKey(selectAllId))return;var controlProvider=me.GetSelectableControlProvider(selectAllId);var selectableControlId=me.GetSelectableControlId(selectAllId);
if(controlProvider===null||selectableControlId===null)return;if(triggerFilterTypeUpdateEvent===undefined)triggerFilterTypeUpdateEvent=false;var selectableControl=controlProvider.call(controlProvider);var type=selectionInfo.GetType();var values=selectionInfo.GetKeys();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(selectAllId);var checkboxNode=me.GetCheckboxNode(node);checkboxNode.checked=type==D2L.LP.LayeredArch.SelectionFilterType.All||type==D2L.LP.LayeredArch.SelectionFilterType.AllExcept;var selection=
me.GetSelection(id);selection.type=type;selection.values={};selection.selectedCount=values.length;for(var i=0;i<values.length;i++)selection.values[values[i]]=true;me.SetIsUpdateStateEnabled(selectAllId,false);selectableControl.SetSelection(selectableControlId,type,values);me.SetIsUpdateStateEnabled(selectAllId,true);if(triggerFilterTypeUpdateEvent){var selectionFilterTypeEvent=me.GetOnSelectionFilterTypeUpdateEvent(id);selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type)}var selectionUpdateEvent=
me.GetOnSelectionUpdateEvent(id);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount)},UpdateStateEnabled:{}};
D2L.LP.Web.UI.Desktop.Controls.SelectAll.SelectionInfo=D2L.Class.Create({Construct:function(type,values){if(type===undefined)type=D2L.LP.LayeredArch.SelectionFilterType.None;if(values===undefined)values="";this.m_type=type;this.m_values=values},_deserialize:function(deserializer){this.m_type=deserializer.GetMember("type");this.m_values=deserializer.GetMember("values")},_serialize:function(serializer){serializer.AddMember("type",this.m_type);serializer.AddMember("values",this.m_values)},GetKeys:function(){return D2L.LP.Web.UI.Selection.DecodeKeys(this.m_values)},
GetType:function(){return this.m_type},GetEncodedValues:function(){return this.m_values}});
D2L.LP.Web.UI.Desktop.Controls.SelectAllLink={Clear:function(id){var node=D2L.LP.Web.UI.Desktop.Controls.SelectAllLink.GetNodeByChildId(id);node.d2l_selectionControl.SelectAll(node.d2l_selectionControlId,D2L.LP.LayeredArch.SelectionFilterType.Some);var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall-link-info",node);var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode));
D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",pageResultNode)},GetNodeByChildId:function(id){return D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-selectall-link",D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue()))},SelectAll:function(id){var node=D2L.LP.Web.UI.Desktop.Controls.SelectAllLink.GetNodeByChildId(id);node.d2l_selectionControl.SelectAll(node.d2l_selectionControlId,D2L.LP.LayeredArch.SelectionFilterType.All);var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall-link-info",
node);var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",pageResultNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode))}};
D2L.LP.Web.UI.Desktop.Controls.SemanticEditor={CreateRange:function(start,end){return{Start:start,End:end}},GetContainedRanges:function(text,selection,tag){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var ranges=[];var startIndex=null;var endIndex=null;var index=text.indexOf(tag);while(index>-1){if(startIndex==null){startIndex=index;if(startIndex>selection.End)break}else{endIndex=index;if(startIndex<=selection.End&&endIndex>=selection.Start)ranges.push(me.CreateRange(startIndex,endIndex+tag.length));
if(endIndex>selection.End)break;startIndex=null;endIndex=null}index=text.indexOf(tag,index+tag.length)}return ranges},GetTextAreaNode:function(node){return contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-semantic-editor-content",node)},GetLineRange:function(text,index){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;if(index>text.length)return null;var startIndex=text.substring(0,index).lastIndexOf("\n",index);if(startIndex==-1)startIndex=0;var endIndex=text.indexOf("\n",index);
if(endIndex==-1)endIndex=text.length;return me.CreateRange(startIndex,endIndex)},GetSelectionRange:function(textAreaNode){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var selection;if(textAreaNode.selectionStart!==undefined)selection=me.CreateRange(textAreaNode.selectionStart,textAreaNode.selectionEnd);else if(document.selection){var range=document.selection.createRange();var range1=textAreaNode.createTextRange();var range2=range1.duplicate();range1.moveToBookmark(range.getBookmark());range2.setEndPoint("EndToStart",
range1);var newlineCount=0;var range2Length=range2.text.replace(/\r\n/g,function(){newlineCount++;return"\r"}).length;var offset=range2.moveStart("character",range2Length);while(range2.compareEndPoints("StartToEnd",range2)==-1){offset+=2;var a=range2.moveStart("character",1)}offset+=newlineCount;selection=me.CreateRange(offset,offset+range.text.length)}else selection=me.CreateRange(0,0);return selection},IsContainedIn:function(index,ranges){for(var i=0;i<ranges.length;i++)if(index>ranges[i].Start&&
index<ranges[i].End)return true;return false},SetSelection:function(textAreaNode,selection){var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-semantic-editor",textAreaNode);node.d2l_selectionStart=selection.Start;node.d2l_selectionEnd=selection.End;if(textAreaNode.selectionStart!==undefined){textAreaNode.selectionStart=selection.Start;textAreaNode.selectionEnd=selection.End}else if(document.selection){var range=textAreaNode.createTextRange();range.moveStart("character",selection.Start);
range.moveEnd("character",selection.End);range.select()}textAreaNode.focus()},ToggleSymmetricTags:function(node,tag){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var textAreaNode=me.GetTextAreaNode(node);var ranges=me.GetContainedRanges(textAreaNode.value,me.CreateRange(node.d2l_selectionStart,node.d2l_selectionEnd),tag);var startTag=me.IsContainedIn(node.d2l_selectionStart,ranges)?"":tag;var endTag=me.IsContainedIn(node.d2l_selectionEnd,ranges)?"":tag;if(ranges.length==1&&startTag==""&&endTag==
""){startTag=tag;endTag=tag}var tagPattern=tag.replace(/\*/g,"\\*");var singleTagPattern=new RegExp(tagPattern,"g");var doubleTagPattern=new RegExp(tagPattern+tagPattern,"g");var leadingText=(textAreaNode.value.substring(0,node.d2l_selectionStart)+startTag).replace(doubleTagPattern,"");var text=textAreaNode.value.substring(node.d2l_selectionStart,node.d2l_selectionEnd).replace(singleTagPattern,"");var trailingText=(endTag+textAreaNode.value.substring(node.d2l_selectionEnd)).replace(doubleTagPattern,
"");textAreaNode.value=leadingText+text+trailingText;me.SetSelection(textAreaNode,me.CreateRange(leadingText.length,leadingText.length+text.length))}};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.IPlugin=function(){};D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.IPlugin.prototype.OnEditorUpdate=function(){};
D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.BoldPlugin=D2L.Class.Create({Construct:function(){this.m_buttonId;this.m_isEnabled=false},OnEditorUpdate:function(context){var isEnabled=context.Selection.End>context.Selection.Start;if(this.m_isEnabled!==isEnabled){D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(this.m_buttonId,isEnabled);this.m_isEnabled=isEnabled}},_deserialize:function(deserializer){this.m_buttonId=deserializer.GetMember("ButtonId")},_serialize:function(serializer){return}});
D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.ToggleBold=function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=editorId.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);editor.ToggleSymmetricTags(node,"**")};
D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.UnorderedListPlugin=D2L.Class.Create({Construct:function(){this.m_buttonId;this.m_isEnabled=false},OnEditorUpdate:function(context){var isEnabled=true;if(this.m_isEnabled!==isEnabled){D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(this.m_buttonId,isEnabled);this.m_isEnabled=isEnabled}},OnKeyUp:function(context,keyCode){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var textAreaNode=context.TextAreaNode;if(keyCode==13){var lineRange=editor.GetLineRange(textAreaNode.value,
context.Selection.Start-1);var isListItem=/^[\n\t\s]*\* /.test(textAreaNode.value.substring(lineRange.Start,lineRange.End));if(isListItem){var whiteSpace=textAreaNode.value.substring(lineRange.Start,textAreaNode.value.indexOf("*",lineRange.Start)).replace(/^\n/,"");textAreaNode.value=textAreaNode.value.substring(0,context.Selection.Start)+whiteSpace+"* "+textAreaNode.value.substring(context.Selection.Start);var updateLength=whiteSpace.length+2;editor.SetSelection(textAreaNode,editor.CreateRange(context.Selection.Start+
updateLength,context.Selection.End+updateLength))}}},_deserialize:function(deserializer){this.m_buttonId=deserializer.GetMember("ButtonId")},_serialize:function(serializer){return}});
D2L.LP.Web.UI.Desktop.Controls.SemanticEditor.ToggleUnorderedList=function(editorId){var editor=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=editorId.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id);var textAreaNode=editor.GetTextAreaNode(node);var lineRange=editor.GetLineRange(textAreaNode.value,node.d2l_selectionStart);var isListItem=/^[\n\t\s]*\* /.test(textAreaNode.value.substring(lineRange.Start,lineRange.End));var newSelection;if(!isListItem){textAreaNode.value=textAreaNode.value.substring(0,
lineRange.Start)+"* "+textAreaNode.value.substring(lineRange.Start);newSelection=editor.CreateRange(node.d2l_selectionStart+2,node.d2l_selectionEnd+2)}else{textAreaNode.value=textAreaNode.value.substring(0,lineRange.Start)+textAreaNode.value.substring(textAreaNode.value.indexOf("* ",lineRange.Start)+2);newSelection=editor.CreateRange(node.d2l_selectionStart-2,node.d2l_selectionEnd-2)}editor.SetSelection(textAreaNode,newSelection)};
D2L.LP.Web.UI.Desktop.Controls.Shim={m_shim:null,m_zIndex:1E3,Delete:function(handle){var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;if(handle===undefined||handle===null)return;var resetRoles=function(nodes){for(var i=0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined)return;if(node.d2l_role==""){node.removeAttribute("role");node.d2l_role=undefined}else{D2L.LP.Web.UI.Html.Aria.SetRole(node,node.d2l_role);node.d2l_role=undefined}}};var resetAria=function(nodes){for(var i=
0;i<nodes.length;i++){var node=nodes[i];if(node.setAttribute===undefined)return;if(node.d2l_aria_hidden==""){node.removeAttribute("aria-hidden");node.d2l_aria_hidden=undefined}else{D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"aria-hidden",node.d2l_aria_hidden);node.d2l_aria_hidden=undefined}}};if(handle.hiddenNodes.length>0)resetRoles(handle.hiddenNodes.pop());if(handle.hiddenAriaNodes.length>0)resetAria(handle.hiddenAriaNodes.pop());if(handle.zIndices.length>0){var lastZIndex=handle.zIndices.pop();
me.m_shim.shim.style.zIndex=lastZIndex}else{D2L.LP.Web.UI.Html.Dom.RemoveElement(me.m_shim.shim);handle.rootWin.D2L.LP.Web.UI.Events.OnResize.RemoveListener(handle.onresize);me.m_shim=null}},GetZIndex:function(){D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex++;return D2L.LP.Web.UI.Desktop.Controls.Shim.m_zIndex},AddShim:function(handle,w,node,isTransparent){var me=handle.rootWin.D2L.LP.Web.UI.Desktop.Controls.Shim;var shim=document.createElement("div");shim.className="d2l-shim";if(!isTransparent)shim.className+=
" d2l-shim-opaque";shim.style.zIndex=me.GetZIndex();setTimeout(function(){shim.style.opacity="0.5"},100);handle.shim=shim;if(node===w.document){var resize=function(){var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(handle.rootWin);shim.style.width="1px";shim.style.height="1px";var page=D2L.LP.Web.UI.Html.Dom.GetPageSize(handle.rootWin);shim.style.height=Math.max(page.height,viewport.height)+"px";shim.style.width="100%"};resize();handle.onresize=function(){resize()};D2L.LP.Web.UI.Events.OnResize.AddListener(handle.onresize)}handle.rootWin.document.body.appendChild(shim)},
HideAccessibleElements:function(handle){var hidden=[];var hiddenAria=[];handle.hiddenNodes.push(hidden);handle.hiddenAriaNodes.push(hiddenAria);var recurse=function(node){var abort=node==handle.dialog||node==handle.node||node.setAttribute===undefined||node.nodeName===undefined||node.nodeName.toLowerCase()==="iframe";if(abort)return;var oldRole=node.getAttribute("role");if(node.d2l_role===undefined){hidden.push(node);if(oldRole!=null)node.d2l_role=oldRole;else node.d2l_role=""}D2L.LP.Web.UI.Html.Aria.SetRole(node,
"presentation");if(node.nodeName==="FORM"||node.nodeName==="A"){var oldHidden=node.getAttribute("aria-hidden");if(node.d2l_aria_hidden===undefined){hiddenAria.push(node);if(oldHidden!=null)node.d2l_aria_hidden=oldHidden;else node.d2l_aria_hidden=""}D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"aria-hidden","true")}for(var i=0;i<node.childNodes.length;i++)recurse(node.childNodes[i])};recurse(handle.rootWin.document.body)},Create:function(node,isTransparent){var rootWindow=null;var currWin=window;while(currWin!=
null&&currWin.D2L!=null&&currWin.D2L!=undefined){if(currWin==rootWindow)break;rootWindow=currWin;currWin=currWin.parent}var me=rootWindow.D2L.LP.Web.UI.Desktop.Controls.Shim;if(me.m_shim===null){var handle={shim:null,zIndices:[],onresize:null,node:node,win:window,rootWin:rootWindow,hiddenNodes:[],hiddenAriaNodes:[]};me.AddShim(handle,window,window.document,isTransparent);me.m_shim=handle}else{me.m_shim.zIndices.push(me.m_shim.shim.style.zIndex);me.m_shim.shim.style.zIndex=me.GetZIndex()}me.HideAccessibleElements(me.m_shim);
node.style.zIndex=me.GetZIndex();return me.m_shim}};
D2L.LP.Web.UI.Desktop.Controls.Sort={GetNode:function(id){var parent=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var node=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-sort",parent);if(node===null)throw"Sort not found: '"+id.GetValue()+"'.";return node[0]},GetSelectedSortField:function(id){var selectList=D2L.LP.Web.UI.Desktop.Controls.Sort.GetNode(id);return selectList.value},GetSelectedSortFieldIsAscending:function(id){var selectList=D2L.LP.Web.UI.Desktop.Controls.Sort.GetNode(id);
var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(selectList);return D2L.LP.Web.UI.Html.Dom.GetAttribute(hiddenNode,"value")},ValidateRequired:function(id){var input=D2L.LP.Web.UI.Common.Controls.SelectList.GetInput(id);if(input.options.length===0)return false;var selectedOption=input.options[input.selectedIndex];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-selectlist-nonselectable",selectedOption))return false;return true}};
D2L.LP.Web.UI.Desktop.Controls.TimeSelector={IntervalEnum:{Five:5,Ten:10,Fifteen:15,Twenty:20,Thirty:30,Sixty:60},BuildSelectList:function(nodes,timeInterval){if(timeInterval===null||timeInterval==undefined||timeInterval<5||timeInterval>60)timeInterval=30;var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;if(nodes.list===null){nodes.list=document.createElement("ul");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.list,"role","listbox");nodes.list.className="d2l-time-selector-list";nodes.floatingContainer.appendChild(nodes.list)}while(nodes.list.childNodes.length>
0)nodes.list.removeChild(nodes.list.firstChild);var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();var hour=0;var minute=0;while(hour<24){var time=new D2L.LocalTime(hour,minute,0);var timeStr=dateTimeFormatter.FormatTime(time);var item=document.createElement("li");D2L.LP.Web.UI.Html.Dom.SetAttribute(item,"role","option");var id=new D2L.LP.Web.UI.Html.UniqueHtmlId;item.id=id.GetValue();item.d2l_time=time;item.d2l_index=nodes.list.childNodes.length;item.appendChild(document.createTextNode(timeStr));
nodes.list.appendChild(item);minute+=timeInterval;if(minute>=60){++hour;minute-=60}}},GetNodes:function(id){var idVal=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(idVal);if(node===null)throw"TimeSelector not found: '"+idVal+"'.";return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodesByNode(node)},GetNodesByNode:function(node){var container=node.parentNode;var hour=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-balloon",hour))hour=
D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var minute=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(hour);var isEnabled=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(minute);var floatingContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(isEnabled);var list=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-time-selector-list",floatingContainer);return{container:container,floatingContainer:floatingContainer,hour:hour,minute:minute,isEnabled:isEnabled,edit:node,list:list}},GetTime:function(id){var nodes=
D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetNodes(id);return D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes)},GetTimeNodes:function(nodes){var hour=parseInt(nodes.hour.value);var minute=parseInt(nodes.minute.value);var result=new D2L.LocalTime(hour,minute,0);return result},IsEnabledNodes:function(nodes){return!nodes.edit.disabled},SetEnforceTimeIntervals:function(id,isEnforced){id.$().data("enforcetimeintervals",isEnforced)},SetIsEnabled:function(id,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;
me.SetIsEnabledNodes(me.GetNodes(id),isEnabled)},SetIsEnabledNodes:function(nodes,isEnabled){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;nodes.isEnabled.value=isEnabled?"1":"0";nodes.edit.disabled=!isEnabled;var time=me.GetTimeNodes(nodes);nodes.container.d2l_onChange.Trigger(time,time)},SetIsVisible:function(id,isVisible){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;me.SetIsVisibleNode(me.GetNodes(id).container,isVisible)},SetIsVisibleNode:function(node,isVisible){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,
isVisible)},SetTime:function(id,time){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var nodes=me.GetNodes(id);me.SetTimeNodes(nodes,time)},SetTimeInterval:function(id,interval){interval=parseInt(interval);if(isNaN(interval))interval=30;var intervalEnum=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.IntervalEnum;for(var timeInterval in intervalEnum){var timeValue=intervalEnum[timeInterval];if(interval<=timeValue){interval=timeValue;break}}if(interval>intervalEnum.Sixty)interval=60;id.$().data("timeinterval",
interval)},SetTimeNodes:function(nodes,time,useInputTime){var prevTime=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes);var locale=D2L.LP.Globalization.Locale;var dateTimeFormatter=locale.GetDateTimeFormatter();if(useInputTime){var dateTimeParser=locale.GetDateTimeParser();var inputtedTime=dateTimeParser.TryParseTime(nodes.edit.value);time=new D2L.LocalTime(inputtedTime.GetHour(),inputtedTime.GetMinute(),inputtedTime.GetSecond())}var timeStr=dateTimeFormatter.FormatTime(time);nodes.edit.value=
timeStr;nodes.hour.value=time.GetHour();nodes.minute.value=time.GetMinute();nodes.container.d2l_onChange.Trigger(time,prevTime)}};
D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder={Init:function(startId,endId,autoShiftTimes){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startNodes=ts.GetNodes(startId);var endNodes=ts.GetNodes(endId);startNodes.container.d2l_onChange.AddListener(function(time,prevTime){me.OnStartChange(startNodes,endNodes,time,prevTime,true,autoShiftTimes)});endNodes.container.d2l_onChange.AddListener(function(){me.RenderValidation(startNodes,endNodes,
true)})},OnStartChange:function(startNodes,endNodes,time,prevTime,isSameDay,autoShiftTimes){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var endTime=ts.GetTimeNodes(endNodes);var wasValid=me.Validate(prevTime,endTime);if(isSameDay&&wasValid&&autoShiftTimes){var hourDiff=time.GetHour()-prevTime.GetHour();var minuteDiff=time.GetMinute()-prevTime.GetMinute();var newEndHour=endTime.GetHour()+hourDiff;var newEndMinute=endTime.GetMinute()+minuteDiff;
if(newEndMinute>59){newEndHour++;newEndMinute-=60}else if(newEndMinute<0){newEndHour--;newEndMinute+=60}if(newEndHour>23){newEndHour=23;newEndMinute=59}else if(newEndHour<0){newEndHour=0;newEndMinute=0}ts.SetTimeNodes(endNodes,new D2L.LocalTime(newEndHour,newEndMinute,0))}me.RenderValidation(startNodes,endNodes,isSameDay)},RenderValidation:function(startNodes,endNodes,isSameDay){var me=D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder;var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(endNodes.edit);var isValid=
me.ValidateNodes(startNodes,endNodes);if(!isSameDay||isValid){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",endNodes.edit);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-time-selector-invalid",startNodes.edit)}else{D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",endNodes.edit);if(!isVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-time-selector-invalid",startNodes.edit)}},ValidateIds:function(startId,endId){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.ValidateNodes(ts.GetNodes(startId),
ts.GetNodes(endId))},ValidateNodes:function(startNodes,endNodes){var ts=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var startIsEnabled=ts.IsEnabledNodes(startNodes);var endIsEnabled=ts.IsEnabledNodes(endNodes);if(!startIsEnabled||!endIsEnabled)return true;var startTime=ts.GetTimeNodes(startNodes);var endTime=ts.GetTimeNodes(endNodes);return D2L.LP.Web.UI.Desktop.Controls.TimeRangeBinder.Validate(startTime,endTime)},Validate:function(startTime,endTime){if(startTime.GetHour()===endTime.GetHour())return startTime.GetMinute()<
endTime.GetMinute();return startTime.GetHour()<endTime.GetHour()}};
D2L.LP.Web.UI.Desktop.Controls.Toggle={SetIsActiveFunction:function(id,setActive){var activeId=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"active");var inactiveId=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"inactive");var activeNode=D2L.LP.Web.UI.Html.Dom.GetElementById(activeId.GetValue());var inactiveNode=D2L.LP.Web.UI.Html.Dom.GetElementById(inactiveId.GetValue());if(activeNode===null||inactiveNode===null)throw"SetIsActiveFunction Error. Node does not exist: '"+id.GetValue()+
"'.";D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(activeNode,setActive);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(inactiveNode,!setActive)},GetIsActiveFunction:function(id){var activeId=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"active");var activeNode=D2L.LP.Web.UI.Html.Dom.GetElementById(activeId.GetValue());if(activeNode===null)throw"GetIsActiveFunction Error. Node does not exist: '"+id.GetValue()+"'.";return D2L.LP.Web.UI.Html.Dom.IsVisible(activeNode)},ToggleFunction:function(id){var me=
D2L.LP.Web.UI.Desktop.Controls.Toggle;var isActive=me.GetIsActiveFunction(id);me.SetIsActiveFunction(id,!isActive)}};
D2L.LP.Web.UI.Desktop.Controls.ToggleContainer={Toggle:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.ToggleContainer.GetHandle(id);$(handle.expandNode).toggleClass("d2l-hidden");$(handle.collapseNode).toggleClass("d2l-hidden");$(handle.containerNode).toggleClass("d2l-hidden");if(!handle.isExpanded){handle.collapseNode.focus();handle.onExpand()}else{handle.expandNode.focus();handle.onCollapse()}handle.isExpanded=!handle.isExpanded},Expand:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.ToggleContainer.GetHandle(id);
if(handle.isExpanded)return;$(handle.expandNode).addClass("d2l-hidden");$(handle.collapseNode).removeClass("d2l-hidden");$(handle.containerNode).removeClass("d2l-hidden");handle.onExpand();handle.isExpanded=true},Collapse:function(id){var handle=D2L.LP.Web.UI.Desktop.Controls.ToggleContainer.GetHandle(id);if(!handle.isExpanded)return;$(handle.expandNode).removeClass("d2l-hidden");$(handle.collapseNode).addClass("d2l-hidden");$(handle.containerNode).addClass("d2l-hidden");handle.onCollapse();handle.isExpanded=
false},GetHandle:function(id){var node=id.$()[0];var handle=node.handle;return handle}};
D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput={GetValue:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var inputs=node.getElementsByTagName("input");var value="none";var originalValue="none";for(var i=0;i<inputs.length;i++)if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],"type")=="radio"&&inputs[i].checked)value=inputs[i].value;else if(D2L.LP.Web.UI.Html.Dom.GetAttribute(inputs[i],"type")=="hidden")originalValue=inputs[i].value;var param=new D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param(value,
originalValue);return param},InitHandle:function(node){var handle={node:node,labels:[],noneInput:null,votesNode:null,currentMessageNode:null,upMessageNode:null,downMessageNode:null,noneMessageNode:null,showToolTip:true,upVotes:0,downVotes:0};handle.labels=node.getElementsByTagName("label");var noneLabel=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-none",node)[0];handle.noneInput=noneLabel.getElementsByTagName("input")[0];handle.votesNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-votes",
node)[0];handle.showToolTip=D2L.LP.Web.UI.Html.Dom.HasAttribute(handle.votesNode,"title");var messages=handle.votesNode.getElementsByTagName("span");for(var i=0;i<messages.length;i++)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",messages[i])){handle.currentMessageNode=messages[i];break}handle.upMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-up",handle.votesNode)[0];handle.downMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-down",
handle.votesNode)[0];handle.noneMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-msg-none",handle.votesNode)[0];handle.upVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-upvotes");handle.downVotes=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-downvotes");return handle},SetMessage:function(handle,messageNode){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",handle.currentMessageNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",messageNode);if(handle.showToolTip){var title=
D2L.LP.Web.UI.Html.Dom.GetAttribute(messageNode,"data-d2l-title");D2L.LP.Web.UI.Html.Dom.SetAttribute(handle.votesNode,"title",title)}handle.currentMessageNode=messageNode},SetSelected:function(handle,index,clickLabel){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var label=handle.labels[index];var input=label.getElementsByTagName("input")[0];if(clickLabel)if(input.checked)handle.noneInput.checked=true;else input.checked=true;if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-updownvote-active",
label)){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-updownvote-active",label);if(index==0)handle.upVotes--;else if(index==1)handle.downVotes--;me.SetMessage(handle,handle.noneMessageNode)}else{var selectedNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-updownvote-active",handle.node)[0];D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-updownvote-active",selectedNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-updownvote-active",label);if(index==0){handle.upVotes++;me.SetMessage(handle,handle.upMessageNode)}else if(index==
1){handle.downVotes++;me.SetMessage(handle,handle.downMessageNode)}}var onChange=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id);if(onChange!==null)onChange()}};
D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput.Param=D2L.Class.Create({Construct:function(value,originalValue){if(value===undefined){value="";originalValue=""}this.m_value=value;this.m_originalValue=originalValue},_serialize:function(serializer){serializer.AddMember("value",this.m_value);serializer.AddMember("originalValue",this.m_originalValue)},GetValue:function(){return this.m_value},GetOriginalValue:function(){return this.m_originalValue}});D2L.LP.Web.UI.Legacy={MasterPages:{}};
D2L.LP.Web.UI.Legacy.MasterPages.Dialog={InstallTitle:function(handle,closeText){var doc=handle.container.ownerDocument;var nodeWin=handle.frame.contentWindow;var titleNode=D2L.LP.Web.UI.Html.Dom.GetElementById("d_page_title",doc);var title="";if(titleNode!==null){titleNode.style.display="none";title=titleNode.innerHTML}handle.nodes.title=doc.createElement("div");handle.nodes.title.className="d2l-dialog-title";handle.nodes.heading=doc.createElement("h1");handle.nodes.heading.className="d2l-heading";
handle.nodes.heading.id=nodeWin.UI.GetUniqueHtmlId();handle.nodes.heading.innerHTML=title;handle.nodes.title.appendChild(handle.nodes.heading);handle.nodes.close=doc.createElement("a");handle.nodes.close.className="d2l-dialog-close";var closeImg=doc.createElement("span");handle.nodes.close.appendChild(closeImg);var closeTextElem=doc.createElement("span");closeTextElem.className="d2l-offscreen";closeTextElem.appendChild(doc.createTextNode(closeText));closeImg.appendChild(closeTextElem);handle.nodes.title.appendChild(handle.nodes.close);
handle.container.insertBefore(handle.nodes.title,handle.container.firstChild)},InstallFooter:function(handle,adapter,buttons){var doc=handle.container.ownerDocument;adapter.m_footerNode=doc.createElement("div");adapter.m_footerNode.className="d2l-dialog-footer";if(buttons.length>0)for(var i=0;i<buttons.length;i++){var buttonAdapter=adapter.AddCustomButton(new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter(buttons[i].Text),0,buttons[i].ResponseType,buttons[i].Param,buttons[i].Key,buttons[i].IsPrimary);
buttonAdapter.SetIsEnabled(buttons[i].IsEnabled)}var resize=doc.createElement("span");resize.className="d2l-dialog-resize";adapter.m_footerNode.appendChild(resize);handle.container.appendChild(adapter.m_footerNode);handle.nodes.footer=adapter.m_footerNode},CreateSettings:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var onload=function(handle){var nodeWin=handle.frame.contentWindow;if(nodeWin.D2L===
undefined)return;var adapter=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter(handle,responseDataKey,srcCallback,resizeCallback);me.InstallTitle(handle,closeText);me.InstallFooter(handle,adapter,buttons);handle.body.style.overflow="auto";nodeWin.UI.SetParentDialog(adapter);nodeWin.d2l_Onload()};var settings={Onload:onload,Width:width!==null?width:undefined,Height:height!==null?height:undefined};return settings},Open:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,
height,closeText,buttons){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;location=(new D2L.LP.Web.Http.UrlLocation(location.GetUrl())).WithQueryString("d2l_body_type","2");var settings=me.CreateSettings(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons);return dialog.Open(openerId,location,settings)},OpenWithParam:function(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,
buttons,params){var me=D2L.LP.Web.UI.Legacy.MasterPages.Dialog;var dialog=D2L.LP.Web.UI.Desktop.MasterPages.Dialog;location=(new D2L.LP.Web.Http.UrlLocation(location.GetUrl())).WithQueryString("d2l_body_type","2");var settings=me.CreateSettings(openerId,location,srcCallback,resizeCallback,responseDataKey,width,height,closeText,buttons);return dialog.OpenWithParam(openerId,location,params,settings)}};
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter=D2L.Class.Create({Construct:function(dialog,srcCallback,win,doc,text,responseType,responseParam,key,isPrimary){if(responseType===undefined)responseType=1;if(responseParam===undefined)responseParam="";this.m_domNode=null;this.m_dialog=dialog;this.m_srcCallback=srcCallback;this.m_win=win;this.m_doc=doc;this.m_text=text;this.m_dialog=dialog;this.m_responseType=responseType;this.m_responseParam=responseParam;this.m_key=key;this.m_isEnabled=true;this.m_isDisplayed=
true;this.m_onClick=null;this.m_isPrimary=isPrimary;this.m_isRendered=false},BuildDom:function(){var me=this;var b=D2L.LP.Web.UI.Common.Controls.Button;this.m_onClick=function(){var response=new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response(me.m_dialog,me.m_responseType,me.m_responseParam);if(me.m_win[me.m_srcCallback]!==undefined)me.m_win[me.m_srcCallback](response);else me.m_dialog.CallCallback(response)};this.m_domNode=b.Build(this.m_doc);return this.m_domNode},Init:function(){this.m_isRendered=
true;var b=D2L.LP.Web.UI.Common.Controls.Button;D2L.LP.Web.UI.Common.Controls.Button.Init(this.m_domNode);b.SetIsPrimaryNode(this.m_domNode,this.m_isPrimary);this.SetIsDisplayed(this.m_isDisplayed);this.SetIsEnabled(this.m_isEnabled);this.SetOnClick(this.m_onClick);this.SetText(this.m_text)},GetDomNode:function(){return this.m_domNode},GetText:function(){return this.m_text},SetIsDisplayed:function(isDisplayed){this.m_isDisplayed=isDisplayed;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetIsVisibleNode(this.m_domNode,
isDisplayed)},SetIsEnabled:function(isEnabled){this.m_isEnabled=isEnabled;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabledNode(this.m_domNode,isEnabled)},SetIsPrimary:function(){},SetText:function(text){this.m_text=text;if(!this.m_isRendered)return;var me=this;this.m_text.GetText().Register(function(val){D2L.LP.Web.UI.Common.Controls.Button.SetTextNode(me.m_domNode,val)})},SetOnClick:function(onClick){this.m_onClick=null;if(!this.m_isRendered)return;D2L.LP.Web.UI.Common.Controls.Button.SetOnClickNode(this.m_domNode,
onClick)}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.DialogAdapter=D2L.Class.Create({Construct:function(handle,dataKey,srcCallback,resizeCallback){this.m_handle=handle;this.m_footerNode=null;this.m_dataKey=dataKey;this.m_positiveButton=null;this.m_srcCallback=srcCallback;this.m_buttons=[];if(resizeCallback!==undefined){resizeCallback=handle.frame.contentWindow[resizeCallback];if(resizeCallback!==undefined)handle.dialog.OnResize.AddListener(function(){try{resizeCallback()}catch(ex){}})}},AddButton:function(type,responseParam,
key,isPrimary){if(responseParam===undefined)responseParam="";var win=this.m_handle.frame.contentWindow;var text=win.D2L.Control.Button.GetTermForType(type);var responseType=1;if(type==1||type==9)responseType=0;else if(type==4)responseType=2;return this.AddCustomButton(text,0,responseType,responseParam,key,isPrimary)},AddCustomButton:function(text,position,responseType,responseParam,key,isPrimary){var doc=this.m_handle.container.ownerDocument;var nodeWin=this.m_handle.frame.contentWindow;var button=
new D2L.LP.Web.UI.Legacy.MasterPages.Dialog.ButtonAdapter(this,this.m_srcCallback,this.m_handle.frame.contentWindow,doc,text,responseType,responseParam,key,isPrimary);this.m_buttons.push(button);button.BuildDom();if(responseType===1)this.m_positiveButton=button;var buttonsNode=null;var buttonsNodes=nodeWin.D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-buttons",this.m_footerNode);if(buttonsNodes.length===0){buttonsNode=doc.createElement("div");buttonsNode.className="d2l-dialog-buttons";
this.m_footerNode.appendChild(buttonsNode)}else buttonsNode=buttonsNodes[0];buttonsNode.appendChild(button.GetDomNode());button.Init();buttonsNode.appendChild(doc.createTextNode(" "));return button},CallCallback:function(response){var result=[];var dataKeys=[];if(this.m_dataKey.length>0)dataKeys=this.m_dataKey.split(",");for(var j=0;j<dataKeys.length;j++){var itemResult=undefined;var dataItemKeys=dataKeys[j].split(".");if(dataItemKeys.length>0){itemResult=response.GetData(dataItemKeys[0]);if(itemResult!==
undefined)for(var i=1;i<dataItemKeys.length;i++)if(itemResult[dataItemKeys[i]]!==undefined)itemResult=itemResult[dataItemKeys[i]]}result.push(itemResult)}if(result.length==0)result=undefined;else if(result.length==1)result=result[0];D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(response.GetType()>0,true,result,this.m_handle)},Close:function(){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.CloseHelperWithHandle(true,true,undefined,this.m_handle)},GetButton:function(key){for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i].m_key==
key)return this.m_buttons[i];return null},GetButtonCount:function(){return 0},GetContentHeight:function(){return this.m_handle.body.clientHeight},GetPositiveButton:function(){return this.m_positiveButton},GetFooterText:function(){return""},RemoveButton:function(button){for(var i=0;i<this.m_buttons.length;i++)if(this.m_buttons[i]==button){button.m_domNode.parentNode.removeChild(button.m_domNode);this.m_buttons.splice(i,1)}},RemoveButtons:function(){for(var i=0;i<this.m_buttons.length;i++)this.m_buttons[i].m_domNode.parentNode.removeChild(this.m_buttons[i].m_domNode);
this.m_buttons=[]},SetFooterText:function(text){},SetSize:function(width,height){D2L.LP.Web.UI.Common.MasterPages.Dialog.SetSize(this.m_handle,width,height)},SetTitle:function(text){}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.Response=D2L.Class.Create({Construct:function(dialog,type,param){this.m_data=[];this.m_dialog=dialog;this.m_type=type;this.m_param=param},CallCallback:function(){this.GetDialog().CallCallback(this)},GetData:function(key){return this.m_data[key]},GetDialog:function(){return this.m_dialog},GetParam:function(){return this.m_param},GetType:function(){return this.m_type},SetData:function(key,value){this.m_data[key]=value}});
D2L.LP.Web.UI.Legacy.MasterPages.Dialog.TextAdapter=D2L.Class.Create({Construct:function(text){this.m_text=text},AssignText:function(obj,attrName){obj[attrName]=this.m_text},GetText:function(){var text=this.m_text;return{Register:function(callback){callback(text)}}}});D2L.LP.Web.UI.Events.OnClick=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnContentHeightChange=new D2L.LP.Web.UI.Events.Event(function(){var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body");if(body===null)body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-body");var height=Math.max(body.scrollHeight,body.offsetHeight);return[height]});D2L.LP.Web.UI.Events.OnMouseMove=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnMouseUp=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnFormReset=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnInit=D2L.LP.Web.UI.Events.OnInit||new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnKeyPress=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnLoad=D2L.LP.Web.UI.Events.OnLoad||new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnOrientationChange=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnResize=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnScroll=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnSizingFinished=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.OnStorage=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnViewRender=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnVisibilityChange=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnProcessingBegin=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Events.OnProcessingEnd=new D2L.LP.Web.UI.Events.Event;
D2L.LP.Web.UI.Events.VisibilityManager={AddListener:function(node,callback){D2L.LP.Web.UI.Events.VisibilityManager.Listeners.push({node:node,callback:callback})},Initialize:function(){D2L.LP.Web.UI.Events.OnVisibilityChange.AddListener(function(node,isDisplayed){var listeners=D2L.LP.Web.UI.Events.VisibilityManager.Listeners;for(var i=0;i<listeners.length;i++)if(D2L.LP.Web.UI.Html.Dom.IsAncestor(node,listeners[i].node))if(D2L.LP.Web.UI.Html.Css.GetStyle(listeners[i].node,"display")!="none")listeners[i].callback.call(listeners[i].callback,
isDisplayed)})},Listeners:[]};D2L.LP.Web.UI.Events.VisibilityManager.Initialize();D2L.LP.Web.UI.Rpc.OnFailure=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Rpc.FailureReasons={Unknown:1,NotAuthenticated:2};D2L.LP.Web.UI.Events.OnLoad.AddListener(function(){D2L.LP.Web.UI.Events.OnViewRender.Trigger(document)});
D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(node){if(node.nodeType!=9&&node.nodeType!=1)return;if(node!==document)$(node).trigger("vui-viewrender");vui.applyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassInitializers,node);var tagInitializers=D2L.LP.Web.UI.Html.Dom.TagInitializers;for(var tagName in tagInitializers){var nodes=node.getElementsByTagName(tagName);var nodesCopy=[];for(var j=0;j<nodes.length;j++)nodesCopy.push(nodes[j]);for(var j=0;j<nodesCopy.length;j++)for(var k=0;k<tagInitializers[tagName].length;k++)tagInitializers[tagName][k].call(tagInitializers[tagName],
nodesCopy[j])}});D2L.LP.Web.UI.Html.PartialRendering.OnBefore.AddListener(function(placeholderId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(placeholderId.GetValue());if(node===null||node.nodeType!=9&&node.nodeType!=1)return;vui.applyClassFunctions(D2L.LP.Web.UI.Html.Dom.ClassDestructors,node)});D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(sourceNode){if(sourceNode===document)return;D2L.LP.Web.UI.Html.Math.UpdateNode(sourceNode)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fuzzydate",function(node){var formatter=D2L.LP.Globalization.Locale.GetDateTimeFormatter();var $node=$(node);var bypassAttr=$node.attr("data-bypass");if(bypassAttr!==undefined)return;$node.attr("aria-live","off");var dateTime=D2L.LocalDateTime.FromJavaScriptDate(new Date(parseInt($node.attr("data-date"))));var pageLoadNowDate=formatter.m_fuzzyDateTimeDescriptor.Now;var pageLoadNowDateJs=D2L.LocalDateTime.ToJavaScriptDate(pageLoadNowDate);var getNowDate=
function(){var pageLoadTime=formatter.m_fuzzyDateTimeDescriptor.ClientNow;var pageLoadOffset=(new Date).getTime()-pageLoadTime.getTime();var nowDateJs=new Date(pageLoadNowDateJs.getTime()+pageLoadOffset);var nowDate=D2L.LocalDateTime.FromJavaScriptDate(nowDateJs);return nowDate};var updateText=function(){var parent=node.parentNode;while(parent!==null&&parent!==node.ownerDocument)parent=parent.parentNode;if(parent===null)return;var newNowDate=getNowDate();var newFormat=formatter.FormatFuzzyDateTime(dateTime,
newNowDate);$node.text(newFormat.text);if(newFormat.timeout>0)setTimeout(updateText,newFormat.timeout)};var initialNowDate=getNowDate();var format=formatter.FormatFuzzyDateTime(dateTime,initialNowDate);if(format.timeout>0)setTimeout(updateText,format.timeout)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-close",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitClose(node,window)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-title",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitTitle(node,window)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dialog-resize",function(node){D2L.LP.Web.UI.Desktop.MasterPages.Dialog.InitResize(node,window)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-page-main",function(node){try{var topWindow=window.top;var topMost=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-main",topWindow.contentDocument);if(topMost==node)D2L.LP.Web.UI.Html.Aria.SetRole(node,"main")}catch(e){}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-popup",function(node){var title=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-popup-title",node);var body=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-popup-body",node);var footer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-popup-buttons",node);var onResize=function(){body.style.height="1px";var offset=0;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(title);offset+=rect.height;if(footer!==null){rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footer);
offset+=rect.height}var pageSize=D2L.LP.Web.UI.Html.Dom.GetPageSize(window);var viewportSize=D2L.LP.Web.UI.Html.Dom.GetViewportSize();body.style.height=Math.max(pageSize.height,viewportSize.height)-offset+"px"};onResize();D2L.LP.Web.UI.Events.OnResize.AddListener(onResize)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-page-actions",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"navigation")});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-page-buttons",function(node){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("dba",function(node){var isBottom=$(node).is(".dba_b");if(!isBottom)return;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.PageButtons.Init(node)},300)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-page-collapsepane-container",function(node){D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.Init(node)});
D2L.LP.Web.UI.Events.OnViewRender.AddListener(function(node){var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-page-collapsepane-container",node);if(container!=null&&node.nodeType==1){var context=D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.GetContext(node);D2L.LP.Web.UI.Desktop.MasterPages.CollapsePane.OnScroll(context)}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-tool-areas",function(node){var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var selected=null;var bar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-tool-areas-bar",node);var applyBar=function(link,first){var item=link.parentNode;var prev=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(item);var pos=$(item).position();var width=$(item).width()-(prev!==
null?30:15);var left=pos.left+(prev!==null||isRtl?15:0);var properties={"width":width+"px","left":left};if(!first)$(bar).animate(properties,100);else $(bar).css(properties).show()};var over=false;var newSelection=false;var onOver=function(){if(newSelection)return;over=true;applyBar(this,false)};var onOut=function(){if(newSelection)return;over=false;setTimeout(function(){if(!over)applyBar(selected,false)},300)};$(node).find(".d2l-tool-areas-link").each(function(index,item){if($(item).parent().hasClass("d2l-tool-areas-item-selected")){selected=
item;applyBar(selected,true)}$(item).hover(onOver,onOut).focus(onOver).blur(onOut).click(function(){newSelection=true})})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dragdrop-draggable",function(node){var ddType=D2L.LP.Web.UI.Html.DragDrop.DragDropType.Draggable;if(D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){var ddSettings=D2L.LP.Web.UI.ObjectRepository.Get(node.id);D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,ddSettings["drag"],ddSettings["drop"])}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-dragdrop-droppable",function(node){var ddType=D2L.LP.Web.UI.Html.DragDrop.DragDropType.Droppable;if(D2L.LP.Web.UI.ObjectRepository.HasKey(node.id)){var ddSettings=D2L.LP.Web.UI.ObjectRepository.Get(node.id);D2L.LP.Web.UI.Html.DragDrop.InstallNode(node,ddType,ddSettings["drag"],ddSettings["drop"])}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-filedrop",function(node){var me=D2L.LP.Web.UI.Html.Files.FileUpload.FileDrop.Default;me.MakeFileDropNode(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-flash-message",function(node){var over=false;var fadedOut=false;var $node=$(node);$node.attr("role","alert");var $pageMessage=$node.closest(".d2l-page-message");if($pageMessage===undefined)return;var pageMessageId=$pageMessage.attr("id");if(pageMessageId===undefined)return;pageMessageId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(pageMessageId);var autoHide=$(node).data("d2l-autohide")!==undefined;var FadeOut=function(){if(over)return;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Close(pageMessageId);
setTimeout(function(){fadedOut=true},2E3)};if(autoHide){setTimeout(FadeOut,4E3);$pageMessage.on("mouseover",function(){if(fadedOut)return;over=true;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(pageMessageId)}).on("mouseout",function(){over=false;setTimeout(FadeOut,4E3)})}setTimeout(function(){var $messageNode=$node.find(".d2l-flash-message-text");var text=$("<p></p>").append($messageNode.attr("data-message-text"));$messageNode.append(text);$node.css("visibility","hidden");$node.css("visibility",
"visible");D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(pageMessageId)},100)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("vui-button",function(node){D2L.LP.Web.UI.Common.Controls.Button.Init(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("vui-button");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-checkbox",function(node){var hidden=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(hidden===null)return;var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.checked});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){hidden.value=node.checked?"1":"0";setTimeout(function(){changeEvent.Trigger()},0)});D2L.LP.Web.UI.Events.OnFormReset.AddListener(function(form){if(node.form==
form)hidden.value=node.checked?"1":"0"})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-checkbox-image-checkmark-no-css3-selector-support",function(node){var onChangeFunction=function(hasFocus){D2L.LP.Web.UI.Common.Controls.Checkbox.NoCss3SelectorSupportOnChange(node,hasFocus)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){onChangeFunction(true)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,function(){onChangeFunction(false)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,function(){onChangeFunction(true)});
onChangeFunction(false)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-checkbox");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-collapsepane-header",function(node){var actionNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-collapsepane-action",node);var expandCollapse=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(e){if(actionNode===null){eval(expandCollapse);return}var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);
if(eventTarget!==actionNode&&eventTarget.parentNode!==actionNode)eval(expandCollapse)})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-edit-required",function(node){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"required","true")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-edit",function(node){if(node.autocomplete!="on")node.autocomplete="off";var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.value});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger();D2L.LP.Web.UI.Common.Controls.Edit.SetClearLinkIsVisible(node,true)});if(!D2L.LP.Web.UI.ObjectRepository.HasKey(node.id))return;var prevNodeVal=
node.value;var onKeyPress=function(kpArgs){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,"key")){var onKeyPressFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"key");setTimeout(function(){onKeyPressFunction.call(onKeyPressFunction)},0)}if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter&&D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,"enter")){var onEnterFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"enter");onEnterFunction.call(onEnterFunction)}if(kpArgs.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter&&D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,"change")){var dispatchOnChange=function(){if(prevNodeVal!==node.value){node.value=node.value;D2L.LP.Web.UI.Html.Dom.DispatchEvent("change",node)}};setTimeout(dispatchOnChange)}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){onKeyPress(kpArgs)});if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,"change")){var onChangeFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"change");
D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){prevNodeVal=node.value;onChangeFunction.call(onChangeFunction)})}var edit=$(node);var onBlur=edit.attr("data-onblur");if(onBlur)edit.on("blur",function(){eval(onBlur)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-edit-clearicon",function(node){var input=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);var box=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(input,true);node.style.marginTop=Math.round((box.bottom-box.top-node.offsetHeight)/2+1)+"px"});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-expandcollapse",function(node){var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);var key=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-key");var groupName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-group");var onStateChanged=null;if(groupName!==null)onStateChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(groupName,"ItemStateChanged");var triggerChange=function(state){if(!D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressStateChangeEvent)if(groupName!==
null&&key!==null){D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SetChangedKey(key,state);if(onStateChanged!==null)onStateChanged.call(onStateChanged)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",links[0],function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||window.event);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[1],true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[0],false);if(!D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange)D2L.LP.Web.UI.Html.Dom.FocusNode(links[1]);
triggerChange(false)});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",links[1],function(evt){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(evt||window.event);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[0],true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(links[1],false);if(!D2L.LP.Web.UI.Common.Controls.ExpandCollapse.SuppressFocusChange)D2L.LP.Web.UI.Html.Dom.FocusNode(links[0]);triggerChange(true)})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-expandcollapse");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-field-required",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"presentation")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-form",function(form){var submitFormOnEnterBuster=document.createElement("input");submitFormOnEnterBuster.type="text";submitFormOnEnterBuster.className="d2l-hidden";form.appendChild(submitFormOnEnterBuster);var onChangeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,"change");if(onChangeFunc!==null)D2L.LP.Web.UI.Common.Controls.ChangeTracking.OnChange.AddListener(function(changedElement){onChangeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(form.id,"change");
if(onChangeFunc!==null)if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,changedElement))onChangeFunc.call(onChangeFunc)});var trackChanges=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-form-track-changes",form)&&D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",document)==null&&D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form-track-changes",form)==null;if(!trackChanges)return;form.m_stopChangeTrackingPrompt=false;window.onbeforeunload=function(){if(form.m_stopChangeTrackingPrompt)return;
if(D2L.LP.Web.UI.Common.Controls.Form.HasChangedNode(form))return"Unsaved Changes"}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-hidden-track",function(node){node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,node.d2l_changeEvent,function(){return node.value})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe",function(iframe){var onClick=D2L.LP.Web.UI.Events.OnClick;var $iframe=$(iframe);var loadingIcon=$iframe.prev(".d2l-iframe-loading-container");var showContent=function(){loadingIcon.hide();$iframe.removeClass("d2l-iframe-offscreen")};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,showContent);var loadHandler=function(){var handleClick=function(evt){onClick.Trigger(evt)};try{D2L.LP.Web.UI.Html.Dom.AddEventListener("click",iframe.contentWindow.document,
handleClick)}catch(e){}try{var mathJaxMessageNode=D2L.LP.Web.UI.Html.Dom.GetElementById("MathJax_MSIE_Frame",iframe.contentWindow.document);if(mathJaxMessageNode&&mathJaxMessageNode.parentNode&&mathJaxMessageNode.parentNode.parentNode)mathJaxMessageNode.parentNode.parentNode.removeChild(mathJaxMessageNode.parentNode)}catch(e){}};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,loadHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fullscreen",function(iframe){document.body.style.overflow="hidden";var pagePadding=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-page-main-padding",document);if(pagePadding!==null&&pagePadding!==undefined)pagePadding.style.paddingBottom=0;var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",document);if(dialogBody===null)dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-popup-body",document);
var resize=function(){var viewportHeight;if(dialogBody===null)viewportHeight=D2L.LP.Web.UI.Html.Dom.GetViewportSize().height;else viewportHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody).height;var height=viewportHeight;if(dialogBody===null){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(iframe);height-=rect.top}else height-=5;iframe.style.height=height+"px"};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize);setTimeout(function(){D2L.LP.Web.UI.Events.OnResize.AddListener(function(){resize()})})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fit",function(iframe){var doResize=function(){try{var body=iframe.contentWindow.document.body;if(body){var scrollHeight=body.scrollHeight;if(iframe.contentWindow.document.documentElement&&navigator.appVersion.indexOf("MSIE")<0){var documentElementHeight=iframe.contentWindow.document.documentElement.scrollHeight;scrollHeight=Math.min(documentElementHeight,scrollHeight)}body.style.overflowY="hidden";iframe.style.height=scrollHeight+"px"}}catch(e){}setTimeout(function(){doResize()},
500)};var resize=function(){var body=null;try{body=iframe.contentWindow.document.body}catch(e){}if(body===null)return;doResize()};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-iframe-fit-user-content",function(iframe){var doResize=function(){try{var body=iframe.contentWindow.document.body;if(body){var height=Math.max(body.scrollHeight,body.offsetHeight,body.clientHeight);var docElement=iframe.contentWindow.document.documentElement;if(docElement)height=Math.max(height,docElement.scrollHeight,docElement.offsetHeight,docElement.clientHeight);if(iframe.contentWindow.innerHeight)height=Math.max(height,iframe.contentWindow.innerHeight);
body.style.overflowY="hidden";iframe.style.height=height+"px"}}catch(e){}setTimeout(function(){doResize()},500)};var resize=function(){var body=null;try{body=iframe.contentWindow.document.body}catch(e){}if(body===null)return;if(isFullScreen())return;doResize()};var isFullScreen=function(){try{var body=iframe.contentWindow.document.body;var isFs=false;if(body){var originalIframeHeight=iframe.offsetHeight;var prevHeight=Math.max(body.scrollHeight,body.offsetHeight,body.clientHeight);iframe.style.height=
originalIframeHeight+1+"px";var newHeight=Math.max(body.scrollHeight,body.offsetHeight,body.clientHeight);if(newHeight==prevHeight+1)isFs=true;iframe.style.height=originalIframeHeight+"px"}return isFs}catch(e){return false}};D2L.LP.Web.UI.Common.Controls.IFrame.AddOnLoadHandler(iframe,resize)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-image",function(node){if(node.alt!=="")node.title=node.alt});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-imagelink",function(node){var me=D2L.LP.Web.UI.Common.Controls.ImageLink;var isDisabled=!me.IsEnabledNode(node);if(isDisabled)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"disabled","true");var hasOnClick=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-onclick");if(hasOnClick){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,"data-onclick");if(onClick)D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
node,function(){if(D2L.LP.Web.UI.Common.Controls.ImageLink.IsEnabledNode(node))eval(onClick)})}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-imagelink");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-clickable",function(node){D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-clickable");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-longedit",function(node){var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.value});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger()})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-longedit-autoresize",function(node){var cloneTextArea=document.createElement("textarea");cloneTextArea.className=node.className;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-longedit-offscreen",cloneTextArea);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cloneTextArea);document.body.appendChild(cloneTextArea);var heightOffset=0;var first=true;var updateHeight=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
cloneTextArea);cloneTextArea.style.width=rect.width+"px";if(first){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-height",50);heightOffset=(rect.height?rect.height:50)-cloneTextArea.scrollHeight;first=false}cloneTextArea.value=node.value;var setHeight=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-height"));var newHeight=Math.max(setHeight,cloneTextArea.scrollHeight+heightOffset);if(newHeight>setHeight)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-longedit-resized",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-longedit-resized",
node);node.style.height=newHeight+"px";D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",cloneTextArea)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,updateHeight);D2L.LP.Web.UI.Html.Dom.AddEventListener("input",node,updateHeight);node.d2l_onChange=updateHeight;updateHeight();D2L.LP.Web.UI.Events.OnSizingFinished.Trigger()});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-longedit-autoresize-ie",function(node){var heightOffset;var updateHeight=function(){var setHeight=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-height"));var newHeight=Math.max(setHeight,node.scrollHeight+heightOffset);if(newHeight>setHeight)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-longedit-resized",node);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-longedit-resized",node);node.style.height=newHeight+"px"};var updateLongEditHeightDelayed=
function(){setTimeout(function(){updateHeight()},0)};var init=function(){var content=node.value;node.value="";var wasHidden=D2L.LP.Web.UI.Common.Controls.LongEdit.AddOffScreenClass(node,true);setTimeout(function(){var initHeight=node.offsetHeight;D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-height",initHeight);node.style.height=initHeight+"px";heightOffset=node.offsetHeight-node.scrollHeight;node.value=content;setTimeout(function(){updateHeight();D2L.LP.Web.UI.Events.OnSizingFinished.Trigger()},
0);D2L.LP.Web.UI.Common.Controls.LongEdit.RemoveOffScreenClass(node,wasHidden)},0)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,updateHeight);D2L.LP.Web.UI.Html.Dom.AddKeyUpEventListener(node,updateHeight);node.attachEvent("onpaste",updateLongEditHeightDelayed);node.attachEvent("oncut",updateLongEditHeightDelayed);node.d2l_onChange=updateHeight;init()});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-radio",function(node){var changeEvent=new D2L.LP.Web.UI.Events.Event;var noTracking=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-notracking");if(!noTracking)D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.checked});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger()})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-radio");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-select",function(node){var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.selectedIndex});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger()});var container=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-select-container",node);if(container===null)return;var arrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-select-arrow",
container);if(arrow===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-container-focus",container);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-select-arrow-focus",arrow)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",node,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-select-container-focus",container);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-select-arrow-focus",arrow)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-select-optgroup",function(node){for(var i=0;i<node.childNodes.length;i++){var option=node.childNodes[i];if(option.nodeType==1)option.title=node.label}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-select");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-panel",function(node){var prevSibling=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);if(prevSibling===null||!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-panel-title",prevSibling))return;var links=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",prevSibling);if(links.length!==2)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("click",links[0],function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-panel-collapsed",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-panel-title-collapsed",
prevSibling)});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",links[1],function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-panel-collapsed",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-panel-title-collapsed",prevSibling)})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-placeholder-live",function(node){D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"live",D2L.LP.Web.UI.Html.Aria.Politeness.Assertive)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-text-imagelink",function(node){if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"href"))D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-text-imagelink");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-validator",function(node){setTimeout(function(){var form=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-form",node);if(form===null)return;D2L.LP.Web.UI.Common.Controls.ValidatorCustom.Init(form,node)},0)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("vui-accordion",function(node){$(node).on("expandPanel",function(e,args){if(!args.isFirstExpand)return;var firstExpandHandler=$(args.header).attr("data-on-first-expand");if(firstExpandHandler==null)return;$(args.header).removeAttr("data-on-first-expand");eval(firstExpandHandler)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-action-container",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ActionContainer;var selectionUpdatedEvent=me.TryGetSelectionUpdatedEventByNode(node);if(selectionUpdatedEvent==null)return;var itemButtonIds;var getItemButtonIds=function(){if(itemButtonIds!==undefined)return itemButtonIds;var itemButtonNodes=D2L.LP.Web.UI.Html.Dom.GetImmediateChildElementsByClassName("d2l-action-container-itembutton",node);itemButtonIds=[];for(var i=0;i<itemButtonNodes.length;i++)itemButtonIds.push(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(itemButtonNodes[i].getAttribute("id")));
return itemButtonIds};node.d2l_dataControlSelectionHandler=function(selectionInfo){node.d2l_selectionInfo=selectionInfo;var buttonIds=getItemButtonIds();var isEnabled=selectionInfo.GetType()!=D2L.LP.LayeredArch.SelectionFilterType.None;for(var i=0;i<buttonIds.length;i++)D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(buttonIds[i],isEnabled)};selectionUpdatedEvent.AddListener(node.d2l_dataControlSelectionHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-autocomplete-static",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle=me.InitHandle(node);handle.processFunction=me.Static.Filter;handle.highlight=true;me.Initialize(handle)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-autocomplete-dynamic",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.AutoComplete;var handle=me.InitHandle(node);handle.processFunction=me.Dynamic.PartialFunction;handle.highlight=me.GetDataAttribute(handle.containerNode,"data-d2l-highlight");handle.lastSearch=null;var totalResults=me.GetDataAttribute(handle.containerNode,"data-d2l-totalresults");if(totalResults>0)handle.totalResults=totalResults;me.Initialize(handle)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-breadcrumbs",function(node){var breadCrumbs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-breadcrumb",node);if(breadCrumbs.length===0)return;var lastChild=breadCrumbs[breadCrumbs.length-1];D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-breadcrumb-last",lastChild)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-button-checkbox",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ButtonCheckbox;var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);");var id1=new D2L.LP.Web.UI.Html.UniqueHtmlId;var nodes=me.GetNodesNode(node);nodes.text.id=id1.GetValue();if(nodes.textSelected!==undefined){var id2=new D2L.LP.Web.UI.Html.UniqueHtmlId;nodes.textSelected.id=id2.GetValue()}D2L.LP.Web.UI.Html.Aria.SetRole(node,
"checkbox");me.AdjustAria(nodes);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){var isSelected=me.GetIsSelectedNode(nodes.hidden);me.SetIsSelected(id,!isSelected,true)})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-button-checkbox");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-button-filter",function(node){var labels=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-heading",node);var lists=node.getElementsByTagName("ul");if(labels.length===1&&lists.length===1){D2L.LP.Web.UI.Html.Aria.SetRole(lists[0],"toolbar");D2L.LP.Web.UI.Html.Aria.SetAttribute(lists[0],"labelledby",labels[0].id)}var anchors=node.getElementsByTagName("a");for(var i=0;i<anchors.length;i++){D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i].parentNode,"presentation");
D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i],"button");if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(anchors[i],"href"))D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],"href","javascript:void(0);");if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-button-filter-selected",anchors[i]))D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[i],"pressed",true);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",anchors[i],function(index){return function(){var isEnabled=D2L.LP.Web.UI.Common.Controls.Button.IsEnabledNode(anchors[index]);
if(!isEnabled)return;var f=D2L.LP.Web.UI.ObjectRepository.TryGet(anchors[index].getAttribute("id"));if(f===null)return;for(var j=0;j<anchors.length;j++){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-button-filter-selected",anchors[j]);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[j],"pressed",false)}D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-button-filter-selected",anchors[index]);D2L.LP.Web.UI.Html.Aria.SetAttribute(anchors[index],"pressed",true);f.call(f)}}(i))}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-button-filter");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-button-menu",function(node){D2L.LP.Web.UI.Desktop.Controls.ButtonMenu.Init(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-button-menu");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-calendar-mini",function(node){var navMatrix=new Array;var prevMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-prevmonth",node);var nextMonthArrow=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-nextmonth",node);var navLocation={col:0,row:0,daysPerWeek:7};var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var setOnClick=
function(onclick,days,i,j){days[i+j].onclick=function(event){if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar();onclick(event)};days[i+j].onkeypress=function(kpEvent){var keyCodeEvent=kpEvent||window.event;var keyCode=keyCodeEvent.keyCode;if(keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter||keyCode==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Space){if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar();onclick(kpEvent)}}};
var monthChangeAdditionalOnClick=function(){setTimeout(function(){if(node.editNode!=null&&node.editNode.onMiniCalendarChange)node.editNode.onMiniCalendarChange()},200)};var initNavMatrix=function(){D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(prevMonthArrow.id),monthChangeAdditionalOnClick);D2L.LP.Web.UI.Common.Controls.ImageLink.AddOnClick(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(nextMonthArrow.id),monthChangeAdditionalOnClick);var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-calendar-mini-day",
node);for(var i=0;i<days.length;i+=7){navMatrix.push(new Array);for(var j=0;j<7;j++){setOnClick(days[i+j].onclick,days,i,j);navMatrix[navMatrix.length-1].push(days[i+j]);days[i+j].tabIndex=-1}}};var navMatrixBoundaryCheck=function(){return navLocation.row>=0&&navLocation.row<navMatrix.length&&navLocation.col>=0&&navLocation.col<navLocation.daysPerWeek};var navFocusSelectedDay=function(){var day=1;var selectedDay=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-calendar-mini-selected",node);
if(selectedDay!==undefined&&selectedDay!==null)if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",selectedDay))day=D2L.LP.Web.UI.Html.Dom.GetAttribute(selectedDay,"data-date");navFocusDay(day)};var navRestoreColumnFocus=function(col,startFromBottom){var row=startFromBottom?navMatrix.length-1:0;var day=navMatrix[row][col];while(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",day)){row=startFromBottom?row-1:row+1;day=navMatrix[row][col];if(row<0||row>navMatrix.length)return}navLocation.col=
col;navLocation.row=row;day.focus()};var navFocusDay=function(day){if(day===undefined||day===null)day=1;var days=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-calendar-mini-day",node);var firstDayOffset=0;for(var i=0;i<days.length;i++)if(D2L.LP.Web.UI.Html.Dom.GetAttribute(days[i],"data-date")==="1"){firstDayOffset=i;break}day=day-0;firstDayOffset=firstDayOffset-0;var row=Math.floor(day/navLocation.daysPerWeek);if(day%navLocation.daysPerWeek==0)row=row-1;var col=day%navLocation.daysPerWeek;if(col==
0)col=navLocation.daysPerWeek;col=col+firstDayOffset;if(col>navLocation.daysPerWeek){row=row+1;col=col%navLocation.daysPerWeek}if(row!=null&&row!=undefined&&col!=null&&col!=undefined)navFocusNode(row,col-1)};var navFocusNode=function(optRow,optCol){if(optRow!=null&&optRow!=undefined&&optCol!=null&&optCol!=undefined){navLocation.row=optRow;navLocation.col=optCol}if(navMatrixBoundaryCheck())if(navMatrix[navLocation.row][navLocation.col]!==null)navMatrix[navLocation.row][navLocation.col].focus()};var changeMonth=
function(changeMonthEvent){changeMonthEvent.click(changeMonthEvent)};var preserveColumn=function(col,startFromBottom){if(col!==undefined&&col!==null&&node.parentNode&&node.parentNode.parentNode){var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-placeholder",node);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-restoreColumn",col);D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-startFromBottom",startFromBottom)}};var preserveDate=function(col,row){if(col===undefined||
col===null||row===undefined||row===null)return;var placeHolder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-placeholder",node);if(placeHolder===undefined||placeHolder===null)return;var day=navMatrix[row][col];if(day!==null&&D2L.LP.Web.UI.Html.Dom.HasAttribute(day,"data-date")){var dayStr=D2L.LP.Web.UI.Html.Dom.GetAttribute(day,"data-date");D2L.LP.Web.UI.Html.Dom.SetAttribute(placeHolder,"data-restoreDate",dayStr)}};var navArrowHandler=function(col,row){navLocation.col+=col*(isRTL?-1:1);
navLocation.row+=row;var rowMax=navMatrix.length-1;if(navLocation.row<0){preserveColumn(navLocation.col,true);changeMonth(prevMonthArrow);return}else if(navLocation.row>rowMax){preserveColumn(navLocation.col,false);changeMonth(nextMonthArrow);return}else if(navLocation.col<0&&navLocation.row==0){preserveColumn(6,true);changeMonth(prevMonthArrow);return}else if(navLocation.col>=navLocation.daysPerWeek&&navLocation.row==rowMax){preserveColumn(0,false);changeMonth(nextMonthArrow);return}else if(navLocation.col<
0){navLocation.row=navLocation.row-1;navLocation.col=navLocation.daysPerWeek-1}else if(navLocation.col>navLocation.daysPerWeek-1){navLocation.row=navLocation.row+1;navLocation.col=0}else{var day=navMatrix[navLocation.row][navLocation.col];if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-calendar-mini-other",day)){preserveDate(navLocation.col,navLocation.row);navLocation.row==0?changeMonth(prevMonthArrow):changeMonth(nextMonthArrow);return}}navFocusNode()};var navOnKeyPress=function(kpArgs){var result=
false;var e=kpArgs.GetEventObject();if(!D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.IsControlPressed)if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowUp){navArrowHandler(0,-1);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){navArrowHandler(0,1);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){navArrowHandler(-1,0);result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){navArrowHandler(1,
0);result=true}else{if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab){navLocation.col=0;navLocation.row=0;navFocusNode(0,0)}if(node.editNode!=null&&node.editNode.closeMiniCalendar)node.editNode.closeMiniCalendar()}}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowLeft){changeMonth(prevMonthArrow);result=true}else if(kpArgs.GetKey()==
D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowRight){changeMonth(nextMonthArrow);result=true}return result};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});initNavMatrix();node.navLocation=navLocation;node.navFocusNode=navFocusNode;node.navFocusDay=navFocusDay;node.navRestoreColumnFocus=navRestoreColumnFocus;node.navFocusSelectedDay=navFocusSelectedDay});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-checkboxlist",function(node){var cascadeSelection=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-cascadeSelection");if(cascadeSelection===undefined||cascadeSelection===null||cascadeSelection==D2L.LP.Web.UI.Desktop.Controls.CheckboxList.CascadeOptions.None)return;if(cascadeSelection){var childNodes=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetItemsNodesByNode(node);for(var i=0;i<childNodes.length;i++)(function(index){var checkBox=D2L.LP.Web.UI.Desktop.Controls.CheckboxList.GetCheckboxNode(childNodes[index]);
D2L.LP.Web.UI.Html.Dom.AddEventListener("change",checkBox,function(){D2L.LP.Web.UI.Desktop.Controls.CheckboxList.CascadeSelection(childNodes[index],cascadeSelection)})})(i)}});D2L.LP.Web.UI.Desktop.Controls.ClassListFilterInlineGroup={GetSelectedViewKey:function(id){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(id.GetValue(),"HiddenSelectedViewKey"))return D2L.LP.Web.UI.ObjectRepository.Get(id.GetValue(),"HiddenSelectedViewKey");else return D2L.LP.Web.UI.Desktop.Controls.FilterInlineFlyout.GetKey(id)}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-checkbox-text",function(node){var container=node.parentNode;var isImageCheckbox=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-checkbox-image-checkmark",node);if(isImageCheckbox)node=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-checkbox-image-placeholder",node);var isVisible=D2L.LP.Web.UI.Html.Dom.IsVisible(node);if(!isVisible)return;var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node,false);var isRtl=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==
D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;node.style.position="absolute";node.style.top=rect.top+"px";if(!isRtl){container.style.paddingLeft=rect.width+3+"px";node.style.marginLeft=0-rect.width-3+"px"}else{container.style.paddingRight=rect.width+3+"px";node.style.marginRight=0-rect.width-3+"px"}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-contextmenu",function(node){var contextMenuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-item",node);for(var i=0;i<contextMenuItems.length;i++)D2L.LP.Web.UI.Desktop.Controls.ContextMenuItem.Initialize(contextMenuItems[i],new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id));var floatingContainerNode=node.parentNode;D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InstallKeyboardSupport(node);D2L.LP.Web.UI.Html.Aria.SetRole(floatingContainerNode,
"menu");D2L.LP.Web.UI.Html.Aria.SetRole(node,"presentation");floatingContainerNode.tabIndex="-1";var contextMenuSeparators=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-contextmenu-separator",node);for(var i=0;i<contextMenuSeparators.length;i++)D2L.LP.Web.UI.Html.Aria.SetRole(contextMenuSeparators[i],"separator")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-contextmenu-ph",function(node){D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"haspopup","true");var contextMenuId=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create($(node).attr("data-contextMenuId"));if(contextMenuId!==null)D2L.LP.Web.UI.Desktop.Controls.ContextMenu.InitPlaceholder(node,contextMenuId,"d2l-contextmenu-ph-hover")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-contextmenu");
D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-contextmenu-ph");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-colourselector-button",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-colourselector-disabled",node))return;D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"href","javascript:void(0);")});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-colourselector",function(node){D2L.LP.Web.UI.Desktop.Controls.ColourSelector.Init(node)});
D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-colourselector-button");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListId=node.parentNode.getAttribute("id");if(dataListId!=null){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListId);var totalItemCount;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,2))totalItemCount=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,2);var pageNumber;if(D2L.LP.Web.UI.ObjectRepository.HasKeys(dataListId,3))pageNumber=D2L.LP.Web.UI.ObjectRepository.Get(dataListId,
3);var itemNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item",node);me.SetIsNewItems(itemNodes);setTimeout(function(){var hasMoreItems=me.GetHasMoreItems(id);if(!hasMoreItems&&totalItemCount!==undefined&&itemNodes.length<totalItemCount)hasMoreItems=true;me.GetOnLoadCompletedEvent(id).Trigger(hasMoreItems,itemNodes,totalItemCount,pageNumber)})}D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-checkboxitem",function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.CheckboxItems.InitializeCheckboxItem(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-radioitem",function(node){D2L.LP.Web.UI.Desktop.Controls.DataList.RadioItems.InitializeRadioItem(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-placeholder",function(node){var dataListNode=node.parentNode;D2L.LP.Web.UI.Html.PartialRendering.OnAfter.AddListener(function(id){if(id.GetValue()==node.id)D2L.LP.Web.UI.Desktop.Controls.DataList.AdjustLastVisibleChild(dataListNode)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-item-actionable",function(node){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var contentNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-item-content",node);var actionNode;var actionControlId=node.getAttribute("data-d2l-actionId");if(actionControlId!=null){actionNode=D2L.LP.Web.UI.Html.Dom.GetElementById(actionControlId);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-datalist-item-actioncontrol",actionNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("vui-outline",
actionNode)}var addFocusClassName=function(node,className){if(className.length>0)node.className+=" "+className};var removeFocusClassName=function(node,className){if(className.length>0)node.className=node.className.replace(" "+className,"")};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",actionNode,function(){addFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",actionNode,function(){removeFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",
contentNode,function(){addFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",contentNode,function(){removeFocusClassName(node,"d2l-datalist-item-active")});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",contentNode,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);while(eventTarget!==contentNode&&eventTarget!==null){var onClickRule=dataList.CaptureOnClickRules[eventTarget.nodeName.toUpperCase()];if(onClickRule!==undefined&&
onClickRule===true)return;eventTarget=eventTarget.parentNode}var href=actionNode.getAttribute("href");actionNode.removeAttribute("href");D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",actionNode);actionNode.href=href;if(href!==null&&href!=="javascript:void(0);")D2L.LP.Web.UI.Html.Dom.Navigate(new D2L.LP.Web.Http.UrlLocation(href))})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-datalist-item-actionable");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-item-dragdrop",function(node){var dataListItem=D2L.LP.Web.UI.Desktop.Controls.DataListItem.DragDrop;dataListItem.InstallDragDropEvents(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-empty-drop",function(node){var droppableSettings=new D2L.LP.Web.UI.Html.DragDrop.DroppableSettings;droppableSettings.SetDropEffect(D2L.LP.Web.UI.Html.DragDrop.DropEffect.None);var acceptableDragGroups=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"EmptyListAcceptableDragGroups");var fileDropNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-filedrop",node);if(acceptableDragGroups)for(var i=0;i<acceptableDragGroups.length;i++)droppableSettings.AddAcceptableDragGroup(acceptableDragGroups[i]);
var handleDrop=function(dragObject){var draggedNodeSettings=dragObject.GetDraggableSettings();node.d2l_draggedNodeKey=draggedNodeSettings.GetKey();node.d2l_dragObjectParam=draggedNodeSettings.GetParam();node.d2l_dragObject=dragObject;var emptyListOnItemDrop=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"EmptyListOnItemDrop");if(emptyListOnItemDrop)emptyListOnItemDrop.call(this);handleDragout()};var handleDragIn=function(){var hoverNode=fileDropNode||node;D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filedropstyle-container-dragover",
hoverNode)};var handleDragout=function(){var hoverNode=fileDropNode||node;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filedropstyle-container-dragover",hoverNode)};droppableSettings.GetDropEvent().AddListener(handleDrop);droppableSettings.GetDragInEvent().AddListener(handleDragIn);droppableSettings.GetDragOutEvent().AddListener(handleDragout);D2L.LP.Web.UI.Html.DragDrop.MakeDroppableNode(node,droppableSettings)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-item-dragdrop-reorder",function(node){var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList.DragDrop.GetParentDataList(node);var reorderId=D2L.LP.Web.UI.ObjectRepository.Get(dataList.id,"ReorderId");var hiddens=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-datalist-item-dragdrop-reorder-hidden",node);for(var i=0;i<hiddens.length;i++)hiddens[i].name=reorderId;setTimeout(function(){node.d2l_DraggableSettings.SetDragGroup("d2l.datalist.reorder."+
dataList.id);node.d2l_DroppableSettings.SetAcceptableDragGroups(["d2l.datalist.reorder."+dataList.id]);node.d2l_DroppableSettings.GetDropEvent().AddListener(function(){D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.UpdateDataListReorderState(dataList)})});if(dataList.d2l_reorderChangeEvent===undefined){dataList.d2l_reorderChangeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(dataList,dataList.d2l_reorderChangeEvent,function(){var ordredKeys=
D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.GetOrderedKeysNode(dataList);var value=ordredKeys.join();return value})}D2L.LP.Web.UI.Desktop.Controls.DataList.Reorder.InstallKeyboardEvents(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datalist-summary",function(node){var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall",node);if(selectAllNode==null)return;var dataList=D2L.LP.Web.UI.Desktop.Controls.DataList;var dataListNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-datalist-container",selectAllNode);var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListNode.getAttribute("id"));var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist",
dataListNode);var itemCount=dataList.GetItemCount(dataListId);var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute("id"));node.d2l_onRemoveItemHandler=function(itemNode){D2L.LP.Web.UI.Desktop.Controls.SelectAll.RemoveItem(selectAllId,dataList.CheckboxItems.GetCheckboxNode(itemNode).value)};dataList.GetOnRemoveItemEvent(dataListId).AddListener(node.d2l_onRemoveItemHandler);var clearLinkNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-clear",node);
var selectEverythingNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-selecteverything",node);var noSearchTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-count-nosearch",node);var selectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-count-selected",node);var allSelectedTextNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-count-all-selected",node);var updateShownCount=function(){if(itemCount===
0)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",noSearchTextNode);if(noSearchTextNode.innerHTML.indexOf("{count}")>=0)noSearchTextNode.innerHTML=noSearchTextNode.innerHTML.replace("{count}",'<span class="d2l-datalist-summary-count-shown-counter"></span>');var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-count-shown-counter",noSearchTextNode);if(counterNode==null)return;var numShownFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(itemCount);
if(counterNode.textContent!==undefined)counterNode.textContent=numShownFormatted;else if(counterNode.innerText!==undefined)counterNode.innerText=numShownFormatted};node.d2l_updateSelectAllVisibilityHandler=function(){itemCount=dataList.GetItemCount(dataListId);updateShownCount();var isMultiSelectAlllowed=D2L.LP.Web.UI.Html.Dom.GetFirstImmediateChildElementByClassName("d2l-datalist-checkboxitem",listNode)!=null;if(itemCount>0){if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",node))D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
node)}else D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);if(!isMultiSelectAlllowed&&!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",selectAllNode)){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectAllNode);return}if(isMultiSelectAlllowed&&D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",selectAllNode)){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",selectAllNode);return}};dataList.GetOnLoadCompletedEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);dataList.GetOnLoadMoreCompletedEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);
dataList.GetOnRemoveItemEvent(dataListId).AddListener(node.d2l_updateSelectAllVisibilityHandler);var selectionUpdatedEvent=dataList.Summary.GetSelectionUpdatedEvent(dataListId);node.d2l_selectionUpdateHandler=function(type,count){var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetSelectionInfo(selectAllId);if(selectionInfo!=null)selectionUpdatedEvent.Trigger(selectionInfo);if(type==D2L.LP.LayeredArch.SelectionFilterType.All){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectedTextNode);
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",noSearchTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",allSelectedTextNode);if(clearLinkNode!=null)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",clearLinkNode);if(selectEverythingNode!=null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectEverythingNode)}else if(type!=D2L.LP.LayeredArch.SelectionFilterType.None){if(selectedTextNode.innerHTML.indexOf("{count}")>=0)selectedTextNode.innerHTML=selectedTextNode.innerHTML.replace("{count}",
'<span class="d2l-datalist-summary-count-selected-counter"></span>');var numSelectedFormatted=D2L.LP.Globalization.Locale.GetNumberFormatter().FormatInteger(count);var counterNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datalist-summary-count-selected-counter",selectedTextNode);if(counterNode.textContent!==undefined)counterNode.textContent=numSelectedFormatted;else if(counterNode.innerText!==undefined)counterNode.innerText=numSelectedFormatted;setTimeout(function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",noSearchTextNode)},0);if(clearLinkNode!=null)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",clearLinkNode);if(selectEverythingNode!=null)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",selectEverythingNode)}else{updateShownCount();setTimeout(function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectedTextNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",allSelectedTextNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
noSearchTextNode)},0);if(clearLinkNode!=null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",clearLinkNode);if(selectEverythingNode!=null)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",selectEverythingNode)}};D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetOnSelectionUpdateEvent(selectAllId).AddListener(node.d2l_selectionUpdateHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-datetime-selector",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.DateTimeSelector;var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-datetime-selector-date-input",node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);var nodes=me.GetNodes(id);var phid=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-placeholder",nodes.floatingContainer).id;nodes.container.d2l_onChange=new D2L.LP.Web.UI.Events.Event;nodes.container.d2l_onChange.AddListener(function(){var onChangeFunction=
D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,"OnDateTimeChangeFunction");if(onChangeFunction)onChangeFunction.call(onChangeFunction)});D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,nodes.container.d2l_onChange,function(){return edit.value});edit.d2l_lastGoodDate=me.GetSelectedDateTimeNodes(nodes);var locale=D2L.LP.Globalization.Locale;var dateTimeParser=locale.GetDateTimeParser();var closing=false;var onMiniCalendarChange=function(){nodes=me.GetNodes(id,phid);if(nodes.floatingContainer!=
null&&nodes.floatingContainer!=undefined)nodes.floatingContainer.tabIndex=-1;if(nodes.miniCalendar!=null&&nodes.miniCalendar!=undefined)nodes.miniCalendar.editNode=nodes.edit};var isMiniCalendarOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer)};var openMiniCalendarFunc=D2L.LP.Web.UI.ObjectRepository.Get(nodes.edit.id,"OpenMiniCalendar");var openMiniCalendar=function(){if(closing||nodes.floatingContainer==null||isMiniCalendarOpen())return;openMiniCalendarFunc.call(openMiniCalendarFunc);
onMiniCalendarChange()};var closeMiniCalendar=function(){closing=true;if(nodes.floatingContainer!=null&&isMiniCalendarOpen())D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer);setTimeout(function(){closing=false},200)};var onChange=function(){var dateTime=edit.d2l_lastGoodDate;try{var parsedDate=dateTimeParser.TryParseInputDate(edit.value);var time=D2L.LP.Web.UI.Desktop.Controls.TimeSelector.GetTimeNodes(nodes.timeNodes);if(parsedDate!==null){dateTime=parsedDate;dateTime.m_hour=
time.m_hour;dateTime.m_minute=time.m_minute}}catch(e){}me.SetSelectedDateTimeByNode(nodes,dateTime)};var navOnKeyPress=function(kpArgs){var result=false;if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.ArrowDown){openMiniCalendar();if(nodes.miniCalendar!=null&&nodes.miniCalendar.navFocusDay)nodes.miniCalendar.navFocusSelectedDay();result=true}else if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Tab||kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)closeMiniCalendar();
return result};var onFocus=function(e){openMiniCalendar()};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var result=navOnKeyPress(kpArgs);if(result){var event=kpArgs.GetEventObject();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(event)}});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",nodes.edit,onFocus);D2L.LP.Web.UI.Html.Dom.AddEventListener("change",nodes.edit,onChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.edit,openMiniCalendar);nodes.edit.closeMiniCalendar=
closeMiniCalendar;nodes.edit.onMiniCalendarChange=onMiniCalendarChange});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-datetime-selector");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable",function(node){if(!D2L.LP.Web.UI.ObjectRepository.HasKey(node.id))return;var anchor=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);D2L.LP.Web.UI.Html.Dom.SetAttribute(anchor,"href","javascript:void(0);");var autoResize=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-editable-autosize",node);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(e){var target=e.srcElement||e.target;if(target.nodeName=="A"){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);
return false}D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",anchor)});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",anchor,function(){D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ClickHelper(node,autoResize)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchor,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-editable-focus",node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",anchor,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-editable-focus",node)});D2L.LP.Web.UI.Desktop.Controls.EditInPlace.ModifyAnchors(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-edit",function(node){var isRequired=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-editable-target-edit-required",node);var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-edit",node);var finish2=function(hasChanged,isEmpty){input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty)};var finish=function(bypassType){if(input.d2l_value===null)return;var value=input.value.trim();var isEmpty=
value.length===0;var bypassValidation=true;if(bypassType===1)input.value=input.d2l_value;else if(bypassType===2&&isEmpty&&isRequired)input.value=input.d2l_value;else{input.value=value;bypassValidation=false}value=input.value;isEmpty=value.length===0;var hasChanged=input.d2l_value.trim()!==value;if(!bypassValidation&&isRequired){if(!isEmpty)finish2(hasChanged,isEmpty)}else finish2(hasChanged,isEmpty)};var handleKeyPress=function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)finish(0);
else if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)finish(1)};D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",input,function(){finish(2)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-longedit",function(node){var input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-longedit",node);var finish=function(bypassType){if(input.d2l_value===null)return;var value=input.value.trim();if(bypassType==1)value=input.d2l_value;var hasChanged=input.d2l_value!==value;var isEmpty=value.length===0;input.value=value;input.d2l_value=null;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.FinishHelper(node,hasChanged,isEmpty)};var handleKeyPress=
function(kpArgs){var key=kpArgs.GetKey();if(key==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)finish(1)};D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",input,finish);D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(input,handleKeyPress)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-editable");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-editable-target-htmleditor",function(node){node.d2l_editorLoadedEvt=new D2L.LP.Web.UI.Events.Event});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-latexeditor",function(node){var latexnode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-latexedit",node);var previewNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-mathpreview",node);var keypressCallback=function(parentnode,preview){return function(){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.GetMathML(parentnode,function(mathml){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.SetPreviewMathML(preview,mathml)})}}(node,
previewNode);D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",latexnode,keypressCallback);var help=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-equation-latexhelp",node);help.focus();setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.GetMathML(node,function(mathml){D2L.LP.Web.UI.Desktop.Controls.EquationEditor.LatexEditor.SetPreviewMathML(previewNode,mathml)})},500)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-equationeditor",function(node){var mathml=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-mathml");var graphicalNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-graphicalequationeditor",node);var culture=D2L.LP.Globalization.Locale.GetCultureCode();if(culture!=null)culture=culture.Culture;else culture="en";if(graphicalNode!=null){var editor=com.wiris.jsEditor.JsEditor.newInstance({"language":culture,"toolbar":'<toolbar ref="general"/>',
"checkSyntax":"false"});if(document.URL.indexOf("https://")==0){com.wiris.jsEditor.defaultBasePath=com.wiris.jsEditor.defaultBasePath.replace("http://","https://");com.wiris.jsEditor.defaultServicePath=com.wiris.jsEditor.defaultServicePath.replace("http://","https://")}editor.insertInto(graphicalNode)}D2L.LP.Web.UI.Desktop.Controls.EquationEditor.GraphicalEditor.SetMath(node,mathml);var win=win||window;var dialogs=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-dialog-frame",win.parent.document);
var dialog=null;for(var i=0;i<dialogs.length;i++)if(dialogs[i].contentWindow==win)dialog=dialogs[i].parentNode.parentNode;if(dialog!=null){var h=dialog.d2l_handle.frame.contentWindow.D2L.LP.Web.UI.ObjectRepository.TryGet("DialogHeight",0);D2L.LP.Web.UI.Html.Dom.SetAttribute(node,"data-d2l-initialheight",h)}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileinput",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FileInput;var id=node.getAttribute("id");var fileInputId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var isMultiple=node.getAttribute("data-d2l-ismultiple")=="true";node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,node.d2l_changeEvent,function(){var ret="";var files=me.GetParam(fileInputId).GetFiles();for(var i=0;i<
files.length;i++)ret+=files[i].GetActionType()+files[i].GetPluginKey()+files[i].GetId();return ret});me.SetAddFileVisibility(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileinput-upload-progress",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"progressbar");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuemin","0");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuemax","100");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"aria-valuenow","0")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-fileinput");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-filterinline-group",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;var isSingle=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-filterinline-group-single",node);var nodes=me.GetNodesNode(node);var label=D2L.LP.Web.UI.Html.Dom.GetPreviousElementSibling(node);label.id=(new D2L.LP.Web.UI.Html.UniqueHtmlId).GetValue();D2L.LP.Web.UI.Html.Aria.SetRole(node,isSingle?"radiogroup":"group");D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"labelledby",label.id);
for(var i=0;i<nodes.anchors.length;i++){var anchors=nodes.anchors;D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i].parentNode,"presentation");D2L.LP.Web.UI.Html.Aria.SetRole(anchors[i],isSingle?"radio":"checkbox");if(!D2L.LP.Web.UI.Html.Dom.HasAttribute(anchors[i],"href")){D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],"onclick","this.focus(); return false;");D2L.LP.Web.UI.Html.Dom.SetAttribute(anchors[i],"href","javascript:void(0);")}var newIsSelected=me.IsSelectedNode(anchors[i]);me.SetIsSelectedNodes(node.id,
nodes,anchors[i],newIsSelected,false);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",anchors[i],function(index){return function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-filterinline-item-focus",anchors[index])}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",anchors[i],function(index){return function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filterinline-item-focus",anchors[index])}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("click",anchors[i],function(index){return function(){if(isSingle)for(var j=
0;j<anchors.length;j++)me.SetIsSelectedNodes(node.id,nodes,anchors[j],false,false);newIsSelected=me.IsSelectedNode(anchors[index]);me.SetIsSelectedNodes(node.id,nodes,anchors[index],!newIsSelected,true);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-filterinline-item-focus",anchors[index])}}(i))}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-filterinline",function(node){if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,"IsEmpty")){var isEmpty=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"IsEmpty");if(isEmpty)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node);return}var me=D2L.LP.Web.UI.Desktop.Controls.FilterInline;me.RenderClear(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-filterinline");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileupload",function(node){var fu_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-cont",node);var fu_input=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-input",node);var fu_input_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-fileinput-cont",node);var fu_input_progressbar=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-progressbar-cont",node);var fu_hidden_tempFileId=
D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(fu_cont);var fu_filelink;var fu_deleteIcon=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-deleteicon",node);var fu_abortButton=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-fileupload-abortbutton",node);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_deleteIcon);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_deleteIcon);var fu_filelink_placeholder_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-placeholder",
node);var fu_hidden_iFrame;var fu_temp_form;var fu_hiddenIFrameName="uploadIFrame";var fu_addProgressBar;var fu_removeProgressBar;var fu_getFileUploadErrorMessage;var fu_generateValidators;var fu_uploadCallback;var fu_generateForm;var fu_handleDelete;var fu_handleAbort;var fu_handleFileLinkChange;fu_addProgressBar=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_progressbar);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_abortButton)};fu_removeProgressBar=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",
fu_input_progressbar);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fu_abortButton)};fu_getFileUploadErrorMessage=function(errCode){var errMessage="";var subkey="";if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeMaxFileSize)subkey="InvalidFileSizeMessage";else if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeTotalFileSize)subkey="InvalidTotalFileSizeMessage";else if(errCode==D2L.LP.Web.UI.Desktop.Controls.FileUpload.ErrCodeRestrictedFile)subkey="InvalidRestrictedFileMessage";
else return false;var getErrorMessageFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,subkey);errMessage=getErrorMessageFunc(getErrorMessageFunc);return errMessage};fu_generateValidators=function(inputId,validationFunc,errMessage){var validators=[];var validatorFunc=function(){return D2L.LP.Web.UI.Common.Controls.ValidatorCustom.GenerateValidatorObject(inputId,validationFunc,errMessage)};validators.push(validatorFunc());return validators};fu_uploadCallback=function(fileData){var jsonblob=fileData.replace(/\'/g,
'"');var json=D2L.LP.Web.Serialization.Json.Deserialize(jsonblob);var deserializer=new D2L.LP.Web.Serialization.Json.Deserializer(json);var fileId=deserializer.GetMember("FileId",false);var failReason=deserializer.GetMember("FailReason",false);var failCode=deserializer.GetMember("FailCode",false);fu_cont.appendChild(fu_input_cont);var validationFunction=function(){return fileId?true:false};var validationSourceId=fu_input.id;var validationErrorMessage=fu_getFileUploadErrorMessage(failCode);var validators=
fu_generateValidators(validationSourceId,validationFunction,validationErrorMessage);D2L.LP.Web.UI.Common.Controls.Form.Validate(fu_temp_form,validators);if(fileId){fu_hidden_tempFileId.value=fileId;var fileUploadPartialRenderFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"FileLinkPartial");var func=function(){fu_filelink_placeholder_cont=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-placeholder",node);fu_filelink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink",
node);var _anchor=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-filelink-link",fu_filelink);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(fu_deleteIcon,fu_filelink);D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_deleteIcon,"href","javascript:void(0);");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",fu_deleteIcon,fu_handleDelete);_anchor.focus()};fileUploadPartialRenderFunction.call(fileUploadPartialRenderFunction).AddListener(func);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_input_cont)}else fu_input.focus();
D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);fu_removeProgressBar();setTimeout(function(){fu_cont.removeChild(fu_hidden_iFrame);fu_cont.removeChild(fu_temp_form)},0)};fu_generateForm=function(){var maxFileSizeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MaxFileSize");var maxFileSize=maxFileSizeFunc(maxFileSizeFunc);var totalFileSizeFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"TotalFileSize");var totalFileSize=totalFileSizeFunc(totalFileSizeFunc);var _form=document.createElement("FORM");
D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"action",D2L.LP.Web.UI.Desktop.Controls.FileUpload.GetAction(fu_input.value,fu_uploadCallback,node.id,fu_input.id,maxFileSize,totalFileSize,0));D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"id",node.id+"_form");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"method","post");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"enctype","multipart/form-data");D2L.LP.Web.UI.Html.Dom.SetAttribute(_form,"encoding","multipart/form-data");_form.target=fu_hiddenIFrameName;_form.onsubmit=
"return false;";return _form};fu_handleDelete=function(){D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_filelink);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_deleteIcon);fu_cont.appendChild(fu_input_cont);setTimeout(function(){fu_input.focus()},0)};fu_handleAbort=function(){D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_temp_form);fu_cont.appendChild(fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);D2L.LP.Web.UI.Html.Dom.RemoveElement(fu_hidden_iFrame);
setTimeout(function(){fu_input_cont.focus();fu_removeProgressBar();fu_input.focus()},0)};fu_handleFileLinkChange=function(){var validateFileTypeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"ValidateFileType");var invalidFileExtensionMessageFunc=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"InvalidFileExtensionMessage");var validateFileTypeInputId=fu_input.id;var result=validateFileTypeFunction(validateFileTypeFunction);var validationFunction=function(){return result};var validateFileTypeMessage=
invalidFileExtensionMessageFunc(invalidFileExtensionMessageFunc);fu_hidden_iFrame=D2L.LP.Web.UI.Desktop.Controls.FileUpload.GenerateIFrame(fu_hiddenIFrameName,fu_cont);D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_input,"name","uploadFile");fu_temp_form=null;fu_temp_form=fu_generateForm();fu_cont.removeChild(fu_input_cont);fu_temp_form.appendChild(fu_input_cont);fu_cont.appendChild(fu_temp_form);var validators=fu_generateValidators(validateFileTypeInputId,validationFunction,validateFileTypeMessage);var failed=
true;D2L.LP.Web.UI.Common.Controls.Form.Validate(fu_temp_form,validators).AddListener(function(passed){if(passed){failed=false;fu_cont.removeChild(fu_temp_form);fu_hidden_iFrame.appendChild(fu_temp_form);fu_addProgressBar();fu_temp_form.submit()}else;});setTimeout(function(){if(failed){fu_cont.removeChild(fu_temp_form);fu_hidden_iFrame.appendChild(fu_temp_form)}fu_temp_form.reset();fu_temp_form.removeChild(fu_input_cont);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",fu_input_cont);fu_cont.appendChild(fu_input_cont);
fu_cont.removeChild(fu_input_cont);if(failed){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",fu_input_cont);fu_cont.appendChild(fu_input_cont);fu_cont.removeChild(fu_hidden_iFrame)}else{fu_hidden_iFrame.removeChild(fu_temp_form);fu_cont.appendChild(fu_temp_form)}D2L.LP.Web.UI.Html.Dom.SetAttribute(fu_input,"name","");fu_input.value="";fu_abortButton.focus()},0)};D2L.LP.Web.UI.Html.Dom.AddEventListener("change",fu_input,fu_handleFileLinkChange);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
fu_abortButton,fu_handleAbort)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-fileupload");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileviewer-image",function(node){var content=$(node);var viewer=content.closest(".d2l-fileviewer");var location=content.attr("data-location");var altText=content.attr("data-alt");var maxHeight=content.attr("data-max-height");viewer.css("overflow","hidden");viewer.css("min-height","100%");content.append('<img class="d2l-fileviewer-rendered-image"/>');var renderedImage=content.find(".d2l-fileviewer-rendered-image");renderedImage.css("max-width","100%");
if(maxHeight!==undefined)renderedImage.css("max-height",maxHeight);renderedImage.load(function(){var contentHeight=renderedImage.innerHeight();D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad(".d2l-fileviewer-rendered-image",contentHeight)}).attr({src:location,alt:altText})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-floating-container-movable",function(node){var titleHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container-titlebar",node);var closeNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-floating-container-close",titleHandle);var dragSettings=new D2L.LP.Web.UI.Html.DragDrop.DraggableSettings;dragSettings.SetHandle(titleHandle);dragSettings.SetIsDelayed(false);dragSettings.SetDragDropEffect(D2L.LP.Web.UI.Html.DragDrop.DragDropEffect.Move);
if(closeNode)dragSettings.AddHandleException(closeNode);dragSettings.SetGhostType(D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow);dragSettings.SetIsAutoScroll(false);D2L.LP.Web.UI.Html.DragDrop.MakeDraggableNode(node,dragSettings)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-floating-container-autoclose",function(elem){D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(elem,function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape)D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(elem,true)})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fragment",function(node){D2L.LP.Web.UI.Desktop.Controls.Fragment.Init(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-grid-sel-input",function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var cellNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-grid-cell-sel",node);var clickFunction=function(){if(node.type=="radio"){D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateSelectionStyleForAllInputs(gridId);D2L.LP.Web.UI.Desktop.Controls.Grid.ResetSelectionState(gridId)}D2L.LP.Web.UI.Desktop.Controls.Grid.AddOrUpdateSelectionStateAndStyle(gridId,
node);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(gridId);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(gridId)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,clickFunction);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cellNode,function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(target!==node){node.checked=!node.checked;clickFunction()}});var row=cellNode.parentNode;var rowHeader=row.getElementsByTagName("th")[0];var labelledById=D2L.LP.Web.UI.Html.Dom.GetAttribute(row,
"data-sel-labelled-by");if(labelledById)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"labelledby",labelledById);else D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"labelledby",rowHeader.id)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-grid-sel-page-input",function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty){node.disabled=true;node.title="";return}var cellNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-grid-cell-sel",node);var clickFunction=function(){D2L.LP.Web.UI.Desktop.Controls.Grid.SetAllPageIsSelected(gridId,node.checked)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",
node,clickFunction);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",cellNode,function(e){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(target!==node){node.checked=!node.checked;clickFunction()}})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-grid-wrapper",function(node){var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.id);var isEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(id);var sortField=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"SortField");if(sortField)D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(id,sortField);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateCountText(id);D2L.LP.Web.UI.Desktop.Controls.Grid.UpdateActionButtons(id);if(D2L.LP.Web.UI.Desktop.Controls.Grid.GetHasMoreItems(id)===
false&&!isEmpty)D2L.LP.Web.UI.Desktop.Controls.Grid.SetFooterIsVisible(id,false);var onBeforeSubmit=function(form){if(D2L.LP.Web.UI.Html.Dom.IsAncestor(form,node)){var selectionInfoHidden=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-selection-info-hidden",node);if(!selectionInfoHidden){var hiddenContainerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-selected-keys-hidden-container",node);if(hiddenContainerNode)D2L.LP.Web.UI.Html.Dom.RemoveChildElements(hiddenContainerNode);
return}var selectionInfo=D2L.LP.Web.UI.Desktop.Controls.Grid.GetSelectionInfo(id);var hiddenName=selectionInfoHidden.name;var serializer=new D2L.LP.Web.Serialization.Serializer;serializer.AddMember(hiddenName,selectionInfo);var hiddenContainer=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-grid-selected-keys-hidden-container",node);if(hiddenContainer)D2L.LP.Web.UI.Html.Dom.RemoveChildElements(hiddenContainer);else{hiddenContainer=document.createElement("div");hiddenContainer.className="d2l-grid-selected-keys-hidden-container";
node.appendChild(hiddenContainer)}var serializeMembers=serializer.GetMembers();for(var i=0;i<serializeMembers.length;i++){var hidden=document.createElement("input");hidden.type="hidden";hidden.name=serializeMembers[i][0];hidden.value=serializeMembers[i][1];hiddenContainer.appendChild(hidden)}}};node.d2l_onBeforeSubmitHandle=onBeforeSubmit;D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(onBeforeSubmit)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-grid-header-sort-field",function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var isCurrentSort=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-iscurrentsort")=="1";var fieldName=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-fieldname");var isClickable=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-grid-header-sort-field-no-click",node);var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-grid-header-sort-field-disabled",
node);if(isCurrentSort){var isAscending=D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-grid-header-sort-field-asc",node);D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(gridId,fieldName,isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending)}return}if(!isClickable)return;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var onClickSortDirection;if(isCurrentSort){var isAscending=
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-grid-header-sort-field-asc",node);var sortDirection=isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending;onClickSortDirection=isAscending?D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Descending:D2L.LP.Web.UI.Desktop.Controls.Grid.SortDirection.Ascending;D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortField(gridId,fieldName,sortDirection);if(D2L.LP.Web.UI.Desktop.Controls.Grid.m_reloadTriggeredBySort)node.focus()}else{var defaultSortDirection=
D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-defaultsortdirection");onClickSortDirection=defaultSortDirection}D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){D2L.LP.Web.UI.Desktop.Controls.Grid.SetSortFieldAndReload(gridId,fieldName,onClickSortDirection)});var mouseOver=false;D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,function(){if(!mouseOver)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-grid-header-cell-hover",node.parentNode);mouseOver=true});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",
node,function(){if(mouseOver)D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-grid-header-cell-hover",node.parentNode);mouseOver=false})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-grid-header-sort-field-multikey",function(node){var gridId=D2L.LP.Web.UI.Desktop.Controls.Grid.GetGridIdByDescendantNode(node);var parentHeader=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-grid-header-cell",node);var flyoutOpener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-opener",node);parentHeader.style.overflow="visible";var isGridEmpty=D2L.LP.Web.UI.Desktop.Controls.Grid.IsEmpty(gridId);if(isGridEmpty)return;var handleClick=
function(evt){var target=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(evt);if(target===node||target===parentHeader)D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",flyoutOpener)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",parentHeader,handleClick);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",parentHeader,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-grid-header-sort-field-multikey-hover",parentHeader)});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",parentHeader,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-grid-header-sort-field-multikey-hover",
parentHeader)})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-hour-selector",function(node){var select=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-select",node);var hidden=D2L.LP.Web.UI.Html.Dom.GetLastElementChild(node);D2L.LP.Web.UI.Html.Dom.AddEventListener("change",select,function(){var option=select.options[select.selectedIndex];hidden.value=option.value})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-toolbar",function(node){var toolbarLabel=node.getAttribute("data-d2l-toolbar-label");if(toolbarLabel!=null)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",toolbarLabel);D2L.LP.Web.UI.Html.Aria.SetRole(node,"toolbar")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-wysiwyg",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var id=node.getAttribute("id");var textAreaId=me.GetTextAreaId(node);var isInline=htmlEditor.IsInlineByNode(node);var pluginInitializers=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"pluginInitializers");var pluginLayoutInitializers=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"pluginLayoutInitializers");
var contentCss=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"contentCssLocation");node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor;var delimitedPlugins="autolink";if(!isInline)delimitedPlugins+=", fullpage";if(pluginInitializers!=null)for(var i=0;i<pluginInitializers.length;i++){var pluginInitializer=pluginInitializers[i];var pluginName=pluginInitializer.call(pluginInitializer);if(pluginName!=null&&pluginName.length>0)if(delimitedPlugins.length>0)delimitedPlugins+=","+pluginName;
else delimitedPlugins+=pluginName}var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;tinyMCE.init({mode:"none",apply_source_formatting:true,auto_reset_designmode:true,content_css:contentCss,convert_fonts_to_spans:true,convert_urls:false,language:"",paste_strip_class_attributes:"mso",plugins:delimitedPlugins,relative_urls:false,setupcontent_callback:"D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeCallback",
theme:"advanced",theme_advanced_layout_manager:"customlayout",theme_advanced_custom_layout:"D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.InitializeLayout",theme_advanced_path:false,d2l_context:{Id:id,Node:node,TextAreaId:textAreaId,PluginLayoutInitializers:pluginLayoutInitializers},directionality:isRTL?"rtl":"ltr",paste_retain_style_properties:"all",valid_elements:"*[*]",extended_valid_elements:"@[accesskey|class|contenteditable|contextmenu|dir|draggable|dropzone|hidden|id|inert|itemid|itemprop|itemref|itemscope|itemtype|lang|spellcheck|style|tabindex|title|translate],"+
"address,"+"article,"+"aside,"+"audio[src|crossorigin|preload|autoplay|mediagroup|loop|muted|controls],"+"bdi,"+"canvas[width|height],"+"datalist,"+"details[open],"+"figcaption,"+"figure,"+"footer,"+"header,"+"hgroup,"+"main,"+"mark,"+"menu[type|label],"+"menuitem[checked|command|default|disabled|icon|label|radiogroup|type],"+"meter[value|min|max|low|high|optimal],"+"nav,"+"output[for|form|name],"+"progress[value|max],"+"section,"+"source[src|type|media],"+"summary,"+"span[*],"+"time[datetime],"+
"track[kind|src|srclang|label|default],"+"video[src|crossorigin|poster|preload|autoplay|mediagroup|loop|muted|controls|width|height],"+"wbr,"});if(!isInline){var fullPageFontSize=node.getAttribute("data-d2l-editor-fullpage-fontsize");if(fullPageFontSize!=null&&fullPageFontSize.length>0)tinyMCE.settings["fullpage_default_font_size"]=fullPageFontSize;var fullPageFontFace=node.getAttribute("data-d2l-editor-fullpage-fontface");if(fullPageFontFace!=null&&fullPageFontFace.length>0)tinyMCE.settings["fullpage_default_font_family"]=
fullPageFontFace}if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_files=[];node.d2l_files_queued=0;node.d2l_onContentFocus=new D2L.LP.Web.UI.Events.Event;node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event;var editor=me.GetEditorInstanceByNode(node);if(editor!==undefined)tinyMCE.remove(editor);tinyMCE.execCommand("mceAddEditor",false,textAreaId)}D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.Initialize();D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SelectList.Initialize();
node.d2l_onBeforeSubmitHandle=function(form){htmlEditor.UpdateFilesNodeByNode(node);me.UpdateTextArea(textAreaId)};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(node.d2l_onBeforeSubmitHandle);var skipToolbarsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-skiptoolbars",node);var onClickSkipToolbars=skipToolbarsNode.getAttribute("data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",skipToolbarsNode,function(){setTimeout(function(){skipToolbarsNode.d2l_onClickHandle=
function(){eval(onClickSkipToolbars)};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle)},0)});D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",skipToolbarsNode,function(){D2L.LP.Web.UI.Html.Dom.RemoveEventListener("click",skipToolbarsNode,skipToolbarsNode.d2l_onClickHandle)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",node,function(e){node.d2l_hasFocus=true;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-htmleditor-frosted",node)},true);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",
node,function(e){node.d2l_hasFocus=false;setTimeout(function(){if(!node.d2l_hasFocus)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-htmleditor-frosted",node)},0)},true);var focus=function(){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.WysiwygEditor.FocusByNode(node)};node.focus=focus;D2L.LP.Web.UI.Events.VisibilityManager.AddListener(node,function(isDisplayed){if(isDisplayed)htmlEditor.UpdateComponentVisibilityByNode(node)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-texteditor",function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.TextEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_isDirty=false;node.d2l_files=[];node.d2l_files_queued=0;node.d2l_changeEvent=new D2L.LP.Web.UI.Events.Event}var controlWidth=node.getAttribute("data-d2l-width");var controlHeight=node.getAttribute("data-d2l-height");var footerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-footer",
node);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-textarea",node);var setSize=function(height,width){node.style.width=width;node.style.height=height;var controlRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);var footerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(footerNode);textAreaNode.style.height=controlRect.height-footerRect.height-10+"px"};setSize(controlHeight,controlWidth);var resizeHandle=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-resize",
node);var resizeSettings={Handle:resizeHandle,DisplayType:"hidden",GhostType:D2L.LP.Web.UI.Html.DragDrop.GhostType.OriginalShadow};var onResize=D2L.LP.Web.UI.Html.DragDrop.MakeResizeableNode(node,resizeSettings,window,window);onResize.AddListener(function(size){setSize(size.height+"px",size.width+"px")});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",textAreaNode,function(){node.d2l_isDirty=true;node.d2l_changeEvent.Trigger()})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-noeditor",function(node){node.d2l_control=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.NoEditor;if(!node.d2l_initialized){node.d2l_initialized=true;node.d2l_files=[];node.d2l_files_queued=0}});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-button",function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-buttonmenuitem",function(node){D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.InitializeByNode(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-color-button",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-split-button",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton;D2L.LP.Web.UI.Html.Aria.SetRole(node,"button");var title=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"title");if(title!=null&&title.length>0)D2L.LP.Web.UI.Html.Aria.SetAttribute(node,"label",title);D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(node);var onClick=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-onclick");D2L.LP.Web.UI.Html.Dom.RemoveAttribute(node,
"data-onclick");D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){eval(onClick)});var iconNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-split-button-icon",node);var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-buttonmenuitem",menuContainer);var activeKey=null;var itemsData={};var registerMenuItemEvents=function(menuItemNode){var menuItemKey=menuItemNode.getAttribute("data-d2l-key");
menuItemNode.d2l_activeHandler=function(isActive){if(menuItemKey===node.getAttribute("data-d2l-key"))me.SetIsActiveByNode(node,isActive)};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnActiveChangeByNode(menuItemNode).AddListener(menuItemNode.d2l_activeHandler);menuItem.d2l_enabledHandler=function(isEnabled){if(menuItemKey===node.getAttribute("data-d2l-key"))me.SetIsEnabledByNode(node,isEnabled)};D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnEnabledChangeByNode(menuItemNode).AddListener(menuItem.d2l_enabledHandler)};
for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];var key=menuItem.getAttribute("data-d2l-key");var txtNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-buttonmenuitem-text",menuItem);var imgNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-buttonmenuitem-icon",menuItem);if(key!==undefined&&key!=null){itemsData[key]={className:imgNode.className.replace("d2l-htmleditor-buttonmenuitem-icon",""),key:key,src:imgNode.src,title:D2L.LP.Web.UI.Html.Dom.GetTextContent(txtNode)};
if(activeKey===null)activeKey=key}registerMenuItemEvents(menuItem)}node.d2l_itemsData=itemsData;if(activeKey===null)return;D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SplitButton.UpdateByNode(node,activeKey)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-htmleditor-symbol",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.SymbolAction.View;var listNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-htmleditor-symbol-list",node);var charNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-symbol-char",listNode);var editId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(node.getAttribute("data-d2l-editId"));var installOnClick=function(charNode){D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(charNode);
D2L.LP.Web.UI.Html.Dom.AddEventListener("click",charNode,function(){var numCode=charNode.getAttribute("data-d2l-numcode");D2L.LP.Web.UI.Common.Controls.Edit.SetValue(editId,numCode);me.SetSelectedSymbolByNode(node,numCode)})};for(var i=0;i<charNodes.length;i++){var charNode=charNodes[i];installOnClick(charNode)}D2L.LP.Web.UI.Html.Dom.DispatchEvent("click",charNodes[0])});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-integer-selector",function(node){var inputNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-edit",node)[0];var textBlockNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-textblock",node);var textBlockNode=null;if(textBlockNodes.length>=1)textBlockNode=textBlockNodes[0];D2L.LP.Web.UI.Html.Aria.SetAttribute(inputNode,"live",D2L.LP.Web.UI.Html.Aria.Politeness.Assertive);if(textBlockNode!=null)D2L.LP.Web.UI.Html.Aria.SetAttribute(textBlockNode,
"live",D2L.LP.Web.UI.Html.Aria.Politeness.Assertive)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-integer-selector");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-newwindow",function(node){var hasHref=D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"href");if(!hasHref)return;node.target="_blank"});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-menuflyout",function(node){var opener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-opener",node);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-text",node);var openFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFunction");var openFirstFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFirstFunction");var closeFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"MenuFlyout.CloseFunction");var contentsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-contents",node);if(contentsNode!=null)D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init(node,opener,contentsNode,textNode,openFunction,openFirstFunction,closeFunction)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-menuflyout-link",function(node){var opener=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-opener",node);var textNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-textblock",opener);var openFirstFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"MenuFlyout.OpenFirstFunction");var link=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-link-link",node);var contentsNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-menuflyout-contents",
node);var focus=function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-menuflyout-link-focus",node)};var blur=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-menuflyout-link-focus",node)};if(contentsNode!=null){D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",link,focus);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",opener,focus);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",link,blur);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",opener,blur);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Init(node,
opener,contentsNode,textNode,null,openFirstFunction)}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-menuflyout-link");D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-menuflyout");D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-messagearea",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"alert");node.tabIndex=0;if(node.childNodes.length>0)D2L.LP.Web.UI.Common.Controls.MessageArea.SetIsVisible(true)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("vui-moreless",function(node){var onExpandHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onExpand");node.d2l_expandHandler=function(sender,args){onExpandHandler.call(onExpandHandler)};if(onExpandHandler!==null)$(node).on("vui-moreless-expand",node.d2l_expandHandler);var onCollapseHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onCollapse");node.d2l_collapseHandler=function(sender,args){onCollapseHandler.call(onCollapseHandler)};if(onCollapseHandler!==
null)$(node).on("vui-moreless-collapse",node.d2l_collapseHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-multiselect",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.MultiSelect;var handle=me.InitHandle(node);me.Initialize(handle);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",handle.node,function(){handle.inputNode.focus()});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",handle.node,function(){D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-multiselect-active",handle.node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",handle.node,function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-multiselect-active",
handle.node)});D2L.LP.Web.UI.Html.Dom.AddEventListener("paste",handle.inputNode,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);setTimeout(function(){var text=handle.inputNode.value;if(!D2L.LP.Web.UI.Desktop.Controls.AutoComplete.GetForceSelection(handle.autoCompleteId))me.OnItemAdded(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(handle.node.id),text,"")},0)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-multiselect-clearicon",function(node){D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e)});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e)});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){var key=kpArgs.GetKey();if(key===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Backspace||key===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Delete){var parentNode=
D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-multiselect-choice",node);var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(parentNode.id);D2L.LP.Web.UI.Desktop.Controls.MultiSelect.OnClickClearIcon(id);D2L.LP.Web.UI.Html.Dom.CancelEventBubble(kpArgs.GetEventObject());D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject())}})});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-multiselect");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-numericpager",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.NumericPager;var id=node.getAttribute("id");var pagerId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var editNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-edit",node)[0];node.d2l_editId=editNode.getAttribute("id");var buttons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-numericpager-iterator",node);node.d2l_previousId=buttons[0].getAttribute("id");D2L.LP.Web.UI.Html.Aria.SetRole(buttons[0],
"button");node.d2l_nextId=buttons[1].getAttribute("id");D2L.LP.Web.UI.Html.Aria.SetRole(buttons[1],"button");var controlProvider=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"controlProvider");if(controlProvider!=null){var pageableControlId=D2L.LP.Web.UI.ObjectRepository.Get(id,"pageableControlId");var pageableControl=controlProvider.call(controlProvider);var onLoadCompletedHandler=function(hasMoreItems,itemNodes,totalItemCount,pageNumber){if(totalItemCount===0)D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,
false);else D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(node,true);if(totalItemCount!==undefined){var pageSize=parseInt(me.GetPageSize(pagerId));var pageCount=Math.ceil(parseInt(totalItemCount,10)/pageSize);me.SetPageCount(pagerId,pageCount)}if(pageNumber)me.SetPageNumber(pagerId,pageNumber,false)};pageableControl.GetOnLoadCompletedEvent(pageableControlId).AddListener(onLoadCompletedHandler);node.d2l_onLoadCompletedHandle=onLoadCompletedHandler;if(pageableControl.GetOnPageCompletedEvent&&pageableControl.ScrollToFirstItem){var onPageCompletedHandler=
function(){pageableControl.ScrollToFirstItem(pageableControlId)};pageableControl.GetOnPageCompletedEvent(pageableControlId).AddListener(onPageCompletedHandler);node.d2l_onPageCompletedHandle=onPageCompletedHandler}node.d2l_pageableControlId=pageableControlId;node.d2l_pageableControl=pageableControl}node.d2l_pageCount=D2L.LP.Web.UI.ObjectRepository.Get(id,"pageCount");me.UpdateNextPrevious(node)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-numericpager");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-onoff",function(node){var onOff=$(node).OnOff();var isProcessing=false;var alertSpan=$("<span>",{"role":"status","aria-live":"assertive","style":"clip: rect(1px, 1px, 1px, 1px); position: absolute;"});alertSpan.text("");onOff.append(alertSpan);var beginProcessing=function(){isProcessing=true;setTimeout(function(){if(isProcessing)onOff.OnOff("setLoading",isProcessing)},200)};var finishProcessing=function(){if(isProcessing){isProcessing=false;onOff.OnOff("setLoading",
isProcessing)}};if(onOff.attr("data-onchange")){var onChange=onOff.attr("data-onchange");onOff.on("change",function(){var ret=eval(onChange);if(ret===undefined||ret===null||ret.AddListener===undefined)return;var text=onOff.attr("data-alert");alertSpan.text(text);ret.AddListener(function(){finishProcessing()});ret.AddReleaseListener(function(){finishProcessing()});beginProcessing()})}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-quickentry-long",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.QuickEntryLong;var handle=me.GetHandleNode(node);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",handle.LongEdit,function(){me.FocusHandle(handle)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-rating-input",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.RatingInput;var handle=me.InitHandle(node);for(var i=0;i<handle.labels.length;i++){var label=handle.labels[i];var input=label.getElementsByTagName("input")[0];D2L.LP.Web.UI.Html.Dom.AddEventListener("click",input,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);me.SetSelected(handle,index,false)}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("click",label,
function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);me.SetSelected(handle,index,true)}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",label,function(index){return function(){me.HandleMouseOverLabel(handle,index)}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",label,function(){me.ClearHoverClass(handle)});D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",input,function(index){return function(){me.HandleFocus(handle,
index)}}(i));D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",input,function(index){return function(){me.HandleBlur(handle,index)}}(i))}if(handle.distribution===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle);handle.hover=true});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,function(){handle.hover=false;D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle)});D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.ClassInitialize(handle)});
D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-rating-input");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-rating",function(node){var handle={distribution:null};D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.InitHandle(node,handle);if(handle.distribution===null)return;D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Show(handle)});D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,function(){D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.Hide(handle)});D2L.LP.Web.UI.Desktop.Controls.RatingDistribution.ClassInitialize(handle)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("vui-scroll-point",function(node){var onSpyHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onSpy");node.d2l_spyHandler=function(sender,args){if(node.getAttribute("data-spy-key")!==args.key)return;onSpyHandler.call(onSpyHandler)};if(onSpyHandler!==null)$(window).on("vui-spy",node.d2l_spyHandler);var onSkimSpyHandler=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"onSkimSpy");node.d2l_skimSpyHandler=function(sender,args){if(node.getAttribute("data-spy-key")!==
args.key)return;onSkimSpyHandler.call(onSkimSpyHandler)};if(onSkimSpyHandler!==null)$(window).on("vui-skim-spy",node.d2l_skimSpyHandler)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-searchsimple",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"search");var buttons=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node);for(var i=0;i<buttons.length;i++)D2L.LP.Web.UI.Html.Aria.SetRole(buttons[i],"button")});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-searchsimple-input",function(node){var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(node.id);var numKeyPresses=1;if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-keypresses"))numKeyPresses=parseInt(D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-keypresses"));var onKeyPress=function(kpArgs){if(kpArgs.GetKey()==D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter)D2L.LP.Web.UI.Desktop.Controls.SearchSimple.Search(id);if(D2L.LP.Web.UI.ObjectRepository.HasKeys(node.id,
"key")){var val=D2L.LP.Web.UI.Desktop.Controls.SearchSimple.GetInputValue(id);if(val.length>=numKeyPresses){var onKeyPressFunction=D2L.LP.Web.UI.ObjectRepository.Get(node.id,"key");setTimeout(function(){onKeyPressFunction.call(onKeyPressFunction)},0)}}};D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,onKeyPress)});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-searchsimple-input");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-selectall",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SelectAll;var id=node.getAttribute("id");var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);if(!D2L.LP.Web.UI.ObjectRepository.HasKey(id))return;var controlProvider=me.GetSelectableControlProvider(id);var selectableControlId=me.GetSelectableControlId(id);if(controlProvider===null||selectableControlId===null)return;var selectableControl=controlProvider.call(controlProvider);var selectionFilterTypeEvent=
me.GetOnSelectionFilterTypeUpdateEvent(selectAllId);var selectionUpdateEvent=me.GetOnSelectionUpdateEvent(selectAllId);var checkboxNode=me.GetCheckboxNode(node);var typeNode=me.GetTypeNode(node);var valuesNode=me.GetValuesNode(node);var selection=me.GetSelection(selectAllId);var updateSelectionControl=function(itemNodes){selectableControl.SetIsAllSelected(selectableControlId,checkboxNode.checked,itemNodes)};var updateState=function(){if(!me.IsUpdateStateEnabled(id))return;if(checkboxNode.checked){var unSelectedValues=
selectableControl.GetValues(selectableControlId,false);if(unSelectedValues.length>0){checkboxNode.checked=false;selection.type=D2L.LP.LayeredArch.SelectionFilterType.Some}}selection.selectedCount=0;for(var value in selection.values)if(selection.values[value])selection.selectedCount+=1;if(selection.selectedCount>0){if(selection.type!=D2L.LP.LayeredArch.SelectionFilterType.All)selection.type=D2L.LP.LayeredArch.SelectionFilterType.Some}else selection.type=D2L.LP.LayeredArch.SelectionFilterType.None;
selectionFilterTypeEvent.Trigger(checkboxNode.checked,selection.type);selectionUpdateEvent.Trigger(selection.type,selection.selectedCount)};var updateBulk=function(itemNodes){me.SetIsUpdateStateEnabled(id,false);updateSelectionControl(itemNodes);me.SetIsUpdateStateEnabled(id,true);updateState()};D2L.LP.Web.UI.Html.Dom.AddEventListener("click",checkboxNode,function(){updateBulk()});var onPageHandler=function(){selection.persisted=true};selectableControl.GetOnPageEvent(selectableControlId).AddListener(onPageHandler);
var onPageCompletedHandler=function(itemNodes){if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.None){updateState();return}if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.All){checkboxNode.checked=true;updateBulk(itemNodes);return}me.SetIsUpdateStateEnabled(id,false);selectableControl.SetSelection(selectableControlId,D2L.LP.LayeredArch.SelectionFilterType.Some,selection.getValuesArray());me.SetIsUpdateStateEnabled(id,true);updateState()};selectableControl.GetOnPageCompletedEvent(selectableControlId).AddListener(onPageCompletedHandler);
var onLoadMoreCompletedHandler=function(hasMoreItems,itemNodes){if(checkboxNode.checked)for(var i=0;i<itemNodes.length;i++)selectableControl.HighlightItemByNode(itemNodes[i]);updateBulk(itemNodes)};selectableControl.GetOnLoadMoreCompletedEvent(selectableControlId).AddListener(onLoadMoreCompletedHandler);var selectableControlItemSelectedHandler=function(itemValue,isSelected){if(isSelected)selection.add(itemValue);else selection.remove(itemValue);updateState()};selectableControl.GetItemSelectedEvent(selectableControlId).AddListener(selectableControlItemSelectedHandler);
var onBeforeSubmitHandler=function(form){typeNode.value=selection.type;valuesNode.value=D2L.LP.Web.UI.Selection.EncodeKeys(selection.getValuesArray())};D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.AddListener(onBeforeSubmitHandler);if(!selection.persisted){var intialSelectedValues=selectableControl.GetSelectedValues(selectableControlId);selection.reset();for(var i=0;i<intialSelectedValues.length;i++)selection.add(intialSelectedValues[i]);updateState()}else if(selection.type==D2L.LP.LayeredArch.SelectionFilterType.All)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-readonly",
node);selection.persisted=false;node.d2l_onLoadMoreCompletedHandler=onLoadMoreCompletedHandler;node.d2l_selectableControlId=selectableControlId;node.d2l_selectableControl=selectableControl;node.d2l_selectableControlItemSelectedHandler=selectableControlItemSelectedHandler;node.d2l_pageHandler=onPageHandler;node.d2l_pageCompletedHandler=onPageCompletedHandler;node.d2l_onBeforeSubmitHandler=onBeforeSubmitHandler});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-selectall-link",function(node){var id=node.getAttribute("id");var controlProvider=D2L.LP.Web.UI.ObjectRepository.Get(id,0);node.d2l_status="init";node.d2l_selectionControl=controlProvider.call(controlProvider);node.d2l_selectionControlId=D2L.LP.Web.UI.ObjectRepository.Get(id,1);var updateInfo=function(infoNode,selectionType){var pageResultNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(infoNode);if(selectionType==D2L.LP.LayeredArch.SelectionFilterType.Some){D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(pageResultNode),
node.d2l_hasMoreItems);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",pageResultNode);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(pageResultNode))}};var updateMe=function(isSelectAll,selectionType){var nodeExists=D2L.LP.Web.UI.Html.Dom.GetElementById(node.id);if(nodeExists===null)return;var infoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall-link-info",node);var placeholderId=infoNode.getAttribute("id");var isVisible=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",
node);if(isSelectAll&&selectionType!=D2L.LP.LayeredArch.SelectionFilterType.None){if(isVisible){updateInfo(infoNode,selectionType);return}var infoPartial=D2L.LP.Web.UI.ObjectRepository.TryGet(id,2);if(infoPartial!=null&&node.d2l_status=="init"){node.d2l_status="loading";infoPartial.call(infoPartial).AddListener(function(){var newInfoNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall-link-info",node);newInfoNode.id=placeholderId;updateInfo(newInfoNode,selectionType);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",
node);node.d2l_status="loaded"})}else{updateInfo(infoNode,selectionType);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-hidden",node)}}else if(isVisible)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-hidden",node)};node.d2l_selectionControl.GetOnSelectionFilterTypeUpdateEvent(node.d2l_selectionControlId).AddListener(updateMe);node.d2l_onSelectionFilterTypeUpdateEventHandler=updateMe;node.d2l_selectionControl.GetOnResetEvent(node.d2l_selectionControlId).AddListener(function(hasMoreItems){node.d2l_status="init";
node.d2l_hasMoreItems=hasMoreItems})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-semantic-editor",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.SemanticEditor;var id=node.getAttribute("id");var toolbarNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var textAreaNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(toolbarNode);var positionNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(textAreaNode);var plugins=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"plugins");var echoPosition=function(selection){positionNode.innerHTML=
"Start: "+selection.Start+"<br>"+"End: "+selection.End+"<br>"+'Value: "'+textAreaNode.value.substring(selection.Start,selection.End)+'"'};var updatePlugins=function(selection){echoPosition(selection);node.d2l_selectionStart=selection.Start;node.d2l_selectionEnd=selection.End;var context={Selection:selection,TextAreaNode:textAreaNode};for(var i=0;i<plugins.length;i++)if(plugins[i].OnEditorUpdate)plugins[i].OnEditorUpdate(context)};D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode))});
D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode))});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode))});D2L.LP.Web.UI.Html.Dom.AddEventListener("select",textAreaNode,function(){updatePlugins(me.GetSelectionRange(textAreaNode))});D2L.LP.Web.UI.Html.Dom.AddEventListener("keyup",textAreaNode,function(e){updatePlugins(me.GetSelectionRange(textAreaNode));var key;
if(window.event)key=e.keyCode;else if(e.which)key=e.which;var context={Selection:me.CreateRange(node.d2l_selectionStart,node.d2l_selectionEnd),TextAreaNode:textAreaNode};for(var i=0;i<plugins.length;i++)if(plugins[i].OnKeyUp)plugins[i].OnKeyUp(context,key)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-sort",function(node){var changeEvent=new D2L.LP.Web.UI.Events.Event;D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,changeEvent,function(){return node.selectedIndex});D2L.LP.Web.UI.Html.Dom.AddEventListener("change",node,function(){changeEvent.Trigger();var optionNode=node.options[node.selectedIndex];var isAscendingValue=D2L.LP.Web.UI.Html.Dom.GetAttribute(optionNode,"data-isAscending");var hiddenNode=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);
D2L.LP.Web.UI.Html.Dom.SetAttribute(hiddenNode,"value",isAscendingValue)})});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-togglecontainer",function(node){var handle={node:null,containerNode:null,expandNode:null,collapseNode:null,onExpand:null,onCollapse:null,isExpanded:false};var $node=$(node);handle.node=node;handle.expandNode=$node.find("a:first")[0];handle.collapseNode=$node.find("a+a")[0];handle.containerNode=$node.find(".d2l-togglecontainer-inner")[0];handle.onExpand=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"expand")||function(){};handle.onCollapse=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,
"collapse")||function(){};handle.isExpanded=!$(handle.containerNode).hasClass("d2l-hidden");node.handle=handle});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-time-selector",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.TimeSelector;var timeSelectorData=$(node).data();var edit=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edit.id);id.$().data(timeSelectorData);var data=id.$().data();var nodes=me.GetNodesByNode(edit);var useEditValue=true;nodes.container.d2l_onChange=new D2L.LP.Web.UI.Events.Event;nodes.container.d2l_onChange.AddListener(function(){var onChangeFunction=
D2L.LP.Web.UI.ObjectRepository.TryGet(nodes.edit.id,"OnDateTimeChangeFunction");if(onChangeFunction)onChangeFunction.call(onChangeFunction)});D2L.LP.Web.UI.Common.Controls.ChangeTracking.AddChangeTrackElement(node,nodes.container.d2l_onChange,function(){return edit.value});var locale=D2L.LP.Globalization.Locale;var dateTimeParser=locale.GetDateTimeParser();var closing=false;var selectedIndex=0;var lastGoodTime=me.GetTimeNodes(nodes);var refreshSelectedIndex=function(){var interval=data.timeinterval;
if(interval===null||interval===undefined||interval<5||interval>60){data.timeinterval=30;interval=30}var time=dateTimeParser.TryParseTime(nodes.edit.value);if(time===null||time===undefined)time=lastGoodTime;var hour=time.GetHour();var minute=time.GetMinute();if(data.enforcetimeintervals){var remainder=minute%interval;if(minute>0&&minute<interval)minute=interval;else if(remainder>0)minute+=interval-remainder;while(minute>=60){minute-=60;++hour}hour=Math.min(23,hour);time=new D2L.LocalTime(hour,minute,
0)}lastGoodTime=time;me.SetTimeNodes(nodes,time);var index=hour*60/interval;index+=minute/interval;selectedIndex=Math.floor(index)};var selectSelectedItem=function(){var item=nodes.list.childNodes[selectedIndex];me.SetTimeNodes(nodes,item.d2l_time,false)};var updateSelectedItem=function(applyOffset){var selectedItem=null;for(var i=0;i<nodes.list.childNodes.length;i++){var item=nodes.list.childNodes[i];if(i===selectedIndex){item.className="d2l-time-selector-listitem-selected";selectedItem=item;D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,
"aria-activedescendant",item.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-activedescendant",item.id)}else item.className=""}if(selectedItem===null){D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-activedescendant","");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-activedescendant","");return}var divBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(nodes.floatingContainer);var itemBox=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(selectedItem);var offset=applyOffset?
(divBox.height-itemBox.height)/2:0;if(itemBox.bottom>divBox.bottom)nodes.floatingContainer.scrollTop+=itemBox.bottom-divBox.bottom+offset;else if(itemBox.top<divBox.top)nodes.floatingContainer.scrollTop-=divBox.top-itemBox.top-offset};var close=function(doDelay,ignoreFocus){closing=true;setTimeout(function(){D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.CloseNode(nodes.floatingContainer,ignoreFocus);setTimeout(function(){closing=false},0);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded",
"false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","true")},doDelay?200:0)};var open=function(){if(isOpen()||closing)return;me.BuildSelectList(nodes,data.timeinterval);refreshSelectedIndex();D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.OpenNode(nodes.floatingContainer,id,{AttachToBody:true,AutoCloseExclusions:[edit],FocusOnOpen:false,Position:D2L.LP.Web.UI.Html.Style.OverlayPosition.Bottom,TabIndex:-1});updateSelectedItem(true);nodes.edit.focus();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,
"aria-expanded","true");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","false")};var isOpen=function(){return D2L.LP.Web.UI.Desktop.Controls.FloatingContainer.IsOpenNode(nodes.floatingContainer)};D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",nodes.edit,function(){refreshSelectedIndex();D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,
"aria-hidden","true")});D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.edit,open);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",nodes.floatingContainer,function(e){var eventTarget=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);if(eventTarget&&eventTarget.tagName.toLowerCase()=="li"){selectedIndex=eventTarget.d2l_index;selectSelectedItem();close(false,false)}});var keys=D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key;D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(nodes.edit,function(kpArgs){var key=
kpArgs.GetKey();if(key==keys.ArrowUp||key==keys.ArrowDown){if(!isOpen())open();else{var maxIndex=60/data.timeinterval*24-1;if(key==keys.ArrowUp){--selectedIndex;if(selectedIndex==-1)selectedIndex=maxIndex}else{++selectedIndex;if(selectedIndex==maxIndex+1)selectedIndex=0}updateSelectedItem(false)}useEditValue=false;D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject())}else if(key==keys.Enter){useEditValue?refreshSelectedIndex():selectSelectedItem();D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(kpArgs.GetEventObject());
close(false,false)}else if(key==keys.Escape||key==keys.Tab){close(false,true);nodes.edit.focus()}else if(key!=keys.Shift&&key!=keys.Control&&key!=keys.PageUp&&key!=keys.PageDown&&key!=keys.End&&key!=keys.Home&&key!=keys.ArrowLeft&&key!=keys.ArrowRight){close(false,false);useEditValue=true}});D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-haspopup","true");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-owns",nodes.floatingContainer.id);D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"role",
"combobox");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-autocomplete","list");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"aria-expanded","false");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.edit,"tabindex","0");D2L.LP.Web.UI.Html.Dom.SetAttribute(nodes.floatingContainer,"aria-hidden","true")});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-time-selector");
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-updownvote-input",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.UpDownVoteInput;var handle=me.InitHandle(node);for(var i=0;i<handle.labels.length;i++){var label=handle.labels[i];var input=label.getElementsByTagName("input")[0];D2L.LP.Web.UI.Html.Dom.AddEventListener("click",label,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);D2L.LP.Web.UI.Html.Dom.CancelEventDefaultBehaviour(e);me.SetSelected(handle,index,true)}}(i));
D2L.LP.Web.UI.Html.Dom.AddEventListener("click",input,function(index){return function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);me.SetSelected(handle,index,false)}}(i))}});D2L.LP.Web.UI.Html.PartialRendering.AddClassNameToFocusIncludeList("d2l-updownvote-input");
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-action-container",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.ActionContainer;if(node.d2l_dataControlSelectionHandler!=null){var selectionUpdatedEvent=me.TryGetSelectionUpdatedEventByNode(node);if(selectionUpdatedEvent!=null)selectionUpdatedEvent.RemoveListener(node.d2l_dataControlSelectionHandler)}});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-datalist-summary",function(node){var dataListNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-datalist-container",node);var dataListId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(dataListNode.getAttribute("id"));if(node.d2l_updateSelectAllVisibilityHandler!==undefined){D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadCompletedEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler);D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnLoadMoreCompletedEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler);
D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnRemoveItemEvent(dataListId).RemoveListener(node.d2l_updateSelectAllVisibilityHandler)}if(node.d2l_onRemoveItemHandler!==undefined)D2L.LP.Web.UI.Desktop.Controls.DataList.GetOnRemoveItemEvent(dataListId).RemoveListener(node.d2l_onRemoveItemHandler);if(node.d2l_selectionUpdateHandler!==undefined){var selectAllNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-selectall",node);var selectAllId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(selectAllNode.getAttribute("id"));
D2L.LP.Web.UI.Desktop.Controls.SelectAll.GetOnSelectionUpdateEvent(selectAllId).RemoveListener(node.d2l_selectionUpdateHandler)}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-form",function(node){D2L.LP.Web.UI.Common.Controls.MessageArea.Reset(node)});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-htmleditor-split-button",function(node){var menuContainer=D2L.LP.Web.UI.Html.Dom.GetNextElementSibling(node);var menuItems=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-htmleditor-buttonmenuitem",menuContainer);for(var i=0;i<menuItems.length;i++){var menuItem=menuItems[i];D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnActiveChangeByNode(menuItem).RemoveListener(menuItem.d2l_activeHandler);menuItem.d2l_activeHandler=null;D2L.LP.Web.UI.Desktop.Controls.HtmlEditorComponents.Button.GetOnEnabledChangeByNode(menuItem).RemoveListener(menuItem.d2l_enabledHandler);
menuItem.d2l_enabledHandler=null}});D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-htmleditor-wysiwyg",function(node){if(node.d2l_onBeforeSubmitHandle!==undefined)D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeSubmitHandle)});D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-htmleditor",function(node){var me=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;me.ActionIdMap[node.id]={}});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-loadmore-pager",function(node){if(node.d2l_pageableControl!==undefined){node.d2l_pageableControl.GetOnLoadCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadCompleteHandle);node.d2l_pageableControl.GetOnLoadMoreCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadMoreHandle)}});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("vui-moreless",function(node){if(node.d2l_expandHandler!==undefined)$(node).off("vui-moreless-expand",null,node.d2l_expandHandler);if(node.d2l_collapseHandler!==undefined)$(node).off("vui-moreless-collapse",null,node.d2l_collapseHandler)});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-numericpager",function(node){if(node.d2l_pageableControl!==undefined){node.d2l_pageableControl.GetOnLoadCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onLoadCompletedHandle);if(node.d2l_onPageCompletedHandle!==undefined)node.d2l_pageableControl.GetOnPageCompletedEvent(node.d2l_pageableControlId).RemoveListener(node.d2l_onPageCompletedHandle)}});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-selectall",function(node){node.d2l_selectableControl.GetOnLoadMoreCompletedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_onLoadMoreCompletedHandler);node.d2l_selectableControl.GetItemSelectedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_selectableControlItemSelectedHandler);node.d2l_selectableControl.GetOnPageEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_pageHandler);node.d2l_selectableControl.GetOnPageCompletedEvent(node.d2l_selectableControlId).RemoveListener(node.d2l_pageCompletedHandler);
D2L.LP.Web.UI.Common.Controls.Form.OnBeforeSubmit.RemoveListener(node.d2l_onBeforeSubmitHandler)});D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-selectall-link",function(node){node.d2l_selectionControl.GetOnSelectionFilterTypeUpdateEvent(node.d2l_selectionControlId).RemoveListener(node.d2l_onSelectionFilterTypeUpdateEventHandler)});
$(document).ready(function(){var handleMove=function(e){D2L.LP.Web.UI.Events.OnMouseMove.Trigger(e.originalEvent)};var handleUp=function(e){D2L.LP.Web.UI.Events.OnMouseUp.Trigger(e.originalEvent)};var handleDown=function(e){D2L.LP.Web.UI.Events.m_lastMouseDownPosition=D2L.LP.Web.UI.Html.Dom.GetMousePosition(window,e.originalEvent)};$(window).resize(function(){D2L.LP.Web.UI.Events.OnResize.Trigger()}).scroll(function(){D2L.LP.Web.UI.Events.OnScroll.Trigger()});D2L.LP.Web.UI.Html.Dom.AddEventListener("storage",
window,D2L.LP.Web.UI.Html.Dom.Storage.OnStorage);$(document).click(function(e){D2L.LP.Web.UI.Events.OnClick.Trigger(e)}).mousemove(handleMove).mouseup(handleUp).mousedown(handleDown).on("touchmove",handleMove).on("touchend",handleUp).on("touchstart",handleDown);if(document.body)$(document.body).on("orientationchange",function(){D2L.LP.Web.UI.Events.OnOrientationChange.Trigger()});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(document,function(keyPressEventArg){D2L.LP.Web.UI.Events.OnKeyPress.Trigger(keyPressEventArg)});
if(window.History!==undefined&&window.History.enabled)window.History.Adapter.bind(window,"statechange",function(){D2L.LP.Web.UI.Html.JavaScript.History.HandleStateChange(window.History.getState())});D2L.LP.Web.UI.Events.OnInit.Trigger();D2L.LP.Web.UI.Events.OnLoad.Trigger()});D2L.LP.DocumentViewers={};D2L.LP.DocumentViewers.Legacy={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-documentviewer-legacy",function(node){var setSize=function(){document.body.style.height=frameElement.offsetHeight+"px"};D2L.LP.Web.UI.Events.OnLoad.AddListener(setSize);D2L.LP.Web.UI.Events.OnResize.AddListener(setSize);setSize();var viewerNode=D2L.LP.Web.UI.Html.Dom.GetFirstElementChild(node);if(viewerNode!=null){var viewerId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(viewerNode.getAttribute("id"));var fullscreen=D2L.LP.DocumentViewers.Documents.Components.Fullscreen;
var fullscreenEvent=fullscreen.GetOnToggleFullscreenEvent(viewerId);fullscreenEvent.AddListener(function(){var isFullscreen=fullscreen.IsFullscreen(viewerId);if(isFullscreen)D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-documentviewer-legacy-fullscreen",frameElement);else D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-documentviewer-legacy-fullscreen",frameElement)})}});D2L.LP.DocumentViewers.FileViewerRenderers={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-documentViewer",function(node){var parent=$(node).closest(".d2l-fileviewer");if(parent.length>0){$(".d2l-documentViewer").css("min-height","200px");parent.css("overflow","hidden");parent.css("min-height","200px")}});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-fileviewer-pdf",function(node){var content=$(node);var viewer=content.closest(".d2l-fileviewer");var location=content.attr("data-location");var titleText=content.attr("data-title");var hasNativeReader=content.attr("data-has-native-reader");var isTablet=content.attr("data-is-tablet");var maxHeight=content.attr("data-max-height");var id=content.attr("id");var docViewerPartial=D2L.LP.Web.UI.ObjectRepository.Get(id);var hasReader=true;if(hasNativeReader===
"False")hasReader=D2L.LP.DocumentViewers.FileViewerRenderers.PDFRenderer.HasReader();if(hasReader&&isTablet!="True"){content.append('<iframe class="d2l-fileviewer-rendered-pdf"/>');var renderedPDF=content.find(".d2l-fileviewer-rendered-pdf");renderedPDF.css("width","100%");renderedPDF.css("overflow","hidden");renderedPDF.css("min-height","300px");viewer.css("min-height","305px");if(maxHeight)renderedPDF.css("max-height",maxHeight);var resize=function(){var contentHeight=800;renderedPDF.height(contentHeight);
D2L.LP.Web.UI.Desktop.Controls.FileViewer.OnPluginLoad(renderedPDF,contentHeight)};renderedPDF.load().attr({src:location,title:titleText,onload:resize})}else docViewerPartial()});
D2L.LP.DocumentViewers.FileViewerRenderers.PDFRenderer={HasReader:function(){var me=D2L.LP.DocumentViewers.FileViewerRenderers.PDFRenderer;var plugins=navigator.plugins;if(plugins.length>0){var ChromeViewer=me.GetNavigatorPlugin(plugins,"Chrome PDF Viewer");return ChromeViewer}},GetNavigatorPlugin:function(plugins,name){if(plugins[name]!==undefined)return true;return false}};
D2L.LP.DocumentViewers.Documents={ApplyClassProperties:function(rootNode,propertyMap){var me=D2L.LP.DocumentViewers.Documents;if(rootNode.className){var classes=me.GetClasses(rootNode);for(var i=0;i<classes.length;i++){var classData=propertyMap[classes[i]];if(classData)for(var prop in classData)rootNode[prop]=classData[prop]}}var child=rootNode.firstChild;while(child){me.ApplyClassProperties(child,propertyMap);child=child.nextSibling}},DrawDocument:function(node,scrollPane,textSection){var me=D2L.LP.DocumentViewers.Documents;
var documentData=node.d2l_documentData;var scrollInfo=me.GetScroll(scrollPane);me.UpdateViewerClassName(node);var zoomProperties=documentData.zoomLevels[node.d2l_zoomLevel];if(zoomProperties)me.ApplyClassProperties(node,zoomProperties);if(!node.d2l_htmlLoaded)if(documentData.htmlPath){node.d2l_htmlLoaded=true;var onLoadHtml=function(data){textSection.innerHTML=data.html;D2L.LP.Web.UI.Events.OnViewRender.Trigger(textSection)};D2L.LP.Web.UI.Rpc.Connect("GET",new D2L.LP.Web.Http.UrlLocation(documentData.htmlPath),
{},{success:onLoadHtml})}me.SetScroll(scrollPane,scrollInfo);setTimeout(function(){me.SetUpScrollPosition(scrollPane)},0)},GetAbsoluteScroll:function(element){var x=element.scrollLeft;var y=element.scrollTop;return{x:x,y:y}},GetBoundingRect:function(elem){var offsetParent=elem.offsetParent,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,top=elem.offsetTop,left=elem.offsetLeft;var width=elem.offsetWidth;var height=elem.offsetHeight;var positionedOffsetParent;
while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;offsetParent=elem.offsetParent}}return{top:top,right:left+width,bottom:top+height,left:left,width:width,height:height}},GetClasses:function(element){var className=element.className;var classes;if(className&&className.split)classes=className.split(/[ \t]/);else classes=[];var ret={};for(var i=0;i<classes.length;i++){ret[classes[i]]=true;
ret[i]=classes[i]}ret.length=classes.length;return ret},GetData:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_documentData},GetMode:function(id,x){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_mode},GetPageNumber:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_pageNumber},GetRendersNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-documentViewer-renders",
node)[0]},GetScroll:function(element){var y;if(element.scrollTop<=0)y=0;else y=(element.scrollTop+element.clientHeight/2)/element.scrollHeight;var x;if(element.scrollWidth<=element.clientWidth)x=0.5;else x=(element.scrollLeft+element.clientWidth/2)/element.scrollWidth;return{x:x,y:y}},GetScrollPane:function(node){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-documentViewer-viewer",node)[0]},GetTextSectionNode:function(node){return D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-documentViewer-text",
node)[0]},GetZoomLevel:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_zoomLevel},IntersectBounds:function(rect1,rect2){if(!rect1)return rect2;if(!rect2)return rect1;var top=Math.max(rect1.top,rect2.top);var bottom=Math.min(rect1.bottom,rect2.bottom);var left=Math.max(rect1.left,rect2.left);var right=Math.min(rect1.right,rect2.right);var width=right-left;var height=bottom-top;if(width<=0||height<=0)return{top:0,right:0,bottom:0,left:0,width:0,height:0};return{top:top,
right:right,bottom:bottom,left:left,width:width,height:height}},IsFeatureAllowed:function(feature,features){for(var i=0;i<features.length;i++)if(features[i]===feature)return true;return false},IsModeAllowed:function(mode,modes){for(i=0;i<modes.length;i++)if(modes[i]===mode)return true;return false},ProcessVisibleChildren:function(element,action,bounds){var me=D2L.LP.DocumentViewers.Documents;if(!bounds)bounds=me.GetBoundingRect(element);var child=element.firstChild;while(child){var childBounds=me.GetBoundingRect(child);
childBounds=me.IntersectBounds(childBounds,bounds);if(childBounds.width>0&&childBounds.height>0){action(child,childBounds);me.ProcessVisibleChildren(child,action,childBounds)}child=child.nextSibling}},ResizeByNode:function(node){if(node.d2l_resizeHandle!==undefined)node.d2l_resizeHandle()},ScrollToPage:function(id,pageNumber){var me=D2L.LP.DocumentViewers.Documents;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var scrollPane=me.GetScrollPane(node);var pageNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-documentViewer-page",
node);var pageIndex=pageNumber-1;if(pageNumber>pageNodes.length)pageIndex=pageNodes.length-1;var pageNode=pageNodes[pageIndex];var pageScroll=0;if(pageNode.offsetTop>7)pageScroll=pageNode.offsetTop-16;scrollPane.scrollTop=pageScroll},SetAbsoluteScroll:function(element,scroll){element.scrollLeft=scroll.x;element.scrollTop=scroll.y},SetMode:function(id,newMode){var viewerId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(viewerId);if(node.d2l_mode===newMode)return;var me=D2L.LP.DocumentViewers.Documents;
var scrollPane=me.GetScrollPane(node);var textSection=me.GetTextSectionNode(node);node.d2l_isModeSaveEnabled=node.d2l_mode.length>0;node.d2l_mode=newMode;if(D2L.LP.Web.UI.ObjectRepository.HasKey(viewerId)){var onModeChange=D2L.LP.Web.UI.ObjectRepository.Get(viewerId,"onModeChange");onModeChange.call(onModeChange)}me.DrawDocument(node,scrollPane,textSection);if(newMode=="render"&&node.d2l_isFitToWidth)D2L.LP.DocumentViewers.Documents.Components.Zoom.FitToWidth(id,node.d2l_documentData);scrollPane.scrollTop=
0;scrollPane.scrollLeft=0},SetScroll:function(element,scroll){var y=scroll.y*element.scrollHeight-element.clientHeight/2;var x=scroll.x*element.scrollWidth-element.clientWidth/2;element.scrollLeft=x;element.scrollTop=y},SetUpScrollPosition:function(scrollPane){var me=D2L.LP.DocumentViewers.Documents;var mostVisibleChild=me.SetVisibleSources(scrollPane);return mostVisibleChild},SetVisibleSources:function(element){var me=D2L.LP.DocumentViewers.Documents;var maxVisibleHeight=0;var mostVisibleChild=false;
me.ProcessVisibleChildren(element,function(child,visibleRegion){if(child.lazysrc){child.src=child.lazysrc;child.lazysrc=false}if(visibleRegion.height>maxVisibleHeight){var classes=me.GetClasses(child);if(classes["d2l-documentViewer-page"]){maxVisibleHeight=visibleRegion.height;mostVisibleChild=child}}});return mostVisibleChild},SetZoomLevel:function(node,zoomLevel){if(zoomLevel<0||zoomLevel>node.d2l_documentData.zoomLevels.length-1)return;if(node.d2l_zoomLevel!==zoomLevel||node.d2l_isFitToWidth){node.d2l_zoomLevel=
zoomLevel;var id=node.getAttribute("id");if(D2L.LP.Web.UI.ObjectRepository.HasKey(id)){var onZoomLevelChange=D2L.LP.Web.UI.ObjectRepository.Get(id,"onZoomLevelChange");onZoomLevelChange.call(onZoomLevelChange)}}var me=D2L.LP.DocumentViewers.Documents;var scrollPane=me.GetScrollPane(node);var textSection=me.GetTextSectionNode(node);me.DrawDocument(node,scrollPane,textSection)},UpdateViewerClassName:function(node){var me=D2L.LP.DocumentViewers.Documents;var ret=node.d2l_className;var mode=node.d2l_mode;
if(node.d2l_isFullscreen)ret+=" d2l-documentViewer-fullscreen";else ret+=" d2l-documentViewer-inline";if(me.IsFeatureAllowed("loading",node.d2l_documentData.features))ret+=" d2l-documentViewer-enable-loading";if(me.IsFeatureAllowed("error",node.d2l_documentData.features))ret+=" d2l-documentViewer-enable-error";if(mode.length>0&&me.IsModeAllowed(mode,node.d2l_documentData.modes))ret+=" d2l-documentViewer-show-"+mode;node.className=ret},ZoomIn:function(id){var me=D2L.LP.DocumentViewers.Documents;var node=
D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_zoomFactor<1){me.SetZoomLevel(node,node.d2l_zoomLevel);node.d2l_isFitToWidth=false;node.d2l_zoomFactor=1}else me.SetZoomLevel(node,node.d2l_zoomLevel+1)},ZoomOut:function(id){var me=D2L.LP.DocumentViewers.Documents;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());node.d2l_isFitToWidth=false;node.d2l_zoomFactor=1;me.SetZoomLevel(node,node.d2l_zoomLevel-1)},Init:function(node){if(node==null||node.d2l_isInitialized)return;
node.d2l_isInitialized=true;var me=D2L.LP.DocumentViewers.Documents;var id=node.getAttribute("id");var mode=node.getAttribute("data-d2l-viewMode");var zoomLevel=node.getAttribute("data-d2l-zoomLevel");var json=D2L.LP.Web.UI.ObjectRepository.TryGet(node.id,"data");if(json==null)return;var data=D2L.LP.Web.Serialization.Json.Deserialize(json);var scrollPane=me.GetScrollPane(node);var renders=me.GetRendersNode(node);var textSection=me.GetTextSectionNode(node);node.d2l_className=node.className;node.d2l_pageNumber=
0;node.d2l_zoomLevel=zoomLevel;node.d2l_isFullscreen=false;node.d2l_isModeSaveEnabled=false;node.d2l_isFitToWidth=data.zoomToWidth!=null?data.zoomToWidth:true;node.d2l_zoomFactor=1;node.d2l_mode="";node.d2l_documentData={pageCount:0,loaded:false,autoReloadPath:false,pageNames:[],modes:[],features:[],zoomLevels:[{"zoomIn":{disabled:false},"zoomOut":{disabled:"disabled"}},{"zoomIn":{disabled:"disabled"},"zoomOut":{disabled:false}}]};node.d2l_htmlLoaded=false;node.setHtmlPreLoaded=function(){node.d2l_htmlLoaded=
true};var pageCount=0;var pollInterval=2E3;var setData=function(documentData){node.d2l_documentData=documentData;var updatePageNumber=pageCount==0&&documentData.pageCount>0;while(pageCount<documentData.pageCount){var pageNumber=pageCount+1;var page=document.createElement("img");page.className="d2l-documentViewer-page page"+pageNumber;page.src="/d2l/img/LP/pixel.gif";page.width=96;page.height=24;page.alt=documentData.pageNames[pageCount];page.d2l_pageNumber=pageNumber;renders.appendChild(page);pageCount++}if(node.d2l_mode.length==
0&&me.IsModeAllowed(mode,documentData.modes))me.SetMode(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id),mode);if(!documentData.loaded&&documentData.autoReloadPath){setTimeout(function(){D2L.LP.Web.UI.Rpc.Connect("GET",new D2L.LP.Web.Http.UrlLocation(documentData.autoReloadPath),{},{success:function(data){setData(data)}})},pollInterval);pollInterval=pollInterval*2;if(pollInterval>15E3)pollInterval=15E3}else if(node.d2l_mode.length===0&&documentData.modes.length>0)me.SetMode(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id),
documentData.modes[0]);var scroll=me.GetAbsoluteScroll(scrollPane);me.DrawDocument(node,scrollPane,textSection);if(node.d2l_isFitToWidth)D2L.LP.DocumentViewers.Documents.Components.Zoom.FitToWidth(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id),documentData);me.SetAbsoluteScroll(scrollPane,scroll);if(D2L.LP.Web.UI.ObjectRepository.HasKey(id)){var onDocumentData=D2L.LP.Web.UI.ObjectRepository.Get(id,"onDocumentData");onDocumentData.call(onDocumentData)}if(updatePageNumber){node.d2l_pageNumber=1;if(D2L.LP.Web.UI.ObjectRepository.HasKey(id)){var onPageChange=
D2L.LP.Web.UI.ObjectRepository.Get(id,"onPageChange");onPageChange.call(onPageChange)}}};me.DrawDocument(node,scrollPane,textSection);if(data!==undefined)setData(data)}};D2L.LP.DocumentViewers.Documents.Components={};
D2L.LP.DocumentViewers.Documents.Components.Download={Download:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var documentData=node.d2l_documentData;if(!documentData.downloadPath)return;var frm=document.createElement("form");frm.target="_top";frm.action=documentData.downloadPath;frm.method="post";var hidden=document.createElement("input");hidden.type="hidden";hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();
frm.appendChild(hidden);document.body.appendChild(frm);frm.submit()},UpdateDownload:function(downloadId,data){var me=D2L.LP.DocumentViewers.Documents;D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(downloadId,me.IsFeatureAllowed("download",data.features))}};
D2L.LP.DocumentViewers.Documents.Components.Fullscreen={GetOnToggleFullscreenEvent:function(id){var me=D2L.LP.DocumentViewers.Documents.Components.Fullscreen;var evt=me.OnToggleFullscreenEvents[id.GetValue()];if(evt===undefined){evt=new D2L.LP.Web.UI.Events.Event;me.OnToggleFullscreenEvents[id.GetValue()]=evt}return evt},IsFullscreen:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node==null)return false;return D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-documentViewer-fullscreen",
node)},OnToggleFullscreenEvents:{},ToggleFullscreen:function(id){var me=D2L.LP.DocumentViewers.Documents.Components.Fullscreen;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());node.d2l_isFullscreen=!node.d2l_isFullscreen;if(node.d2l_isFullscreen){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-documentViewer-inline",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-documentViewer-fullscreen",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-min-width",node);node.setAttribute("data-d2l-body-overflow",
document.body.style.overflow);document.body.style.overflow="hidden"}else{D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-documentViewer-fullscreen",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-min-width",node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-documentViewer-inline",node);document.body.style.overflow=node.getAttribute("data-d2l-body-overflow")}if(node.d2l_isFitToWidth)D2L.LP.DocumentViewers.Documents.Components.Zoom.FitToWidth(id,node.d2l_documentData);D2L.LP.DocumentViewers.Documents.ResizeByNode(node);
var fullscreenEvent=me.GetOnToggleFullscreenEvent(id);fullscreenEvent.Trigger()}};
D2L.LP.DocumentViewers.Documents.Components.ViewMode={IsModeAllowed:function(mode,modes){for(i=0;i<modes.length;i++)if(modes[i]===mode)return true;return false},IsModeSaveEnabled:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());return node.d2l_isModeSaveEnabled},UpdateModeState:function(modeId,modeName,currentMode,data){var me=D2L.LP.DocumentViewers.Documents.Components.ViewMode;var modes=data.modes;if(!modes)return;D2L.LP.Web.UI.Html.Dom.SetIsDisplayed(modeId,currentMode!==
modeName&&me.IsModeAllowed(modeName,modes))}};
D2L.LP.DocumentViewers.Documents.Components.Zoom={FitToWidth:function(viewerId,data){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(viewerId.GetValue());var pageNumber=node.d2l_pageNumber;if(pageNumber==null||pageNumber==0)pageNumber=1;pageNumber="page"+pageNumber;if(data.zoomLevels==null)return;var zoomLevels=[];for(var i=0;i<data.zoomLevels.length;i++)if(data.zoomLevels[i][pageNumber]!==undefined)zoomLevels.push(data.zoomLevels[i][pageNumber]);if(zoomLevels.length===0)return;var viewerRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);
var zoomLevelIndex;for(var i=0;i<zoomLevels.length;i++)if(zoomLevels[i].width>viewerRect.width){if(zoomLevelIndex===undefined)zoomLevelIndex=0;break}else zoomLevelIndex=i;if(zoomLevelIndex+1<zoomLevels.length)zoomLevelIndex+=1;var imageNodes=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-documentViewer-page",node);var newZoomLevel=zoomLevels[zoomLevelIndex];var widthDiff=newZoomLevel.width-viewerRect.width+40;node.d2l_isFitToWidth=true;if(widthDiff>0){var scaleFactor=widthDiff/newZoomLevel.width;
node.d2l_zoomFactor=1-scaleFactor;D2L.LP.DocumentViewers.Documents.SetZoomLevel(node,zoomLevelIndex);for(var i=0;i<imageNodes.length;i++){var imageNode=imageNodes[i];var imageWidth=imageNode.getAttribute("width");var imageHeight=imageNode.getAttribute("height");imageNode.setAttribute("width",imageWidth*node.d2l_zoomFactor);imageNode.setAttribute("height",imageHeight*node.d2l_zoomFactor)}}else{node.d2l_zoomFactor=1;D2L.LP.DocumentViewers.Documents.SetZoomLevel(node,zoomLevelIndex)}},UpdateZoomState:function(zoomButtonId,
zoomPropertyName,zoomLevel,data){var zoomProperties=data.zoomLevels[zoomLevel];if(!zoomProperties)return;if(zoomButtonId!=null){var node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-documentViewer",D2L.LP.Web.UI.Html.Dom.GetElementById(zoomButtonId.GetValue()));D2L.LP.Web.UI.Common.Controls.Button.SetIsEnabled(zoomButtonId,zoomProperties[zoomPropertyName]&&(!zoomProperties[zoomPropertyName].disabled||node.d2l_zoomFactor<1))}}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-documentViewer",function(node){D2L.LP.DocumentViewers.Documents.Init(node);var me=D2L.LP.DocumentViewers.Documents;var id=node.getAttribute("id");var viewerId=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(id);var scrollPane=me.GetScrollPane(node);var redrawCount=0;node.d2l_redrawHandler=function(){if(node.d2l_mode=="render"){redrawCount=Math.max(redrawCount,0)+1;setTimeout(function(){redrawCount--;if(redrawCount==0){var pageNode=me.SetUpScrollPosition(scrollPane);
if(node.d2l_pageNumber!==pageNode.d2l_pageNumber){node.d2l_pageNumber=pageNode.d2l_pageNumber;if(D2L.LP.Web.UI.ObjectRepository.HasKey(id)){var onPageChange=D2L.LP.Web.UI.ObjectRepository.Get(id,"onPageChange");onPageChange.call(onPageChange)}}}},200)}};D2L.LP.Web.UI.Html.Dom.AddEventListener("scroll",scrollPane,node.d2l_redrawHandler);D2L.LP.Web.UI.Events.OnResize.AddListener(node.d2l_redrawHandler);if(node.getAttribute("data-d2l-displayMode")=="FitToViewPort"){var dialogBody=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-dialog-body",
document);var maxHeight=D2L.LP.Web.UI.Html.Css.GetStyle(node,"max-height");var minHeight=D2L.LP.Web.UI.Html.Css.GetStyle(node,"min-height");node.d2l_resizeHandle=function(){var viewportHeight;if(dialogBody===null)viewportHeight=D2L.LP.Web.UI.Html.Dom.GetViewportSize(window).height;else viewportHeight=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(dialogBody).height;var height=viewportHeight;if(dialogBody===null){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);height-=rect.top}else height-=5;if(height>
maxHeight.replace("px",""))node.style.height=maxHeight;else if(height<minHeight.replace("px",""))node.style.height=minHeight;else node.style.height=height+"px"};node.d2l_resizeHandle();D2L.LP.Web.UI.Events.OnResize.AddListener(node.d2l_resizeHandle)}node.d2l_fitToWidthHandle=function(){if(node.d2l_isFitToWidth)D2L.LP.DocumentViewers.Documents.Components.Zoom.FitToWidth(viewerId,node.d2l_documentData)};D2L.LP.Web.UI.Events.OnOrientationChange.AddListener(node.d2l_fitToWidthHandle)});
D2L.LP.Web.UI.Html.Dom.AddClassDestructor("d2l-documentViewer",function(node){if(node.d2l_resizeHandle!=null)D2L.LP.Web.UI.Events.OnResize.RemoveListener(node.d2l_resizeHandle);if(node.d2l_redrawHandler!=null)D2L.LP.Web.UI.Events.OnResize.RemoveListener(node.d2l_redrawHandler);if(node.d2l_fitToWidthHandle!=null)D2L.LP.Web.UI.Events.OnOrientationChange.RemoveListener(node.d2l_fitToWidthHandle)});D2L.LP.Profile={Web:{Desktop:{Controls:{}}}};
D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard={GetHandle:function(node){if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-card",node))node=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-user-profile-card",node)[0];return node.handle},InitHandle:function(node){var handle={node:node,cornerNode:null,loadFunction:null,isCardOpen:false,isVertical:true,horizontalOffset:0,verticalOffset:0};handle.cornerNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-user-profile-card-corner",handle.node)[0];
handle.loadFunction=D2L.LP.Web.UI.ObjectRepository.TryGet(handle.node.id,"load");var parentNode=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-handle",node);var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parentNode);if(D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-card-horizontal",node)){handle.isVertical=false;handle.horizontalOffset=parentRect.width+20}else handle.verticalOffset+=parentRect.height+15;node.handle=handle;return handle},ShowCard:function(node,updatePosition){if(updatePosition==
null)updatePosition=true;var me=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;var handle=me.GetHandle(node);if(!handle.isCardOpen){if(updatePosition)me.UpdatePosition(handle,node);if(handle.loadFunction){handle.loadFunction();handle.loadFunction=null}handle.isCardOpen=true}},HideCard:function(node){var me=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;var handle=me.GetHandle(node);handle.isCardOpen=false},UpdatePosition:function(handle,containerNode){var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==
D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-card-left",handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-card-right",handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-card-corner-left",handle.cornerNode);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-card-corner-right",handle.cornerNode);var parent=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-max-width",handle.node)||
document.body;var flyoutRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(containerNode);var parentRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(parent);var contentsRect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(handle.node);var left=Math.max(flyoutRect.right-parentRect.left,0);var right=Math.max(parentRect.right-flyoutRect.left,0);var rightOverflow;if(isRTL)rightOverflow=left-contentsRect.width;else rightOverflow=right-contentsRect.width;var cornerClassName="";if(rightOverflow>0){if(isRTL)handle.node.style.right+=
handle.horizontalOffset+"px";else handle.node.style.left+=handle.horizontalOffset+"px";cornerClassName="d2l-user-profile-card-corner-left"}else if((isRTL?right:left)-contentsRect.width>0){if(isRTL)handle.node.style.left+=handle.horizontalOffset+"px";else handle.node.style.right+=handle.horizontalOffset+"px";cornerClassName="d2l-user-profile-card-corner-right"}else if(isRTL)if(handle.isVertical)handle.node.style.right=0+"px";else{cornerClassName="d2l-user-profile-card-corner-left";handle.node.style.left=
flyoutRect.width+20+"px"}else if(handle.isVertical)handle.node.style.left=0+"px";else{cornerClassName="d2l-user-profile-card-corner-left";handle.node.style.left=flyoutRect.width+20+"px"}if(cornerClassName!="")D2L.LP.Web.UI.Html.Dom.AddClassName(cornerClassName,handle.cornerNode);handle.node.style.top+=handle.verticalOffset+"px"}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-user-profile-card",function(node){D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.InitHandle(node)});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-user-profile-card-online-edit",function(node){var menu=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-menuflyout",node)[0];var onClick=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);var node=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var clickedInMenu=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-card-online-edit",node)!=null;if(clickedInMenu==false){var id=D2L.LP.Web.UI.Html.AbsoluteHtmlId.Create(menu.id);D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.Close(id)}};
var card=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-card",node);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",card,onClick)});
D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle={GetHandle:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-handle",node))node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-handle",node);return node.handle},FreezeCard:function(id){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.GetHandle(id);handle.keepOpen=true;handle.suppressEsc=true},ThawCard:function(id){var handle=
D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.GetHandle(id);handle.keepOpen=false;setTimeout(function(){handle.suppressEsc=false;if(handle.hoveredOpen||handle.clickedOpen||handle.keepOpen)return;D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-hide",handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-hide-fast",handle.node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-show",handle.node);D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-user-profile-handle-hide",
handle.node)},500)},Init:function(infoList){for(var i=0;i<infoList.length;i++){var handleId=infoList[i].HandleId.GetValue();var profileHandle=D2L.LP.Web.UI.Html.Dom.GetElementById(handleId);if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-handle-print",profileHandle)){D2L.LP.Web.UI.Common.Controls.ImageLink.SetImage(infoList[i].ImageId,infoList[i].ImageUrl,infoList[i].Size,infoList[i].Size);D2L.LP.Web.UI.Html.Dom.SetAttribute(profileHandle,"data-d2l-pid",infoList[i].ProfileId);var span=profileHandle.getElementsByTagName("span")[0];
span.innerHTML=infoList[i].Title}else{var image=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-user-profile-handle-no-sprite",profileHandle)[0];image.src=infoList[i].ImageUrl;image.height=infoList[i].Size;image.width=infoList[i].Size}}},InitHandle:function(node){var handle={node:node,imageNode:null,clickedOpen:false,hoveredOpen:false,keepOpen:false,fadeInThreshold:400,fadeOutThreshold:600,noShow:false};handle.imageNode=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-imagelink",node)[0];handle.noShow=
D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-handle-print",node);node.handle=handle;return handle},ShowCard:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-user-profile-handle",node))node=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-handle",node);D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.ShowCard(node)},GetProfileId:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());
var pid=D2L.LP.Web.UI.Html.Dom.GetAttribute(node,"data-d2l-pid");return pid}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-user-profile-handle-normal",function(node){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.InitHandle(node);var userProfileCard=D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard;var $card=$(".d2l-user-profile-card",node);if(handle.noShow)return;$card.hide();var fadeInThreshold=400;var fadeOutThreshold=600;var removeClassNames=function(){D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-hide",node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-hide-fast",
node);D2L.LP.Web.UI.Html.Dom.RemoveClassName("d2l-user-profile-handle-show",node)};$card.bind("webkitTransitionEnd oTransitionEnd otransitionend transitionend msTransitionEnd",function(){if($card.parent().hasClass("d2l-user-profile-handle-hide")||$card.parent().hasClass("d2l-user-profile-handle-hide-fast"))$card.hide()});var fadeCardIn=function(){if(handle.clickedOpen)return;handle.hoveredOpen=true;setTimeout(function(){if(!handle.hoveredOpen||handle.clickedOpen)return;removeClassNames();$card.show();
D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-user-profile-handle-show",node);userProfileCard.ShowCard(node);$(node).hide().show(0)},fadeInThreshold)};var fadeCardOut=function(){handle.hoveredOpen=false;if(handle.clickedOpen||handle.keepOpen)return;setTimeout(function(){if(handle.hoveredOpen||handle.keepOpen)return;removeClassNames();D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-user-profile-handle-hide",node);userProfileCard.HideCard(node)},fadeOutThreshold)};var showCard=function(){if(handle.clickedOpen||
handle.keepOpen)return;$card.show();handle.clickedOpen=true;handle.hoveredOpen=false;D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",document.body,onFocus,true);removeClassNames();D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-user-profile-handle-show",node);userProfileCard.ShowCard(node);handle.imageNode.focus()};var hideCard=function(){$card.hide();if(!handle.clickedOpen||handle.hoveredOpen)return;handle.clickedOpen=false;D2L.LP.Web.UI.Html.Dom.RemoveEventListener("focus",document.body,onFocus,true);
removeClassNames();D2L.LP.Web.UI.Html.Dom.AddClassName("d2l-user-profile-handle-hide-fast",node);userProfileCard.HideCard(node)};var onFocus=function(){var activeNode=D2L.LP.Web.UI.Html.Dom.GetActiveElement();if(!D2L.LP.Web.UI.Html.Dom.IsAncestor(node,activeNode))hideCard()};var onClick=function(e){D2L.LP.Web.UI.Html.Dom.CancelEventBubble(e);var node=D2L.LP.Web.UI.Html.Dom.GetEventTargetElement(e);var clickedInCard=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-user-profile-card",node)!=
null;if(handle.clickedOpen&&clickedInCard==false)hideCard();else showCard()};D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,fadeCardIn);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,fadeCardOut);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,onClick);D2L.LP.Web.UI.Events.OnClick.AddListener(function(){if(!handle.clickedOpen)return;hideCard()});D2L.LP.Web.UI.Html.Dom.AddKeyPressEventListener(node,function(kpArgs){if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Escape&&
!handle.suppressEsc)hideCard();else if(kpArgs.GetKey()===D2L.LP.Web.UI.Html.Dom.KeyPressEventArgs.Key.Enter){showCard();return false}})});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-user-profile-handle-always-show",function(node){var handle=D2L.LP.Profile.Web.Desktop.Controls.UserProfileHandle.InitHandle(node);D2L.LP.Profile.Web.Desktop.Controls.UserProfileCard.ShowCard(node,false)});D2L.LP.QuickLinks={Web:{Desktop:{Controls:{},Dialog:{},HtmlEditor:{}}}};
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector={ClearSelection:function(id){var controlId=id.GetValue();var node=D2L.LP.Web.UI.Html.Dom.GetElementById(controlId);node.d2l_selectedItems=[];var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(controlId,"onSelectionChanged");if(onSelectionChanged!=null)onSelectionChanged.call(onSelectionChanged)},GetOutputFormat:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());var outputFormat=node.getAttribute("data-d2l-outputformat");
if(outputFormat===undefined||outputFormat===null)return"";else return outputFormat},GetSelectedItem:function(id){var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;var items=me.GetSelectedItems(id);if(items.length==0)return null;return items[items.length-1]},GetSelectedItems:function(id){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems!=null)return node.d2l_selectedItems;return[]},OnSelectItem:function(id,typeKey,itemId,itemTitle,itemProperties){if(itemId==
null)return;if(itemTitle==null)itemTitle="";var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,itemId,null,itemTitle,itemProperties,me.GetOutputFormat(id)))},OnSelectPublicItem:function(id,typeKey,itemUrl,itemTitle,itemProperties){if(itemUrl==null)return;if(itemTitle==null)itemTitle="";var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector;me.OnSelectItemHelper(id,new me.ItemData(typeKey,null,itemUrl,itemTitle,itemProperties,me.GetOutputFormat(id)))},
OnSelectItemHelper:function(id,item){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(id.GetValue());if(node.d2l_selectedItems===undefined)node.d2l_selectedItems=[];node.d2l_selectedItems.push(item);var onSelect=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onSelect");if(onSelect!=null)onSelect.call(onSelect);var onSelectionChanged=D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onSelectionChanged");if(onSelectionChanged!=null)onSelectionChanged.call(onSelectionChanged)},TriggerOnManage:function(id){setTimeout(function(){var onManage=
D2L.LP.Web.UI.ObjectRepository.TryGet(id.GetValue(),"onManage");if(onManage!=null)onManage.call(onManage)},0)}};D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.AddFileItem={GetTitle:function(fileParam){var files=fileParam.GetFiles();if(files==null||fileParam.length===0)return"Placeholder";return files[0].GetFileName()}};
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData=D2L.Class.Create({Construct:function(typeKey,id,url,title,properties,outputFormat){this.m_typeKey=typeKey;if(id==null)id="";this.m_id=id;if(url==null)url="";this.m_url=url;this.m_title=title;if(properties==null)properties=[];this.m_properties=properties;if(outputFormat==null)outputFormat="";this.m_outputFormat=outputFormat},_serialize:function(serializer){serializer.AddMember("typeKey",this.m_typeKey);serializer.AddMember("id",this.m_id);
serializer.AddMember("url",this.m_url);serializer.AddMember("title",this.m_title);serializer.AddMember("outputFormat",this.m_outputFormat);var properties=this.m_properties;for(var i=0;i<properties.length;i++)serializer.AddMember(properties[i].name,properties[i].value)}});D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter={GetParam:function(value){var me=D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter;var param=new me.Param(value);return param}};
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.SearchSimpleFilter.Param=D2L.Class.Create({Construct:function(value){if(value===undefined)value="";this.m_value=value},_serialize:function(serializer){serializer.AddMember("type","searchsimple");serializer.AddMember("value",this.m_value)}});
D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.IFrame={Create:function(location,title,target){var iFrameContainer=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-quicklinkselector-iframe",frameElement);if(iFrameContainer==null)return;var id=new D2L.LP.Web.UI.Html.AbsoluteHtmlId(iFrameContainer.getAttribute("data-d2l-id"));var typeKey=iFrameContainer.getAttribute("data-d2l-typekey");if(title===undefined)title=location.GetUrl();if(target!=null)target=[{"name":"target","value":target}];
var createPublicItem=parent.D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.OnSelectPublicItem;createPublicItem(id,typeKey,location.GetUrl(),title,target)}};D2L.LP.QuickLinks.Web.Desktop.Dialog.Default={OnSelectionChanged:function(itemIds){}};
D2L.LP.QuickLinks.Web.Desktop.HtmlEditor.QuickLinksDialogComponent={GetQuickLinkItems:function(editorId){var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());if(node.d2l_quicklinks!==undefined)return node.d2l_quicklinks;return[]},GetQuickLinkData:function(editorId){var node=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(node==null||node.nodeName!="A")return null;var href=node.getAttribute("href");var title=D2L.LP.Web.UI.Html.Dom.GetTextContent(node);var target=
node.getAttribute("target");if(target=="_top")target="WholeWindow";else if(target=="_blank")target="NewWindow";else target="SameFrame";var properties=[];properties.push({name:"target",value:target});return new D2L.LP.QuickLinks.Web.Desktop.Controls.QuickLinkSelector.ItemData("",null,href,title,properties,"html")},GetQuickLinkSelectedText:function(editorId){var text;var selectedNode=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectedNode(editorId);if(selectedNode&&selectedNode.nodeName==="A")text=
D2L.LP.Web.UI.Html.Dom.GetTextContent(selectedNode);else text=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.GetSelectionContent(editorId);if(text===undefined||text===null)text="";return text},Insert:function(editorId,openFunction,quicklinksProvider,selectionProvider){D2L.LP.Web.UI.Desktop.Controls.HtmlEditor.PasteDelayed(editorId,openFunction,selectionProvider,function(quicklinkItems){var evt=new D2L.LP.Web.UI.Events.Event;var node=D2L.LP.Web.UI.Html.Dom.GetElementById(editorId.GetValue());node.d2l_quicklinks=
quicklinkItems;quicklinksProvider.call(quicklinksProvider).AddListener(function(quicklinks){if(quicklinks==null||quicklinks.length==0){evt.Trigger("");return}var quicklinksHtml="";for(var i=0;i<quicklinks.length;i++)quicklinksHtml+=quicklinks[i].html;evt.Trigger(quicklinksHtml)});return evt})},SelectLink:function(editorId){var htmlEditor=D2L.LP.Web.UI.Desktop.Controls.HtmlEditor;var selectedNode=htmlEditor.GetSelectedNode(editorId);if(selectedNode==null)return;if(selectedNode.nodeName=="A")htmlEditor.SelectNode(editorId,
selectedNode)}};D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-quicklinkselector-iframe",function(node){var id=node.getAttribute("id");var setWidth=D2L.LP.Web.UI.ObjectRepository.TryGet(id,"setWidth");if(setWidth!=null)setWidth.call(setWidth);D2L.LP.Web.UI.Events.OnContentHeightChange.Trigger()});
D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne={Init:function(node){var data={"size":"medium","count":"true"};if(D2L.LP.Web.UI.Html.Dom.HasAttribute(node,"data-href"))data["href"]=node.getAttribute("data-href");gapi.plusone.render(node,data)}};D2L.LP.Web.UI.Desktop.Controls.TweetButton={Init:function(node){D2L.LP.Web.UI.Html.Dom.AddEventListener("click",node,function(){var win=window.open(node.getAttribute("href"),"twitterWin","height=420,width=555,menubar=no,toolbar=no");win.focus()})}};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-gplusone",function(node){D2L.LP.Web.UI.Desktop.Controls.GooglePlusOne.Init(node)});D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-twitter",function(node){D2L.LP.Web.UI.Desktop.Controls.TweetButton.Init(node)});
D2L.LP.ActivityBar={Init:function(pollLocation,pollInterval,bucketClassNameFormat,updateVariableNameFormat){var myWindow=window;var findTopWindow=function(win){try{if(win&&win["D2L"]!==undefined){if(win.parent&&win.parent!=win)return findTopWindow(win.parent);return win}}catch(e){}};var topWindow=findTopWindow(myWindow);if(myWindow!==topWindow||myWindow===null)return;pollInterval=pollInterval*1E3;var processPollResponse=function(data){for(var i=0;i<data.length;i++){var bucketClassName=bucketClassNameFormat.replace("{0}",
data[i]);var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)continue;D2L.LP.ActivityBar.SetAlertStatus(bucketClassName);var updateVariable=updateVariableNameFormat.replace("{0}",data[i]);D2L.VS(updateVariable,true);var messageDisplayed=bucket.m_ariaMessageDisplayed;if(!messageDisplayed){bucket.m_ariaMessageDisplayed=true;var ariaMessage=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"aria-message");D2L.LP.Web.UI.Html.Aria.LogMessage(ariaMessage)}}setTimeout(poll,
pollInterval)};var poll=function(){var expired=D2L.PT.Auth.SessionTimeout.IsExpired();if(expired){setTimeout(poll,pollInterval);return}var rpcEvt=D2L.LP.Web.UI.Rpc.ConnectObject(D2L.LP.Web.UI.Rpc.Verbs.GET,pollLocation,null,{keepAlive:false,failure:function(){return true}});rpcEvt.AddListener(processPollResponse)};setTimeout(poll,pollInterval)},SetAlertStatus:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;var alertImage=
D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);var bucketId=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"flyout-id");var isOpen=D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.IsOpen(bucketId);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,
true);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,!isOpen);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,isOpen)},OpenBucket:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;bucket.m_ariaMessageDisplayed=false;var alertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",
bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,
false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,true)},CloseBucket:function(bucketClassName){var bucket=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName(bucketClassName);if(bucket===null)return;bucket.m_ariaMessageDisplayed=false;var alertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("Alert",bucket);var openAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("OpenAlert",bucket);var newAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewAlert",bucket);
var newOpenAlertImage=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("NewOpenAlert",bucket);var hasAlert=!D2L.LP.Web.UI.Html.Dom.HasClassName("d2l-hidden",newOpenAlertImage);D2L.LP.ActivityBar.UpdateTitle(bucketClassName,hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(alertImage,!hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(openAlertImage,false);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newAlertImage,hasAlert);D2L.LP.Web.UI.Html.Dom.SetIsDisplayedNode(newOpenAlertImage,false)},UpdateTitle:function(bucketClassName,
hasNewAlerts){var bucketId=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"flyout-id");var title;if(hasNewAlerts)title=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"new-alert-title");else title=D2L.LP.Web.UI.ObjectRepository.Get(bucketClassName,"title");D2L.LP.Web.UI.Desktop.Controls.MenuFlyout.SetTitle(bucketId,title)}};D2L.PT.Auth=D2L.PT.Auth||{};
D2L.PT.Auth.SessionTimeout={InitData:{ExpireIsVisible:false,ExpireFunc:function(){},Extending:false,ExtendFunc:function(){},IsInit:false,LogoutFunc:function(){},NewUserFunc:function(){},DismissNewUserFunc:function(){},RequiresSession:false,SessionTimeout:180*6E4,UserId:0,WarningBuffer:5*6E4,WarningIsVisible:false,WarningMessageId:null,WarningAlertId:null,WarningCheckId:null,WarningTimeoutIntervalIds:[]},SessionManager:null,ApplyTimeoutConstraints:function(oldTimeout){var newTimeout=oldTimeout;if(oldTimeout<
1)newTimeout=1;if(oldTimeout>35796)newTimeout=35796;return newTimeout},Expire:function(sm,expiredState){if(!sm.InitData.RequiresSession||sm.InitData.ExpireIsVisible)return;sm.InitData.ExpireIsVisible=true;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Expired",expiredState);sm.HideWarning(sm);if(expiredState==="1")sm.InitData.LogoutFunc();else if(expiredState==="2")sm.InitData.ExpireFunc()},ExpiryInit:function(closeDialogFunc){var handleStorageChange=function(e){if(e.Key==="Session.Expired"&&
e.NewValue==="0")closeDialogFunc()};D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange)},FinalizeLogin:function(){if(!window.opener)return;window.close()},FinalizeLoginUsernamePassword:function(){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired","0")},GetWarningBuffer:function(){var me=D2L.PT.Auth.SessionTimeout;var buffer=10*60*1E3;if(me.InitData.SessionTimeout<=buffer)if(me.InitData.SessionTimeout>6E4)buffer=6E4;else buffer=0;return buffer},HandleSessionStorageChange:function(sm,
expired){if(expired==="1"||expired==="2")sm.Expire(sm,expired);else{sm.InitData.ExpireIsVisible=false;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Resumed");D2L.PT.Auth.SessionTimeout.HideWarning(sm)}},HandleLastAccessedStorageChange:function(sm){if(sm.InitData.SessionTimeout<18E4)return;if(sm.InitData.WarningTimeoutIntervalIds.length>0){sm.HideWarning(sm);for(var i=0;i<sm.InitData.WarningTimeoutIntervalIds.length;i++)clearTimeout(sm.InitData.WarningTimeoutIntervalIds[i])}var timeout=sm.InitData.SessionTimeout-
sm.InitData.WarningBuffer;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Resetting timeout");sm.InitData.WarningTimeoutIntervalIds=[setTimeout(function(){sm.ShowWarning(sm)},timeout)]},HandleUserStorageChange:function(sm,e){D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: User change",e.OldValue,e.NewValue);sm.InitData.DismissNewUserFunc();if(e.NewValue!==sm.InitData.UserId)sm.InitData.NewUserFunc()},HideWarning:function(sm){if(!sm.InitData.WarningIsVisible)return;var isExpired=sm.IsExpired();
D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: hiding warning");sm.InitData.WarningIsVisible=false;sm.InitData.Extending=false;var timeout=0;if(!isExpired){D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningAlertId).style.display="none";D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningCheckId).style.display="block";timeout=1E3}setTimeout(function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Close(sm.InitData.WarningMessageId)},timeout)},IsExpired:function(){var expiredState=
D2L.LP.Web.UI.Html.Dom.Storage.Local.Get("Session.Expired");var isExpired=expiredState==="1"||expiredState==="2";return isExpired},Init:function(userId,sessionTimeout,warningBuffer,warningMessageId,warningAlertId,warningCheckId,extendFunc,expireFunc,logoutFunc,newUserFunc,dismissNewUserFunc){var me=D2L.PT.Auth.SessionTimeout;var verifiedSessionTimeout=me.ApplyTimeoutConstraints(sessionTimeout);me.InitData.ExpireFunc=expireFunc;me.InitData.ExtendFunc=extendFunc;me.InitData.IsInit=true;me.InitData.LogoutFunc=
logoutFunc;me.InitData.NewUserFunc=newUserFunc;me.InitData.DismissNewUserFunc=dismissNewUserFunc;me.InitData.RequiresSession=true;me.InitData.SessionTimeout=verifiedSessionTimeout*6E4;me.InitData.UserId=userId;me.InitData.WarningBuffer=warningBuffer*6E4;me.InitData.WarningAlertId=warningAlertId;me.InitData.WarningCheckId=warningCheckId;me.InitData.WarningMessageId=warningMessageId;var findSessionManager=function(win){try{if(win&&win.D2L!==undefined){if(win.D2L.PT.Auth.SessionTimeout.InitData.IsInit)me.SessionManager=
win.D2L.PT.Auth.SessionTimeout;if(win.parent&&win.parent!=win)findSessionManager(win.parent)}}catch(e){}};findSessionManager(window);if(me.SessionManager===null)return;var expired="0";var lastAccessed="0";if(me.SessionManager!==D2L.PT.Auth.SessionTimeout){D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString());D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.UserId",userId);return}var handleStorageChange=function(e){if(e.Key==="Session.Expired"){if(expired!==
e.NewValue){expired=e.NewValue;me.HandleSessionStorageChange(me,expired)}}else if(e.Key==="Session.UserId"){if(userId!==e.NewValue){userId=e.NewValue;me.HandleUserStorageChange(me,e)}}else if(e.Key==="Session.LastAccessed")if(lastAccessed!==e.NewValue){lastAccessed=e.NewValue;me.HandleLastAccessedStorageChange(me)}};var handleClickKey=function(){if(!me.InitData.WarningIsVisible||me.InitData.Extending)return;me.InitData.Extending=true;me.InitData.ExtendFunc()};D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired",
expired);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.UserId",userId);D2L.LP.Web.UI.Events.OnClick.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnKeyPress.AddListener(handleClickKey);D2L.LP.Web.UI.Events.OnStorage.AddListener(handleStorageChange);D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString())},RpcReceivePayloadProvider:function(result){var sm=D2L.PT.Auth.SessionTimeout.SessionManager;if(sm===null)return;D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: Rpc update, has expired:",
result.HasExpired,"Keep alive:",result.KeepAlive);if(sm.IsExpired()){D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: already expired");return}if(result.HasExpired)D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired","2");else if(result.KeepAlive)D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.LastAccessed",(new Date).getTime().toString())},ShowWarning:function(sm){if(sm.InitData.WarningIsVisible||sm.IsExpired())return;var timeout=5E4;var shake=function(){D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Shake(sm.InitData.WarningMessageId);
sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,timeout));timeout=6E4};D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: showing warning");sm.InitData.WarningIsVisible=true;D2L.LP.Web.UI.Desktop.MasterPages.PageMessage.Open(sm.InitData.WarningMessageId);setTimeout(function(){var checkNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningCheckId);if(checkNode)checkNode.style.display="none";var alertNode=D2L.LP.Web.UI.Html.Dom.GetElementById(sm.InitData.WarningAlertId);if(alertNode)alertNode.style.display=
"block";sm.InitData.WarningTimeoutIntervalIds.push(setTimeout(shake,5E3))},50)}};
D2L.PT.Auth.Logout=function(logoutLocation){var frm=document.createElement("form");frm.target="_top";frm.action=logoutLocation;frm.method="post";var hidden=document.createElement("input");hidden.type="hidden";hidden.name=D2L.LP.Web.Authentication.Xsrf.GetXsrfTokenParameterName();hidden.value=D2L.LP.Web.Authentication.Xsrf.GetXsrfToken();frm.appendChild(hidden);document.body.appendChild(frm);frm.submit();D2L.LP.Web.UI.Html.JavaScript.Console.Debug("Session: logging out...");D2L.LP.Web.UI.Html.Dom.Storage.Local.Set("Session.Expired",
"1",false)};D2L.PT.Navbars={};
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-minibar",function(node){var placeholder=D2L.LP.Web.UI.Html.Dom.GetParentElementByClassName("d2l-minibar-placeholder",node);if(placeholder===null)return;var flyouts=D2L.LP.Web.UI.Html.Dom.GetElementsByClassName("d2l-menuflyout-contents",node);var adjustFlyouts=function(minibarHeight){if(flyouts.length===0)return;var viewport=D2L.LP.Web.UI.Html.Dom.GetViewportSize(window);var maxHeight=Math.max(viewport.height-minibarHeight-10,100);for(var i=0;i<flyouts.length;i++)flyouts[i].style.maxHeight=
maxHeight+"px"};var adjustHeight=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(node);placeholder.style.height=rect.height+"px";adjustFlyouts(rect.height)};D2L.LP.Web.UI.Events.OnResize.AddListener(adjustHeight);adjustHeight()});
D2L.LP.Web.UI.Html.Dom.AddClassInitializer("d2l-navbar",function(node){D2L.LP.Web.UI.Html.Aria.SetRole(node,"navigation");var isRTL=D2L.LP.Globalization.Locale.GetTextFormatDescriptor().TextDirection==D2L.LP.Globalization.Formatting.Text.TextDirection.RightToLeft;var editLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-navbar-edit",node);var manageLink=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-navbar-manage",node);var container=D2L.LP.Web.UI.Html.Dom.GetFirstElementByClassName("d2l-max-width",
node);if(editLink===null||container===null)return;var show=function(){var rect=D2L.LP.Web.UI.Html.Dom.GetBoundingRect(container);editLink.style.top=rect.top+25+"px";manageLink.style.top=rect.top+5+"px";var left;if(isRTL){left=rect.right;if(rect.right-13<rect.width)left=left+-13;editLink.style.left=left+"px";editLink.style.right="auto";manageLink.style.left=left+"px";manageLink.style.right="auto"}else{left=rect.left+-13;if(left<0)left=0;editLink.style.left=left+"px";manageLink.style.left=left+"px"}};
var hide=function(){if(isRTL){editLink.style.right="-10000px";manageLink.style.right="-10000px"}else{editLink.style.left="-10000px";manageLink.style.left="-10000px"}};D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseover",node,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",editLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("focus",manageLink,show);D2L.LP.Web.UI.Html.Dom.AddEventListener("mouseout",node,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",editLink,hide);D2L.LP.Web.UI.Html.Dom.AddEventListener("blur",
manageLink,hide)});D2L.PT.ExternalUrls={Web:{Desktop:{HtmlEditor:{},Whitelisting:{},XSPL:{IFrame:{}}}}};
D2L.PT.ExternalUrls.Web.Desktop.HtmlEditor.XSPLScript={Initialize:function(replace){tinymce.create("d2l.tinymce.plugins.XSPLScript",{init:function(ed,url){var me=this;me.editor=ed;ed.onBeforeSetContent.add(function(ed,o){me._convertXSPLIFrameToXSPLImagePlaceholder(o);return});ed.onPostProcess.add(function(ed,o){me._convertXSPLImagePlaceholderToOriginalContent(o);return})},_convertXSPLIFrameToXSPLImagePlaceholder:function(context){var me=this;if(context.content==null||context.content.length==0)return;
var tempContent=context.content;var replace=function(match){var originalContent=me._getOriginalContent(match);var originalContentEncoded=tinymce.html.Entities.encodeAllRaw(originalContent);var img='<img style="'+me._getImageStyle()+'" class="d2l-xspl-image-placehoder" src="'+me.editor.theme.url+'/img/trans.gif"'+' data-d2l-xspl-original-html="'+originalContentEncoded+'"/>';return img};tempContent=tempContent.replace(me._xsplIFrameRegEx(),replace);context.content=tempContent},_xsplIFrameRegEx:function(){return/<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi},
_getImageStyle:function(height,width){return"border:1px solid #333399; background-position:center;"+" height:"+(height||173)+"px;"+"width:"+(width||330)+"px;"+" background-repeat:no-repeat; background-color:#ffffcc;"+" background-image: url(/d2l/img/lp/xspl/html_editor_media.png);"},_getOriginalContent:function(html){var me=this;var tempContent=html;var replace=function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&
originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=tinymce.html.Entities.decode(originalContentHtmlEncoded);originalContent=me._getOriginalContent(originalContent)}return originalContent};tempContent=tempContent.replace(me._xsplIFrameRegEx(),replace);return tempContent},_convertXSPLImagePlaceholderToOriginalContent:function(context){if(context.content==null||context.content.length==0)return;var tempContent=context.content;var replace=
function(match){var originalContent=match;var originalContentHtmlEncodedMatch=match.match(/ data-d2l-xspl-original-html=\"([^\"]*)\"/i);if(originalContentHtmlEncodedMatch&&originalContentHtmlEncodedMatch[1]){var originalContentHtmlEncoded=originalContentHtmlEncodedMatch[1];originalContent=tinymce.html.Entities.decode(originalContentHtmlEncoded)}return originalContent};tempContent=tempContent.replace(/<img[^>]*class=\"d2l-xspl-image-placehoder\"[^>]*>/gi,replace);context.content=tempContent}});tinymce.PluginManager.add("d2l_xspl",
d2l.tinymce.plugins.XSPLScript);return"-d2l_xspl"}};
D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.ClearGridEdit=function(idString){var grid=$(".d2l-grid-wrapper");var editTargets=grid.find(".d2l-editable-target");var editables=grid.find(".d2l-editable-padding");var edits=grid.find(".d2l-edit");for(i=0;i<editTargets.length;++i){if(editTargets[i].id===idString)continue;D2L.LP.Web.UI.Desktop.Controls.EditInPlace.Finish(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(editTargets[i].id));D2L.LP.Web.UI.Common.Controls.Edit.SetValue(new D2L.LP.Web.UI.Html.AbsoluteHtmlId(edits[i].id),editables[i].children[0].textContent)}};
D2L.PT.ExternalUrls.Web.Desktop.Whitelisting.StripLRM=function(id){var input=id.$();var value=input.val();value=value.replace(/\u200E/g,"");input.val(value)};D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml=function(url,xsplNode){var originalHtml=D2L.LP.Web.UI.Html.Dom.GetAttribute(xsplNode,"data-original-html");originalHtml=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalHtml);if(originalHtml)$(xsplNode).replaceWith(originalHtml)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow=function(xsplNode,url,blockLinkText){var linkContainer=document.createElement("div");var originalXSPLCode;if(xsplNode.outerHTML!==undefined)originalXSPLCode=xsplNode.outerHTML;else originalXSPLCode=$("<div>").append($(xsplNode).clone()).html();var onClickHandler=function(){originalXSPLCode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam(originalXSPLCode);$(linkContainer).prev().replaceWith(originalXSPLCode);$(linkContainer).remove()};var link=D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink(blockLinkText,
onClickHandler);linkContainer.appendChild(link);D2L.LP.Web.UI.Html.Dom.InsertElementAfter(linkContainer,xsplNode);D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,xsplNode);return true};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames=function(url,originalXSPLCode){var tempContent=originalXSPLCode;var replace=function(match){var originalContent=match;var src=match.match(/ src=\"([^\"]*)\"/i);if(src&&src[1]&&decodeURIComponent(src[1]).indexOf(url)>=-1){var encodedOriginalContentMatch=match.match(/ data-original-html=\"([^\"]*)\"/i);if(encodedOriginalContentMatch&&encodedOriginalContentMatch[1]){var originalContentHtmlEncoded=encodedOriginalContentMatch[1];originalContent=
$("<div/>").html(originalContentHtmlEncoded).text();originalContent=D2L.PT.ExternalUrls.Web.Desktop.XSPL.FixNestedXSPLIFrames(url,originalContent)}}return originalContent};tempContent=tempContent.replace(/<iframe[^>]*class=\"d2l-xspl-box\"[^>]*>(.|\n|\r)*?<\/iframe>/gi,replace);return tempContent};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.BuildBlockLink=function(blockLinkText,onClickHandler){var link=document.createElement("a");link.className="xspl-block-link";if(link.textContent!==undefined)link.textContent=blockLinkText;else if(node.innerText!==undefined)link.innerText=blockLinkText;D2L.LP.Web.UI.Html.Aria.SetRole(link,"button");D2L.LP.Web.UI.Common.Controls.Link.InstallClickable(link);D2L.LP.Web.UI.Html.Dom.AddEventListener("click",link,onClickHandler);return link};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.AddUnTrustParam=function(originalXSPLCode){if(originalXSPLCode.indexOf("/lp/externalUrls/xspl?untrust=1")<0)originalXSPLCode=originalXSPLCode.replace("/lp/externalUrls/xspl?","/lp/externalUrls/xspl?untrust=1&");return originalXSPLCode};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ReplaceMeWithOriginalHtml=function(url){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.ReplaceXSPLWithOriginalHtml(url,iframeNode)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.Allow=function(url,blockLinkText){var parentWindow=window.parent;var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();parentWindow.D2L.PT.ExternalUrls.Web.Desktop.XSPL.Allow(iframeNode,url,blockLinkText)};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.ResizeToContent=function(){var iframeNode=D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame();var height=D2L.LP.Web.UI.Html.Dom.GetPageSize(window).height;iframeNode.style.height=height+"px"};
D2L.PT.ExternalUrls.Web.Desktop.XSPL.IFrame.GetIFrame=function(){var doc=undefined;try{doc=window.parent.document}catch(e){}if(doc===undefined)return null;var iframes=window.parent.document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++)if(iframes[i].contentWindow==window)return iframes[i];return null};if(window["D2L"]!==undefined&&D2L.LP.Web.Packaging!==undefined)D2L.LP.Web.Packaging.Register("D2L.LP.Web.Desktop.default");